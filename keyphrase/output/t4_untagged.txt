disk file allocation based on the buddy system is covered in koch  1987   a file-organization scheme that guarantees retrieval in one access is described by larson and kajla  1984   log-structured file organizations for enhancing both performance and consistency are discussed in rosenblum and ousterhout  1991   seltzer et al  1993   and seltzer et al  1995   algorithms such as balanced trees  and much more  are covered by knuth  1998  and carmen et al  2001   the zfs source code for space maps can be found at http  //src.opensolaris.org/source/xref/onnv/onnvgate/ usr i src/uts/ common/ fs/ zfs/ space_map.c  
in/IN/in chapter/NN/chapter 5/CD/5 /,/, we/PRP/we showed/VBD/showed how/WRB/how the/DT/the cpu/NN/cpu can/MD/can be/VB/be shared/VBN/shared by/IN/by a/DT/a set/NN/set of/IN/of processes/NNP/processes. as/IN/as a/DT/a result/NN/result of/IN/of cpu/NN/cpu scheduling/VBG/scheduling /,/, we/PRP/we can/MD/can improve/VB/improve both/DT/both the/DT/the utilization/NN/utilization of/IN/of the/DT/the cpu/NN/cpu and/CC/and the/DT/the speed/NN/speed of/IN/of the/DT/the computer/NN/computer 's/POS/'s response/NN/response to/TO/to its/PRP$/its users/NNP/users. to/TO/to realize/VB/realize this/DT/this increase/NN/increase in/IN/in performance/NN/performance /,/, however/RB/however /,/, we/PRP/we must/MD/must keep/VB/keep several/JJ/several processes/NNS/processes in/IN/in memory/NN/memory ;/:/; that/DT/that is/VBZ/is /,/, we/PRP/we must/MD/must share/VB/share memory/NNP/memory. in/IN/in this/DT/this chapter/NN/chapter /,/, we/PRP/we discuss/VBP/discuss various/JJ/various ways/NNS/ways to/TO/to manage/VB/manage memory/NNP/memory. the/DT/the memorymanagement/NN/memorymanagement algorithms/NNS/algorithms vary/JJ/vary from/IN/from a/DT/a primitive/JJ/primitive bare-machine/NN/bare-machine approach/NN/approach to/TO/to paging/NN/paging and/CC/and segmentation/NN/segmentation strategies/NNP/strategies. each/DT/each approach/NN/approach has/VBZ/has its/PRP$/its own/JJ/own advantages/NNS/advantages and/CC/and disadvantages/NNP/disadvantages. selection/NN/selection of/IN/of a/DT/a memory-management/JJ/memory-management method/NN/method for/IN/for a/DT/a specific/JJ/specific system/NN/system depends/NNS/depends on/IN/on many/JJ/many factors/NNS/factors /,/, especially/RB/especially on/IN/on the/DT/the hardware/NN/hardware design/NN/design of/IN/of the/DT/the system/NNP/system. as/IN/as we/PRP/we shall/MD/shall see/VB/see /,/, many/JJ/many algorithms/NNS/algorithms require/VBP/require hardware/NN/hardware support/NN/support /,/, although/IN/although recent/JJ/recent designs/NNS/designs have/VBP/have closely/RB/closely integrated/VBN/integrated the/DT/the hardware/NN/hardware and/CC/and operating/NN/operating system/NNP/system. to/TO/to provide/VB/provide a/DT/a detailed/JJ/detailed description/NN/description of/IN/of various/JJ/various ways/NNS/ways of/IN/of organizing/VBG/organizing memory/NN/memory hardware/NNP/hardware. to/TO/to discuss/VB/discuss various/JJ/various memory-management/JJ/memory-management techniques/NNS/techniques /,/, including/VBG/including paging/NN/paging and/CC/and segmentation/NNP/segmentation. to/TO/to provide/VB/provide a/DT/a detailed/JJ/detailed description/NN/description of/IN/of the/DT/the intel/NN/intel pentium/NN/pentium /,/, which/WDT/which supports/NNS/supports both/DT/both pure/NN/pure segmentation/NN/segmentation and/CC/and segmentation/NN/segmentation with/IN/with paging/NNP/paging. as/IN/as we/PRP/we saw/VBD/saw in/IN/in chapter/NN/chapter 1/CD/1 /,/, memory/NN/memory is/VBZ/is central/JJ/central to/TO/to the/DT/the operation/NN/operation of/IN/of a/DT/a modern/JJ/modern computer/NN/computer system/NNP/system. memory/NN/memory consists/VBZ/consists of/IN/of a/DT/a large/JJ/large array/NN/array of/IN/of words/NNS/words or/CC/or bytes/NNS/bytes /,/, each/DT/each with/IN/with its/PRP$/its own/JJ/own address/NNP/address. the/DT/the cpu/NN/cpu fetches/VBZ/fetches instructions/NNS/instructions from/IN/from memory/NN/memory according/VBG/according to/TO/to the/DT/the value/NN/value of/IN/of the/DT/the program/NN/program counter/NNP/counter. these/DT/these instructions/NNS/instructions may/MD/may cause/VB/cause additional/JJ/additional loading/NN/loading from/IN/from and/CC/and storing/VBG/storing to/TO/to specific/JJ/specific memory/NN/memory addresses/NNP/addresses. a/DT/a typical/JJ/typical instruction-execution/NN/instruction-execution cycle/NN/cycle /,/, for/IN/for example/NN/example /,/, first/JJ/first fetches/NNS/fetches an/DT/an instruction/NN/instruction from/IN/from memory/NNP/memory. the/DT/the instruction/NN/instruction is/VBZ/is then/RB/then decoded/VBN/decoded and/CC/and may/MD/may cause/VB/cause operands/NNS/operands to/TO/to be/VB/be fetched/VBN/fetched from/IN/from memory/NNP/memory. after/IN/after the/DT/the instruction/NN/instruction has/VBZ/has been/VBN/been executed/VBN/executed on/IN/on the/DT/the 315/CD/315 316/CD/316 chapter/NN/chapter 8/CD/8 operands/NNS/operands /,/, results/NNS/results may/MD/may be/VB/be stored/VBN/stored back/RP/back in/IN/in memory/NNP/memory. the/DT/the mernory/NN/mernory unit/NN/unit sees/NNS/sees only/RB/only a/DT/a stream/NN/stream of/IN/of memory/NN/memory addresses/NNS/addresses ;/:/; it/PRP/it does/VBZ/does not/RB/not know/VB/know how/WRB/how they/PRP/they are/VBP/are generated/VBN/generated /-NONE-/( by/IN/by the/DT/the instruction/NN/instruction counter/NN/counter /,/, indexing/VBG/indexing /,/, indirection/NN/indirection /,/, literal/JJ/literal addresses/NNS/addresses /,/, and/CC/and so/RB/so on/IN/on /NNP/) or/CC/or what/WP/what they/PRP/they are/VBP/are for/IN/for /NNP/( instructions/NNS/instructions or/CC/or data/NNS/data /:/) /./. accordingly/RB/accordingly /,/, we/PRP/we can/MD/can ignore/VB/ignore hozu/NN/hozu a/DT/a program/NN/program generates/VBZ/generates a/DT/a memory/NN/memory address/NNP/address. we/PRP/we are/VBP/are interested/JJ/interested only/RB/only in/IN/in the/DT/the sequence/NN/sequence of/IN/of memory/NN/memory addresses/NNS/addresses generated/VBD/generated by/IN/by the/DT/the running/VBG/running program/NNP/program. we/PRP/we begin/VBP/begin our/PRP$/our discussion/NN/discussion by/IN/by covering/NN/covering several/JJ/several issues/NNS/issues that/WDT/that are/VBP/are pertinent/VBP/pertinent to/TO/to the/DT/the various/JJ/various techniques/NNS/techniques for/IN/for managing/VBG/managing memory/NNP/memory. this/DT/this coverage/NN/coverage includes/VBZ/includes an/DT/an overview/NN/overview of/IN/of basic/JJ/basic hardware/NN/hardware issues/NNS/issues /,/, the/DT/the binding/NN/binding of/IN/of symbolic/JJ/symbolic memory/NN/memory addresses/NNS/addresses to/TO/to actual/JJ/actual physical/JJ/physical addresses/NNS/addresses /,/, and/CC/and the/DT/the distinction/NN/distinction between/IN/between logical/JJ/logical and/CC/and physical/JJ/physical addresses/NNP/addresses. we/PRP/we conclude/VBP/conclude the/DT/the section/NN/section with/IN/with a/DT/a discussion/NN/discussion of/IN/of dynamically/RB/dynamically loading/VBG/loading and/CC/and linking/VBG/linking code/NN/code and/CC/and shared/VBD/shared libraries/NNP/libraries. 8.1.1/CD/8.1.1 basic/JJ/basic hardware/NN/hardware main/NN/main memory/NN/memory and/CC/and the/DT/the registers/NNS/registers built/VBN/built into/IN/into the/DT/the processor/NN/processor itself/PRP/itself are/VBP/are the/DT/the only/JJ/only storage/NN/storage that/WDT/that the/DT/the cpu/NN/cpu can/MD/can access/NN/access directly/NNP/directly. there/EX/there are/VBP/are machine/NN/machine instructions/NNS/instructions that/WDT/that take/VB/take memory/NN/memory addresses/NNS/addresses as/IN/as arguments/NNS/arguments /,/, but/CC/but none/NN/none that/IN/that take/NN/take disk/NN/disk addresses/NNP/addresses. therefore/RB/therefore /,/, any/DT/any instructions/NNS/instructions in/IN/in execution/NN/execution /,/, and/CC/and any/DT/any data/NNS/data being/VBG/being used/VBN/used by/IN/by the/DT/the instructions/NNS/instructions /,/, must/MD/must be/VB/be in/IN/in one/CD/one of/IN/of these/DT/these direct-access/JJ/direct-access storage/NN/storage devices/NNP/devices. if/IN/if the/DT/the data/NNS/data are/VBP/are not/RB/not in/IN/in memory/NN/memory /,/, they/PRP/they must/MD/must be/VB/be moved/VBN/moved there/EX/there before/IN/before the/DT/the cpu/NN/cpu can/MD/can operate/VB/operate on/IN/on them/NNP/them. registers/NNS/registers that/WDT/that are/VBP/are built/VBN/built into/IN/into the/DT/the cpu/NN/cpu are/VBP/are generally/RB/generally accessible/JJ/accessible within/IN/within one/CD/one cycle/NN/cycle of/IN/of the/DT/the cpu/NN/cpu clock/NNP/clock. most/JJS/most cpus/JJ/cpus can/MD/can decode/VB/decode instructions/NNS/instructions and/CC/and perform/NN/perform simple/NN/simple operations/NNS/operations on/IN/on register/NN/register contents/NNS/contents at/IN/at the/DT/the rate/NN/rate of/IN/of one/CD/one or/CC/or more/JJR/more operations/NNS/operations per/IN/per clock/NN/clock tick/NN/tick the/DT/the same/JJ/same can/NN/can not/RB/not be/VB/be said/VBN/said of/IN/of main/JJ/main memory/NN/memory /,/, which/WDT/which is/VBZ/is accessed/VBN/accessed via/IN/via a/DT/a transaction/NN/transaction on/IN/on the/DT/the memory/NN/memory bus/NNP/bus. completing/NN/completing a/DT/a memory/NN/memory access/NN/access may/MD/may take/VB/take many/JJ/many cycles/NNS/cycles of/IN/of the/DT/the cpu/NN/cpu clock/NNP/clock. in/IN/in such/JJ/such cases/NNS/cases /,/, the/DT/the processor/NN/processor normally/RB/normally needs/VBZ/needs to/TO/to stall/VB/stall /,/, since/IN/since it/PRP/it does/VBZ/does not/RB/not have/VB/have the/DT/the data/NNS/data required/VBN/required to/TO/to complete/VB/complete the/DT/the instruction/NN/instruction that/IN/that it/PRP/it is/VBZ/is executing/NNP/executing. this/DT/this situation/NN/situation is/VBZ/is intolerable/JJ/intolerable because/IN/because of/IN/of the/DT/the frequency/NN/frequency of/IN/of memory/NN/memory accesses/NNP/accesses. the/DT/the remedy/NN/remedy is/VBZ/is to/TO/to add/VB/add fast/JJ/fast memory/NN/memory between/IN/between the/DT/the cpu/NN/cpu and/CC/and 0/-NONE-/0 operating/VBG/operating system/NN/system 256000/CD/256000 process/NN/process 300040/CD/300040 i/PRP/i soa/VBP/soa /:/( lj.o/-NONE-/lj.o i/PRP/i process/VBP/process base/NN/base 420940/CD/420940 i/PRP/i 120/CD/120 !/./! 1go/CD/1go i/PRP/i i/PRP/i /./. limit/NN/limit process/NN/process 880000/CD/880000 1024000/CD/1024000 figure/NN/figure 8.1/CD/8.1 a/DT/a base/NN/base and/CC/and a/DT/a limit/NN/limit register/NN/register define/NN/define a/DT/a logical/JJ/logical address/NN/address space/NNP/space. 8.1/CD/8.1 317/CD/317 main/JJ/main memory/NNP/memory. a/DT/a memory/NN/memory buffer/NN/buffer used/VBD/used to/TO/to accommodate/VB/accommodate a/DT/a speed/NN/speed differential/NN/differential /,/, called/VBN/called a/DT/a is/VBZ/is described/VBN/described in/IN/in section/NN/section 1.8.3/CD/1.8.3. not/RB/not only/RB/only are/VBP/are we/PRP/we concerned/VBD/concerned with/IN/with the/DT/the relative/JJ/relative speed/NN/speed of/IN/of accessing/VBG/accessing physical/JJ/physical memory/NN/memory /,/, but/CC/but we/PRP/we also/RB/also must/MD/must ensure/VB/ensure correct/JJ/correct operation/NN/operation to/TO/to protect/VB/protect the/DT/the operating/NN/operating system/NN/system from/IN/from access/NN/access by/IN/by user/NN/user processes/NNS/processes and/CC/and /,/, in/IN/in addition/NN/addition /,/, to/TO/to protect/VB/protect user/NN/user processes/NNS/processes from/IN/from one/CD/one another/NNP/another. this/DT/this protection/NN/protection must/MD/must be/VB/be provided/VBN/provided by/IN/by the/DT/the hardware/NNP/hardware. it/PRP/it can/MD/can be/VB/be implemented/VBN/implemented in/IN/in several/JJ/several ways/NNS/ways /,/, as/IN/as we/PRP/we shall/MD/shall see/VB/see throughout/IN/throughout the/DT/the chapter/NNP/chapter. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we outline/VBP/outline one/CD/one possible/JJ/possible implementation/NNP/implementation. we/PRP/we first/RB/first need/VBP/need to/TO/to make/VB/make sure/JJ/sure that/IN/that each/DT/each process/NN/process has/VBZ/has a/DT/a separate/JJ/separate memory/NN/memory space/NNP/space. to/TO/to do/VB/do this/DT/this /,/, we/PRP/we need/VBP/need the/DT/the ability/NN/ability to/TO/to determine/VB/determine the/DT/the range/NN/range of/IN/of legal/JJ/legal addresses/NNS/addresses that/WDT/that the/DT/the process/NN/process may/MD/may access/NN/access and/CC/and to/TO/to ensure/VB/ensure that/IN/that the/DT/the process/NN/process can/MD/can access/NN/access only/RB/only these/DT/these legal/JJ/legal addresses/NNP/addresses. we/PRP/we can/MD/can provide/VB/provide this/DT/this protection/NN/protection by/IN/by using/VBG/using two/CD/two registers/NNS/registers /,/, usually/RB/usually a/DT/a base/NN/base and/CC/and a/DT/a limit/NN/limit /,/, as/IN/as illustrated/VBN/illustrated in/IN/in figure/NN/figure 8.1/CD/8.1. the/DT/the base/NN/base holds/VBZ/holds the/DT/the smallest/JJS/smallest legal/JJ/legal physical/JJ/physical memory/NN/memory address/NN/address ;/:/; the/DT/the specifies/NNS/specifies the/DT/the size/NN/size of/IN/of the/DT/the range/NNP/range. for/IN/for example/NN/example /,/, if/IN/if the/DT/the base/NN/base register/NN/register holds/NNS/holds 300040/CD/300040 and/CC/and the/DT/the limit/NN/limit register/NN/register is/VBZ/is 120900/CD/120900 /,/, then/RB/then the/DT/the program/NN/program can/MD/can legally/RB/legally access/NN/access all/DT/all addresses/NNS/addresses from/IN/from 300040/CD/300040 through/IN/through 420939/CD/420939 /CD/( inclusive/JJ/inclusive /NN/) /./. protection/NN/protection of/IN/of memory/NN/memory space/NN/space is/VBZ/is accomplished/VBN/accomplished by/IN/by having/NN/having the/DT/the cpu/NN/cpu hardware/NN/hardware compare/NN/compare every/DT/every address/NN/address generated/VBD/generated in/IN/in user/NN/user mode/NN/mode with/IN/with the/DT/the registers/NNP/registers. any/DT/any attempt/NN/attempt by/IN/by a/DT/a program/NN/program executing/NN/executing in/IN/in user/NN/user mode/NN/mode to/TO/to access/NN/access operating-system/NN/operating-system memory/NN/memory or/CC/or other/JJ/other users/NNS/users '/POS/' memory/NN/memory results/NNS/results in/IN/in a/DT/a trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NN/system /,/, which/WDT/which treats/NNS/treats the/DT/the attempt/NN/attempt as/IN/as a/DT/a fatal/JJ/fatal error/NN/error /:/( figure/NN/figure 8.2/CD/8.2 /CD/) /./. this/DT/this scheme/NN/scheme prevents/VBZ/prevents a/DT/a user/NN/user program/NN/program from/IN/from /NNP/( accidentally/RB/accidentally or/CC/or deliberately/RB/deliberately /:/) modifying/VBG/modifying the/DT/the code/NN/code or/CC/or data/NNS/data structures/NNS/structures of/IN/of either/DT/either the/DT/the operating/NN/operating system/NN/system or/CC/or other/JJ/other users/NNP/users. the/DT/the base/NN/base and/CC/and limit/NN/limit registers/NNS/registers can/MD/can be/VB/be loaded/VBN/loaded only/RB/only by/IN/by the/DT/the operating/NN/operating system/NN/system /,/, which/WDT/which uses/NNS/uses a/DT/a special/JJ/special privileged/JJ/privileged instruction/NNP/instruction. since/IN/since privileged/JJ/privileged instructions/NNS/instructions can/MD/can be/VB/be executed/VBN/executed only/RB/only in/IN/in kernel/NN/kernel mode/NN/mode /,/, and/CC/and since/IN/since only/RB/only the/DT/the operating/NN/operating system/NN/system executes/VBZ/executes in/IN/in kernel/NN/kernel mode/NN/mode /,/, only/RB/only the/DT/the operating/NN/operating system/NN/system can/MD/can load/VB/load the/DT/the base/NN/base and/CC/and limit/NN/limit registers/NNP/registers. this/DT/this scheme/NN/scheme allows/VBZ/allows the/DT/the operating/NN/operating system/NN/system to/TO/to change/VB/change the/DT/the value/NN/value of/IN/of the/DT/the registers/NNS/registers but/CC/but prevents/NNS/prevents user/VBP/user programs/NNS/programs from/IN/from changing/VBG/changing the/DT/the registers/NNS/registers '/POS/' contents/NNP/contents. the/DT/the operating/NN/operating system/NN/system /,/, executing/VBG/executing in/IN/in kernel/NN/kernel mode/NN/mode /,/, is/VBZ/is given/VBN/given unrestricted/VBN/unrestricted access/NN/access to/TO/to both/DT/both operating/NN/operating system/NN/system memory/NN/memory and/CC/and users/NNS/users '/POS/' memory/NNP/memory. this/DT/this provision/NN/provision allows/VBZ/allows the/DT/the operating/NN/operating system/NN/system to/TO/to load/VB/load users/NNS/users '/POS/' programs/NNS/programs into/IN/into users/NNS/users '/POS/' memory/NN/memory /,/, to/TO/to yes/NNS/yes no/DT/no trap/NN/trap to/TO/to operating/NN/operating system/NN/system monitor-addressing/NN/monitor-addressing error/NN/error memory/NN/memory figure/NN/figure 8.2/CD/8.2 hardware/NN/hardware address/NN/address protection/NN/protection with/IN/with base/NN/base and/CC/and limit/NN/limit registers/NNP/registers. 318/CD/318 chapter/NN/chapter 8/CD/8 dump/NN/dump out/IN/out those/DT/those programs/NNS/programs in/IN/in case/NN/case of/IN/of errors/NNS/errors /,/, to/TO/to access/NN/access and/CC/and modify/NN/modify parameters/NNS/parameters of/IN/of system/NN/system calls/NNS/calls /,/, and/CC/and so/RB/so on/NNP/on. 8.1.2/CD/8.1.2 address/NN/address binding/VBG/binding usually/RB/usually /,/, a/DT/a program/NN/program resides/VBZ/resides on/IN/on a/DT/a disk/NN/disk as/IN/as a/DT/a binary/JJ/binary executable/JJ/executable file/NNP/file. to/TO/to be/VB/be executed/VBN/executed /,/, the/DT/the program/NN/program must/MD/must be/VB/be brought/VBN/brought into/IN/into memory/NN/memory and/CC/and placed/VBD/placed within/IN/within a/DT/a process/NNP/process. depending/NN/depending on/IN/on the/DT/the memory/NN/memory management/NN/management in/IN/in use/NN/use /,/, the/DT/the process/NN/process may/MD/may be/VB/be moved/VBN/moved between/IN/between disk/NN/disk and/CC/and memory/NN/memory during/IN/during its/PRP$/its execution/NNP/execution. the/DT/the processes/NNS/processes on/IN/on the/DT/the disk/NN/disk that/IN/that are/VBP/are waiting/VBG/waiting to/TO/to be/VB/be brought/VBN/brought into/IN/into memory/NN/memory for/IN/for execution/NN/execution form/NN/form the/DT/the the/DT/the normal/JJ/normal procedure/NN/procedure is/VBZ/is to/TO/to select/VB/select one/CD/one of/IN/of the/DT/the processes/NNS/processes in/IN/in the/DT/the input/NN/input queue/NN/queue and/CC/and to/TO/to load/VB/load that/IN/that process/NN/process into/IN/into memory/NNP/memory. as/IN/as the/DT/the process/NN/process is/VBZ/is executed/VBN/executed /,/, it/PRP/it accesses/VBZ/accesses instructions/NNS/instructions and/CC/and data/NNS/data from/IN/from memory/NNP/memory. eventually/RB/eventually /,/, the/DT/the process/NN/process terminates/VBZ/terminates /,/, and/CC/and its/PRP$/its memory/NN/memory space/NN/space is/VBZ/is declared/VBN/declared available/-NONE-/available. most/RBS/most systems/NNS/systems allow/VBP/allow a/DT/a user/NN/user process/NN/process to/TO/to reside/VB/reside in/IN/in any/DT/any part/NN/part of/IN/of the/DT/the physical/JJ/physical memory/NNP/memory. thus/RB/thus /,/, although/IN/although the/DT/the address/NN/address space/NN/space of/IN/of the/DT/the computer/NN/computer starts/VBZ/starts at/IN/at 00000/CD/00000 /,/, the/DT/the first/JJ/first address/NN/address of/IN/of the/DT/the user/NN/user process/NN/process need/VBP/need not/RB/not be/VB/be 00000/CD/00000. this/DT/this approach/NN/approach affects/VBZ/affects the/DT/the addresses/NNS/addresses that/WDT/that the/DT/the user/NN/user program/NN/program can/MD/can use/NNP/use. in/IN/in most/JJS/most cases/NNS/cases /,/, a/DT/a user/NN/user program/NN/program will/MD/will go/VB/go through/IN/through several/JJ/several steps-some/JJ/steps-some of/IN/of which/WDT/which may/MD/may be/VB/be optional-before/JJ/optional-before bein.g/JJ/bein.g executed/VBN/executed /-NONE-/( figure/NN/figure 8.3/CD/8.3 /CD/) /./. addresses/NNS/addresses may/MD/may be/VB/be represented/VBN/represented in/IN/in different/JJ/different ways/NNS/ways during/IN/during these/DT/these steps/NNP/steps. addresses/VBZ/addresses in/IN/in the/DT/the source/NN/source program/NN/program are/VBP/are generally/RB/generally symbolic/JJ/symbolic /NN/( such/JJ/such as/IN/as count/NN/count /:/) /./. a/DT/a compiler/NN/compiler will/MD/will typically/RB/typically bind/VB/bind these/DT/these symbolic/JJ/symbolic addresses/NNS/addresses to/TO/to relocatable/JJ/relocatable addresses/NNS/addresses /:/( such/JJ/such as/IN/as 14/CD/14 bytes/NNS/bytes from/IN/from the/DT/the beginning/NN/beginning of/IN/of this/DT/this module/NN/module /:/) /./. the/DT/the lin.kage/NN/lin.kage editor/NN/editor or/CC/or loader/NN/loader will/MD/will in/IN/in turn/NN/turn bind/NN/bind the/DT/the relocatable/JJ/relocatable addresses/NNS/addresses to/TO/to absolute/VB/absolute addresses/NNS/addresses /:/( such/JJ/such as/IN/as 74014/CD/74014 /CD/) /./. each/DT/each binding/VBG/binding is/VBZ/is a/DT/a mapping/NN/mapping from/IN/from one/CD/one address/NN/address space/NN/space to/TO/to another/NNP/another. classically/RB/classically /,/, the/DT/the binding/NN/binding of/IN/of instructions/NNS/instructions and/CC/and data/NNS/data to/TO/to memory/NN/memory addresses/NNS/addresses can/MD/can be/VB/be done/VBN/done at/IN/at any/DT/any step/NN/step along/IN/along the/DT/the way/NN/way /:/: compile/JJ/compile time/NNP/time. if/IN/if you/PRP/you know/VBP/know at/IN/at compile/JJ/compile time/NN/time where/WRB/where the/DT/the process/NN/process will/MD/will reside/VB/reside in/IN/in memory/NN/memory /,/, then/RB/then can/MD/can be/VB/be generated/NNP/generated. for/IN/for example/NN/example /,/, if/IN/if you/PRP/you krww/VBP/krww that/IN/that a/DT/a user/NN/user process/NN/process will/MD/will reside/VB/reside starting/VBG/starting at/IN/at location/NN/location r/NN/r /,/, then/RB/then the/DT/the generated/VBN/generated compiler/NN/compiler code/NN/code will/MD/will start/VB/start at/IN/at that/DT/that location/NN/location and/CC/and extend/NN/extend up/RP/up from/IN/from there/NNP/there. if/IN/if /,/, at/IN/at some/DT/some later/JJ/later time/NN/time /,/, the/DT/the starting/NN/starting location/NN/location changes/NNS/changes /,/, then/RB/then it/PRP/it will/MD/will be/VB/be necessary/JJ/necessary to/TO/to recompile/VB/recompile this/DT/this code/NNP/code. the/DT/the ms-dos/NNP/ms-dos .com-format/NNP/.com-format programs/NNS/programs are/VBP/are bound/VBN/bound at/IN/at compile/JJ/compile time/NNP/time. load/NN/load time/NNP/time. if/IN/if it/PRP/it is/VBZ/is not/RB/not known/VBN/known at/IN/at compile/NN/compile time/NN/time where/WRB/where the/DT/the process/NN/process will/MD/will reside/VB/reside in/IN/in memory/NN/memory /,/, then/RB/then the/DT/the compiler/NN/compiler must/MD/must generate/VB/generate in/IN/in this/DT/this case/NN/case /,/, final/JJ/final binding/NN/binding is/VBZ/is delayed/VBN/delayed until/IN/until load/JJ/load time/NNP/time. if/IN/if the/DT/the starting/NN/starting address/NN/address changes/NNS/changes /,/, we/PRP/we need/VBP/need only/RB/only reload/JJ/reload the/DT/the user/NN/user code/NN/code to/TO/to incorporate/VB/incorporate this/DT/this changed/VBN/changed value/NNP/value. execution/NN/execution time/NNP/time. if/IN/if the/DT/the process/NN/process can/MD/can be/VB/be moved/VBN/moved during/IN/during its/PRP$/its execution/NN/execution from/IN/from one/CD/one memory/NN/memory segment/NN/segment to/TO/to another/DT/another /,/, then/RB/then binding/VBG/binding must/MD/must be/VB/be delayed/VBN/delayed until/IN/until run/VBN/run time/NNP/time. special/JJ/special hardware/NN/hardware must/MD/must be/VB/be available/JJ/available for/IN/for this/DT/this scheme/NN/scheme to/TO/to work/VB/work /,/, as/IN/as will/MD/will be/VB/be discussed/VBN/discussed in/IN/in section/NN/section 8.1.3/CD/8.1.3. most/JJS/most general-purpose/JJ/general-purpose operating/NN/operating systems/NNS/systems 11se/CD/11se this/DT/this method/NNP/method. a/DT/a major/JJ/major portion/NN/portion of/IN/of this/DT/this chapter/NN/chapter is/VBZ/is devoted/VBN/devoted to/TO/to showing/NN/showing how/WRB/how these/DT/these various/JJ/various bindings/NNS/bindings can/MD/can be/VB/be implemented/VBN/implemented effectively/RB/effectively in/IN/in a/DT/a computer/NN/computer system/NN/system and/CC/and to/TO/to discussing/VBG/discussing appropriate/NN/appropriate hardware/NN/hardware support/NNP/support. 8.1/CD/8.1 compile/NN/compile time/NN/time load/NN/load time/NN/time /:/} execution/NN/execution time/NN/time /:/( run/VBN/run time/NN/time /:/) figure/NN/figure 8.3/CD/8.3 multistep/NN/multistep processing/NN/processing of/IN/of a/DT/a user/NN/user program/NNP/program. 8.1.3/CD/8.1.3 logical/JJ/logical versus/NN/versus physical/JJ/physical address/NN/address space/NN/space an/DT/an address/NN/address generated/VBN/generated by/IN/by the/DT/the cpu/NN/cpu is/VBZ/is commonly/RB/commonly referred/VBN/referred to/TO/to as/RB/as a/DT/a 319/CD/319 whereas/NNS/whereas an/DT/an address/NN/address seen/VBN/seen by/IN/by the/DT/the memory/NN/memory unit-that/JJ/unit-that is/VBZ/is /,/, the/DT/the one/CD/one loaded/VBD/loaded into/IN/into the/DT/the of/IN/of the/DT/the memory-is/NNP/memory-is commonly/RB/commonly referred/VBD/referred to/TO/to as/IN/as a/DT/a the/DT/the compile-time/JJ/compile-time and/CC/and load-time/JJ/load-time address-binding/JJ/address-binding methods/NNS/methods generate/VBP/generate identical/JJ/identical logical/JJ/logical and/CC/and physical/JJ/physical addresses/NNP/addresses. however/RB/however /,/, the/DT/the execution-time/JJ/execution-time addressbinding/NN/addressbinding scheme/NN/scheme results/NNS/results in/IN/in differing/VBG/differing logical/JJ/logical and/CC/and addresses/NNP/addresses. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we usually/RB/usually refer/VBP/refer to/TO/to the/DT/the logical/JJ/logical address/NN/address as/IN/as a/DT/a we/PRP/we use/VBP/use logical/JJ/logical address/NN/address and/CC/and virtual/JJ/virtual address/NN/address interchangeably/RB/interchangeably in/IN/in this/DT/this text/NNP/text. the/DT/the set/NN/set of/IN/of all/DT/all logical/JJ/logical addresses/NNS/addresses generated/VBN/generated by/IN/by a/DT/a program/NN/program is/VBZ/is a/DT/a logical/JJ/logical the/DT/the set/NN/set of/IN/of all/DT/all physical/JJ/physical addresses/NNS/addresses corresponding/VBG/corresponding to/TO/to these/DT/these logical/JJ/logical addresses/NNS/addresses is/VBZ/is a/DT/a physical/JJ/physical thus/NN/thus /,/, in_/NNP/in_ the/DT/the execution-time/JJ/execution-time address-binding/JJ/address-binding scheme/NN/scheme /,/, the/DT/the logical/JJ/logical and/CC/and physical/JJ/physical address/NN/address spaces/NNS/spaces differ/NNP/differ. the/DT/the run-time/JJ/run-time mapping/NN/mapping from/IN/from virtual/JJ/virtual to/TO/to physical/JJ/physical addresses/NNS/addresses is/VBZ/is done/VBN/done by/IN/by a/DT/a hardware/NN/hardware device/NN/device called/VBN/called the/DT/the we/PRP/we can/MD/can choose/VB/choose from/IN/from many/JJ/many different/JJ/different methods/NNS/methods to/TO/to accomplish/VB/accomplish such/JJ/such mapping/NN/mapping /,/, as/IN/as we/PRP/we discuss/VBP/discuss in/IN/in 320/CD/320 chapter/NN/chapter 8/CD/8 figure/NN/figure 8.4/CD/8.4 dynamic/JJ/dynamic relocation/NN/relocation using/VBG/using a/DT/a relocation/NN/relocation register/NNP/register. sections/NNS/sections 8.3/CD/8.3 through/IN/through 8.7/CD/8.7. for/IN/for the/DT/the time/NN/time being/VBG/being /,/, we/PRP/we illustrate/VBP/illustrate this/DT/this mapping/NN/mapping with/IN/with a/DT/a simple/JJ/simple mmu/NN/mmu scheme/NN/scheme that/WDT/that is/VBZ/is a/DT/a generalization/NN/generalization of/IN/of the/DT/the base-register/JJ/base-register scheme/NN/scheme described/VBD/described in/IN/in section/NN/section 8.1.1/CD/8.1.1. the/DT/the base/NN/base register/NN/register is/VBZ/is now/RB/now called/VBN/called a/DT/a the/DT/the value/NN/value in/IN/in the/DT/the relocation/NN/relocation register/NN/register is/VBZ/is added/VBN/added to/TO/to every/DT/every address/NN/address generated/VBD/generated by/IN/by a/DT/a user/NN/user process/NN/process at/IN/at the/DT/the time/NN/time the/DT/the address/NN/address is/VBZ/is sent/VBN/sent to/TO/to memory/NN/memory /:/( see/NN/see figure/NN/figure 8.4/CD/8.4 /CD/) /./. for/IN/for example/NN/example /,/, if/IN/if the/DT/the base/NN/base is/VBZ/is at/IN/at 14000/CD/14000 /,/, then/RB/then an/DT/an attempt/NN/attempt by/IN/by the/DT/the user/NN/user to/TO/to address/VB/address location/NN/location 0/-NONE-/0 is/VBZ/is dynamically/RB/dynamically relocated/VBN/relocated to/TO/to location/NN/location 14000/CD/14000 ;/:/; an/DT/an access/NN/access to/TO/to location/NN/location 346/CD/346 is/VBZ/is mapped/VBN/mapped to/TO/to location/NN/location 14346/CD/14346. the/DT/the ms-dos/NNP/ms-dos operating/NN/operating system/NN/system running/VBG/running on/IN/on the/DT/the intel/NN/intel 80x86/CD/80x86 family/NN/family of/IN/of processors/NNS/processors used/VBN/used four/CD/four relocation/NN/relocation registers/NNS/registers when/WRB/when loading/VBG/loading and/CC/and running/VBG/running processes/NNP/processes. the/DT/the user/NN/user program/NN/program never/RB/never sees/VBZ/sees the/DT/the real/JJ/real physical/JJ/physical addresses/NNP/addresses. the/DT/the program/NN/program can/MD/can create/VB/create a/DT/a pointer/NN/pointer to/TO/to location/NN/location 346/CD/346 /,/, store/IN/store it/PRP/it in/IN/in memory/NN/memory /,/, manipulate/JJ/manipulate it/PRP/it /,/, and/CC/and compare/VB/compare it/PRP/it with/IN/with other/JJ/other addresses-all/JJ/addresses-all as/IN/as the/DT/the number/NN/number 346/CD/346. only/RB/only when/WRB/when it/PRP/it is/VBZ/is used/VBN/used as/RB/as a/DT/a memory/NN/memory address/NN/address /:/( in/IN/in an/DT/an indirect/JJ/indirect load/NN/load or/CC/or store/VB/store /,/, perhaps/RB/perhaps /:/) is/VBZ/is it/PRP/it relocated/VBD/relocated relative/JJ/relative to/TO/to the/DT/the base/NN/base register/NNP/register. the/DT/the user/NN/user program/NN/program deals/NNS/deals with/IN/with logical/JJ/logical addresses/NNP/addresses. the/DT/the memory-mapping/JJ/memory-mapping hardware/NN/hardware converts/NNS/converts logical/JJ/logical addresses/NNS/addresses into/IN/into physical/JJ/physical addresses/NNP/addresses. this/DT/this form/NN/form of/IN/of execution-time/JJ/execution-time binding/NN/binding was/VBD/was discussed/VBN/discussed in/IN/in section/NN/section 8.1.2/CD/8.1.2. the/DT/the final/JJ/final location/NN/location of/IN/of a/DT/a referenced/VBN/referenced memory/NN/memory address/NN/address is/VBZ/is not/RB/not determined/VBN/determined until/IN/until the/DT/the reference/NN/reference is/VBZ/is made/NNP/made. we/PRP/we now/RB/now have/VBP/have two/CD/two different/JJ/different types/NNS/types of/IN/of addresses/NNS/addresses /:/: logical/JJ/logical addresses/NNS/addresses /:/( in/IN/in the/DT/the range/NN/range 0/-NONE-/0 to/TO/to max/VB/max /:/) and/CC/and physical/JJ/physical addresses/NNS/addresses /:/( in/IN/in the/DT/the ranger/NN/ranger +/:/+ 0/-NONE-/0 tor/NN/tor +/:/+ max/NN/max for/IN/for a/DT/a base/NN/base valuer/NN/valuer /:/) /./. the/DT/the user/NN/user generates/VBZ/generates only/RB/only logical/JJ/logical addresses/NNS/addresses and/CC/and thinks/NNS/thinks that/WDT/that the/DT/the process/NN/process runs/VBZ/runs in/IN/in locations/NNS/locations 0/-NONE-/0 to/TO/to max/NNP/max. the/DT/the user/NN/user program/NN/program generates/NNS/generates only/RB/only logical/JJ/logical addresses/NNS/addresses and/CC/and thinks/NNS/thinks that/WDT/that the/DT/the process/NN/process runs/VBZ/runs in/IN/in locations/NNS/locations 0/-NONE-/0 to/TO/to max/NNP/max. however/RB/however /,/, these/DT/these logical/JJ/logical addresses/NNS/addresses must/MD/must be/VB/be mapped/VBN/mapped to/TO/to physical/JJ/physical addresses/NNS/addresses before/IN/before they/PRP/they are/VBP/are used/NNP/used. the/DT/the concept/NN/concept of/IN/of a/DT/a logical/JJ/logical address/NN/address space/NN/space that/WDT/that is/VBZ/is bound/VBP/bound to/TO/to a/DT/a separate/JJ/separate physical/JJ/physical address/NN/address space/NN/space is/VBZ/is central/JJ/central to/TO/to proper/JJ/proper memory/NN/memory management/NNP/management. 8.1.4/CD/8.1.4 dynamic/JJ/dynamic loading/NN/loading in/IN/in our/PRP$/our discussion/NN/discussion so/IN/so far/RB/far /,/, it/PRP/it has/VBZ/has been/VBN/been necessary/JJ/necessary for/IN/for the/DT/the entire/JJ/entire program/NN/program and/CC/and all/DT/all data/NNS/data of/IN/of a/DT/a process/NN/process to/TO/to be/VB/be in/IN/in physical/JJ/physical memory/NN/memory for/IN/for the/DT/the process/NN/process to/TO/to execute/NNP/execute. the/DT/the size/NN/size of/IN/of a/DT/a process/NN/process has/VBZ/has thus/RB/thus been/VBN/been limited/VBN/limited to/TO/to the/DT/the size/NN/size of/IN/of physical/JJ/physical memory/NNP/memory. to/TO/to obtain/VB/obtain better/JJR/better memory-space/NN/memory-space utilization/NN/utilization /,/, we/PRP/we can/MD/can use/VB/use dynamic/JJ/dynamic with/IN/with dynancic/JJ/dynancic 8.1/CD/8.1 321/CD/321 loading/VBG/loading /,/, a/DT/a routine/NN/routine is/VBZ/is not/RB/not loaded/VBN/loaded until/IN/until it/PRP/it is/VBZ/is called/NNP/called. all/DT/all routines/NNS/routines are/VBP/are kept/VBN/kept on/IN/on disk/NN/disk in/IN/in a/DT/a relocatable/JJ/relocatable load/NN/load format/NNP/format. the/DT/the main/JJ/main program/NN/program is/VBZ/is loaded/VBN/loaded into/IN/into memory/NN/memory and/CC/and is/VBZ/is executed/NNP/executed. when/WRB/when a/DT/a routine/NN/routine needs/VBZ/needs to/TO/to call/VB/call another/DT/another routine/NN/routine /,/, the/DT/the calling/NN/calling routine/NN/routine first/RB/first checks/VBZ/checks to/TO/to see/VB/see whether/IN/whether the/DT/the other/JJ/other routine/NN/routine has/VBZ/has been/VBN/been loaded/NNP/loaded. if/IN/if it/PRP/it has/VBZ/has not/RB/not /,/, the/DT/the relocatable/JJ/relocatable linking/NN/linking loader/NN/loader is/VBZ/is called/VBN/called to/TO/to load/VB/load the/DT/the desired/VBN/desired routine/NN/routine into/IN/into menwry/NN/menwry and/CC/and to/TO/to update/VB/update the/DT/the program/NN/program 's/POS/'s address/NN/address tables/NNS/tables to/TO/to reflect/VB/reflect this/DT/this change/NNP/change. then/RB/then control/NN/control is/VBZ/is passed/VBN/passed to/TO/to the/DT/the newly/RB/newly loaded/VBN/loaded routine/NNP/routine. the/DT/the advantage/NN/advantage of/IN/of dynamic/JJ/dynamic loading/NN/loading is/VBZ/is that/IN/that an/DT/an unused/VBN/unused routine/NN/routine is/VBZ/is never/RB/never loaded/NNP/loaded. this/DT/this method/NN/method is/VBZ/is particularly/RB/particularly useful/JJ/useful when/WRB/when large/JJ/large amounts/NNS/amounts of/IN/of code/NN/code are/VBP/are needed/VBN/needed to/TO/to handle/VB/handle infrequently/RB/infrequently occurring/VBG/occurring cases/NNS/cases /,/, such/JJ/such as/IN/as error/NN/error routines/NNP/routines. in/IN/in this/DT/this case/NN/case /,/, although/IN/although the/DT/the total/JJ/total program/NN/program size/NN/size may/MD/may be/VB/be large/JJ/large /,/, the/DT/the portion/NN/portion that/IN/that is/VBZ/is used/VBN/used /-NONE-/( and/CC/and hence/NN/hence loaded/VBD/loaded /CD/) may/MD/may be/VB/be much/RB/much smaller/NNP/smaller. dynamic/JJ/dynamic loading/NN/loading does/VBZ/does not/RB/not require/VB/require special/JJ/special support/NN/support from/IN/from the/DT/the operating/NN/operating system/NNP/system. it/PRP/it is/VBZ/is the/DT/the responsibility/NN/responsibility of/IN/of the/DT/the users/NNS/users to/TO/to design/VB/design their/PRP$/their programs/NNS/programs to/TO/to take/VB/take advantage/NN/advantage of/IN/of such/JJ/such a/DT/a method/NNP/method. operating/NN/operating systems/NNS/systems may/MD/may help/VB/help the/DT/the programmer/NN/programmer /,/, however/RB/however /,/, by/IN/by providing/NN/providing library/NN/library routines/NNS/routines to/TO/to implement/VB/implement dynamic/JJ/dynamic loading/NNP/loading. 8.1.5/CD/8.1.5 dynamic/JJ/dynamic linking/NN/linking and/CC/and shared/VBD/shared libraries/NNS/libraries figure/NN/figure 8.3/CD/8.3 also/RB/also shows/VBZ/shows some/DT/some operating/NN/operating systems/NNS/systems support/NN/support only/RB/only linking/VBG/linking /,/, in/IN/in system/NN/system language/NN/language libraries/NNS/libraries are/VBP/are treated/VBN/treated like/IN/like any/DT/any other/JJ/other object/NN/object module/NN/module and/CC/and are/VBP/are combined/VBN/combined by/IN/by the/DT/the loader/NN/loader into/IN/into the/DT/the binary/JJ/binary program/NN/program image/NNP/image. dynamic/JJ/dynamic linking/NN/linking /,/, in/IN/in contrast/NN/contrast /,/, is/VBZ/is similar/JJ/similar to/TO/to dynamic/JJ/dynamic loading/NNP/loading. here/RB/here /,/, though/IN/though /,/, linking/VBG/linking /,/, rather/RB/rather than/IN/than loading/VBG/loading /,/, is/VBZ/is postponed/VBN/postponed until/IN/until execution/NN/execution time/NNP/time. this/DT/this feature/NN/feature is/VBZ/is usually/RB/usually used/VBN/used with/IN/with system/NN/system libraries/NNS/libraries /,/, such/JJ/such as/IN/as language/NN/language subroutine/NN/subroutine libraries/NNP/libraries. without/IN/without this/DT/this facility/NN/facility /,/, each/DT/each program/NN/program on/IN/on a/DT/a system/NN/system must/MD/must include/VB/include a/DT/a copy/NN/copy of/IN/of its/PRP$/its language/NN/language library/NN/library /:/( or/CC/or at/IN/at least/JJS/least the/DT/the routines/NNS/routines referenced/VBD/referenced by/IN/by the/DT/the program/NN/program /:/) in/IN/in the/DT/the executable/JJ/executable image/NNP/image. this/DT/this requirement/NN/requirement wastes/VBZ/wastes both/DT/both disk/NN/disk space/NN/space and/CC/and main/JJ/main memory/NNP/memory. with/IN/with dynamic/JJ/dynamic linking/NN/linking /,/, a/DT/a stub/NN/stub is/VBZ/is included/VBN/included in/IN/in the/DT/the image/NN/image for/IN/for each/DT/each libraryroutine/NN/libraryroutine reference/NNP/reference. the/DT/the stub/NN/stub is/VBZ/is a/DT/a small/JJ/small piece/NN/piece of/IN/of code/NN/code that/IN/that indicates/VBZ/indicates how/WRB/how to/TO/to locate/VB/locate the/DT/the appropriate/NN/appropriate memory-resident/NN/memory-resident library/NN/library routine/NN/routine or/CC/or how/WRB/how to/TO/to load/VB/load the/DT/the library/NN/library if/IN/if the/DT/the routine/NN/routine is/VBZ/is not/RB/not already/RB/already present/NNP/present. when/WRB/when the/DT/the stub/NN/stub is/VBZ/is executed/VBN/executed /,/, it/PRP/it checks/VBZ/checks to/TO/to see/VB/see whether/IN/whether the/DT/the needed/VBN/needed routine/NN/routine is/VBZ/is already/RB/already in/IN/in memory/NNP/memory. if/IN/if it/PRP/it is/VBZ/is not/RB/not /,/, the/DT/the program/NN/program loads/NNS/loads the/DT/the routine/NN/routine into/IN/into memory/NNP/memory. either/CC/either way/NN/way /,/, the/DT/the stub/NN/stub replaces/NNS/replaces itself/PRP/itself with/IN/with the/DT/the address/NN/address of/IN/of the/DT/the routine/NN/routine and/CC/and executes/VBZ/executes the/DT/the routine/NNP/routine. thus/RB/thus /,/, the/DT/the next/JJ/next time/NN/time that/WDT/that particular/JJ/particular code/NN/code segment/NN/segment is/VBZ/is reached/VBN/reached /,/, the/DT/the library/NN/library routine/NN/routine is/VBZ/is executed/VBN/executed directly/RB/directly /,/, incurring/VBG/incurring no/DT/no cost/NN/cost for/IN/for dynamic/JJ/dynamic linking/NNP/linking. under/IN/under this/DT/this scheme/NN/scheme /,/, all/DT/all processes/NNS/processes that/WDT/that use/NN/use a/DT/a language/NN/language library/NN/library execute/NN/execute only/RB/only one/CD/one copy/NN/copy of/IN/of the/DT/the library/NN/library code/NNP/code. this/DT/this feature/NN/feature can/MD/can be/VB/be extended/VBN/extended to/TO/to library/JJ/library updates/NNS/updates /:/( such/JJ/such as/IN/as bug/NN/bug fixes/NNS/fixes /:/) /./. a/DT/a library/NN/library may/MD/may be/VB/be replaced/VBN/replaced by/IN/by a/DT/a new/JJ/new version/NN/version /,/, and/CC/and all/DT/all programs/NNS/programs that/WDT/that reference/NN/reference the/DT/the library/NN/library will/MD/will automatically/RB/automatically use/VB/use the/DT/the new/JJ/new version/NNP/version. without/IN/without dynamic/JJ/dynamic linking/NN/linking /,/, all/DT/all such/JJ/such programs/NNS/programs would/MD/would need/VB/need to/TO/to be/VB/be relinked/VBN/relinked to/TO/to gain/VB/gain access/NN/access to/TO/to the/DT/the new/JJ/new library/NNP/library. so/RB/so that/IN/that programs/NNS/programs will/MD/will not/RB/not accidentally/RB/accidentally execute/VB/execute new/JJ/new /,/, incompatible/JJ/incompatible versions/NNS/versions of/IN/of libraries/NNS/libraries /,/, version/NN/version information/NN/information is/VBZ/is included/VBN/included in/IN/in both/DT/both the/DT/the program/NN/program and/CC/and the/DT/the library/NNP/library. more/RBR/more than/IN/than one/CD/one version/NN/version of/IN/of a/DT/a library/NN/library may/MD/may be/VB/be loaded/VBN/loaded into/IN/into memory/NN/memory /,/, and/CC/and each/DT/each program/NN/program uses/VBZ/uses its/PRP$/its version/NN/version information/NN/information to/TO/to decide/VB/decide which/WDT/which copy/VB/copy of/IN/of the/DT/the library/NN/library to/TO/to use/NNP/use. versions/NNS/versions with/IN/with minor/JJ/minor changes/NNS/changes retain/VBP/retain the/DT/the same/JJ/same version/NN/version number/NN/number /,/, whereas/NNS/whereas versions/NNS/versions with/IN/with major/JJ/major changes/NNS/changes increment/NN/increment the/DT/the number/NNP/number. thus/RB/thus /,/, only/RB/only programs/NNS/programs that/WDT/that are/VBP/are compiled/VBN/compiled with/IN/with the/DT/the new/JJ/new library/NN/library version/NN/version are/VBP/are affected/VBN/affected by/IN/by any/DT/any incompatible/JJ/incompatible changes/NNS/changes incorporated/VBN/incorporated 322/CD/322 chapter/NN/chapter 8/CD/8 8.2/CD/8.2 in/IN/in it/NNP/it. other/JJ/other programs/NNS/programs linked/VBD/linked before/IN/before the/DT/the new/JJ/new library/NN/library was/VBD/was installed/VBN/installed will/MD/will continue/VB/continue using/VBG/using the/DT/the older/NN/older library/NNP/library. this/DT/this system/NN/system is/VBZ/is also/RB/also known/VBN/known as/IN/as 'h/JJ/'h /:/- =/:/= '/''/' unlike/IN/unlike dynamic/JJ/dynamic loading/NN/loading /,/, dynamic/JJ/dynamic linking/NN/linking generally/RB/generally requires/VBZ/requires help/NN/help from/IN/from the/DT/the operating/NN/operating system/NNP/system. if/IN/if the/DT/the processes/NNS/processes in/IN/in memory/NN/memory are/VBP/are protected/VBN/protected from/IN/from one/CD/one another/DT/another /,/, then/RB/then the/DT/the operating/NN/operating system/NN/system is/VBZ/is the/DT/the only/JJ/only entity/NN/entity that/WDT/that can/MD/can check/VB/check to/TO/to see/VB/see whether/IN/whether the/DT/the needed/VBN/needed routine/NN/routine is/VBZ/is in/IN/in another/DT/another process/NN/process 's/POS/'s memory/NN/memory space/NN/space or/CC/or that/IN/that can/MD/can allow/VB/allow multiple/NNS/multiple processes/NNS/processes to/TO/to access/NN/access the/DT/the same/JJ/same memory/NN/memory addresses/NNP/addresses. we/PRP/we elaborate/VBP/elaborate on/IN/on this/DT/this concept/NN/concept when/WRB/when we/PRP/we discuss/VBP/discuss paging/VBG/paging in/IN/in section/NN/section 8.4.4/CD/8.4.4. a/DT/a process/NN/process must/MD/must be/VB/be in/IN/in memory/NN/memory to/TO/to be/VB/be executed/NNP/executed. a/DT/a process/NN/process /,/, however/RB/however /,/, can/MD/can be/VB/be temporarily/RB/temporarily out/RP/out of/IN/of memory/NN/memory to/TO/to a/DT/a and/CC/and then/RB/then brought/VBD/brought into/IN/into memory/NN/memory for/IN/for continued/VBN/continued execution/NNP/execution. for/IN/for example/NN/example /,/, assume/NN/assume a/DT/a multiprogramming/NN/multiprogramming environment/NN/environment with/IN/with a/DT/a round-robin/JJ/round-robin cpu-scheduling/JJ/cpu-scheduling algorithm/NNP/algorithm. when/WRB/when a/DT/a quantum/NN/quantum expires/VBZ/expires /,/, the/DT/the memory/NN/memory manager/NN/manager will/MD/will start/VB/start to/TO/to swap/VB/swap out/RP/out the/DT/the process/NN/process that/IN/that just/RB/just finished/VBD/finished and/CC/and to/TO/to swap/VB/swap another/DT/another process/NN/process into/IN/into the/DT/the memory/NN/memory space/NN/space that/WDT/that has/VBZ/has been/VBN/been freed/VBN/freed /-NONE-/( figure/NN/figure 8.5/CD/8.5 /CD/) /./. in/IN/in the/DT/the meantime/NN/meantime /,/, the/DT/the cpu/NN/cpu scheduler/NN/scheduler will/MD/will allocate/VB/allocate a/DT/a time/NN/time slice/NN/slice to/TO/to some/DT/some other/JJ/other process/NN/process in/IN/in memory/NNP/memory. when/WRB/when each/DT/each process/NN/process finishes/VBZ/finishes its/PRP$/its quantum/NN/quantum /,/, it/PRP/it will/MD/will be/VB/be swapped/VBN/swapped with/IN/with another/DT/another process/NNP/process. ideally/RB/ideally /,/, the/DT/the memory/NN/memory manager/NN/manager can/MD/can swap/VB/swap processes/NNS/processes fast/RB/fast enough/RB/enough that/IN/that some/DT/some processes/NNS/processes will/MD/will be/VB/be in/IN/in memory/NN/memory /,/, ready/RB/ready to/TO/to execute/VB/execute /,/, when/WRB/when the/DT/the cpu/NN/cpu scheduler/NN/scheduler wants/VBZ/wants to/TO/to reschedule/VB/reschedule the/DT/the cpu/NNP/cpu. in/IN/in addition/NN/addition /,/, the/DT/the quantum/NN/quantum must/MD/must be/VB/be large/JJ/large enough/RB/enough to/TO/to allow/VB/allow reasonable/JJ/reasonable amounts/NNS/amounts of/IN/of computing/VBG/computing to/TO/to be/VB/be done/VBN/done between/IN/between swaps/NNP/swaps. a/DT/a variant/NN/variant of/IN/of this/DT/this swapping/NN/swapping policy/NN/policy is/VBZ/is used/VBN/used for/IN/for priority-based/JJ/priority-based scheduling/NN/scheduling algorithms/NNP/algorithms. if/IN/if a/DT/a higher-priority/NN/higher-priority process/NN/process arrives/NNS/arrives and/CC/and wants/NNS/wants service/NN/service /,/, the/DT/the memory/NN/memory manager/NN/manager can/MD/can swap/VB/swap out/RP/out the/DT/the lower-priority/JJ/lower-priority process/NN/process and/CC/and then/RB/then load/VB/load and/CC/and execute/VB/execute the/DT/the higher-priority/NN/higher-priority process/NNP/process. when/WRB/when the/DT/the higher-priority/NN/higher-priority process/NN/process finishes/NNS/finishes /,/, the/DT/the @/NNP/@ swap/NN/swap out/IN/out @/CD/@ swap/NN/swap in/IN/in backing/NN/backing store/NN/store main/NN/main memory/NN/memory figure/NN/figure 8.5/CD/8.5 swapping/VBG/swapping of/IN/of two/CD/two processes/NNS/processes using/VBG/using a/DT/a disk/NN/disk as/IN/as a/DT/a backing/NN/backing store/NNP/store. 8.2/CD/8.2 323/CD/323 lower-priority/JJ/lower-priority process/NN/process can/MD/can be/VB/be swapped/VBN/swapped back/RP/back in/IN/in and/CC/and continued/NNP/continued. this/DT/this variant/NN/variant of/IN/of swapping/VBG/swapping is/VBZ/is sometimes/RB/sometimes called/VBN/called roll/NN/roll normally/RB/normally /,/, a/DT/a process/NN/process that/WDT/that is/VBZ/is swapped/VBN/swapped out/RP/out will/MD/will be/VB/be swapped/VBN/swapped back/RP/back into/IN/into the/DT/the same/JJ/same memory/NN/memory space/NN/space it/PRP/it occupied/VBD/occupied previously/NNP/previously. this/DT/this restriction/NN/restriction is/VBZ/is dictated/VBN/dictated by/IN/by the/DT/the method/NN/method of/IN/of address/NN/address binding/NNP/binding. if/IN/if binding/VBG/binding is/VBZ/is done/VBN/done at/IN/at assembly/RB/assembly or/CC/or load/VB/load time/NN/time /,/, then/RB/then the/DT/the process/NN/process can/MD/can not/RB/not be/VB/be easily/RB/easily moved/VBN/moved to/TO/to a/DT/a different/JJ/different location/NNP/location. if/IN/if execution-time/JJ/execution-time binding/NN/binding is/VBZ/is being/VBG/being used/VBN/used /,/, however/RB/however /,/, then/RB/then a/DT/a process/NN/process can/MD/can be/VB/be swapped/VBN/swapped into/IN/into a/DT/a different/JJ/different memory/NN/memory space/NN/space /,/, because/IN/because the/DT/the physical/JJ/physical addresses/NNS/addresses are/VBP/are computed/VBN/computed during/IN/during execution/NN/execution time/NNP/time. swapping/NN/swapping requires/VBZ/requires a/DT/a backing/NN/backing store/NNP/store. the/DT/the backing/NN/backing store/NN/store is/VBZ/is commonly/RB/commonly a/DT/a fast/JJ/fast disk/NNP/disk. it/PRP/it must/MD/must be/VB/be large/JJ/large enough/RB/enough to/TO/to accommodate/VB/accommodate copies/NNS/copies of/IN/of all/DT/all memory/NN/memory images/NNS/images for/IN/for all/DT/all users/NNS/users /,/, and/CC/and it/PRP/it must/MD/must provide/VB/provide direct/JJ/direct access/NN/access to/TO/to these/DT/these memory/NN/memory images/NNP/images. the/DT/the system/NN/system maintains/VBZ/maintains a/DT/a consisting/NN/consisting of/IN/of all/DT/all processes/NNS/processes whose/WP$/whose memory/NN/memory images/NNS/images are/VBP/are on/IN/on the/DT/the backing/NN/backing store/NN/store or/CC/or in/IN/in memory/NN/memory and/CC/and are/VBP/are ready/RB/ready to/TO/to run/NNP/run. whenever/NN/whenever the/DT/the cpu/NN/cpu scheduler/NN/scheduler decides/VBZ/decides to/TO/to execute/VB/execute a/DT/a process/NN/process /,/, it/PRP/it calls/VBZ/calls the/DT/the dispatcher/NNP/dispatcher. the/DT/the dispatcher/NN/dispatcher checks/NNS/checks to/TO/to see/VB/see whether/IN/whether the/DT/the next/JJ/next process/NN/process in/IN/in the/DT/the queue/NN/queue is/VBZ/is in/IN/in memory/NNP/memory. if/IN/if it/PRP/it is/VBZ/is not/RB/not /,/, and/CC/and if/IN/if there/EX/there is/VBZ/is no/DT/no free/JJ/free memory/NN/memory region/NN/region /,/, the/DT/the dispatcher/NN/dispatcher swaps/VBZ/swaps out/RP/out a/DT/a process/NN/process currently/RB/currently in/IN/in memory/NN/memory and/CC/and swaps/NNS/swaps in/IN/in the/DT/the desired/VBN/desired process/NNP/process. it/PRP/it then/RB/then reloads/VBZ/reloads registers/NNS/registers and/CC/and transfers/NNS/transfers control/NN/control to/TO/to the/DT/the selected/VBN/selected process/NNP/process. the/DT/the context-switch/JJ/context-switch time/NN/time in/IN/in such/JJ/such a/DT/a swapping/NN/swapping system/NN/system is/VBZ/is fairly/RB/fairly high/NNP/high. to/TO/to get/VB/get an/DT/an idea/NN/idea of/IN/of the/DT/the context-switch/JJ/context-switch time/NN/time /,/, let/VB/let us/PRP/us assume/VB/assume that/IN/that the/DT/the user/NN/user process/NN/process is/VBZ/is 100/CD/100 mb/NN/mb in/IN/in size/NN/size and/CC/and the/DT/the backing/NN/backing store/NN/store is/VBZ/is a/DT/a standard/JJ/standard hard/JJ/hard disk/NN/disk with/IN/with a/DT/a transfer/NN/transfer rate/NN/rate of/IN/of 50mb/CD/50mb per/IN/per second/NNP/second. the/DT/the actual/JJ/actual transfer/NN/transfer of/IN/of the/DT/the 100-mb/CD/100-mb process/NN/process to/TO/to or/CC/or from/IN/from main/JJ/main memory/NN/memory takes/VBZ/takes 100mb/50mb/CD/100mb/50mb per/IN/per second/JJ/second =/NN/= 2/CD/2 seconds/NNP/seconds. assuming/NN/assuming an/DT/an average/JJ/average latency/NN/latency of/IN/of 8/CD/8 milliseconds/NNS/milliseconds /,/, the/DT/the swap/NN/swap time/NN/time is/VBZ/is 2008/CD/2008 milliseconds/NNP/milliseconds. since/IN/since we/PRP/we must/MD/must both/DT/both swap/NN/swap out/IN/out and/CC/and swap/NN/swap in/IN/in /,/, the/DT/the total/JJ/total swap/NN/swap time/NN/time is/VBZ/is about/IN/about 4016/CD/4016 milliseconds/NNP/milliseconds. notice/NN/notice that/WDT/that the/DT/the major/JJ/major part/NN/part of/IN/of the/DT/the swap/NN/swap time/NN/time is/VBZ/is transfer/NN/transfer time/NNP/time. the/DT/the total/JJ/total transfer/NN/transfer time/NN/time is/VBZ/is directly/RB/directly proportional/JJ/proportional to/TO/to the/DT/the amount/NN/amount of/IN/of memory/NN/memory swapped/NNP/swapped. if/IN/if we/PRP/we have/VBP/have a/DT/a computer/NN/computer system/NN/system with/IN/with 4/CD/4 gb/NN/gb of/IN/of main/JJ/main memory/NN/memory and/CC/and a/DT/a resident/NN/resident operating/NN/operating system/NN/system taking/VBG/taking 1/CD/1 gb/NN/gb /,/, the/DT/the maximum/NN/maximum size/NN/size of/IN/of the/DT/the user/NN/user process/NN/process is/VBZ/is 3gb/CD/3gb. however/RB/however /,/, many/JJ/many user/NN/user processes/NNS/processes may/MD/may be/VB/be much/RB/much smaller/JJR/smaller than/IN/than this-say/JJ/this-say /,/, 100/CD/100 mb/NNP/mb. a/DT/a 100-mb/CD/100-mb process/NN/process could/MD/could be/VB/be swapped/VBN/swapped out/RP/out in/IN/in 2/CD/2 seconds/NNS/seconds /,/, compared/VBN/compared with/IN/with the/DT/the 60/CD/60 seconds/NNS/seconds required/VBN/required for/IN/for swapping/NN/swapping 3/CD/3 gb/NNP/gb. clearly/RB/clearly /,/, it/PRP/it would/MD/would be/VB/be useful/JJ/useful to/TO/to know/VB/know exactly/RB/exactly how/WRB/how much/RB/much memory/NN/memory a/DT/a user/NN/user process/NN/process is/VBZ/is using/VBG/using /,/, not/RB/not simply/RB/simply how/WRB/how much/RB/much it/PRP/it might/MD/might be/VB/be using/NNP/using. then/RB/then we/PRP/we would/MD/would need/VB/need to/TO/to swap/VB/swap only/RB/only what/WP/what is/VBZ/is actually/RB/actually used/VBN/used /,/, reducing/VBG/reducing swap/NN/swap time/NNP/time. for/IN/for this/DT/this method/NN/method to/TO/to be/VB/be effective/JJ/effective /,/, the/DT/the user/NN/user must/MD/must keep/VB/keep the/DT/the system/NN/system informed/VBD/informed of/IN/of any/DT/any changes/NNS/changes in/IN/in memory/NN/memory requirements/NNP/requirements. thus/RB/thus /,/, a/DT/a process/NN/process with/IN/with dynamic/JJ/dynamic memory/NN/memory requirements/NNS/requirements will/MD/will need/VB/need to/TO/to issue/VB/issue system/NN/system calls/NNS/calls /:/( request/NN/request memory/NN/memory and/CC/and release/NN/release memory/NN/memory /:/) to/TO/to inform/NN/inform the/DT/the operating/NN/operating system/NN/system of/IN/of its/PRP$/its changing/NN/changing memory/NN/memory needs/NNP/needs. swapping/NN/swapping is/VBZ/is constrained/VBN/constrained by/IN/by other/JJ/other factors/NNS/factors as/IN/as well/NNP/well. if/IN/if we/PRP/we want/VBP/want to/TO/to swap/VB/swap a/DT/a process/NN/process /,/, we/PRP/we must/MD/must be/VB/be sure/JJ/sure that/IN/that it/PRP/it is/VBZ/is completely/RB/completely idle/NNP/idle. of/IN/of particular/JJ/particular concern/NN/concern is/VBZ/is any/DT/any pending/VBG/pending i/0/NNP/i/0. a/DT/a process/NN/process may/MD/may be/VB/be waiting/VBG/waiting for/IN/for an/DT/an i/0/JJ/i/0 operation/NN/operation when/WRB/when we/PRP/we want/VBP/want to/TO/to swap/VB/swap that/IN/that process/NN/process to/TO/to free/JJ/free up/IN/up memory/NNP/memory. however/RB/however /,/, if/IN/if the/DT/the i/0/NNP/i/0 is/VBZ/is asynchronously/RB/asynchronously accessing/VBG/accessing the/DT/the user/NN/user memory/NN/memory for/IN/for i/0/-NONE-/i/0 buffers/NNS/buffers /,/, then/RB/then the/DT/the process/NN/process can/MD/can not/RB/not be/VB/be swapped/NNP/swapped. assume/NN/assume that/WDT/that the/DT/the i/0/-NONE-/i/0 operation/NN/operation is/VBZ/is queued/VBN/queued because/IN/because the/DT/the device/NN/device is/VBZ/is busy/NNP/busy. if/IN/if we/PRP/we were/VBD/were to/TO/to swap/VB/swap out/RP/out process/NN/process p1/NNP/p1 and/CC/and swap/NN/swap in/IN/in process/NN/process p2/NNP/p2 /,/, the/DT/the 324/CD/324 chapter/NN/chapter 8/CD/8 8.3/CD/8.3 i/0/-NONE-/i/0 operation/NN/operation might/MD/might then/RB/then attempt/VB/attempt to/TO/to use/VB/use memory/NN/memory that/WDT/that now/RB/now belongs/VBZ/belongs to/TO/to process/NN/process p2/NNP/p2 /./. there/EX/there are/VBP/are two/CD/two main/JJ/main solutions/NNS/solutions to/TO/to this/DT/this problem/NN/problem /:/: never/RB/never swap/VB/swap a/DT/a process/NN/process with/IN/with pending/VBG/pending i/0/-NONE-/i/0 /,/, or/CC/or execute/VB/execute i/0/-NONE-/i/0 operations/NNS/operations only/RB/only into/IN/into operating-system/JJ/operating-system buffers/NNP/buffers. transfers/NNS/transfers between/IN/between operating-system/JJ/operating-system buffers/NNS/buffers and/CC/and process/NN/process memory/NN/memory then/RB/then occur/VBP/occur only/RB/only when/WRB/when the/DT/the process/NN/process is/VBZ/is swapped/VBN/swapped in/NNP/in. the/DT/the assumption/NN/assumption /,/, mentioned/VBD/mentioned earlier/JJR/earlier /,/, that/IN/that swapping/VBG/swapping requires/NNS/requires few/JJ/few /,/, if/IN/if any/DT/any /,/, head/NN/head seeks/NNS/seeks needs/VBZ/needs further/JJ/further explanation/NNP/explanation. we/PRP/we postpone/VBP/postpone discussing/VBG/discussing this/DT/this issue/NN/issue until/IN/until chapter/NN/chapter 12/CD/12 /,/, where/WRB/where secondary-storage/JJ/secondary-storage structure/NN/structure is/VBZ/is covered/NNP/covered. generally/RB/generally /,/, swap/NN/swap space/NN/space is/VBZ/is allocated/VBN/allocated as/RB/as a/DT/a chunk/NN/chunk of/IN/of disk/NN/disk /,/, separate/JJ/separate from/IN/from the/DT/the file/NN/file system/NN/system /,/, so/RB/so that/IN/that its/PRP$/its use/NN/use is/VBZ/is as/IN/as fast/JJ/fast as/IN/as possible/NNP/possible. currently/RB/currently /,/, standard/JJ/standard swapping/NN/swapping is/VBZ/is used/VBN/used in/IN/in few/JJ/few systems/NNP/systems. it/PRP/it requires/VBZ/requires too/RB/too much/JJ/much swapping/NN/swapping time/NN/time and/CC/and provides/VBZ/provides too/RB/too little/JJ/little execution/NN/execution time/NN/time to/TO/to be/VB/be a/DT/a reasonable/JJ/reasonable memory-management/JJ/memory-management solution/NNP/solution. modified/VBD/modified versions/NNS/versions of/IN/of swapping/VBG/swapping /,/, however/RB/however /,/, are/VBP/are found/VBN/found on/IN/on many/JJ/many systems/NNP/systems. a/DT/a modification/NN/modification of/IN/of swapping/VBG/swapping is/VBZ/is used/VBN/used in/IN/in many/JJ/many versions/NNS/versions of/IN/of unix/NNP/unix. swapping/NN/swapping is/VBZ/is normally/RB/normally disabled/VBN/disabled but/CC/but will/MD/will start/VB/start if/IN/if many/JJ/many processes/NNS/processes are/VBP/are running/VBG/running and/CC/and are/VBP/are using/VBG/using a/DT/a threshold/NN/threshold amount/NN/amount of/IN/of memory/NNP/memory. swapping/NN/swapping is/VBZ/is again/RB/again halted/VBN/halted when/WRB/when the/DT/the load/NN/load on/IN/on the/DT/the system/NN/system is/VBZ/is reduced/NNP/reduced. memory/NN/memory management/NN/management in/IN/in unix/NN/unix is/VBZ/is described/VBN/described fully/RB/fully in/IN/in sections/NNS/sections 21.7/CD/21.7 and/CC/and a.6/NNP/a.6. early/RB/early pcs-which/JJ/pcs-which lacked/VBN/lacked the/DT/the sophistication/NN/sophistication to/TO/to implement/VB/implement more/JJR/more advanced/JJ/advanced memory-management/JJ/memory-management methods-ran/JJ/methods-ran multiple/NN/multiple large/JJ/large processes/NNS/processes by/IN/by using/VBG/using a/DT/a modified/JJ/modified version/NN/version of/IN/of swapping/NNP/swapping. a/DT/a prime/JJ/prime example/NN/example is/VBZ/is the/DT/the microsoft/NN/microsoft windows/VBZ/windows 3.1/CD/3.1 operating/VBG/operating system/NN/system /,/, which/WDT/which supports/NNS/supports concurrent/VBP/concurrent execution/NN/execution of/IN/of processes/NNS/processes in/IN/in memory/NNP/memory. if/IN/if a/DT/a new/JJ/new process/NN/process is/VBZ/is loaded/VBN/loaded and/CC/and there/EX/there is/VBZ/is insufficient/NN/insufficient main/NN/main memory/NN/memory /,/, an/DT/an old/JJ/old process/NN/process is/VBZ/is swapped/VBN/swapped to/TO/to disk/VB/disk this/DT/this operating/NN/operating system/NN/system does/VBZ/does not/RB/not provide/VB/provide full/JJ/full swapping/NN/swapping /,/, however/RB/however /,/, because/IN/because the/DT/the user/NN/user /,/, rather/RB/rather than/IN/than the/DT/the scheduler/NN/scheduler /,/, decides/VBZ/decides when/WRB/when it/PRP/it is/VBZ/is time/NN/time to/TO/to preempt/VB/preempt one/CD/one process/NN/process for/IN/for another/NNP/another. any/DT/any swapped-out/NN/swapped-out process/NN/process remains/VBZ/remains swapped/VBN/swapped out/RP/out /:/( and/CC/and not/RB/not executing/VBG/executing /:/) until/IN/until the/DT/the user/NN/user selects/VBZ/selects that/IN/that process/NN/process to/TO/to run/NNP/run. subsequent/NN/subsequent versions/NNS/versions of/IN/of microsoft/NN/microsoft operating/VBG/operating systems/NNS/systems take/VBP/take advantage/NN/advantage of/IN/of the/DT/the advanced/JJ/advanced mmu/NN/mmu features/NNS/features now/RB/now found/VBN/found in/IN/in pcs/NNP/pcs. we/PRP/we explore/VBP/explore such/JJ/such features/NNS/features in/IN/in section/NN/section 8.4/CD/8.4 and/CC/and in/IN/in chapter/NN/chapter 9/CD/9 /,/, where/WRB/where we/PRP/we cover/VBP/cover virtual/JJ/virtual memory/NNP/memory. the/DT/the main/JJ/main memory/NN/memory must/MD/must accommodate/VB/accommodate both/DT/both the/DT/the operating/NN/operating system/NN/system and/CC/and the/DT/the various/JJ/various user/NN/user processes/NNP/processes. we/PRP/we therefore/VBP/therefore need/VBP/need to/TO/to allocate/VB/allocate main/JJ/main menlory/NN/menlory in/IN/in the/DT/the most/RBS/most efficient/JJ/efficient way/NN/way possible/NNP/possible. this/DT/this section/NN/section explains/VBZ/explains one/CD/one common/JJ/common method/NN/method /,/, contiguous/JJ/contiguous memory/NN/memory allocation/NNP/allocation. the/DT/the memory/NN/memory is/VBZ/is usually/RB/usually divided/VBN/divided into/IN/into two/CD/two partitions/NNS/partitions /:/: one/CD/one for/IN/for the/DT/the resident/NN/resident operating/NN/operating system/NN/system and/CC/and one/CD/one for/IN/for the/DT/the user/NN/user processes/NNP/processes. we/PRP/we can/MD/can place/VB/place the/DT/the operating/NN/operating system/NN/system in/IN/in either/DT/either low/JJ/low memory/NN/memory or/CC/or high/JJ/high memory/NNP/memory. the/DT/the major/JJ/major factor/NN/factor affecting/VBG/affecting this/DT/this decision/NN/decision is/VBZ/is the/DT/the location/NN/location of/IN/of the/DT/the interrupt/JJ/interrupt vector/NNP/vector. since/IN/since the/DT/the interrupt/JJ/interrupt vector/NN/vector is/VBZ/is often/RB/often in/IN/in low/JJ/low memory/NN/memory /,/, programmers/NNS/programmers usually/RB/usually place/NN/place the/DT/the operating/NN/operating system/NN/system in/IN/in low/JJ/low memory/NN/memory as/IN/as well/NNP/well. thus/RB/thus /,/, in/IN/in this/DT/this text/NN/text /,/, we/PRP/we discuss/VBP/discuss only/RB/only the/DT/the situation/NN/situation in/IN/in which/WDT/which the/DT/the operating/NN/operating system/NN/system resides/VBZ/resides in/IN/in low/JJ/low memory/NNP/memory. the/DT/the development/NN/development of/IN/of the/DT/the other/JJ/other situation/NN/situation is/VBZ/is similar/NNP/similar. we/PRP/we usually/RB/usually want/VBP/want several/JJ/several user/NN/user processes/NNS/processes to/TO/to reside/VB/reside in/IN/in memory/NN/memory at/IN/at the/DT/the same/JJ/same time/NNP/time. we/PRP/we therefore/VBP/therefore need/VBP/need to/TO/to consider/VB/consider how/WRB/how to/TO/to allocate/VB/allocate available/JJ/available memory/NN/memory to/TO/to the/DT/the processes/NNS/processes that/WDT/that are/VBP/are in/IN/in the/DT/the input/NN/input queue/NN/queue waiting/VBG/waiting to/TO/to be/VB/be brought/VBN/brought into/IN/into memory/NNP/memory. 8.3/CD/8.3 325/CD/325 in/NNP/in. contiguous/JJ/contiguous memory/NN/memory allocation/NN/allocation /,/, each/DT/each process/NN/process is/VBZ/is contained/VBN/contained in/IN/in a/DT/a single/JJ/single contiguous/JJ/contiguous section/NN/section of/IN/of memory/NNP/memory. 8.3.1/CD/8.3.1 memory/NN/memory mapping/VBG/mapping and/CC/and protection/NN/protection before/IN/before discussing/VBG/discussing memory/NN/memory allocation/NN/allocation further/RB/further /,/, we/PRP/we must/MD/must discuss/VB/discuss the/DT/the issue/NN/issue of/IN/of memory/NN/memory mapping/VBG/mapping and/CC/and protection/NNP/protection. we/PRP/we can/MD/can provide/VB/provide these/DT/these features/NNS/features by/IN/by using/VBG/using a/DT/a relocation/NN/relocation register/NN/register /,/, as/IN/as discussed/VBN/discussed in/IN/in section/NN/section 8.1.3/CD/8.1.3 /,/, together/RB/together with/IN/with a/DT/a limit/NN/limit register/NN/register /,/, as/IN/as discussed/VBN/discussed in/IN/in section/NN/section 8.1.1/CD/8.1.1. the/DT/the relocation/NN/relocation register/NN/register contaitls/NNS/contaitls the/DT/the value/NN/value of/IN/of the/DT/the smallest/JJS/smallest physical/JJ/physical address/NN/address ;/:/; the/DT/the limit/NN/limit register/NN/register contains/VBZ/contains the/DT/the range/NN/range of/IN/of logical/JJ/logical addresses/NNS/addresses /:/( for/IN/for example/NN/example /,/, relocation/NN/relocation =/:/= 100040/CD/100040 and/CC/and limit/NN/limit =/:/= 74600/CD/74600 /CD/) /./. with/IN/with relocation/NN/relocation and/CC/and limit/NN/limit registers/NNS/registers /,/, each/DT/each logical/JJ/logical address/NN/address must/MD/must be/VB/be less/RBR/less than/IN/than the/DT/the limit/NN/limit register/NN/register ;/:/; the/DT/the mmu/NN/mmu maps/VBZ/maps the/DT/the logical/JJ/logical address/NN/address dynamically/RB/dynamically by/IN/by adding/NN/adding the/DT/the value/NN/value in/IN/in the/DT/the relocation/NN/relocation register/NNP/register. this/DT/this mapped/VBD/mapped address/NN/address is/VBZ/is sent/VBN/sent to/TO/to memory/NN/memory /:/( figure/NN/figure 8.6/CD/8.6 /CD/) /./. when/WRB/when the/DT/the cpu/NN/cpu scheduler/NN/scheduler selects/NNS/selects a/DT/a process/NN/process for/IN/for execution/NN/execution /,/, the/DT/the dispatcher/NN/dispatcher loads/NNS/loads the/DT/the relocation/NN/relocation and/CC/and limit/NN/limit registers/NNS/registers with/IN/with the/DT/the correct/JJ/correct values/NNS/values as/IN/as part/NN/part of/IN/of the/DT/the context/NN/context switch/NNP/switch. because/IN/because every/DT/every address/NN/address generated/VBD/generated by/IN/by a/DT/a cpu/NN/cpu is/VBZ/is checked/VBN/checked against/IN/against these/DT/these registers/NNS/registers /,/, we/PRP/we can/MD/can protect/VB/protect both/DT/both the/DT/the operating/NN/operating system/NN/system and/CC/and the/DT/the other/JJ/other users/NNS/users '/POS/' programs/NNS/programs and/CC/and data/NNS/data from/IN/from being/VBG/being modified/VBN/modified by/IN/by this/DT/this running/VBG/running process/NNP/process. the/DT/the relocation-register/JJ/relocation-register scheme/NN/scheme provides/VBZ/provides an/DT/an effective/JJ/effective way/NN/way to/TO/to allow/VB/allow the/DT/the operating/NN/operating system/NN/system 's/POS/'s size/NN/size to/TO/to change/VB/change dynamically/NNP/dynamically. this/DT/this flexibility/NN/flexibility is/VBZ/is desirable/JJ/desirable in/IN/in many/JJ/many situations/NNP/situations. for/IN/for example/NN/example /,/, the/DT/the operating/NN/operating system/NN/system contains/VBZ/contains code/NN/code and/CC/and buffer/NN/buffer space/NN/space for/IN/for device/NN/device drivers/NNP/drivers. if/IN/if a/DT/a device/NN/device driver/NN/driver /:/( or/CC/or other/JJ/other operating-system/JJ/operating-system service/NN/service /:/) is/VBZ/is not/RB/not commonly/RB/commonly used/VBN/used /,/, we/PRP/we do/VBP/do not/RB/not want/VB/want to/TO/to keep/VB/keep the/DT/the code/NN/code and/CC/and data/NNS/data in/IN/in memory/NN/memory /,/, as/IN/as we/PRP/we might/MD/might be/VB/be able/JJ/able to/TO/to use/VB/use that/IN/that space/NN/space for/IN/for other/JJ/other purposes/NNP/purposes. such/JJ/such code/NN/code is/VBZ/is sometimes/RB/sometimes called/VBN/called transient/NN/transient operating-system/NN/operating-system code/NN/code ;/:/; it/PRP/it comes/VBZ/comes and/CC/and goes/VBZ/goes as/RB/as needed/NNP/needed. thus/RB/thus /,/, using/VBG/using this/DT/this code/NN/code changes/NNS/changes the/DT/the size/NN/size of/IN/of the/DT/the operating/NN/operating system/NN/system during/IN/during program/NN/program execution/NNP/execution. 8.3.2/CD/8.3.2 memory/NN/memory allocation/NN/allocation now/RB/now we/PRP/we are/VBP/are ready/RB/ready to/TO/to turn/VB/turn to/TO/to memory/NN/memory allocation/NNP/allocation. one/CD/one of/IN/of the/DT/the simplest/JJS/simplest methods/NNS/methods for/IN/for allocating/VBG/allocating memory/NN/memory is/VBZ/is to/TO/to divide/VB/divide memory/NN/memory into/IN/into several/JJ/several fixed-sized/JJ/fixed-sized each/DT/each partition/NN/partition may/MD/may contain/VB/contain exactly/RB/exactly one/CD/one process/NNP/process. thus/RB/thus /,/, the/DT/the degree/NN/degree no/DT/no trap/NN/trap /:/: addressing/VBG/addressing error/NN/error figure/NN/figure 8.6/CD/8.6 hardware/NN/hardware supportfor/IN/supportfor relocation/NN/relocation and/CC/and limit/NN/limit registers/NNP/registers. 326/CD/326 chapter/NN/chapter 8/CD/8 of/IN/of multiprogramming/NN/multiprogramming is/VBZ/is bound/VBN/bound by/IN/by the/DT/the number/NN/number of/IN/of partitions/NNP/partitions. in/IN/in this/DT/this when/WRB/when a/DT/a partition/NN/partition is/VBZ/is free/JJ/free /,/, a/DT/a process/NN/process is/VBZ/is selected/VBN/selected from/IN/from the/DT/the input/NN/input queue/NN/queue and/CC/and is/VBZ/is loaded/VBN/loaded into/IN/into the/DT/the free/JJ/free partition/NNP/partition. when/WRB/when the/DT/the process/NN/process terminates/VBZ/terminates /,/, the/DT/the partition/NN/partition becomes/VBZ/becomes available/JJ/available for/IN/for another/DT/another process/NNP/process. this/DT/this method/NN/method was/VBD/was originally/RB/originally used/VBN/used by/IN/by the/DT/the ibm/NN/ibm os/360/-NONE-/os/360 operating/VBG/operating system/NN/system /:/( called/VBN/called mft/NN/mft /:/) ;/:/; it/PRP/it is/VBZ/is no/DT/no longer/NN/longer in/IN/in use/NNP/use. the/DT/the method/NN/method described/VBD/described next/JJ/next is/VBZ/is a/DT/a generalization/NN/generalization of/IN/of the/DT/the fixed-partition/NN/fixed-partition scheme/NN/scheme /:/( called/VBN/called mvt/NN/mvt /:/) ;/:/; it/PRP/it is/VBZ/is used/VBN/used primarily/RB/primarily in/IN/in batch/NN/batch environments/NNP/environments. many/JJ/many of/IN/of the/DT/the ideas/NNS/ideas presented/VBD/presented here/RB/here are/VBP/are also/RB/also applicable/JJ/applicable to/TO/to a/DT/a time-sharing/JJ/time-sharing environment/NN/environment in/IN/in which/WDT/which pure/NN/pure segmentation/NN/segmentation is/VBZ/is used/VBN/used for/IN/for memory/NN/memory management/NN/management /:/( section/NN/section 8.6/CD/8.6 /CD/) /./. in/IN/in the/DT/the scheme/NN/scheme /,/, the/DT/the operating/NN/operating system/NN/system keeps/NNS/keeps a/DT/a table/JJ/table indicating/NN/indicating which/WDT/which parts/NNS/parts of/IN/of memory/NN/memory are/VBP/are available/JJ/available and/CC/and which/WDT/which are/VBP/are occupied/NNP/occupied. initially/RB/initially /,/, all/DT/all memory/NN/memory is/VBZ/is available/JJ/available for/IN/for user/NN/user processes/NNS/processes and/CC/and is/VBZ/is considered/VBN/considered one/CD/one large/JJ/large block/NN/block of/IN/of available/JJ/available memory/NN/memory a/DT/a eventually/RB/eventually as/IN/as you/PRP/you will/MD/will see/VB/see /,/, memory/NN/memory contains/VBZ/contains a/DT/a set/NN/set of/IN/of holes/NNS/holes of/IN/of various/JJ/various sizes/NNP/sizes. as/IN/as processes/NNS/processes enter/JJR/enter the/DT/the system/NN/system /,/, they/PRP/they are/VBP/are put/VBN/put into/IN/into an/DT/an input/NN/input queue/NNP/queue. the/DT/the operating/NN/operating system/NN/system takes/VBZ/takes into/IN/into account/NN/account the/DT/the memory/NN/memory requirements/NNS/requirements of/IN/of each/DT/each process/NN/process and/CC/and the/DT/the amount/NN/amount of/IN/of available/JJ/available memory/NN/memory space/NN/space in/IN/in determining/NN/determining which/WDT/which processes/NNS/processes are/VBP/are allocated/VBN/allocated memory/NNP/memory. when/WRB/when a/DT/a process/NN/process is/VBZ/is allocated/VBN/allocated space/NN/space /,/, it/PRP/it is/VBZ/is loaded/VBN/loaded into/IN/into memory/NN/memory /,/, and/CC/and it/PRP/it can/MD/can then/RB/then compete/VB/compete for/IN/for cpu/NN/cpu time/NNP/time. when/WRB/when a/DT/a process/NN/process terminates/VBZ/terminates /,/, it/PRP/it releases/VBZ/releases its/PRP$/its memory/NN/memory which/WDT/which the/DT/the operating/NN/operating system/NN/system may/MD/may then/RB/then fill/VB/fill with/IN/with another/DT/another process/NN/process from/IN/from the/DT/the input/NN/input queue/NNP/queue. at/IN/at any/DT/any given/VBN/given time/NN/time /,/, then/RB/then /,/, we/PRP/we have/VBP/have a/DT/a list/NN/list of/IN/of available/JJ/available block/NN/block sizes/VBZ/sizes and/CC/and an/DT/an input/NN/input queue/NNP/queue. the/DT/the operating/NN/operating system/NN/system can/MD/can order/VB/order the/DT/the input/NN/input queue/NN/queue according/VBG/according to/TO/to a/DT/a scheduling/NN/scheduling algorithm/NNP/algorithm. memory/NN/memory is/VBZ/is allocated/VBN/allocated to/TO/to processes/NNS/processes untit/VB/untit finally/RB/finally /,/, the/DT/the memory/NN/memory requirements/NNS/requirements of/IN/of the/DT/the next/JJ/next process/NN/process can/MD/can not/RB/not be/VB/be satisfied/VBN/satisfied -that/-NONE-/-that is/VBZ/is /,/, no/DT/no available/JJ/available block/NN/block of/IN/of memory/NN/memory /:/( or/CC/or hole/NN/hole /:/) is/VBZ/is large/JJ/large enough/RB/enough to/TO/to hold/VB/hold that/IN/that process/NNP/process. the/DT/the operating/NN/operating system/NN/system can/MD/can then/RB/then wait/VB/wait until/IN/until a/DT/a large/JJ/large enough/RB/enough block/NN/block is/VBZ/is available/JJ/available /,/, or/CC/or it/PRP/it can/MD/can skip/VB/skip down/RP/down the/DT/the input/NN/input queue/NN/queue to/TO/to see/VB/see whether/IN/whether the/DT/the smaller/JJR/smaller memory/NN/memory requirements/NNS/requirements of/IN/of some/DT/some other/JJ/other process/NN/process can/MD/can be/VB/be met/NNP/met. in/IN/in generat/NN/generat as/IN/as mentioned/VBN/mentioned /,/, the/DT/the memory/NN/memory blocks/NNS/blocks available/JJ/available comprise/NN/comprise a/DT/a set/NN/set of/IN/of holes/NNS/holes of/IN/of various/JJ/various sizes/NNS/sizes scattered/VBN/scattered throughout/IN/throughout memory/NNP/memory. when/WRB/when a/DT/a process/NN/process arrives/VBZ/arrives and/CC/and needs/VBZ/needs memory/NN/memory /,/, the/DT/the system/NN/system searches/VBZ/searches the/DT/the set/NN/set for/IN/for a/DT/a hole/NN/hole that/WDT/that is/VBZ/is large/JJ/large enough/RB/enough for/IN/for this/DT/this process/NNP/process. if/IN/if the/DT/the hole/NN/hole is/VBZ/is too/RB/too large/JJ/large /,/, it/PRP/it is/VBZ/is split/VBN/split into/IN/into two/CD/two parts/NNP/parts. one/CD/one part/NN/part is/VBZ/is allocated/VBN/allocated to/TO/to the/DT/the arriving/NN/arriving process/NN/process ;/:/; the/DT/the other/JJ/other is/VBZ/is returned/VBN/returned to/TO/to the/DT/the set/NN/set of/IN/of holes/NNP/holes. when/WRB/when a/DT/a process/NN/process terminates/VBZ/terminates /,/, it/PRP/it releases/VBZ/releases its/PRP$/its block/NN/block of/IN/of memory/NN/memory /,/, which/WDT/which is/VBZ/is then/RB/then placed/VBN/placed back/RB/back in/IN/in the/DT/the set/NN/set of/IN/of holes/NNP/holes. if/IN/if the/DT/the new/JJ/new hole/NN/hole is/VBZ/is adjacent/NN/adjacent to/TO/to other/JJ/other holes/NNS/holes /,/, these/DT/these adjacent/NN/adjacent holes/NNS/holes are/VBP/are merged/VBN/merged to/TO/to form/NN/form one/CD/one larger/NN/larger hole/NNP/hole. at/IN/at this/DT/this point/NN/point /,/, the/DT/the system/NN/system may/MD/may need/VB/need to/TO/to check/VB/check whether/IN/whether there/EX/there are/VBP/are processes/NNS/processes waiting/VBG/waiting for/IN/for memory/NN/memory and/CC/and whether/IN/whether this/DT/this newly/RB/newly freed/VBN/freed and/CC/and recombined/VBN/recombined memory/NN/memory could/MD/could satisfy/VB/satisfy the/DT/the demands/NNS/demands of/IN/of any/DT/any of/IN/of these/DT/these waiting/VBG/waiting processes/NNP/processes. this/DT/this procedure/NN/procedure is/VBZ/is a/DT/a particular/JJ/particular instance/NN/instance of/IN/of the/DT/the general/JJ/general which/NN/which concerns/NNS/concerns how/WRB/how to/TO/to satisfy/VB/satisfy a/DT/a request/NN/request of/IN/of size/NN/size n/NN/n from/IN/from a/DT/a there/RB/there are/VBP/are many/JJ/many solutions/NNS/solutions to/TO/to this/DT/this problem/NNP/problem. the/DT/the and/CC/and strategies/NNS/strategies are/VBP/are the/DT/the ones/NNS/ones most/JJS/most commonly/RB/commonly used/JJ/used to/TO/to select/VB/select a/DT/a free/JJ/free hole/NN/hole from/IN/from the/DT/the set/NN/set of/IN/of available/JJ/available holes/NNP/holes. first/JJ/first fit/NNP/fit. allocate/NN/allocate the/DT/the first/JJ/first hole/NN/hole that/WDT/that is/VBZ/is big/JJ/big enough/NNP/enough. searching/NN/searching can/MD/can start/VB/start either/DT/either at/IN/at the/DT/the beginning/NN/beginning of/IN/of the/DT/the set/NN/set of/IN/of holes/NNS/holes or/CC/or at/IN/at the/DT/the location/NN/location where/WRB/where the/DT/the previous/JJ/previous first-fit/NN/first-fit search/NN/search ended/NNP/ended. we/PRP/we can/MD/can stop/VB/stop searching/VBG/searching as/IN/as soon/RB/soon as/IN/as we/PRP/we find/VBP/find a/DT/a free/JJ/free hole/NN/hole that/WDT/that is/VBZ/is large/JJ/large enough/NNP/enough. 8.3/CD/8.3 327/CD/327 best/JJS/best fit/NNP/fit. allocate/NN/allocate the/DT/the smallest/JJS/smallest hole/NN/hole that/WDT/that is/VBZ/is big/JJ/big enough/NNP/enough. we/PRP/we must/MD/must search/VB/search the/DT/the entire/JJ/entire list/NN/list /,/, unless/IN/unless the/DT/the list/NN/list is/VBZ/is ordered/VBN/ordered by/IN/by size/NNP/size. this/DT/this strategy/NN/strategy produces/VBZ/produces the/DT/the smallest/JJS/smallest leftover/NN/leftover hole/NNP/hole. worst/NN/worst fit/NNP/fit. allocate/NN/allocate the/DT/the largest/JJS/largest hole/NNP/hole. again/RB/again /,/, we/PRP/we must/MD/must search/VB/search the/DT/the entire/JJ/entire list/NN/list /,/, unless/IN/unless it/PRP/it is/VBZ/is sorted/VBN/sorted by/IN/by size/NNP/size. this/DT/this strategy/NN/strategy produces/VBZ/produces the/DT/the largest/JJS/largest leftover/NN/leftover hole/NN/hole /,/, which/WDT/which may/MD/may be/VB/be more/RBR/more useful/JJ/useful than/IN/than the/DT/the smaller/JJR/smaller leftover/NN/leftover hole/NN/hole from/IN/from a/DT/a best-fit/JJ/best-fit approach/NNP/approach. simulations/NNS/simulations have/VBP/have shown/VBN/shown that/IN/that both/DT/both first/JJ/first fit/NN/fit and/CC/and best/JJS/best fit/NN/fit are/VBP/are better/RBR/better than/IN/than worst/JJS/worst fit/NN/fit in/IN/in terms/NNS/terms of/IN/of decreasing/VBG/decreasing time/NN/time and/CC/and storage/NN/storage utilization/NNP/utilization. neither/DT/neither first/JJ/first fit/NN/fit nor/CC/nor best/JJS/best fit/NN/fit is/VBZ/is clearly/RB/clearly better/RBR/better than/IN/than the/DT/the other/JJ/other in/IN/in terms/NNS/terms of/IN/of storage/NN/storage utilization/NN/utilization /,/, but/CC/but first/RB/first fit/JJ/fit is/VBZ/is generally/RB/generally faster/NNP/faster. 8.3.3/CD/8.3.3 fragmentation/NN/fragmentation both/DT/both the/DT/the first-fit/JJ/first-fit and/CC/and best-fit/JJ/best-fit strategies/NNS/strategies for/IN/for memory/NN/memory allocation/NN/allocation suffer/NN/suffer from/IN/from external/JJ/external as/IN/as processes/NNS/processes are/VBP/are loaded/VBN/loaded and/CC/and removed/VBD/removed from/IN/from memory/NN/memory /,/, the/DT/the free/JJ/free memory/NN/memory space/NN/space is/VBZ/is broken/VBN/broken into/IN/into little/JJ/little pieces/NNP/pieces. external/JJ/external fragmentation/NN/fragmentation exists/NNS/exists when/WRB/when there/EX/there is/VBZ/is enough/RB/enough total/JJ/total memory/NN/memory space/NN/space to/TO/to satisfy/VB/satisfy a/DT/a request/NN/request but/CC/but the/DT/the available/JJ/available spaces/NNS/spaces are/VBP/are not/RB/not contiguous/JJ/contiguous ;/:/; storage/NN/storage is/VBZ/is fragmented/VBN/fragmented into/IN/into a/DT/a large/JJ/large number/NN/number of/IN/of small/JJ/small holes/NNP/holes. this/DT/this fragmentation/NN/fragmentation problem/NN/problem can/MD/can be/VB/be severe/NNP/severe. in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, we/PRP/we could/MD/could have/VB/have a/DT/a block/NN/block of/IN/of free/JJ/free /NN/( or/CC/or wasted/VBN/wasted /-NONE-/) memory/NN/memory between/IN/between every/DT/every two/CD/two processes/NNP/processes. if/IN/if all/DT/all these/DT/these small/JJ/small pieces/NNS/pieces of/IN/of memory/NN/memory were/VBD/were in/IN/in one/CD/one big/JJ/big free/JJ/free block/NN/block instead/RB/instead /,/, we/PRP/we might/MD/might be/VB/be able/JJ/able to/TO/to run/VB/run several/JJ/several more/RBR/more processes/NNP/processes. whether/IN/whether we/PRP/we are/VBP/are using/VBG/using the/DT/the first-fit/JJ/first-fit or/CC/or best-fit/JJ/best-fit strategy/NN/strategy can/MD/can affect/VB/affect the/DT/the amount/NN/amount of/IN/of fragmentation/NNP/fragmentation. /NNP/( first/RB/first fit/JJ/fit is/VBZ/is better/RBR/better for/IN/for some/DT/some systems/NNS/systems /,/, whereas/IN/whereas best/JJS/best fit/NN/fit is/VBZ/is better/RBR/better for/IN/for others/NNP/others. /:/) another/DT/another factor/NN/factor is/VBZ/is which/WDT/which end/NN/end of/IN/of a/DT/a free/JJ/free block/NN/block is/VBZ/is allocated/NNP/allocated. /:/( which/WDT/which is/VBZ/is the/DT/the leftover/NN/leftover piece-the/DT/piece-the one/CD/one on/IN/on the/DT/the top/JJ/top or/CC/or the/DT/the one/CD/one on/IN/on the/DT/the bottom/NN/bottom /:/) no/DT/no matter/NN/matter which/WDT/which algorithm/NN/algorithm is/VBZ/is used/VBN/used /,/, however/RB/however /,/, external/JJ/external fragmentation/NN/fragmentation will/MD/will be/VB/be a/DT/a problem/NNP/problem. depending/NN/depending on/IN/on the/DT/the total/JJ/total amount/NN/amount of/IN/of memory/NN/memory storage/NN/storage and/CC/and the/DT/the average/JJ/average process/NN/process size/NN/size /,/, external/JJ/external fragmentation/NN/fragmentation may/MD/may be/VB/be a/DT/a minor/NN/minor or/CC/or a/DT/a major/JJ/major problem/NNP/problem. statistical/JJ/statistical analysis/NN/analysis of/IN/of first/JJ/first fit/NN/fit /,/, for/IN/for instance/NN/instance /,/, reveals/NNS/reveals that/WDT/that /,/, even/RB/even with/IN/with some/DT/some optimization/NN/optimization /,/, given/VBN/given n/NN/n allocated/VBN/allocated blocks/NNS/blocks /,/, another/DT/another 0.5/CD/0.5 n/NN/n blocks/NNS/blocks will/MD/will be/VB/be lost/VBN/lost to/TO/to fragmentation/NNP/fragmentation. that/IN/that is/VBZ/is /,/, one-third/NN/one-third of/IN/of memory/NN/memory may/MD/may be/VB/be unusable/JJ/unusable !/./! this/DT/this property/NN/property is/VBZ/is known/VBN/known as/IN/as the/DT/the memory/NN/memory fragmentation/NN/fragmentation can/MD/can be/VB/be internal/JJ/internal as/IN/as well/RB/well as/IN/as external/NNP/external. consider/NN/consider a/DT/a multiple-partition/NN/multiple-partition allocation/NN/allocation scheme/NN/scheme with/IN/with a/DT/a hole/NN/hole of/IN/of 18,464/CD/18,464 bytes/NNP/bytes. suppose/NN/suppose that/WDT/that the/DT/the next/JJ/next process/NN/process requests/NNS/requests 18,462/CD/18,462 bytes/NNP/bytes. if/IN/if we/PRP/we allocate/VBP/allocate exactly/RB/exactly the/DT/the requested/VBN/requested block/NN/block /,/, we/PRP/we are/VBP/are left/VBN/left with/IN/with a/DT/a hole/NN/hole of/IN/of 2/CD/2 bytes/NNP/bytes. the/DT/the overhead/JJ/overhead to/TO/to keep/VB/keep track/NN/track of/IN/of this/DT/this hole/NN/hole will/MD/will be/VB/be substantially/RB/substantially larger/JJR/larger than/IN/than the/DT/the hole/NN/hole itself/NNP/itself. the/DT/the general/JJ/general approach/NN/approach to/TO/to avoiding/NN/avoiding this/DT/this problem/NN/problem is/VBZ/is to/TO/to break/VB/break the/DT/the physical/JJ/physical memory/NN/memory into/IN/into fixed-sized/JJ/fixed-sized blocks/NNS/blocks and/CC/and allocate/VB/allocate memory/NN/memory in/IN/in units/NNS/units based/VBN/based on/IN/on block/NN/block size/NNP/size. with/IN/with this/DT/this approach/NN/approach /,/, the/DT/the memory/NN/memory allocated/VBD/allocated to/TO/to a/DT/a process/NN/process may/MD/may be/VB/be slightly/RB/slightly larger/JJR/larger than/IN/than the/DT/the requested/VBN/requested memory/NNP/memory. the/DT/the difference/NN/difference between/IN/between these/DT/these two/CD/two numbers/NNS/numbers is/VBZ/is internal/JJ/internal memory/NN/memory that/WDT/that is/VBZ/is internal/JJ/internal to/TO/to a/DT/a partition/NNP/partition. one/CD/one solution/NN/solution to/TO/to the/DT/the problem/NN/problem of/IN/of external/JJ/external fragmentation/NN/fragmentation is/VBZ/is the/DT/the goal/NN/goal is/VBZ/is to/TO/to shuffle/VB/shuffle the/DT/the memory/NN/memory contents/NNS/contents so/RB/so as/IN/as to/TO/to place/NN/place all/DT/all free/JJ/free n'lemory/JJ/n'lemory together/NN/together in/IN/in one/CD/one large/JJ/large block/NNP/block. compaction/NN/compaction is/VBZ/is not/RB/not always/RB/always possible/JJ/possible /,/, however/NNP/however. if/IN/if relocation/NN/relocation is/VBZ/is static/JJ/static and/CC/and is/VBZ/is done/VBN/done at/IN/at assembly/RB/assembly or/CC/or load/VB/load time/NN/time /,/, compaction/NN/compaction can/MD/can not/RB/not be/VB/be done/VBN/done ;/:/; compaction/NN/compaction is/VBZ/is possible/JJ/possible only/RB/only if/IN/if relocation/NN/relocation is/VBZ/is dynamic/JJ/dynamic and/CC/and is/VBZ/is done/VBN/done at/IN/at execution/NN/execution 328/CD/328 chapter/NN/chapter 8/CD/8 8.4/CD/8.4 time/NNP/time. if/IN/if addresses/NNS/addresses are/VBP/are relocated/VBN/relocated dynamically/RB/dynamically /,/, relocation/NN/relocation requires/VBZ/requires only/RB/only moving/VBG/moving the/DT/the program/NN/program and/CC/and data/NNS/data and/CC/and then/RB/then changing/VBG/changing the/DT/the base/NN/base register/NN/register to/TO/to reflect/VB/reflect the/DT/the new/JJ/new base/NN/base address/NNP/address. when/WRB/when compaction/NN/compaction is/VBZ/is possible/JJ/possible /,/, we/PRP/we must/MD/must determine/VB/determine its/PRP$/its cost/NNP/cost. the/DT/the simplest/JJS/simplest compaction/NN/compaction algorithm/NN/algorithm is/VBZ/is to/TO/to move/VB/move all/DT/all processes/NNS/processes toward/IN/toward one/CD/one end/NN/end of/IN/of memory/NN/memory ;/:/; all/DT/all holes/NNS/holes move/VBP/move in/IN/in the/DT/the other/JJ/other direction/NN/direction /,/, producing/VBG/producing one/CD/one large/JJ/large hole/NN/hole of/IN/of available/JJ/available memory/NNP/memory. this/DT/this scheme/NN/scheme can/MD/can be/VB/be expensive/NNP/expensive. another/DT/another possible/JJ/possible solution/NN/solution to/TO/to the/DT/the external-fragmentation/NN/external-fragmentation problem/NN/problem is/VBZ/is to/TO/to permit/VB/permit the/DT/the logical/JJ/logical address/NN/address space/NN/space of/IN/of the/DT/the processes/NNS/processes to/TO/to be/VB/be noncontiguous/JJ/noncontiguous /,/, thus/RB/thus allowing/VBG/allowing a/DT/a process/NN/process to/TO/to be/VB/be allocated/VBN/allocated physical/JJ/physical memory/NN/memory wherever/NN/wherever such/JJ/such memory/NN/memory is/VBZ/is available/NNP/available. two/CD/two complementary/JJ/complementary techniques/NNS/techniques achieve/VBP/achieve this/DT/this solution/NN/solution /:/: paging/VBG/paging /:/( section/NN/section 8.4/CD/8.4 /CD/) and/CC/and segmentation/NN/segmentation /:/( section/NN/section 8.6/CD/8.6 /CD/) /./. these/DT/these techniques/NNS/techniques can/MD/can also/RB/also be/VB/be combined/VBN/combined /-NONE-/( section/NN/section 8.7/CD/8.7 /CD/) /./. is/VBZ/is a/DT/a memory-management/JJ/memory-management scheme/NN/scheme that/WDT/that permits/VBZ/permits the/DT/the physical/JJ/physical address/NN/address space/NN/space a/DT/a process/NN/process to/TO/to be/VB/be noncontiguous/NNP/noncontiguous. paging/NN/paging avoids/NNS/avoids external/JJ/external fragmentation/NN/fragmentation and/CC/and the/DT/the need/NN/need for/IN/for compaction/NNP/compaction. it/PRP/it also/RB/also solves/VBZ/solves the/DT/the considerable/JJ/considerable problem/NN/problem of/IN/of fitting/VBG/fitting memory/NN/memory chunks/NNS/chunks of/IN/of varying/VBG/varying sizes/NNS/sizes onto/IN/onto the/DT/the backin.g/JJ/backin.g store/NN/store ;/:/; most/JJS/most memorymanagement/NN/memorymanagement schemes/NNS/schemes used/VBN/used before/IN/before the/DT/the introduction/NN/introduction of/IN/of paging/VBG/paging suffered/VBN/suffered from/IN/from this/DT/this problem/NNP/problem. the/DT/the problem/NN/problem arises/VBZ/arises because/IN/because /,/, when/WRB/when some/DT/some code/NN/code fragments/NNS/fragments or/CC/or data/NNS/data residing/VBG/residing in/IN/in main/JJ/main memory/NN/memory need/NN/need to/TO/to be/VB/be swapped/VBN/swapped out/RP/out /,/, space/NN/space must/MD/must be/VB/be fmmd/VBN/fmmd on/IN/on the/DT/the backing/NN/backing store/NNP/store. the/DT/the backing/NN/backing store/NN/store has/VBZ/has the/DT/the same/JJ/same fragmentation/NN/fragmentation problems/NNS/problems discussed/VBD/discussed in/IN/in connection/NN/connection with/IN/with main/JJ/main memory/NN/memory /,/, but/CC/but access/NN/access is/VBZ/is much/JJ/much slower/NN/slower /,/, so/RB/so compaction/NN/compaction is/VBZ/is impossible/NNP/impossible. because/IN/because of/IN/of its/PRP$/its advantages/NNS/advantages over/IN/over earlier/JJR/earlier methods/NNS/methods /,/, paging/VBG/paging in/IN/in its/PRP$/its various/JJ/various forms/NNS/forms is/VBZ/is used/VBN/used in/IN/in most/JJS/most operating/VBG/operating systems/NNP/systems. physical/JJ/physical address/NN/address foooo/NN/foooo /:/.. 0000/CD/0000 f1111/NNP/f1111 /:/... 1111/CD/1111 page/NN/page table/JJ/table figure/NN/figure 8.7/CD/8.7 paging/VBG/paging hardware/NNP/hardware. 1---------1/CD/1---------1 physical/JJ/physical memory/NN/memory 8.4/CD/8.4 329/CD/329 traditionally/RB/traditionally /,/, support/NN/support for/IN/for paging/NN/paging has/VBZ/has been/VBN/been handled/VBN/handled by/IN/by hardware/NNP/hardware. however/RB/however /,/, recent/JJ/recent designs/NNS/designs have/VBP/have implemented/VBN/implemented paging/VBG/paging by/IN/by closely/RB/closely integrating/VBG/integrating the/DT/the hardware/NN/hardware and/CC/and operating/NN/operating system/NN/system /,/, especially/RB/especially on/IN/on 64-bit/JJ/64-bit microprocessors/NNP/microprocessors. 8.4.1/CD/8.4.1 basic/JJ/basic method/NN/method the/DT/the basic/JJ/basic method/NN/method for/IN/for implementing/NN/implementing paging/VBG/paging involves/NNS/involves breaking/VBG/breaking physical/JJ/physical memory/NN/memory into/IN/into fixed-sized/JJ/fixed-sized blocks/NNS/blocks called/VBN/called harnes/NNS/harnes and/CC/and breaking/VBG/breaking logical/JJ/logical memory/NN/memory into/IN/into blocks/NNS/blocks of/IN/of the/DT/the same/JJ/same size/NN/size called/VBN/called when/WRB/when a/DT/a process/NN/process is/VBZ/is to/TO/to be/VB/be executed/VBN/executed /,/, its/PRP$/its pages/NNS/pages are/VBP/are loaded/VBN/loaded into/IN/into any/DT/any available/JJ/available memory/NN/memory frames/VBZ/frames from/IN/from their/PRP$/their source/NN/source /:/( a/DT/a file/NN/file system/NN/system or/CC/or the/DT/the backing/NN/backing store/NN/store /:/) /./. the/DT/the backing/NN/backing store/NN/store is/VBZ/is divided/VBN/divided into/IN/into fixed-sized/JJ/fixed-sized blocks/NNS/blocks that/WDT/that are/VBP/are of/IN/of the/DT/the san1.e/JJ/san1.e size/NN/size as/IN/as the/DT/the memory/NN/memory frames/NNP/frames. the/DT/the hardware/NN/hardware support/NN/support for/IN/for paging/NN/paging is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 8.7/CD/8.7. every/DT/every address/NN/address generated/VBD/generated the/DT/the cpu/NN/cpu is/VBZ/is divided/VBN/divided into/IN/into two/CD/two parts/NNS/parts /:/: a/DT/a /NN/{ p/NN/p /:/) and/CC/and a/DT/a /./. the/DT/the page/NN/page number/NN/number is/VBZ/is used/VBN/used as/RB/as an/DT/an index/NN/index into/IN/into a/DT/a the/DT/the page/NN/page table/NN/table contains/VBZ/contains the/DT/the base/NN/base address/NN/address of/IN/of each/DT/each page/NN/page in/IN/in physical/JJ/physical memory/NNP/memory. this/DT/this base/NN/base address/NN/address is/VBZ/is combined/VBN/combined with/IN/with the/DT/the page/NN/page offset/NN/offset to/TO/to define/VB/define the/DT/the physical/JJ/physical memory/NN/memory address/NN/address that/WDT/that is/VBZ/is sent/VBN/sent to/TO/to the/DT/the memory/NN/memory unit/NNP/unit. the/DT/the paging/NN/paging model/NN/model of/IN/of memory/NN/memory is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.8/CD/8.8. the/DT/the page/NN/page size/NN/size /:/( like/IN/like the/DT/the frame/NN/frame size/NN/size /:/) is/VBZ/is defined/VBN/defined by/IN/by the/DT/the hardware/NNP/hardware. the/DT/the size/NN/size of/IN/of a/DT/a page/NN/page is/VBZ/is typically/RB/typically a/DT/a power/NN/power of/IN/of 2/CD/2 /,/, varying/VBG/varying between/IN/between 512/CD/512 bytes/NNS/bytes and/CC/and 16/CD/16 mb/NN/mb per/IN/per page/NN/page /,/, depending/VBG/depending on/IN/on the/DT/the computer/NN/computer architecture/NNP/architecture. the/DT/the selection/NN/selection of/IN/of a/DT/a power/NN/power of/IN/of 2/CD/2 as/IN/as a/DT/a page/NN/page size/NN/size makes/VBZ/makes the/DT/the translation/NN/translation of/IN/of a/DT/a logical/JJ/logical address/NN/address into/IN/into a/DT/a page/NN/page number/NN/number and/CC/and page/NN/page offset/NN/offset particularly/RB/particularly easy/NNP/easy. if/IN/if the/DT/the size/NN/size of/IN/of the/DT/the logical/JJ/logical address/NN/address space/NN/space is/VBZ/is 2m/CD/2m /,/, and/CC/and a/DT/a page/NN/page size/NN/size is/VBZ/is 271/CD/271 addressing/VBG/addressing units/NNS/units /:/( bytes/NNS/bytes or/CC/or wordst/VB/wordst then/RB/then the/DT/the high-order/NN/high-order m/NN/m- n/NN/n bits/NNS/bits of/IN/of a/DT/a logical/JJ/logical address/NN/address designate/NN/designate the/DT/the page/NN/page number/NN/number /,/, and/CC/and the/DT/the n/NN/n low-order/NN/low-order bits/NNS/bits designate/VBP/designate the/DT/the page/NN/page offset/NNP/offset. thus/RB/thus /,/, the/DT/the logical/JJ/logical address/NN/address is/VBZ/is as/IN/as follows/NNS/follows /:/: logical/JJ/logical memory/NN/memory ~/:/~ w/NN/w page/NN/page table/NN/table frame/NN/frame number/NN/number physical/JJ/physical memory/NN/memory figure/NN/figure 8.8/CD/8.8 paging/VBG/paging model/NN/model of/IN/of logical/JJ/logical and/CC/and physical/JJ/physical memory/NNP/memory. 330/CD/330 chapter/NN/chapter 8/CD/8 page/NN/page number/NN/number page/NN/page offset/NN/offset d/NN/d m/NN/m -n/NN/-n n/NN/n where/WRB/where p/NN/p is/VBZ/is an/DT/an index/NN/index into/IN/into the/DT/the page/NN/page table/NN/table and/CC/and d/VBD/d is/VBZ/is the/DT/the displacement/NN/displacement within/IN/within the/DT/the page/NNP/page. as/IN/as a/DT/a concrete/JJ/concrete /NN/( although/IN/although minuscule/NN/minuscule /:/) example/NN/example /,/, consider/NN/consider the/DT/the memory/NN/memory in/IN/in figure/NN/figure 8.9/CD/8.9. here/RB/here /,/, in/IN/in the/DT/the logical/JJ/logical address/NN/address /,/, n/NN/n =/:/= 2/CD/2 and/CC/and m/NN/m =/:/= 4/CD/4. using/VBG/using a/DT/a page/NN/page size/NN/size of/IN/of 4/CD/4 bytes/NNS/bytes and/CC/and a/DT/a physical/JJ/physical memory/NN/memory of/IN/of 32/CD/32 bytes/NNS/bytes /:/( 8/CD/8 pages/NNS/pages /:/) /,/, we/PRP/we show/VBP/show how/WRB/how the/DT/the user/NN/user 's/POS/'s view/NN/view of/IN/of memory/NN/memory can/MD/can be/VB/be mapped/VBN/mapped into/IN/into physical/JJ/physical memory/NNP/memory. logical/JJ/logical address/NN/address 0/-NONE-/0 is/VBZ/is page/NN/page 0/-NONE-/0 /,/, offset/VBP/offset 0/CD/0. indexing/VBG/indexing into/IN/into the/DT/the page/NN/page table/NN/table /,/, we/PRP/we find/VBP/find that/IN/that page/NN/page 0/-NONE-/0 is/VBZ/is in/IN/in frame/NN/frame 5/CD/5. thus/RB/thus /,/, logical/JJ/logical address/NN/address 0/-NONE-/0 maps/VBZ/maps to/TO/to physical/JJ/physical address/NN/address 20/CD/20 /CD/[ =/CD/= /CD/( 5/CD/5 x/NN/x 4/CD/4 /CD/) +/CD/+ 0/-NONE-/0 /:/] /./. logical/JJ/logical address/NN/address 3/CD/3 /CD/( page/NN/page 0/-NONE-/0 /,/, offset/VBP/offset 3/CD/3 /CD/) maps/NNS/maps to/TO/to physical/JJ/physical address/NN/address 23/CD/23 /CD/[ =/CD/= /CD/( 5/CD/5 x/NN/x 4/CD/4 /CD/) +/CD/+ 3/CD/3 /CD/] /./. logical/JJ/logical address/NN/address 4/CD/4 is/VBZ/is page/NN/page 1/CD/1 /,/, offset/VBN/offset 0/-NONE-/0 ;/:/; according/VBG/according to/TO/to the/DT/the page/NN/page table/NN/table /,/, page/NN/page 1/CD/1 is/VBZ/is mapped/VBN/mapped to/TO/to frame/VB/frame 6/CD/6. thus/RB/thus /,/, logical/JJ/logical address/NN/address 4/CD/4 maps/NNS/maps to/TO/to physical/JJ/physical address/NN/address 24/CD/24 /CD/[ =/CD/= /CD/( 6/CD/6 x/NN/x 4/CD/4 /CD/) +/CD/+ o/NN/o /:/] /./. logical/JJ/logical address/NN/address 13/CD/13 maps/NNS/maps to/TO/to physical/JJ/physical address/NN/address 9/CD/9. you/PRP/you may/MD/may have/VB/have noticed/VBN/noticed that/IN/that paging/NN/paging itself/PRP/itself is/VBZ/is a/DT/a form/NN/form of/IN/of dynamic/JJ/dynamic relocation/NNP/relocation. every/DT/every logical/JJ/logical address/NN/address is/VBZ/is bound/VBN/bound by/IN/by the/DT/the paging/VBG/paging hardware/NN/hardware to/TO/to some/DT/some physical/JJ/physical address/NNP/address. using/NN/using paging/VBG/paging is/VBZ/is similar/JJ/similar to/TO/to using/VBG/using a/DT/a table/JJ/table of/IN/of base/NN/base /:/( or/CC/or relocation/NN/relocation /:/) registers/NNS/registers /,/, one/CD/one for/IN/for each/DT/each frame/NN/frame of/IN/of memory/NNP/memory. ~/NNP/~ m6/NNP/m6 2/CD/2 1/CD/1 3/CD/3 2/CD/2 page/NN/page table/JJ/table logical/JJ/logical memory/NN/memory physical/JJ/physical memory/NN/memory figure/NN/figure 8.9/CD/8.9 paging/VBG/paging example/NN/example for/IN/for a/DT/a 32-byte/JJ/32-byte memory/NN/memory with/IN/with 4-byte/JJ/4-byte pages/NNP/pages. 8.4/CD/8.4 331/CD/331 when/WRB/when we/PRP/we use/VBP/use a/DT/a paging/NN/paging scheme/NN/scheme /,/, we/PRP/we have/VBP/have no/DT/no external/JJ/external fragmentation/NN/fragmentation /:/: any/DT/any free/JJ/free frame/NN/frame can/MD/can be/VB/be allocated/VBN/allocated to/TO/to a/DT/a process/NN/process that/WDT/that needs/VBZ/needs it/NNP/it. however/RB/however /,/, we/PRP/we may/MD/may have/VB/have some/DT/some internal/JJ/internal fragmentation/NNP/fragmentation. notice/NN/notice that/WDT/that frames/VBZ/frames are/VBP/are allocated/VBN/allocated as/IN/as units/NNP/units. if/IN/if the/DT/the memory/NN/memory requirements/NNS/requirements of/IN/of a/DT/a process/NN/process do/VBP/do not/RB/not happen/VB/happen to/TO/to coincide/VB/coincide with/IN/with page/NN/page boundaries/NNS/boundaries /,/, the/DT/the last/JJ/last frame/NN/frame allocated/VBD/allocated may/MD/may not/RB/not be/VB/be completely/RB/completely full/NNP/full. for/IN/for example/NN/example /,/, if/IN/if page/NN/page size/NN/size is/VBZ/is 2,048/CD/2,048 bytes/NNS/bytes /,/, a/DT/a process/NN/process of/IN/of 72,766/CD/72,766 bytes/NNS/bytes will/MD/will need/VB/need 35/CD/35 pages/NNS/pages plus/CC/plus 1,086/CD/1,086 bytes/NNP/bytes. it/PRP/it will/MD/will be/VB/be allocated/VBN/allocated 36/CD/36 frames/NNS/frames /,/, resulting/VBG/resulting in/IN/in internal/JJ/internal fragmentation/NN/fragmentation of/IN/of 2,048/CD/2,048 /:/- 1,086/CD/1,086 =/CD/= 962/CD/962 bytes/NNP/bytes. in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, a/DT/a process/NN/process would/MD/would need/VB/need 11/CD/11 pages/NNS/pages plus/CC/plus 1/CD/1 byte/NNP/byte. it/PRP/it would/MD/would be/VB/be allocated/VBN/allocated 11/CD/11 +/CD/+ 1/CD/1 frames/NNS/frames /,/, resulting/VBG/resulting in/IN/in internal/JJ/internal fragmentation/NN/fragmentation of/IN/of almost/RB/almost an/DT/an entire/JJ/entire frame/NNP/frame. if/IN/if process/NN/process size/NN/size is/VBZ/is independent/JJ/independent of/IN/of page/NN/page size/NN/size /,/, we/PRP/we expect/VBP/expect internal/JJ/internal fragmentation/NN/fragmentation to/TO/to average/VB/average one-half/JJ/one-half page/NN/page per/IN/per process/NNP/process. this/DT/this consideration/NN/consideration suggests/VBZ/suggests that/IN/that small/JJ/small page/NN/page sizes/VBZ/sizes are/VBP/are desirable/NNP/desirable. however/RB/however /,/, overhead/JJ/overhead is/VBZ/is involved/VBN/involved in/IN/in each/DT/each page-table/JJ/page-table entry/NN/entry /,/, and/CC/and this/DT/this overhead/NN/overhead is/VBZ/is reduced/VBN/reduced as/RB/as the/DT/the size/NN/size of/IN/of the/DT/the pages/NNS/pages increases/NNP/increases. also/RB/also /,/, disk/NN/disk i/0/-NONE-/i/0 is/VBZ/is more/RBR/more efficient/JJ/efficient when/WRB/when the/DT/the amount/NN/amount data/NNS/data being/VBG/being transferred/VBN/transferred is/VBZ/is larger/JJR/larger /NN/( chapter/NN/chapter 12/CD/12 /CD/) /./. generally/RB/generally /,/, page/NN/page sizes/VBZ/sizes have/VB/have grown/VBN/grown over/IN/over time/NN/time as/IN/as processes/NNS/processes /,/, data/NNS/data sets/NNS/sets /,/, and/CC/and main/JJ/main memory/NN/memory have/VBP/have become/VBN/become larger/NNP/larger. today/NN/today /,/, pages/NNS/pages typically/RB/typically are/VBP/are between/IN/between 4/CD/4 kb/NN/kb and/CC/and 8/CD/8 kb/NN/kb in/IN/in size/NN/size /,/, and/CC/and some/DT/some systems/NNS/systems support/NN/support even/RB/even larger/JJR/larger page/NN/page sizes/NNP/sizes. some/DT/some cpus/NN/cpus and/CC/and kernels/NNS/kernels even/RB/even support/NN/support multiple/NN/multiple page/NN/page sizes/NNP/sizes. for/IN/for instance/NN/instance /,/, solaris/VBZ/solaris uses/NNS/uses page/NN/page sizes/NNS/sizes of/IN/of 8/CD/8 kb/NN/kb and/CC/and 4/CD/4 mb/NN/mb /,/, depending/VBG/depending on/IN/on the/DT/the data/NNS/data stored/VBD/stored by/IN/by the/DT/the pages/NNP/pages. researchers/NNS/researchers are/VBP/are now/RB/now developing/VBG/developing support/NN/support for/IN/for variable/JJ/variable on-the-fly/JJ/on-the-fly page/NN/page size/NNP/size. usually/RB/usually /,/, each/DT/each page-table/JJ/page-table entry/NN/entry is/VBZ/is 4/CD/4 bytes/NNS/bytes long/RB/long /,/, but/CC/but that/IN/that size/NN/size can/MD/can vary/VB/vary as/RB/as well/NNP/well. a/DT/a 32-bit/JJ/32-bit entry/NN/entry can/MD/can point/VB/point to/TO/to one/CD/one of/IN/of 232/CD/232 physical/JJ/physical page/NN/page frames/NNP/frames. if/IN/if frame/NN/frame size/NN/size is/VBZ/is 4/CD/4 kb/NN/kb /,/, then/RB/then a/DT/a system/NN/system with/IN/with 4-byte/JJ/4-byte entries/NNS/entries can/MD/can address/VB/address 244/CD/244 bytes/NNS/bytes /:/( or/CC/or 16/CD/16 tb/NN/tb /:/) of/IN/of physical/JJ/physical memory/NNP/memory. when/WRB/when a/DT/a process/NN/process arrives/VBZ/arrives in/IN/in the/DT/the system/NN/system to/TO/to be/VB/be executed/VBN/executed /,/, its/PRP$/its size/NN/size /,/, expressed/VBN/expressed in/IN/in pages/NNS/pages /,/, is/VBZ/is examined/NNP/examined. each/DT/each page/NN/page of/IN/of the/DT/the process/NN/process needs/VBZ/needs one/CD/one frame/NNP/frame. thus/RB/thus /,/, if/IN/if the/DT/the process/NN/process requires/VBZ/requires 11/CD/11 pages/NNS/pages /,/, at/IN/at least/JJS/least 11/CD/11 frames/NNS/frames must/MD/must be/VB/be available/JJ/available in/IN/in memory/NNP/memory. if/IN/if n/NN/n frames/NNS/frames are/VBP/are available/JJ/available /,/, they/PRP/they are/VBP/are allocated/VBN/allocated to/TO/to this/DT/this arriving/NN/arriving process/NNP/process. the/DT/the first/JJ/first page/NN/page of/IN/of the/DT/the process/NN/process is/VBZ/is loaded/VBN/loaded injo/NN/injo one/CD/one of/IN/of the/DT/the allocated/VBN/allocated frames/NNS/frames /,/, and/CC/and the/DT/the frame/NN/frame number/NN/number is/VBZ/is put/VBN/put in/RP/in the/DT/the page/NN/page table/NN/table for/IN/for this/DT/this process/NNP/process. the/DT/the next/JJ/next page/NN/page is/VBZ/is loaded/VBN/loaded into/IN/into another/DT/another frame/NN/frame /,/, its/PRP$/its frame/NN/frame number/NN/number is/VBZ/is put/VBN/put into/IN/into the/DT/the page/NN/page table/NN/table /,/, and/CC/and so/RB/so on/IN/on /NNP/( figure/NN/figure 8.10/CD/8.10 /CD/) /./. an/DT/an important/JJ/important aspect/NN/aspect of/IN/of paging/VBG/paging is/VBZ/is the/DT/the clear/JJ/clear separation/NN/separation between/IN/between the/DT/the user/NN/user 's/POS/'s view/NN/view of/IN/of memory/NN/memory and/CC/and the/DT/the actual/JJ/actual physical/JJ/physical memory/NNP/memory. the/DT/the user/NN/user program/NN/program views/NNS/views memory/NN/memory as/IN/as one/CD/one single/JJ/single space/NN/space /,/, containing/VBG/containing only/RB/only this/DT/this one/CD/one program/NNP/program. in/IN/in fact/NN/fact /,/, the/DT/the user/NN/user program/NN/program is/VBZ/is scattered/VBN/scattered throughout/IN/throughout physical/JJ/physical memory/NN/memory /,/, which/WDT/which also/RB/also holds/VBZ/holds other/JJ/other programs/NNP/programs. the/DT/the difference/NN/difference between/IN/between the/DT/the user/NN/user 's/POS/'s view/NN/view of/IN/of memory/NN/memory and/CC/and the/DT/the actual/JJ/actual physical/JJ/physical memory/NN/memory is/VBZ/is reconciled/VBN/reconciled by/IN/by the/DT/the address-translation/NN/address-translation hardware/NNP/hardware. the/DT/the logical/JJ/logical addresses/NNS/addresses are/VBP/are translated/VBN/translated into/IN/into physical/JJ/physical addresses/NNP/addresses. this/DT/this mapping/NN/mapping is/VBZ/is hidden/VBN/hidden from/IN/from the/DT/the user/NN/user and/CC/and is/VBZ/is controlled/VBN/controlled by/IN/by the/DT/the operating/NN/operating system/NNP/system. notice/NN/notice that/WDT/that the/DT/the user/NN/user process/NN/process by/IN/by definition/NN/definition is/VBZ/is unable/JJ/unable to/TO/to access/NN/access memory/NN/memory it/PRP/it does/VBZ/does not/RB/not own/NNP/own. it/PRP/it has/VBZ/has no/DT/no way/NN/way of/IN/of addressing/VBG/addressing memory/NN/memory outside/IN/outside of/IN/of its/PRP$/its page/NN/page table/NN/table /,/, and/CC/and the/DT/the table/NN/table includes/VBZ/includes only/RB/only those/DT/those pages/NNS/pages that/IN/that the/DT/the process/NN/process owns/NNP/owns. since/IN/since the/DT/the operating/NN/operating system/NN/system is/VBZ/is managing/VBG/managing physical/JJ/physical memory/NN/memory /,/, it/PRP/it must/MD/must be/VB/be aware/JJ/aware of/IN/of the/DT/the allocation/NN/allocation details/NNS/details of/IN/of physical/JJ/physical memory-which/JJ/memory-which frames/NNS/frames are/VBP/are allocated/VBN/allocated /,/, which/WDT/which frames/VBZ/frames are/VBP/are available/JJ/available /,/, how/WRB/how many/JJ/many total/JJ/total frames/NNS/frames there/EX/there are/VBP/are /,/, and/CC/and so/RB/so on/NNP/on. this/DT/this information/NN/information is/VBZ/is generally/RB/generally kept/VBD/kept in/IN/in a/DT/a data/NN/data structure/NN/structure called/VBN/called a/DT/a frame/NN/frame the/DT/the frame/NN/frame table/NN/table has/VBZ/has one/CD/one entry/NN/entry for/IN/for each/DT/each physical/JJ/physical page/NN/page frame/NN/frame /,/, indicating/VBG/indicating whether/IN/whether the/DT/the latter/NN/latter is/VBZ/is free/JJ/free or/CC/or allocated/VBN/allocated and/CC/and /,/, if/IN/if it/PRP/it is/VBZ/is allocated/VBN/allocated /,/, to/TO/to which/WDT/which page/NN/page of/IN/of which/WDT/which process/NN/process or/CC/or processes/NNP/processes. 332/CD/332 chapter/NN/chapter 8/CD/8 free-frame/JJ/free-frame list/NN/list free-frame/JJ/free-frame list/NN/list 14/CD/14 13/CD/13 15/CD/15 13/CD/13 13/CD/13 18/CD/18 20/CD/20 14/CD/14 14/CD/14 15/CD/15 15/CD/15 15/CD/15 16/CD/16 16/CD/16 17/CD/17 17/CD/17 18/CD/18 18/CD/18 19/CD/19 01/CD/01 19/CD/19 1/CD/1 13/CD/13 20/CD/20 2/CD/2 18/CD/18 20/CD/20 3.20/CD/3.20 21/CD/21 new-process/JJ/new-process page/NN/page table/NN/table 21/CD/21 /CD/( a/DT/a /NN/) /:/( b/NN/b /:/) figure/NN/figure 8.10/CD/8.10 free/JJ/free frames/NNS/frames /:/( a/DT/a /NN/) before/IN/before allocation/NN/allocation and/CC/and /CD/( b/NN/b /:/) after/IN/after allocation/NNP/allocation. in/IN/in addition/NN/addition /,/, the/DT/the operating/NN/operating system/NN/system must/MD/must be/VB/be aware/JJ/aware that/IN/that user/NN/user processes/NNS/processes operate/VBP/operate in/IN/in user/NN/user space/NN/space /,/, and/CC/and all/DT/all logical/JJ/logical addresses/NNS/addresses must/MD/must be/VB/be mapped/VBN/mapped to/TO/to produce/VB/produce physical/JJ/physical addresses/NNP/addresses. if/IN/if a/DT/a user/NN/user makes/VBZ/makes a/DT/a system/NN/system call/NN/call /:/( to/TO/to do/VB/do i/0/-NONE-/i/0 /,/, for/IN/for example/NN/example /:/) and/CC/and provides/VBZ/provides an/DT/an address/NN/address as/IN/as a/DT/a parameter/NN/parameter /:/( a/DT/a buffe1/NNP/buffe1 ~/NNP/~ for/IN/for instance/NN/instance /:/) /,/, that/IN/that address/NN/address must/MD/must be/VB/be mapped/VBN/mapped to/TO/to produce/VB/produce the/DT/the correct/NN/correct physical/JJ/physical address/NNP/address. the/DT/the operating/NN/operating system/NN/system maintains/VBZ/maintains a/DT/a copy/NN/copy of/IN/of the/DT/the page/NN/page table/NN/table for/IN/for each/DT/each process/NN/process /,/, just/RB/just as/IN/as it/PRP/it maintains/VBZ/maintains a/DT/a copy/NN/copy of/IN/of the/DT/the instruction/NN/instruction counter/NN/counter and/CC/and register/NN/register contents/NNP/contents. this/DT/this copy/NN/copy is/VBZ/is used/VBN/used to/TO/to translate/VB/translate logical/JJ/logical addresses/NNS/addresses to/TO/to physical/JJ/physical addresses/NNS/addresses whenever/RB/whenever the/DT/the operating/NN/operating system/NN/system must/MD/must map/VB/map a/DT/a logical/JJ/logical address/NN/address to/TO/to a/DT/a physical/JJ/physical address/NN/address manually/NNP/manually. it/PRP/it is/VBZ/is also/RB/also used/VBN/used by/IN/by the/DT/the cpu/NN/cpu dispatcher/NN/dispatcher to/TO/to define/VB/define the/DT/the hardware/NN/hardware page/NN/page table/NN/table when/WRB/when a/DT/a process/NN/process is/VBZ/is to/TO/to be/VB/be allocated/VBN/allocated the/DT/the cpu/NNP/cpu. paging/NN/paging therefore/RB/therefore increases/VBZ/increases the/DT/the context-switch/JJ/context-switch time/NNP/time. 8.4.2/CD/8.4.2 hardware/NN/hardware support/NN/support each/DT/each operating/NN/operating system/NN/system has/VBZ/has its/PRP$/its own/JJ/own methods/NNS/methods for/IN/for storing/VBG/storing page/NN/page tables/NNP/tables. most/JJS/most allocate/JJ/allocate a/DT/a page/NN/page table/NN/table for/IN/for each/DT/each process/NNP/process. a/DT/a pointer/NN/pointer to/TO/to the/DT/the page/NN/page table/NN/table is/VBZ/is stored/VBN/stored with/IN/with the/DT/the other/JJ/other register/NN/register values/NNS/values /:/( like/IN/like the/DT/the instruction/NN/instruction counter/NN/counter /:/) in/IN/in the/DT/the process/NN/process control/NN/control block/NNP/block. when/WRB/when the/DT/the dispatcher/NN/dispatcher is/VBZ/is told/VBN/told to/TO/to start/VB/start a/DT/a process/NN/process /,/, it/PRP/it must/MD/must reload/VB/reload the/DT/the user/NN/user registers/NNS/registers and/CC/and define/NN/define the/DT/the correct/NN/correct hardware/NN/hardware page-table/JJ/page-table values/NNS/values from/IN/from the/DT/the stored/VBN/stored user/NN/user page/NN/page table/NNP/table. the/DT/the hardware/NN/hardware implementation/NN/implementation of/IN/of the/DT/the page/NN/page table/NN/table can/MD/can be/VB/be done/VBN/done in/IN/in several/JJ/several in/IN/in the/DT/the simplest/NN/simplest case/NN/case /,/, the/DT/the page/NN/page table/NN/table is/VBZ/is implemented/VBN/implemented as/RB/as a/DT/a set/NN/set of/IN/of dedicated/VBN/dedicated these/DT/these registers/NNS/registers should/MD/should be/VB/be built/VBN/built with/IN/with very/RB/very high-speed/JJ/high-speed logic/NN/logic to/TO/to make/VB/make the/DT/the paging-address/JJ/paging-address translation/NN/translation efficient/NNP/efficient. every/DT/every access/NN/access to/TO/to memory/NN/memory nlust/RB/nlust go/VB/go through/IN/through the/DT/the paging/NN/paging map/NN/map /,/, so/RB/so efficiency/NN/efficiency is/VBZ/is a/DT/a major/JJ/major consideration/NNP/consideration. the/DT/the cpu/NN/cpu dispatcher/NN/dispatcher reloads/NNS/reloads these/DT/these registers/NNS/registers /,/, just/RB/just as/IN/as it/PRP/it reloads/VBZ/reloads the/DT/the other/JJ/other registers/NNP/registers. instructions/NNS/instructions to/TO/to load/VB/load or/CC/or modify/VB/modify the/DT/the page-table/JJ/page-table registers/NNS/registers are/VBP/are /,/, of/IN/of course/NN/course /,/, privileged/VBD/privileged /,/, so/RB/so that/IN/that only/RB/only the/DT/the operating/NN/operating system/NN/system can/MD/can change/VB/change the/DT/the memory/NN/memory map/NNP/map. the/DT/the dec/NN/dec pdp-11/-NONE-/pdp-11 is/VBZ/is an/DT/an example/NN/example of/IN/of such/JJ/such an/DT/an architecture/NNP/architecture. the/DT/the address/NN/address consists/VBZ/consists of/IN/of 16/CD/16 bits/NNS/bits /,/, and/CC/and the/DT/the page/NN/page size/NN/size is/VBZ/is 8/CD/8 kb/NNP/kb. the/DT/the page/NN/page table/NN/table thus/RB/thus consists/VBZ/consists of/IN/of eight/CD/eight entries/NNS/entries that/WDT/that are/VBP/are kept/VBD/kept in/IN/in fast/JJ/fast registers/NNP/registers. 8.4/CD/8.4 333/CD/333 the/DT/the use/NN/use of/IN/of registers/NNS/registers for/IN/for the/DT/the page/NN/page table/NN/table is/VBZ/is satisfactory/JJ/satisfactory if/IN/if the/DT/the page/NN/page table/NN/table is/VBZ/is reasonably/RB/reasonably sncall/JJ/sncall /NN/( for/IN/for example/NN/example /,/, 256/CD/256 entries/NNS/entries /:/) /./. most/JJS/most contemporary/JJ/contemporary computers/NNS/computers /,/, however/RB/however /,/, allow/VBP/allow the/DT/the page/NN/page table/NN/table to/TO/to be/VB/be very/RB/very large/JJ/large /NN/( for/IN/for example/NN/example /,/, 1/CD/1 million/CD/million entries/NNS/entries /:/) /./. for/IN/for these/DT/these machines/NNS/machines /,/, the/DT/the use/NN/use of/IN/of fast/NN/fast registers/NNS/registers to/TO/to implement/VB/implement the/DT/the page/NN/page table/NN/table is/VBZ/is not/RB/not feasible/NNP/feasible. rather/RB/rather /,/, the/DT/the page/NN/page table/NN/table is/VBZ/is kept/VBN/kept in/IN/in main/JJ/main memory/NN/memory /,/, and/CC/and a/DT/a points/NNS/points to/TO/to the/DT/the page/NN/page table/NNP/table. changing/NN/changing page/NN/page tables/NNS/tables requires/VBZ/requires changing/VBG/changing only/RB/only this/DT/this one/CD/one register/NN/register /,/, substantially/RB/substantially reducing/VBG/reducing context-switch/JJ/context-switch time/NNP/time. the/DT/the problem/NN/problem with/IN/with this/DT/this approach/NN/approach is/VBZ/is the/DT/the time/NN/time required/VBN/required to/TO/to access/NN/access a/DT/a user/NN/user memory/NN/memory location/NNP/location. if/IN/if we/PRP/we want/VBP/want to/TO/to access/NN/access location/NN/location i/PRP/i /,/, we/PRP/we must/MD/must first/RB/first index/NN/index into/IN/into the/DT/the page/NN/page table/NN/table /,/, using/VBG/using the/DT/the value/NN/value in/IN/in the/DT/the ptbr/NN/ptbr offset/NN/offset by/IN/by the/DT/the page/NN/page number/NN/number fori/NNP/fori. this/DT/this task/NN/task requires/VBZ/requires a/DT/a memory/NN/memory access/NNP/access. it/PRP/it provides/VBZ/provides us/PRP/us with/IN/with the/DT/the frame/NN/frame number/NN/number /,/, which/WDT/which is/VBZ/is combined/VBN/combined with/IN/with the/DT/the page/NN/page offset/NN/offset to/TO/to produce/VB/produce the/DT/the actual/JJ/actual address/NNP/address. we/PRP/we can/MD/can then/RB/then access/VB/access the/DT/the desired/VBN/desired place/NN/place in/IN/in memory/NNP/memory. with/IN/with this/DT/this scheme/NN/scheme /,/, two/CD/two memory/NN/memory accesses/NNS/accesses are/VBP/are needed/VBN/needed to/TO/to access/NN/access a/DT/a byte/NN/byte /:/( one/CD/one for/IN/for the/DT/the page-table/JJ/page-table entry/NN/entry /,/, one/CD/one for/IN/for the/DT/the byte/NN/byte /:/) /./. thus/RB/thus /,/, memory/NN/memory access/NN/access is/VBZ/is slowed/VBN/slowed by/IN/by a/DT/a factor/NN/factor of/IN/of 2/CD/2. this/DT/this delay/NN/delay would/MD/would be/VB/be intolerable/JJ/intolerable under/IN/under most/JJS/most circumstances/NNP/circumstances. we/PRP/we might/MD/might as/RB/as well/RB/well resort/VB/resort to/TO/to swapping/VB/swapping !/./! the/DT/the standard/JJ/standard solution/NN/solution to/TO/to this/DT/this problem/NN/problem is/VBZ/is to/TO/to use/VB/use a/DT/a special/JJ/special /,/, small/JJ/small /,/, fastlookup/NN/fastlookup hardware/NN/hardware cache/NN/cache /,/, called/VBN/called a/DT/a bc.1her/JJ/bc.1her the/DT/the tlb/NN/tlb is/VBZ/is associative/JJ/associative /,/, high-speed/JJ/high-speed memory/NNP/memory. each/DT/each entry/NN/entry in/IN/in the/DT/the tlb/NN/tlb consists/VBZ/consists of/IN/of two/CD/two parts/NNS/parts /:/: a/DT/a key/JJ/key /NN/( or/CC/or tag/NN/tag /:/) and/CC/and a/DT/a value/NNP/value. when/WRB/when the/DT/the associative/JJ/associative memory/NN/memory is/VBZ/is presented/VBN/presented with/IN/with an/DT/an item/NN/item /,/, the/DT/the item/NN/item is/VBZ/is compared/VBN/compared with/IN/with all/DT/all keys/NNS/keys simultaneously/NNP/simultaneously. if/IN/if the/DT/the item/NN/item is/VBZ/is found/VBN/found /,/, the/DT/the corresponding/NN/corresponding value/NN/value field/NN/field is/VBZ/is returned/NNP/returned. the/DT/the search/NN/search is/VBZ/is fast/VBN/fast ;/:/; the/DT/the hardware/NN/hardware /,/, however/RB/however /,/, is/VBZ/is expensive/NNP/expensive. typically/RB/typically /,/, the/DT/the number/NN/number of/IN/of entries/NNS/entries in/IN/in a/DT/a tlb/NN/tlb is/VBZ/is small/JJ/small /,/, often/RB/often numbering/VBG/numbering between/IN/between 64/CD/64 and/CC/and 1,024/CD/1,024. the/DT/the tlb/NN/tlb is/VBZ/is used/VBN/used with/IN/with page/NN/page tables/NNS/tables in/IN/in the/DT/the following/JJ/following way/NNP/way. the/DT/the tlb/NN/tlb contains/VBZ/contains only/RB/only a/DT/a few/JJ/few of/IN/of the/DT/the page-table/JJ/page-table entries/NNP/entries. when/WRB/when a/DT/a logical/JJ/logical address/NN/address is/VBZ/is generated/VBN/generated by/IN/by the/DT/the cpu/NN/cpu /,/, its/PRP$/its page/NN/page number/NN/number is/VBZ/is presented/VBN/presented to/TO/to the/DT/the tlb/NNP/tlb. if/IN/if the/DT/the page/NN/page number/NN/number is/VBZ/is found/VBN/found /,/, its/PRP$/its frame/NN/frame number/NN/number is/VBZ/is immediately/RB/immediately available/JJ/available and/CC/and is/VBZ/is used/VBN/used to/TO/to access/NN/access memory/NNP/memory. the/DT/the whole/JJ/whole task/NN/task may/MD/may take/VB/take less/RBR/less than/IN/than 10/CD/10 percent/NN/percent longer/NN/longer than/IN/than it/PRP/it would/MD/would if/IN/if an/DT/an unmapped/VBN/unmapped memory/NN/memory reference/NN/reference were/VBD/were used/NNP/used. if/IN/if the/DT/the page/NN/page number/NN/number is/VBZ/is not/RB/not in/IN/in the/DT/the tlb/NN/tlb /:/( known/VBN/known as/IN/as a/DT/a a/DT/a memory/NN/memory reference/NN/reference to/TO/to the/DT/the page/NN/page table/NN/table must/MD/must be/VB/be made/NNP/made. when/WRB/when the/DT/the frame/NN/frame number/NN/number is/VBZ/is obtained/VBN/obtained /,/, we/PRP/we can/MD/can use/VB/use it/PRP/it to/TO/to access/NN/access memory/NN/memory /:/( figure/NN/figure 8.11/CD/8.11 /CD/) /./. in/IN/in addition/NN/addition /,/, we/PRP/we add/VBP/add the/DT/the page/NN/page number/NN/number and/CC/and frame/VBD/frame number/NN/number to/TO/to the/DT/the tlb/NN/tlb /,/, so/RB/so that/IN/that they/PRP/they will/MD/will be/VB/be found/VBN/found quickly/RB/quickly on/IN/on the/DT/the next/JJ/next reference/NNP/reference. if/IN/if the/DT/the tlb/NN/tlb is/VBZ/is already/RB/already full/JJ/full of/IN/of entries/NNS/entries /,/, the/DT/the operating/NN/operating system/NN/system must/MD/must select/VB/select one/CD/one for/IN/for replacement/NNP/replacement. replacement/NN/replacement policies/NNS/policies range/VBP/range from/IN/from least/JJS/least recently/RB/recently used/VBD/used /CD/( lru/NN/lru /:/) to/TO/to random/NNP/random. furthermore/NN/furthermore /,/, some/DT/some tlbs/NNS/tlbs allow/VBP/allow certain/JJ/certain entries/NNS/entries to/TO/to be/VB/be meaning/VBG/meaning that/IN/that they/PRP/they can/MD/can not/RB/not be/VB/be removed/VBN/removed from/IN/from the/DT/the tlb/NNP/tlb. typically/RB/typically /,/, tlb/NN/tlb entries/NNS/entries for/IN/for kernel/NN/kernel code/NN/code are/VBP/are wired/VBN/wired down/NNP/down. some/DT/some tlbs/NNS/tlbs store/VBP/store in/IN/in each/DT/each tlb/NN/tlb entry/NNP/entry. an/DT/an asid/JJ/asid uniquely/RB/uniquely identifies/VBZ/identifies each/DT/each process/NN/process and/CC/and is/VBZ/is used/VBN/used to/TO/to provide/VB/provide address-space/JJ/address-space protection/NN/protection for/IN/for that/DT/that process/NNP/process. when/WRB/when the/DT/the tlb/NN/tlb attempts/VBZ/attempts to/TO/to resolve/VB/resolve virtual/JJ/virtual page/NN/page numbers/NNS/numbers /,/, it/PRP/it ensures/VBZ/ensures that/IN/that the/DT/the asid/NN/asid for/IN/for the/DT/the currently/RB/currently running/VBG/running process/NN/process matches/NNS/matches the/DT/the asid/JJ/asid associated/VBN/associated with/IN/with the/DT/the virtual/JJ/virtual page/NNP/page. if/IN/if the/DT/the asids/NNS/asids do/VBP/do not/RB/not match/VB/match /,/, the/DT/the attempt/NN/attempt is/VBZ/is treated/VBN/treated as/RB/as a/DT/a tlb/NN/tlb miss/NNP/miss. in/IN/in addition/NN/addition to/TO/to providing/VBG/providing address-space/NN/address-space protection/NN/protection /,/, an/DT/an asid/JJ/asid allows/NNS/allows the/DT/the tlb/NN/tlb to/TO/to contain/VB/contain entries/NNS/entries for/IN/for several/JJ/several different/JJ/different processes/NNS/processes simultaneously/NNP/simultaneously. if/IN/if the/DT/the tlb/NN/tlb does/VBZ/does not/RB/not support/VB/support separate/JJ/separate asids/NNS/asids /,/, then/RB/then every/DT/every time/NN/time a/DT/a new/JJ/new table/JJ/table is/VBZ/is selected/VBN/selected /-NONE-/( for/IN/for instance/NN/instance /,/, with/IN/with each/DT/each context/NN/context switch/NN/switch /:/) /,/, the/DT/the tlb/NN/tlb must/MD/must /VB/( or/CC/or erased/VBN/erased /-NONE-/) to/TO/to ensure/VB/ensure that/IN/that the/DT/the next/JJ/next executing/NN/executing process/NN/process does/VBZ/does not/RB/not use/VB/use the/DT/the wrong/JJ/wrong translation/NN/translation information/NNP/information. otherwise/NN/otherwise /,/, the/DT/the tlb/NN/tlb could/MD/could include/VB/include old/JJ/old entries/NNS/entries that/WDT/that 334/CD/334 chapter/NN/chapter 8/CD/8 tlb/NN/tlb hit/NN/hit tlb/NN/tlb p/NN/p tlb/NN/tlb miss/NN/miss page/NN/page table/NN/table figure/NN/figure 8.11/CD/8.11 paging/VBG/paging hardware/NN/hardware with/IN/with tlb/NNP/tlb. physical/JJ/physical memory/NN/memory contain/NN/contain valid/VBD/valid virtual/JJ/virtual addresses/NNS/addresses but/CC/but have/VBP/have incorrect/VBN/incorrect or/CC/or invalid/JJ/invalid physical/JJ/physical addresses/NNS/addresses left/VBN/left over/IN/over from/IN/from the/DT/the previous/JJ/previous process/NNP/process. the/DT/the percentage/NN/percentage of/IN/of times/NNS/times that/WDT/that a/DT/a particular/JJ/particular page/NN/page number/NN/number is/VBZ/is found/VBN/found in/IN/in the/DT/the tlb/NN/tlb is/VBZ/is called/VBN/called the/DT/the an/DT/an 80-percent/JJ/80-percent hit/NN/hit ratio/NN/ratio /,/, for/IN/for example/NN/example /,/, means/VBZ/means that/DT/that we/PRP/we find/VBP/find the/DT/the desired/VBN/desired page/NN/page number/NN/number in/IN/in the/DT/the tlb/NN/tlb 80/CD/80 percent/NN/percent of/IN/of the/DT/the time/NNP/time. if/IN/if it/PRP/it takes/VBZ/takes 20/CD/20 nanoseconds/NNS/nanoseconds to/TO/to search/VB/search the/DT/the tlb/NN/tlb and/CC/and 100/CD/100 nanoseconds/NNS/nanoseconds to/TO/to access/NN/access memory/NN/memory /,/, then/RB/then a/DT/a mapped-memory/JJ/mapped-memory access/NN/access takes/VBZ/takes 120/CD/120 nanoseconds/NNS/nanoseconds when/WRB/when the/DT/the page/NN/page number/NN/number is/VBZ/is in/IN/in the/DT/the tlb/NNP/tlb. if/IN/if we/PRP/we fail/VBP/fail to/TO/to find/VB/find the/DT/the page/NN/page number/NN/number in/IN/in the/DT/the tlb/NN/tlb /:/( 20/CD/20 nanoseconds/NNS/nanoseconds /:/) /,/, then/RB/then we/PRP/we must/MD/must first/RB/first access/NN/access memory/NN/memory for/IN/for the/DT/the page/NN/page table/NN/table and/CC/and frame/VBD/frame number/NN/number /:/( 100/CD/100 nanoseconds/NNS/nanoseconds /:/) and/CC/and then/RB/then access/NN/access the/DT/the desired/VBN/desired byte/NN/byte in/IN/in memory/NN/memory /:/( 100/CD/100 nanoseconds/NNS/nanoseconds /:/) /,/, for/IN/for a/DT/a total/JJ/total of/IN/of 220/CD/220 nanoseconds/NNP/nanoseconds. to/TO/to find/VB/find the/DT/the effective/JJ/effective we/PRP/we weight/MD/weight the/DT/the case/NN/case by/IN/by its/PRP$/its probability/NN/probability /:/: effective/JJ/effective access/NN/access time/NN/time =/:/= 0.80/CD/0.80 x/NN/x 120/CD/120 +/CD/+ 0.20/CD/0.20 x/NN/x 220/CD/220 =/CD/= 140/CD/140 nanoseconds/NNP/nanoseconds. in/IN/in this/DT/this example/NN/example /,/, we/PRP/we suffer/VBP/suffer a/DT/a 40-percent/JJ/40-percent slowdown/NN/slowdown in/IN/in memory-access/JJ/memory-access time/NN/time /:/( from/IN/from 100/CD/100 to/TO/to 140/CD/140 nanoseconds/NNS/nanoseconds /:/) /./. for/IN/for a/DT/a 98-percent/JJ/98-percent hit/NN/hit ratio/NN/ratio /,/, we/PRP/we have/VBP/have effective/JJ/effective access/NN/access time/NN/time =/:/= 0.98/CD/0.98 x/NN/x 120/CD/120 +/CD/+ 0.02/CD/0.02 x/NN/x 220/CD/220 =/CD/= 122/CD/122 nanoseconds/NNP/nanoseconds. this/DT/this increased/VBN/increased hit/NN/hit rate/NN/rate produces/NNS/produces only/RB/only a/DT/a 22/CD/22 percent/NN/percent slowdown/NN/slowdown in/IN/in access/NN/access time/NNP/time. we/PRP/we will/MD/will further/RB/further explore/VB/explore the/DT/the impact/NN/impact of/IN/of the/DT/the hit/NN/hit ratio/NN/ratio on/IN/on the/DT/the tlb/NN/tlb in/IN/in chapter/NN/chapter 9/CD/9. 8.4/CD/8.4 335/CD/335 8.4.3/CD/8.4.3 protection/NN/protection memory/NN/memory protection/NN/protection in/IN/in a/DT/a paged/JJ/paged environment/NN/environment is/VBZ/is accomplished/VBN/accomplished by/IN/by protection/NN/protection bits/NNS/bits associated/VBN/associated with/IN/with each/DT/each frame/NNP/frame. normally/RB/normally /,/, these/DT/these bits/NNS/bits are/VBP/are kept/VBN/kept in/IN/in the/DT/the page/NN/page table/NNP/table. one/CD/one bit/NN/bit can/MD/can define/VB/define a/DT/a page/NN/page to/TO/to be/VB/be read-write/JJ/read-write or/CC/or read-only/NNP/read-only. every/DT/every reference/NN/reference to/TO/to memory/NN/memory goes/VBZ/goes through/IN/through the/DT/the page/NN/page table/NN/table to/TO/to find/VB/find the/DT/the correct/NN/correct frame/NN/frame nuncber/NNP/nuncber. at/IN/at the/DT/the same/JJ/same time/NN/time that/WDT/that the/DT/the physical/JJ/physical address/NN/address is/VBZ/is being/VBG/being computed/VBN/computed /,/, the/DT/the protection/NN/protection bits/VBZ/bits can/MD/can be/VB/be checked/VBN/checked to/TO/to verify/VB/verify that/IN/that no/DT/no writes/NNS/writes are/VBP/are being/VBG/being made/VBN/made to/TO/to a/DT/a read-only/JJ/read-only page/NNP/page. an/DT/an attempt/NN/attempt to/TO/to write/VB/write to/TO/to a/DT/a read-only/JJ/read-only page/NN/page causes/NNS/causes a/DT/a hardware/NN/hardware trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NN/system /:/( or/CC/or memory-protection/NN/memory-protection violation/NN/violation /:/) /./. we/PRP/we can/MD/can easily/RB/easily expand/VB/expand this/DT/this approach/NN/approach to/TO/to provide/VB/provide a/DT/a finer/NN/finer level/NN/level of/IN/of protection/NNP/protection. we/PRP/we can/MD/can create/VB/create hardware/NN/hardware to/TO/to provide/VB/provide read-only/JJ/read-only /,/, read-write/JJ/read-write /,/, or/CC/or execute-only/RB/execute-only protection/NN/protection ;/:/; or/CC/or /,/, by/IN/by providing/NN/providing separate/JJ/separate protection/NN/protection bits/NNS/bits for/IN/for each/DT/each kind/NN/kind of/IN/of access/NN/access /,/, we/PRP/we can/MD/can allow/VB/allow any/DT/any combination/NN/combination of/IN/of these/DT/these accesses/NNP/accesses. illegal/JJ/illegal attempts/NNS/attempts will/MD/will be/VB/be trapped/VBN/trapped to/TO/to the/DT/the operating/NN/operating system/NNP/system. one/CD/one additional/JJ/additional bit/NN/bit is/VBZ/is generally/RB/generally attached/VBN/attached to/TO/to each/DT/each entry/NN/entry in/IN/in the/DT/the page/NN/page table/NN/table /:/: a/DT/a bit/NNP/bit. when/WRB/when this/DT/this bit/NN/bit is/VBZ/is set/VBN/set to/TO/to valid/JJ/valid /,/, the/DT/the associated/VBN/associated page/NN/page is/VBZ/is in/IN/in the/DT/the process/NN/process 's/POS/'s logical/JJ/logical address/NN/address space/NN/space and/CC/and is/VBZ/is thus/RB/thus a/DT/a legal/JJ/legal /NN/( or/CC/or valid/JJ/valid /NN/) page/NNP/page. when/WRB/when the/DT/the bit/NN/bit is/VBZ/is set/VBN/set to/TO/to invalid/JJ/invalid /,/, the/DT/the page/NN/page is/VBZ/is not/RB/not in/IN/in the/DT/the process/NN/process 's/POS/'s logical/JJ/logical address/NN/address space/NNP/space. illegal/NN/illegal addresses/NNS/addresses are/VBP/are trapped/VBN/trapped by/IN/by use/NN/use of/IN/of the/DT/the valid/JJ/valid -invalid/JJ/-invalid bit/NNP/bit. the/DT/the operating/NN/operating system/NN/system sets/VBZ/sets this/DT/this bit/NN/bit for/IN/for each/DT/each page/NN/page to/TO/to allow/VB/allow or/CC/or disallow/VB/disallow access/NN/access to/TO/to the/DT/the page/NNP/page. suppose/NN/suppose /,/, for/IN/for example/NN/example /,/, that/IN/that in/IN/in a/DT/a system/NN/system with/IN/with a/DT/a 14-bit/JJ/14-bit address/NN/address space/NN/space /:/( 0/-NONE-/0 to/TO/to 16383/CD/16383 /CD/) /,/, we/PRP/we have/VBP/have a/DT/a program/NN/program that/WDT/that should/MD/should use/VB/use only/RB/only addresses/VBZ/addresses 0/-NONE-/0 to/TO/to 10468/CD/10468. given/VBN/given a/DT/a page/NN/page size/NN/size of/IN/of 2/CD/2 kb/NN/kb /,/, we/PRP/we have/VBP/have the/DT/the situation/NN/situation shown/NN/shown in/IN/in figure/NN/figure 8.12/CD/8.12. addresses/NNS/addresses in/IN/in 0/-NONE-/0 frame/NN/frame number/NN/number j/NN/j valid-invalid/JJ/valid-invalid bit/NN/bit 0/-NONE-/0 10,468/CD/10,468 1/CD/1 2,287/CD/2,287 '-----'--'--'/:/'-----'--'--'- '/''/' page/NN/page n/NN/n figure/NN/figure 8/CD/8. i/PRP/i 2/CD/2 valid/VBD/valid /CD/( v/NN/v /:/) or/CC/or invalid/JJ/invalid /NN/( i/PRP/i /VBP/) bit/NN/bit in/IN/in a/DT/a page/NN/page table/NNP/table. 336/CD/336 chapter/NN/chapter 8/CD/8 pages/NNS/pages 0/-NONE-/0 /,/, 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 4/CD/4 /,/, and/CC/and 5/CD/5 are/VBP/are mapped/VBN/mapped normally/RB/normally through/IN/through the/DT/the page/NN/page table/NNP/table. any/DT/any attempt/NN/attempt to/TO/to generate/VB/generate an/DT/an address/NN/address in/IN/in pages/NNS/pages 6/CD/6 or/CC/or 7/CD/7 /,/, however/RB/however /,/, will/MD/will find/VB/find that/IN/that the/DT/the valid/JJ/valid -invalid/JJ/-invalid bit/NN/bit is/VBZ/is set/VBN/set to/TO/to invalid/JJ/invalid /,/, and/CC/and the/DT/the computer/NN/computer will/MD/will trap/VB/trap to/TO/to flee/VB/flee operating/NN/operating system/NN/system /:/( invalid/JJ/invalid page/NN/page reference/NN/reference /:/) /./. notice/NN/notice that/IN/that this/DT/this scheme/NN/scheme has/VBZ/has created/VBN/created a/DT/a problem/NNP/problem. because/IN/because the/DT/the program/NN/program extends/NNS/extends only/RB/only to/TO/to address/VB/address 10468/CD/10468 /,/, any/DT/any reference/NN/reference beyond/IN/beyond that/DT/that address/NN/address is/VBZ/is illegal/NNP/illegal. howeve1/NNP/howeve1 ~/NNP/~ references/NNS/references to/TO/to page/VB/page 5/CD/5 are/VBP/are classified/VBN/classified as/IN/as valid/JJ/valid /,/, so/RB/so accesses/VBZ/accesses to/TO/to addresses/NNS/addresses up/IN/up to/TO/to 12287/CD/12287 are/VBP/are valid/NNP/valid. only/RB/only the/DT/the addresses/NNS/addresses from/IN/from 12288/CD/12288 to/TO/to 16383/CD/16383 are/VBP/are invalid/NNP/invalid. this/DT/this problem/NN/problem is/VBZ/is a/DT/a result/NN/result of/IN/of the/DT/the 2-kb/CD/2-kb page/NN/page size/NN/size and/CC/and reflects/VBZ/reflects the/DT/the internal/JJ/internal fragmentation/NN/fragmentation of/IN/of paging/NNP/paging. rarely/RB/rarely does/VBZ/does a/DT/a process/NN/process use/NN/use all/DT/all its/PRP$/its address/NN/address range/NNP/range. in/IN/in fact/NN/fact many/JJ/many processes/NNS/processes use/VBP/use only/RB/only a/DT/a small/JJ/small fraction/NN/fraction of/IN/of the/DT/the address/NN/address space/NN/space available/JJ/available to/TO/to them/NNP/them. it/PRP/it would/MD/would be/VB/be wasteful/JJ/wasteful in/IN/in these/DT/these cases/NNS/cases to/TO/to create/VB/create a/DT/a page/NN/page table/NN/table with/IN/with entries/NNS/entries for/IN/for every/DT/every page/NN/page in/IN/in the/DT/the address/NN/address range/NNP/range. most/JJS/most of/IN/of this/DT/this table/NN/table would/MD/would be/VB/be unused/VBN/unused but/CC/but would/MD/would take/VB/take up/RP/up valuable/JJ/valuable memory/NN/memory space/NNP/space. some/DT/some systems/NNS/systems provide/VBP/provide hardware/NN/hardware /,/, in/IN/in the/DT/the form/NN/form of/IN/of a/DT/a length/NN/length to/TO/to indicate/VB/indicate the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page table/NNP/table. value/NN/value is/VBZ/is checked/VBN/checked against/IN/against every/DT/every logical/JJ/logical address/NN/address to/TO/to verify/VB/verify that/IN/that the/DT/the address/NN/address is/VBZ/is in/IN/in the/DT/the valid/JJ/valid range/NN/range for/IN/for the/DT/the process/NNP/process. failure/NN/failure of/IN/of this/DT/this test/NN/test causes/NNS/causes an/DT/an error/NN/error trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NNP/system. 8.4.4/CD/8.4.4 shared/VBD/shared pages/NNS/pages an/DT/an advantage/NN/advantage of/IN/of paging/VBG/paging is/VBZ/is the/DT/the possibility/NN/possibility of/IN/of sharing/VBG/sharing common/JJ/common code/NNP/code. this/DT/this consideration/NN/consideration is/VBZ/is particularly/RB/particularly important/JJ/important in/IN/in a/DT/a time-sharing/JJ/time-sharing environment/NNP/environment. consider/NN/consider a/DT/a system/NN/system that/WDT/that supports/VBZ/supports 40/CD/40 users/NNS/users /,/, each/DT/each of/IN/of whom/WP/whom executes/NNS/executes a/DT/a text/NN/text editor/NNP/editor. if/IN/if the/DT/the text/NN/text editor/NN/editor consists/NNS/consists of/IN/of 150/CD/150 kb/NN/kb of/IN/of code/NN/code and/CC/and 50/CD/50 kb/NN/kb of/IN/of data/NNS/data space/NN/space /,/, we/PRP/we need/VBP/need 8,000/CD/8,000 kb/NN/kb to/TO/to support/VB/support the/DT/the 40/CD/40 users/NNP/users. if/IN/if the/DT/the code/NN/code is/VBZ/is /:/( or/CC/or pure/NN/pure however/RB/however /,/, it/PRP/it can/MD/can be/VB/be shared/VBN/shared /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 8.13/CD/8.13. here/RB/here we/PRP/we see/VBP/see a/DT/a three-page/NN/three-page editor-each/JJ/editor-each page/NN/page 50/CD/50 kb/NN/kb in/IN/in size/NN/size /:/( the/DT/the large/JJ/large page/NN/page size/NN/size is/VBZ/is used/VBN/used to/TO/to simplify/VB/simplify the/DT/the figure/NN/figure /:/) -being/JJ/-being shared/VBN/shared among/IN/among three/CD/three processes/NNP/processes. each/DT/each process/NN/process has/VBZ/has its/PRP$/its own/JJ/own data/NNS/data page/NNP/page. reentrant/NN/reentrant code/NN/code is/VBZ/is non-self-modifying/JJ/non-self-modifying code/NN/code /:/: it/PRP/it never/RB/never changes/VBZ/changes during/IN/during execution/NNP/execution. thus/RB/thus /,/, two/CD/two or/CC/or more/JJR/more processes/NNS/processes can/MD/can execute/VB/execute the/DT/the same/JJ/same code/NN/code at/IN/at the/DT/the same/JJ/same time/NNP/time. each/DT/each process/NN/process has/VBZ/has its/PRP$/its own/JJ/own copy/NN/copy of/IN/of registers/NNS/registers and/CC/and data/NNS/data storage/NN/storage to/TO/to hold/VB/hold the/DT/the data/NN/data for/IN/for the/DT/the process/NN/process 's/POS/'s execution/NNP/execution. the/DT/the data/NNS/data for/IN/for two/CD/two different/JJ/different processes/NNS/processes wilt/VBP/wilt of/IN/of course/NN/course /,/, be/VB/be different/NNP/different. only/RB/only one/CD/one copy/NN/copy of/IN/of the/DT/the editor/NN/editor need/VBP/need be/VB/be kept/VBN/kept in/IN/in physical/JJ/physical memory/NNP/memory. each/DT/each user/NN/user 's/POS/'s page/NN/page table/NN/table maps/NNS/maps onto/IN/onto the/DT/the same/JJ/same physical/JJ/physical copy/NN/copy of/IN/of the/DT/the editor/NN/editor /,/, but/CC/but data/NNS/data pages/NNS/pages are/VBP/are mapped/VBN/mapped onto/IN/onto different/JJ/different frames/NNP/frames. thus/RB/thus /,/, to/TO/to support/VB/support 40/CD/40 users/NNS/users /,/, we/PRP/we need/VBP/need only/RB/only one/CD/one copy/NN/copy of/IN/of the/DT/the editor/NN/editor /:/( 150/CD/150 kb/NN/kb /:/) /,/, plus/CC/plus 40/CD/40 copies/NNS/copies of/IN/of the/DT/the 50/CD/50 kb/NN/kb of/IN/of data/NNS/data space/NN/space per/IN/per user/NNP/user. the/DT/the total/JJ/total space/NN/space required/VBN/required is/VBZ/is now/RB/now 2/CD/2 /CD/) 50/CD/50 kb/NN/kb instead/RB/instead of/IN/of 8,000/CD/8,000 kb-a/NNP/kb-a significant/JJ/significant savings/NNP/savings. other/JJ/other heavily/RB/heavily used/JJ/used programs/NNS/programs can/MD/can also/RB/also be/VB/be shared/VBN/shared -compilers/NNS/-compilers /,/, window/NN/window systems/NNS/systems /,/, run-time/JJ/run-time libraries/NNS/libraries /,/, database/NN/database systems/NNS/systems /,/, and/CC/and so/RB/so on/NNP/on. to/TO/to be/VB/be sharable/JJ/sharable /,/, the/DT/the code/NN/code must/MD/must be/VB/be reentrant/NNP/reentrant. the/DT/the read-only/JJ/read-only nature/NN/nature of/IN/of shared/VBN/shared code/NN/code should/MD/should not/RB/not be/VB/be left/VBN/left to/TO/to the/DT/the correctness/NN/correctness of/IN/of the/DT/the code/NN/code ;/:/; the/DT/the operating/NN/operating system/NN/system should/MD/should enforce/VB/enforce this/DT/this property/NNP/property. the/DT/the sharing/NN/sharing of/IN/of memory/NN/memory among/IN/among processes/NNS/processes on/IN/on a/DT/a system/NN/system is/VBZ/is similar/JJ/similar to/TO/to the/DT/the sharing/NN/sharing of/IN/of the/DT/the address/NN/address space/NN/space of/IN/of a/DT/a task/NN/task by/IN/by threads/NNS/threads /,/, described/VBD/described in/IN/in chapter/NN/chapter 4/CD/4. furthermore/NN/furthermore /,/, recall/NN/recall that/IN/that in/IN/in chapter/NN/chapter 3/CD/3 we/PRP/we described/VBD/described shared/VBN/shared memory/NN/memory as/IN/as a/DT/a method/NN/method 8.5/CD/8.5 ed/VBD/ed 1/CD/1 /:/.. ed/VBN/ed 2/CD/2 ed/VBN/ed 3/CD/3 data/NNS/data .1/CD/.1 process/NN/process p1/NNP/p1 process/NN/process p3/NNP/p3 page/NN/page table/NN/table for/IN/for p1/NNP/p1 page/NN/page table/NN/table for/IN/for p3/NNP/p3 8.5/CD/8.5 ed/VBD/ed 1/CD/1 ed/VBN/ed 2/CD/2 ed/VBN/ed 3/CD/3 data/NNS/data 2/CD/2 process/NN/process p2/NNP/p2 0/-NONE-/0 data/NNS/data 1/CD/1 2/CD/2 data/NNS/data 3/CD/3 3/CD/3 ed/VBN/ed 1/CD/1 ed/VBN/ed 2/CD/2 ed/VBN/ed 3/CD/3 /CD/[ 4/CD/4 5/CD/5 6/CD/6 data/NNS/data 2/CD/2 page/NN/page table/JJ/table for/IN/for p2/NNP/p2 7/CD/7 8/CD/8 9/CD/9 10/CD/10 11/CD/11 figure/NN/figure 8.13/CD/8.13 sharing/VBG/sharing of/IN/of code/NN/code in/IN/in a/DT/a paging/NN/paging environment/NNP/environment. 337/CD/337 of/IN/of interprocess/NN/interprocess corrununication/NNP/corrununication. some/DT/some operating/NN/operating systems/NNS/systems implement/NN/implement shared/VBD/shared memory/NN/memory using/VBG/using shared/VBN/shared pages/NNP/pages. organizing/NN/organizing memory/NN/memory according/VBG/according to/TO/to pages/NNS/pages provides/VBZ/provides numerous/JJ/numerous benefits/NNS/benefits in/IN/in addition/NN/addition to/TO/to allowing/VBG/allowing several/JJ/several processes/NNS/processes to/TO/to share/VB/share the/DT/the same/JJ/same physical/JJ/physical pages/NNP/pages. we/PRP/we cover/RB/cover several/JJ/several other/JJ/other benefits/NNS/benefits in/IN/in chapter/NN/chapter 9/CD/9. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we explore/VBP/explore some/DT/some of/IN/of the/DT/the most/RBS/most common/JJ/common techniques/NNS/techniques for/IN/for structuring/VBG/structuring the/DT/the page/NN/page table/NNP/table. 8.5.1/CD/8.5.1 hierarchical/JJ/hierarchical paging/NN/paging most/JJS/most modern/JJ/modern computer/NN/computer systems/NNS/systems support/NN/support a/DT/a large/JJ/large logical/JJ/logical address/NN/address space/NN/space /:/( 232/CD/232 to/TO/to 264/CD/264 /CD/) /./. in/IN/in such/JJ/such an/DT/an environment/NN/environment /,/, the/DT/the page/NN/page table/NN/table itself/PRP/itself becomes/VBZ/becomes excessively/RB/excessively large/NNP/large. for/IN/for example/NN/example /,/, consider/NN/consider a/DT/a system/NN/system with/IN/with a/DT/a 32-bit/JJ/32-bit logical/JJ/logical address/NN/address space/NNP/space. if/IN/if the/DT/the page/NN/page size/NN/size in/IN/in such/JJ/such a/DT/a system/NN/system is/VBZ/is 4/CD/4 kb/NN/kb /:/( 212/CD/212 /CD/) /,/, then/RB/then a/DT/a page/NN/page table/NN/table may/MD/may consist/VB/consist of/IN/of up/IN/up to/TO/to 1/CD/1 million/CD/million entries/NNS/entries /:/( 232/CD/232 /212/-NONE-//212 /:/) /./. assuming/VBG/assuming that/IN/that each/DT/each entry/NN/entry consists/VBZ/consists of/IN/of 4/CD/4 bytes/NNS/bytes /,/, each/DT/each process/NN/process may/MD/may need/VB/need up/RP/up to/TO/to 4mb/CD/4mb of/IN/of physical/JJ/physical address/NN/address space/NN/space for/IN/for the/DT/the page/NN/page table/NN/table alone/NNP/alone. clearly/RB/clearly /,/, we/PRP/we would/MD/would not/RB/not want/VB/want to/TO/to allocate/VB/allocate the/DT/the page/NN/page table/NN/table contiguously/RB/contiguously in/IN/in main/JJ/main memory/NNP/memory. one/CD/one simple/NN/simple solution/NN/solution to/TO/to this/DT/this problem/NN/problem is/VBZ/is to/TO/to divide/VB/divide the/DT/the page/NN/page table/NN/table into/IN/into smaller/JJR/smaller pieces/NNP/pieces. we/PRP/we can/MD/can accomplish/VB/accomplish this/DT/this division/NN/division in/IN/in several/JJ/several ways/NNP/ways. one/CD/one way/NN/way is/VBZ/is to/TO/to use/VB/use a/DT/a two-level/JJ/two-level paging/NN/paging algorithm/NN/algorithm /,/, in/IN/in which/WDT/which the/DT/the page/NN/page table/NN/table itself/PRP/itself is/VBZ/is also/RB/also paged/VBN/paged /-NONE-/( figure/NN/figure 8.14/CD/8.14 /CD/) /./. for/IN/for example/NN/example /,/, consider/NN/consider again/RB/again the/DT/the system/NN/system with/IN/with 338/CD/338 chapter/NN/chapter 8/CD/8 0/-NONE-/0 page/NN/page table/NN/table memory/NN/memory figure/NN/figure 8.14/CD/8.14 a/DT/a two-level/JJ/two-level page-table/JJ/page-table scheme/NNP/scheme. a/DT/a 32-bit/JJ/32-bit logical/JJ/logical address/NN/address space/NN/space and/CC/and a/DT/a page/NN/page size/NN/size of/IN/of 4/CD/4 kb/NNP/kb. a/DT/a logical/JJ/logical address/NN/address is/VBZ/is divided/VBN/divided into/IN/into a/DT/a page/NN/page number/NN/number consisting/VBG/consisting of/IN/of 20/CD/20 bits/NNS/bits and/CC/and a/DT/a page/NN/page offset/NN/offset consisting/VBG/consisting of/IN/of 12/CD/12 bits/NNP/bits. because/IN/because we/PRP/we page/VBP/page the/DT/the page/NN/page table/NN/table /,/, the/DT/the page/NN/page number/NN/number is/VBZ/is further/RBR/further divided/VBN/divided into/IN/into a/DT/a 10-bit/JJ/10-bit page/NN/page number/NN/number and/CC/and a/DT/a 10-bit/JJ/10-bit page/NN/page offset/NNP/offset. thus/RB/thus /,/, a/DT/a logical/JJ/logical address/NN/address is/VBZ/is as/IN/as follows/NNS/follows /:/: page/NN/page number/NN/number page/NN/page offset/NN/offset d/NN/d 10/CD/10 10/CD/10 12/CD/12 where/WRB/where p1/NNP/p1 is/VBZ/is an/DT/an index/NN/index into/IN/into the/DT/the outer/NN/outer page/NN/page table/NN/table and/CC/and p2/NNP/p2 is/VBZ/is the/DT/the displacement/NN/displacement within/IN/within the/DT/the page/NN/page of/IN/of the/DT/the outer/NN/outer page/NN/page table/NNP/table. the/DT/the address-translation/NN/address-translation method/NN/method for/IN/for this/DT/this architecture/NN/architecture is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.15/CD/8.15. because/IN/because address/NN/address translation/NN/translation works/NNS/works from/IN/from the/DT/the outer/NN/outer page/NN/page table/NN/table inward/NN/inward /,/, this/DT/this scheme/NN/scheme is/VBZ/is also/RB/also known/VBN/known as/IN/as a/DT/a the/DT/the vax/NN/vax architecture/NN/architecture supports/NNS/supports a/DT/a variation/NN/variation of/IN/of two-level/JJ/two-level paging/NNP/paging. the/DT/the vax/NN/vax is/VBZ/is a/DT/a 32-bit/JJ/32-bit machine/NN/machine with/IN/with a/DT/a page/NN/page size/NN/size of/IN/of 512/CD/512 bytes/NNP/bytes. the/DT/the logical/JJ/logical address/NN/address space/NN/space of/IN/of a/DT/a process/NN/process is/VBZ/is divided/VBN/divided into/IN/into four/CD/four equal/JJ/equal sections/NNS/sections /,/, each/DT/each of/IN/of which/WDT/which consists/NNS/consists of/IN/of 230/CD/230 bytes/NNP/bytes. each/DT/each section/NN/section represents/VBZ/represents a/DT/a different/JJ/different part/NN/part of/IN/of the/DT/the logical/JJ/logical address/NN/address space/NN/space of/IN/of a/DT/a process/NNP/process. the/DT/the first/JJ/first 2/CD/2 high-order/NN/high-order bits/NNS/bits of/IN/of the/DT/the logical/JJ/logical address/NN/address designate/NN/designate the/DT/the appropriate/NN/appropriate section/NNP/section. the/DT/the next/JJ/next 21/CD/21 bits/NNS/bits represent/VBP/represent the/DT/the logical/JJ/logical page/NN/page number/NN/number of/IN/of that/DT/that section/NN/section /,/, and/CC/and the/DT/the final/JJ/final 9/CD/9 bits/NNS/bits represent/VBP/represent an/DT/an offset/NN/offset in/IN/in the/DT/the desired/VBN/desired page/NNP/page. by/IN/by partitioning/NN/partitioning the/DT/the page/NN/page outer/NN/outer page/NN/page table/NN/table 8.5/CD/8.5 figure/NN/figure 8/CD/8. 15/CD/15 address/NN/address translation/NN/translation for/IN/for a/DT/a two-level/JJ/two-level 32-bit/JJ/32-bit paging/NN/paging architecture/NNP/architecture. 339/CD/339 table/JJ/table in/IN/in this/DT/this manner/NN/manner /,/, the/DT/the operating/NN/operating system/NN/system can/MD/can leave/VB/leave partitions/NNS/partitions unused/VBN/unused until/IN/until a/DT/a process/NN/process needs/VBZ/needs them/NNP/them. an/DT/an address/NN/address on/IN/on the/DT/the vax/NN/vax architecture/NN/architecture is/VBZ/is as/IN/as follows/NNS/follows /:/: section/NN/section page/NN/page offset/NN/offset s/NNS/s p/VBP/p d/JJ/d 2/CD/2 21/CD/21 9/CD/9 where/WRB/where s/NNS/s designates/VBZ/designates the/DT/the section/NN/section number/NN/number /,/, p/NN/p is/VBZ/is an/DT/an index/NN/index into/IN/into the/DT/the page/NN/page table/NN/table /,/, and/CC/and d/VBD/d is/VBZ/is the/DT/the displacement/NN/displacement within/IN/within the/DT/the page/NNP/page. even/RB/even when/WRB/when this/DT/this scheme/NN/scheme is/VBZ/is used/VBN/used /,/, the/DT/the size/NN/size of/IN/of a/DT/a one-level/JJ/one-level page/NN/page table/NN/table for/IN/for a/DT/a vax/NN/vax process/NN/process using/VBG/using one/CD/one section/NN/section is/VBZ/is 221/CD/221 bits/NNS/bits 4/CD/4 bytes/NNS/bytes per/IN/per entry/NN/entry =/:/= 8mb/CD/8mb. to/TO/to further/RBR/further reduce/VB/reduce main-memory/JJ/main-memory use/NN/use /,/, the/DT/the vax/NN/vax pages/NNS/pages the/DT/the user-process/JJ/user-process page/NN/page tables/NNP/tables. for/IN/for a/DT/a system/NN/system with/IN/with a/DT/a 64-bit/JJ/64-bit logical/JJ/logical address/NN/address space/NN/space /,/, a/DT/a two-level/JJ/two-level paging/NN/paging scheme/NN/scheme is/VBZ/is no/DT/no longer/NN/longer appropriate/NNP/appropriate. to/TO/to illustrate/VB/illustrate this/DT/this point/NN/point /,/, let/VB/let us/PRP/us suppose/VB/suppose that/IN/that the/DT/the page/NN/page size/NN/size in/IN/in such/JJ/such a/DT/a system/NN/system is/VBZ/is 4/CD/4 kb/NN/kb /:/( 212/CD/212 /CD/) /./. in/IN/in this/DT/this case/NN/case /,/, the/DT/the page/NN/page table/NN/table consists/NNS/consists of/IN/of up/IN/up to/TO/to 252/CD/252 entries/NNP/entries. if/IN/if we/PRP/we use/VBP/use a/DT/a two-level/JJ/two-level paging/NN/paging scheme/NN/scheme /,/, then/RB/then the/DT/the iml.er/NN/iml.er page/NN/page tables/NNS/tables can/MD/can conveniently/RB/conveniently be/VB/be one/CD/one page/NN/page long/RB/long /,/, or/CC/or contain/VB/contain 210/CD/210 4-byte/CD/4-byte entries/NNP/entries. the/DT/the addresses/NNS/addresses look/VBP/look like/IN/like this/DT/this /:/: outer/NN/outer page/NN/page inner/NN/inner page/NN/page offset/NN/offset i/PRP/i /:/.. pl/NN/pl /:/.. i/PRP/i p2/NNP/p2 /./. i/PRP/i d/VBD/d 42/CD/42 10/CD/10 12/CD/12 the/DT/the outer/NN/outer page/NN/page table/NN/table consists/NNS/consists of/IN/of 242/CD/242 entries/NNS/entries /,/, or/CC/or 244/CD/244 bytes/NNP/bytes. the/DT/the obvious/JJ/obvious way/NN/way to/TO/to avoid/VB/avoid such/JJ/such a/DT/a large/JJ/large table/NN/table is/VBZ/is to/TO/to divide/VB/divide the/DT/the outer/NN/outer page/NN/page table/NN/table into/IN/into smaller/JJR/smaller pieces/NNP/pieces. /:/( this/DT/this approach/NN/approach is/VBZ/is also/RB/also used/VBN/used on/IN/on some/DT/some 32-bit/JJ/32-bit processors/NNS/processors for/IN/for added/VBN/added flexibility/NN/flexibility and/CC/and efficiency/NNP/efficiency. /NNP/) we/PRP/we can/MD/can divide/VB/divide the/DT/the outer/NN/outer page/NN/page table/NN/table in/IN/in various/JJ/various ways/NNP/ways. we/PRP/we can/MD/can page/VB/page the/DT/the outer/NN/outer page/NN/page table/NN/table /,/, giving/VBG/giving us/PRP/us a/DT/a three-level/JJ/three-level paging/NN/paging scheme/NNP/scheme. suppose/NN/suppose that/WDT/that the/DT/the outer/NN/outer page/NN/page table/NN/table is/VBZ/is made/VBN/made up/RP/up of/IN/of standard-size/JJ/standard-size pages/NNS/pages /:/( 210/CD/210 entries/NNS/entries /,/, or/CC/or 212/CD/212 bytes/NNS/bytes /:/) /./. in/IN/in this/DT/this case/NN/case /,/, a/DT/a 64-bit/JJ/64-bit address/NN/address space/NN/space is/VBZ/is still/RB/still daunting/VBG/daunting /:/: 2nd/JJ/2nd outer/NN/outer page/NN/page outer/NN/outer page/NN/page inner/NN/inner page/NN/page offset/NN/offset i/PRP/i pr/VBP/pr /./. /:/) p2/NNP/p2 i/PRP/i p3/NNP/p3 i/PRP/i d/VBD/d 32/CD/32 10/CD/10 10/CD/10 12/CD/12 the/DT/the outer/NN/outer page/NN/page table/NN/table is/VBZ/is sti11234/NNP/sti11234 bytes/VBZ/bytes in/IN/in size/NNP/size. 340/CD/340 chapter/NN/chapter 8/CD/8 the/DT/the next/JJ/next step/NN/step would/MD/would be/VB/be a/DT/a four-level/JJ/four-level paging/NN/paging scheme/NN/scheme /,/, where/WRB/where the/DT/the second-level/JJ/second-level outer/NN/outer page/NN/page table/NN/table itself/PRP/itself is/VBZ/is also/RB/also paged/VBN/paged /,/, and/CC/and so/RB/so forth/NNP/forth. the/DT/the 64-bit/JJ/64-bit ultrasparc/NN/ultrasparc would/MD/would require/VB/require seven/CD/seven levels/NNS/levels of/IN/of paging-a/NNP/paging-a prohibitive/JJ/prohibitive number/NN/number of/IN/of memory/NN/memory accessesto/IN/accessesto translate/NN/translate each/DT/each logical/JJ/logical address/NNP/address. you/PRP/you can/MD/can see/VB/see from/IN/from this/DT/this example/NN/example why/WRB/why /,/, for/IN/for 64-bit/JJ/64-bit architectures/NNS/architectures /,/, hierarchical/JJ/hierarchical page/NN/page tables/NNS/tables are/VBP/are generally/RB/generally considered/VBN/considered inappropriate/NNP/inappropriate. 8.5.2/CD/8.5.2 hashed/VBD/hashed page/NN/page tables/NNS/tables a/DT/a common/JJ/common approach/NN/approach for/IN/for handling/NN/handling address/NN/address spaces/NNS/spaces larger/JJR/larger than/IN/than 32/CD/32 bits/NNS/bits is/VBZ/is to/TO/to use/VB/use a/DT/a with/IN/with the/DT/the hash/NN/hash value/NN/value being/VBG/being the/DT/the virtual/JJ/virtual page/NN/page number/NNP/number. each/DT/each entry/NN/entry in/IN/in the/DT/the hash/NN/hash table/NN/table contains/VBZ/contains a/DT/a linked/VBN/linked list/NN/list of/IN/of elements/NNS/elements that/WDT/that hash/NN/hash to/TO/to the/DT/the same/JJ/same location/NN/location /:/( to/TO/to handle/VB/handle collisions/NNS/collisions /:/) /./. each/DT/each element/NN/element consists/VBZ/consists of/IN/of three/CD/three fields/NNS/fields /:/: /:/( 1/CD/1 /CD/) the/DT/the virtual/JJ/virtual page/NN/page number/NN/number /,/, /NNP/( 2/CD/2 /CD/) the/DT/the value/NN/value of/IN/of the/DT/the mapped/VBN/mapped page/NN/page frame/NN/frame /,/, and/CC/and /:/( 3/CD/3 /CD/) a/DT/a pointer/NN/pointer to/TO/to the/DT/the next/JJ/next element/NN/element in/IN/in the/DT/the linked/VBN/linked list/NNP/list. the/DT/the algorithm/NN/algorithm works/VBZ/works as/IN/as follows/NNS/follows /:/: the/DT/the virtual/JJ/virtual page/NN/page number/NN/number in/IN/in the/DT/the virtual/JJ/virtual address/NN/address is/VBZ/is hashed/VBN/hashed into/IN/into the/DT/the hash/NN/hash table/NNP/table. the/DT/the virtual/JJ/virtual page/NN/page number/NN/number is/VBZ/is compared/VBN/compared with/IN/with field/NN/field 1/CD/1 in/IN/in the/DT/the first/JJ/first element/NN/element in/IN/in the/DT/the linked/VBN/linked list/NNP/list. if/IN/if there/EX/there is/VBZ/is a/DT/a match/NN/match /,/, the/DT/the corresponding/NN/corresponding page/NN/page frame/NN/frame /:/( field/NN/field 2/CD/2 /CD/) is/VBZ/is used/VBN/used to/TO/to form/NN/form the/DT/the desired/VBN/desired physical/JJ/physical address/NNP/address. if/IN/if there/EX/there is/VBZ/is no/DT/no match/NN/match /,/, subsequent/JJ/subsequent entries/NNS/entries in/IN/in the/DT/the linked/VBN/linked list/NN/list are/VBP/are searched/VBN/searched for/IN/for a/DT/a matching/NN/matching virtual/JJ/virtual page/NN/page number/NNP/number. this/DT/this scheme/NN/scheme is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.16/CD/8.16. a/DT/a variation/NN/variation of/IN/of this/DT/this scheme/NN/scheme that/IN/that is/VBZ/is favorable/JJ/favorable for/IN/for 64-bit/JJ/64-bit address/NN/address spaces/NNS/spaces has/VBZ/has been/VBN/been proposed/NNP/proposed. this/DT/this variation/NN/variation uses/VBZ/uses which/WDT/which are/VBP/are similar/JJ/similar to/TO/to hashed/JJ/hashed page/NN/page tables/NNS/tables except/IN/except that/DT/that each/DT/each entry/NN/entry in/IN/in the/DT/the hash/NN/hash table/NN/table refers/NNS/refers to/TO/to several/JJ/several pages/NNS/pages /:/( such/JJ/such as/IN/as 16/CD/16 /CD/) rather/RB/rather than/IN/than a/DT/a single/JJ/single page/NNP/page. therefore/NN/therefore /,/, a/DT/a single/JJ/single page-table/JJ/page-table entry/NN/entry can/MD/can store/VB/store the/DT/the mappings/NNS/mappings for/IN/for multiple/NN/multiple physical-page/NN/physical-page frames/NNP/frames. clustered/VBD/clustered page/NN/page tables/NNS/tables are/VBP/are particularly/RB/particularly useful/JJ/useful for/IN/for address/NN/address spaces/NNS/spaces /,/, where/WRB/where memory/NN/memory references/NNS/references are/VBP/are noncontiguous/JJ/noncontiguous and/CC/and scattered/VBN/scattered throughout/IN/throughout the/DT/the address/NN/address space/NNP/space. 8.5.3/CD/8.5.3 inverted/VBD/inverted page/NN/page tables/NNS/tables usually/RB/usually /,/, each/DT/each process/NN/process has/VBZ/has an/DT/an associated/VBN/associated page/NN/page table/NNP/table. the/DT/the page/NN/page table/NN/table has/VBZ/has one/CD/one entry/NN/entry for/IN/for each/DT/each page/NN/page that/IN/that the/DT/the process/NN/process is/VBZ/is using/VBG/using /NN/( or/CC/or one/CD/one slot/NN/slot for/IN/for each/DT/each virtual/JJ/virtual hash/NN/hash table/NN/table figure/NN/figure 8.16/CD/8.16 hashed/VBD/hashed page/NN/page table/NNP/table. physical/JJ/physical address/NN/address physical/JJ/physical memory/NN/memory 8.5/CD/8.5 341/CD/341 address/NN/address /,/, regardless/RB/regardless of/IN/of the/DT/the latter/NN/latter 's/POS/'s validity/NN/validity /:/) /./. this/DT/this table/NN/table representation/NN/representation is/VBZ/is a/DT/a natural/JJ/natural one/CD/one /,/, since/IN/since processes/NNS/processes reference/NN/reference pages/NNS/pages through/IN/through the/DT/the pages/NNS/pages '/POS/' virtual/JJ/virtual addresses/NNP/addresses. the/DT/the operating/NN/operating system/NN/system must/MD/must then/RB/then translate/VB/translate this/DT/this reference/NN/reference into/IN/into a/DT/a physical/JJ/physical memory/NN/memory address/NNP/address. since/IN/since the/DT/the table/NN/table is/VBZ/is sorted/VBN/sorted by/IN/by virtual/JJ/virtual address/NN/address /,/, the/DT/the operating/NN/operating system/NN/system is/VBZ/is able/JJ/able to/TO/to calculate/VB/calculate where/WRB/where in/IN/in the/DT/the table/NN/table the/DT/the associated/VBN/associated physical/JJ/physical address/NN/address entry/NN/entry is/VBZ/is located/VBN/located and/CC/and to/TO/to use/VB/use that/IN/that value/NN/value directly/NNP/directly. one/CD/one of/IN/of the/DT/the drawbacks/NNS/drawbacks of/IN/of this/DT/this method/NN/method is/VBZ/is that/IN/that each/DT/each page/NN/page table/JJ/table may/MD/may consist/VB/consist of/IN/of millions/NNS/millions of/IN/of entries/NNP/entries. these/DT/these tables/NNS/tables may/MD/may consume/VB/consume large/JJ/large amounts/NNS/amounts of/IN/of physical/JJ/physical memory/NN/memory just/RB/just to/TO/to keep/VB/keep track/NN/track of/IN/of how/WRB/how other/JJ/other physical/JJ/physical memory/NN/memory is/VBZ/is being/VBG/being used/NNP/used. to/TO/to solve/VB/solve this/DT/this problem/NN/problem /,/, we/PRP/we can/MD/can use/VB/use an/DT/an page/NN/page an/DT/an inverted/JJ/inverted page/NN/page table/NN/table has/VBZ/has one/CD/one entry/NN/entry for/IN/for each/DT/each real/JJ/real page/NN/page /:/( or/CC/or frame/VB/frame /CD/) of/IN/of memory/NNP/memory. each/DT/each entry/NN/entry consists/VBZ/consists of/IN/of the/DT/the virtual/JJ/virtual address/NN/address of/IN/of the/DT/the page/NN/page stored/VBD/stored in/IN/in that/DT/that real/JJ/real memory/NN/memory location/NN/location /,/, with/IN/with information/NN/information about/IN/about the/DT/the process/NN/process that/IN/that owns/VBZ/owns the/DT/the page/NNP/page. thus/RB/thus /,/, only/RB/only one/CD/one page/NN/page table/NN/table is/VBZ/is in/IN/in the/DT/the system/NN/system /,/, and/CC/and it/PRP/it has/VBZ/has only/RB/only one/CD/one entry/NN/entry for/IN/for each/DT/each page/NN/page of/IN/of physical/JJ/physical memory/NNP/memory. figure/NN/figure 8.17/CD/8.17 shows/NNS/shows the/DT/the operation/NN/operation of/IN/of an/DT/an inverted/JJ/inverted page/NN/page table/NNP/table. compare/NN/compare it/PRP/it with/IN/with figure/NN/figure 8.7/CD/8.7 /,/, which/WDT/which depicts/NNS/depicts a/DT/a standard/JJ/standard page/NN/page table/NN/table in/IN/in operation/NNP/operation. inverted/VBD/inverted page/NN/page tables/NNS/tables often/RB/often require/VBP/require that/IN/that an/DT/an address-space/NN/address-space identifier/NN/identifier /:/( section/NN/section 8.4.2/CD/8.4.2 /CD/) be/VB/be stored/VBN/stored in/IN/in each/DT/each entry/NN/entry of/IN/of the/DT/the page/NN/page table/NN/table /,/, since/IN/since the/DT/the table/NN/table usually/RB/usually contains/VBZ/contains several/JJ/several different/JJ/different address/NN/address spaces/NNS/spaces mapping/VBG/mapping physical/JJ/physical memory/NNP/memory. storing/NN/storing the/DT/the address-space/NN/address-space identifier/NN/identifier ensures/NNS/ensures that/WDT/that a/DT/a logical/JJ/logical page/NN/page for/IN/for a/DT/a particular/JJ/particular process/NN/process is/VBZ/is mapped/VBN/mapped to/TO/to the/DT/the corresponding/NN/corresponding physical/JJ/physical page/NN/page frame/NNP/frame. examples/NNS/examples of/IN/of systems/NNS/systems using/VBG/using inverted/VBN/inverted page/NN/page tables/NNS/tables include/VBP/include the/DT/the 64-bit/JJ/64-bit ultrasparc/NN/ultrasparc and/CC/and powerpc/NNP/powerpc. to/TO/to illustrate/VB/illustrate this/DT/this method/NN/method /,/, we/PRP/we describe/VBP/describe a/DT/a simplified/JJ/simplified version/NN/version of/IN/of the/DT/the i11verted/NNP/i11verted page/NN/page table/NN/table used/VBD/used in/IN/in the/DT/the ibm/NN/ibm rt/NNP/rt. each/DT/each virtual/JJ/virtual address/NN/address in/IN/in the/DT/the system/NN/system consists/VBZ/consists of/IN/of a/DT/a triple/NN/triple /:/: process-id/JJ/process-id /,/, page-number/JJ/page-number /,/, offset/VBN/offset /./. each/DT/each inverted/VBD/inverted page-table/JJ/page-table entry/NN/entry is/VBZ/is a/DT/a pair/NN/pair process-id/JJ/process-id /,/, page-number/JJ/page-number where/WRB/where the/DT/the process-id/JJ/process-id assumes/NNS/assumes the/DT/the role/NN/role of/IN/of the/DT/the address-space/NN/address-space identifier/NNP/identifier. when/WRB/when a/DT/a memory/NN/memory page/NN/page table/NN/table physical/JJ/physical address/NN/address figure/NN/figure 8.17/CD/8.17 inverted/VBN/inverted page/NN/page table/NNP/table. physical/JJ/physical memory/NN/memory 342/CD/342 chapter/NN/chapter 8/CD/8 8.6/CD/8.6 reference/NN/reference occurs/NNS/occurs /,/, part/NN/part of/IN/of the/DT/the virtual/JJ/virtual address/NN/address /,/, consisting/VBG/consisting of/IN/of process-id/JJ/process-id /,/, pagenumber/NN/pagenumber /,/, is/VBZ/is presented/VBN/presented to/TO/to the/DT/the memory/NN/memory subsystem/NNP/subsystem. the/DT/the inverted/JJ/inverted page/NN/page table/NN/table is/VBZ/is then/RB/then searched/VBN/searched for/IN/for a/DT/a match/NNP/match. if/IN/if a/DT/a match/NN/match is/VBZ/is found-say/JJ/found-say /,/, at/IN/at entry/NN/entry i-then/JJ/i-then the/DT/the physical/JJ/physical address/NN/address i/PRP/i /,/, offset/VBP/offset is/VBZ/is generated/NNP/generated. if/IN/if no/DT/no match/NN/match is/VBZ/is found/VBN/found /,/, then/RB/then an/DT/an illegal/JJ/illegal address/NN/address access/NN/access has/VBZ/has been/VBN/been attempted/NNP/attempted. although/IN/although this/DT/this scheme/NN/scheme decreases/VBZ/decreases the/DT/the amount/NN/amount of/IN/of memory/NN/memory needed/VBN/needed to/TO/to store/VB/store each/DT/each page/NN/page table/JJ/table /,/, it/PRP/it increases/VBZ/increases the/DT/the amount/NN/amount of/IN/of time/NN/time needed/VBN/needed to/TO/to search/VB/search the/DT/the table/NN/table when/WRB/when a/DT/a page/NN/page reference/NN/reference occurs/NNP/occurs. because/IN/because the/DT/the inverted/JJ/inverted page/NN/page table/NN/table is/VBZ/is sorted/VBN/sorted by/IN/by physical/JJ/physical address/NN/address /,/, but/CC/but lookups/NNS/lookups occur/VBP/occur on/IN/on virtual/JJ/virtual addresses/NNS/addresses /,/, the/DT/the whole/JJ/whole table/NN/table might/MD/might need/VB/need to/TO/to be/VB/be searched/VBN/searched for/IN/for a/DT/a match/NNP/match. this/DT/this search/NN/search would/MD/would take/VB/take far/RB/far too/RB/too long/NNP/long. to/TO/to alleviate/VB/alleviate this/DT/this problem/NN/problem /,/, we/PRP/we use/VBP/use a/DT/a hash/NN/hash table/NN/table /,/, as/IN/as described/VBN/described in/IN/in section/NN/section 8.5.2/CD/8.5.2 /,/, to/TO/to limit/VB/limit the/DT/the search/NN/search to/TO/to one-or/JJ/one-or at/IN/at most/JJS/most a/DT/a few-page-table/JJ/few-page-table entries/NNP/entries. of/IN/of course/NN/course /,/, each/DT/each access/NN/access to/TO/to the/DT/the hash/NN/hash table/NN/table adds/VBZ/adds a/DT/a memory/NN/memory reference/NN/reference to/TO/to the/DT/the procedure/NN/procedure /,/, so/RB/so one/CD/one virtual/JJ/virtual memory/NN/memory reference/NN/reference requires/VBZ/requires at/IN/at least/JJS/least two/CD/two real/JJ/real memory/NN/memory reads-one/NN/reads-one for/IN/for the/DT/the hash-table/JJ/hash-table entry/NN/entry and/CC/and one/CD/one for/IN/for the/DT/the page/NN/page table/NNP/table. /NNP/( recall/NN/recall that/WDT/that the/DT/the tlb/NN/tlb is/VBZ/is searched/VBN/searched first/RB/first /,/, before/IN/before the/DT/the hash/NN/hash table/NN/table is/VBZ/is consulted/VBN/consulted /,/, offering/NN/offering some/DT/some performance/NN/performance improvement/NNP/improvement. /NNP/) systems/NNS/systems that/WDT/that use/NN/use inverted/VBD/inverted page/NN/page tables/NNS/tables have/VBP/have difficulty/NN/difficulty implementing/VBG/implementing shared/VBN/shared memory/NNP/memory. shared/VBD/shared memory/NN/memory is/VBZ/is usually/RB/usually implemented/VBN/implemented as/IN/as multiple/JJ/multiple virtual/JJ/virtual addresses/NNS/addresses /:/( one/CD/one for/IN/for each/DT/each process/NN/process sharing/VBG/sharing the/DT/the memory/NN/memory /:/) that/IN/that are/VBP/are mapped/VBN/mapped to/TO/to one/CD/one physical/JJ/physical address/NNP/address. this/DT/this standard/JJ/standard method/NN/method can/MD/can not/RB/not be/VB/be used/VBN/used with/IN/with inverted/JJ/inverted page/NN/page tables/NNS/tables ;/:/; because/IN/because there/EX/there is/VBZ/is only/RB/only one/CD/one virtual/JJ/virtual page/NN/page entry/NN/entry for/IN/for every/DT/every physical/JJ/physical page/NN/page /,/, one/CD/one physical/JJ/physical page/NN/page can/MD/can not/RB/not have/VB/have two/CD/two /CD/( or/CC/or more/JJR/more /:/) shared/VBN/shared virtual/JJ/virtual addresses/NNP/addresses. a/DT/a simple/JJ/simple technique/NN/technique for/IN/for addressing/NN/addressing this/DT/this issue/NN/issue is/VBZ/is to/TO/to allow/VB/allow the/DT/the page/NN/page table/NN/table to/TO/to contain/VB/contain only/RB/only one/CD/one mapping/VBG/mapping of/IN/of a/DT/a virtual/JJ/virtual address/NN/address to/TO/to the/DT/the shared/VBN/shared physical/JJ/physical address/NNP/address. this/DT/this means/VBZ/means that/IN/that references/NNS/references to/TO/to virtual/JJ/virtual addresses/NNS/addresses that/WDT/that are/VBP/are not/RB/not mapped/VBN/mapped result/NN/result in/IN/in page/NN/page faults/NNP/faults. an/NNP/an. important/JJ/important aspect/NN/aspect of/IN/of memory/NN/memory management/NN/management that/WDT/that became/VBD/became unavoidable/JJ/unavoidable with/IN/with paging/NN/paging is/VBZ/is the/DT/the separation/NN/separation of/IN/of the/DT/the user/NN/user 's/POS/'s view/NN/view of/IN/of memory/NN/memory from/IN/from the/DT/the actual/JJ/actual physical/JJ/physical memory/NNP/memory. as/IN/as we/PRP/we have/VBP/have already/RB/already seen/VBN/seen /,/, the/DT/the user/NN/user 's/POS/'s view/NN/view of/IN/of memory/NN/memory is/VBZ/is not/RB/not the/DT/the same/JJ/same as/IN/as the/DT/the actual/JJ/actual physical/JJ/physical memory/NNP/memory. the/DT/the user/NN/user 's/POS/'s view/NN/view is/VBZ/is mapped/VBN/mapped onto/IN/onto physical/JJ/physical memory/NNP/memory. this/DT/this mapping/NN/mapping allows/VBZ/allows differentiation/NN/differentiation between/IN/between logical/JJ/logical memory/NN/memory and/CC/and physical/JJ/physical memory/NNP/memory. 8.6.1/CD/8.6.1 basic/JJ/basic method/NN/method do/VBP/do users/NNS/users think/VBP/think of/IN/of memory/NN/memory as/IN/as a/DT/a linear/NN/linear array/NN/array of/IN/of bytes/NNS/bytes /,/, some/DT/some containing/NN/containing instructions/NNS/instructions and/CC/and others/NNS/others containing/VBG/containing data/NNS/data most/JJS/most people/NNS/people would/MD/would say/VB/say no/NNP/no. rather/RB/rather /,/, users/NNS/users prefer/VBP/prefer to/TO/to view/VB/view memory/NN/memory as/IN/as a/DT/a collection/NN/collection of/IN/of variable-sized/JJ/variable-sized segments/NNS/segments /,/, with/IN/with no/DT/no necessary/JJ/necessary ordering/NN/ordering among/IN/among segments/NNS/segments /:/( figure/NN/figure 8.18/CD/8.18 /CD/) /./. consider/NN/consider how/WRB/how you/PRP/you think/VBP/think of/IN/of a/DT/a program/NN/program when/WRB/when you/PRP/you are/VBP/are writing/VBG/writing it/NNP/it. you/PRP/you think/VBP/think of/IN/of it/PRP/it as/IN/as a/DT/a main/JJ/main program/NN/program with/IN/with a/DT/a set/NN/set of/IN/of methods/NNS/methods /,/, procedures/NNS/procedures /,/, or/CC/or functions/NNP/functions. it/PRP/it may/MD/may also/RB/also include/VBP/include various/JJ/various data/NNS/data structures/NNS/structures /:/: objects/NNS/objects /,/, arrays/NNS/arrays /,/, stacks/NNS/stacks /,/, variables/NNS/variables /,/, and/CC/and so/RB/so on/NNP/on. each/DT/each of/IN/of these/DT/these modules/NNS/modules or/CC/or data/NNS/data elements/NNS/elements is/VBZ/is referred/VBN/referred to/TO/to by/IN/by name/NNP/name. you/PRP/you talk/VBP/talk about/IN/about the/DT/the stack/NN/stack /,/, the/DT/the math/NN/math library/NN/library /,/, the/DT/the n1.ain/JJ/n1.ain program/NN/program /,/, without/IN/without caring/NN/caring what/WP/what addresses/NNS/addresses in/IN/in memory/NN/memory these/DT/these elements/NNS/elements occupy/NNP/occupy. you/PRP/you are/VBP/are not/RB/not concerned/VBN/concerned with/IN/with whether/IN/whether the/DT/the stack/NN/stack is/VBZ/is stored/VBN/stored before/IN/before or/CC/or after/IN/after the/DT/the sqrt/NN/sqrt /:/( /:/) function/NNP/function. each/DT/each of/IN/of these/DT/these segments/NNS/segments is/VBZ/is of/IN/of variable/JJ/variable length/NN/length ;/:/; the/DT/the length/NN/length is/VBZ/is intrinsically/RB/intrinsically defined/VBN/defined by/IN/by subroutine/NN/subroutine symbol/NN/symbol table/NN/table /./. main/NN/main program/NN/program logical/JJ/logical address/NN/address 8.6/CD/8.6 figure/NN/figure 8.18/CD/8.18 user/NN/user 's/POS/'s view/NN/view of/IN/of a/DT/a program/NNP/program. 343/CD/343 the/DT/the purpose/NN/purpose of/IN/of the/DT/the segment/NN/segment in/IN/in the/DT/the program/NNP/program. elements/NNS/elements within/IN/within a/DT/a segment/NN/segment are/VBP/are identified/VBN/identified by/IN/by their/PRP$/their offset/NN/offset from/IN/from the/DT/the begim1.ing/JJ/begim1.ing of/IN/of the/DT/the segment/NN/segment /:/: the/DT/the first/JJ/first statement/NN/statement of/IN/of the/DT/the program/NN/program /,/, the/DT/the seventh/NN/seventh stack/NN/stack frame/NN/frame entry/NN/entry in/IN/in the/DT/the stack/NN/stack /,/, the/DT/the fifth/JJ/fifth instruction/NN/instruction of/IN/of the/DT/the sqrt/NN/sqrt /:/( /:/) /,/, and/CC/and so/RB/so on/NNP/on. is/VBZ/is a/DT/a memory-management/JJ/memory-management scheme/NN/scheme that/WDT/that supports/VBZ/supports this/DT/this user/NN/user view/NN/view of/IN/of memory/NNP/memory. a/DT/a logical/JJ/logical address/NN/address space/NN/space is/VBZ/is a/DT/a collection/NN/collection of/IN/of segments/NNP/segments. each/DT/each segment/NN/segment has/VBZ/has a/DT/a name/NN/name and/CC/and a/DT/a length/NNP/length. the/DT/the addresses/NNS/addresses specify/VBP/specify both/DT/both the/DT/the segment/NN/segment name/NN/name and/CC/and the/DT/the offset/NN/offset within/IN/within the/DT/the segment/NNP/segment. the/DT/the user/NN/user therefore/NN/therefore specifies/NNS/specifies each/DT/each address/NN/address by/IN/by two/CD/two quantities/NNS/quantities /:/: a/DT/a segment/NN/segment name/NN/name and/CC/and an/DT/an offset/NNP/offset. /NNP/( contrast/NN/contrast this/DT/this scheme/NN/scheme with/IN/with the/DT/the paging/VBG/paging scheme/NN/scheme /,/, in/IN/in which/WDT/which the/DT/the user/NN/user specifies/NNS/specifies only/RB/only a/DT/a single/JJ/single address/NN/address /,/, which/WDT/which is/VBZ/is partitioned/VBN/partitioned by/IN/by the/DT/the hardware/NN/hardware into/IN/into a/DT/a page/NN/page number/NN/number and/CC/and an/DT/an offset/NN/offset /,/, all/DT/all invisible/JJ/invisible to/TO/to the/DT/the programmer/NNP/programmer. /NNP/) for/IN/for simplicity/NN/simplicity of/IN/of implementation/NN/implementation /,/, segments/NNS/segments are/VBP/are numbered/VBN/numbered and/CC/and are/VBP/are referred/VBN/referred to/TO/to by/IN/by a/DT/a segn/NN/segn lent/NN/lent number/NN/number /,/, rather/RB/rather than/IN/than by/IN/by a/DT/a segment/NN/segment name/NNP/name. thus/RB/thus /,/, a/DT/a logical/JJ/logical address/NN/address consists/NNS/consists of/IN/of a/DT/a two/CD/two tuple/JJ/tuple /:/: segment-number/JJ/segment-number /,/, offset/VBN/offset /./. normally/RB/normally /,/, the/DT/the user/NN/user program/NN/program is/VBZ/is compiled/VBN/compiled /,/, and/CC/and the/DT/the compiler/NN/compiler automatically/RB/automatically constructs/VBZ/constructs segments/NNS/segments reflecting/VBG/reflecting the/DT/the input/NN/input program/NNP/program. a/DT/a c/NN/c compiler/NN/compiler might/MD/might create/VB/create separate/JJ/separate segments/NNS/segments for/IN/for the/DT/the following/VBG/following /:/: the/DT/the code/NN/code global/JJ/global variables/NNS/variables the/DT/the heap/NN/heap /,/, from/IN/from which/WDT/which memory/NN/memory is/VBZ/is allocated/VBN/allocated the/DT/the stacks/NNS/stacks used/VBN/used by/IN/by each/DT/each thread/NN/thread the/DT/the standard/JJ/standard c/NN/c library/NN/library 344/CD/344 chapter/NN/chapter 8/CD/8 no/DT/no segment/NN/segment table/NN/table yes/NNS/yes trap/VBP/trap /:/: addressing/VBG/addressing error/NN/error +/:/+ figure/NN/figure 8.19/CD/8.19 segmentation/NN/segmentation hardware/NNP/hardware. physical/JJ/physical memory/NN/memory libraries/NNS/libraries that/WDT/that are/VBP/are linked/VBN/linked in/IN/in during/IN/during compile/JJ/compile time/NN/time might/MD/might be/VB/be assign.ed/JJ/assign.ed separate/JJ/separate segments/NNP/segments. the/DT/the loader/NN/loader would/MD/would take/VB/take all/DT/all these/DT/these segments/NNS/segments and/CC/and assign/NN/assign them/PRP/them segment/NN/segment numbers/NNP/numbers. 8.6.2/CD/8.6.2 hardware/NN/hardware although/IN/although the/DT/the user/NN/user can/MD/can now/RB/now refer/VB/refer to/TO/to objects/NNS/objects in/IN/in the/DT/the program/NN/program by/IN/by a/DT/a two-dimensional/JJ/two-dimensional address/NN/address /,/, the/DT/the actual/JJ/actual physical/JJ/physical memory/NN/memory is/VBZ/is still/RB/still /,/, of/IN/of course/NN/course /,/, a/DT/a one-dimensional/JJ/one-dimensional sequence/NN/sequence of/IN/of bytes/NNP/bytes. thus/RB/thus /,/, we/PRP/we must/MD/must define/VB/define an/DT/an implementation/NN/implementation to/TO/to map/VB/map twodimensional/JJ/twodimensional user-defined/JJ/user-defined addresses/NNS/addresses into/IN/into one-dimensional/JJ/one-dimensional physical/JJ/physical addresses/NNP/addresses. this/DT/this mapping/NN/mapping is/VBZ/is effected/VBN/effected by/IN/by a/DT/a each/DT/each entry/NN/entry in/IN/in the/DT/the segment/NN/segment table/NN/table has/VBZ/has a/DT/a segment/NN/segment base/NN/base and/CC/and a/DT/a segment/NN/segment limit/NNP/limit. the/DT/the segment/NN/segment base/NN/base contains/VBZ/contains the/DT/the startilcg/NN/startilcg physical/JJ/physical address/NN/address where/WRB/where the/DT/the segment/NN/segment resides/VBZ/resides in/IN/in memory/NN/memory /,/, and/CC/and the/DT/the segment/NN/segment limit/NN/limit specifies/NNS/specifies the/DT/the length/NN/length of/IN/of the/DT/the segment/NNP/segment. the/DT/the use/NN/use of/IN/of a/DT/a segment/NN/segment table/NN/table is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 8.19/CD/8.19. a/DT/a logical/JJ/logical address/NN/address consists/NNS/consists of/IN/of two/CD/two parts/NNS/parts /:/: a/DT/a segment/NN/segment number/NN/number /,/, s/NNS/s /,/, and/CC/and an/DT/an offset/NN/offset into/IN/into that/DT/that segment/NN/segment /,/, d/NNP/d. the/DT/the segment/NN/segment number/NN/number is/VBZ/is used/VBN/used as/RB/as an/DT/an index/NN/index to/TO/to the/DT/the segment/NN/segment table/NNP/table. the/DT/the offset/NN/offset d/NN/d of/IN/of the/DT/the logical/JJ/logical address/NN/address must/MD/must be/VB/be between/IN/between 0/-NONE-/0 and/CC/and the/DT/the segment/NN/segment limit/NNP/limit. if/IN/if it/PRP/it is/VBZ/is not/RB/not /,/, we/PRP/we trap/VBP/trap to/TO/to the/DT/the operating/NN/operating system/NN/system /:/( logical/JJ/logical addressing/NN/addressing attempt/NN/attempt beyond/IN/beyond end/NN/end of/IN/of segment/NN/segment /:/) /./. when/WRB/when an/DT/an offset/NN/offset is/VBZ/is legal/JJ/legal /,/, it/PRP/it is/VBZ/is added/VBN/added to/TO/to the/DT/the segment/NN/segment base/NN/base to/TO/to produce/VB/produce the/DT/the address/NN/address in/IN/in physical/JJ/physical memory/NN/memory of/IN/of the/DT/the desired/VBN/desired byte/NNP/byte. the/DT/the segment/NN/segment table/NN/table is/VBZ/is thus/RB/thus essentially/RB/essentially an/DT/an array/NN/array of/IN/of base-limit/JJ/base-limit register/NN/register pairs/NNP/pairs. as/IN/as an/DT/an example/NN/example /,/, consider/NN/consider the/DT/the situation/NN/situation shown/NN/shown in/IN/in figure/NN/figure 8.20/CD/8.20. we/PRP/we have/VBP/have five/CD/five segments/NNS/segments numbered/VBD/numbered from/IN/from 0/-NONE-/0 through/IN/through 4/CD/4. the/DT/the segments/NNS/segments are/VBP/are stored/VBN/stored in/IN/in physical/JJ/physical memory/NN/memory as/IN/as shown/NNP/shown. the/DT/the segment/NN/segment table/NN/table has/VBZ/has a/DT/a separate/JJ/separate entry/NN/entry for/IN/for each/DT/each segment/NN/segment /,/, giving/VBG/giving the/DT/the beginning/NN/beginning address/NN/address of/IN/of the/DT/the segment/NN/segment in/IN/in physical/JJ/physical memory/NN/memory /:/( or/CC/or base/NN/base /:/) and/CC/and the/DT/the length/NN/length of/IN/of that/DT/that segment/NN/segment /:/( or/CC/or limit/NN/limit /:/) /./. for/IN/for example/NN/example /,/, segment/NN/segment 2/CD/2 is/VBZ/is 400/CD/400 bytes/NNS/bytes long/RB/long and/CC/and begins/VBZ/begins at/IN/at location/NN/location 4300/CD/4300. thus/RB/thus /,/, a/DT/a reference/NN/reference to/TO/to byte/VB/byte 53/CD/53 of/IN/of segment/NN/segment 2/CD/2 is/VBZ/is mapped/VBN/mapped 8.7/CD/8.7 subroutine/NN/subroutine segment/NN/segment o/NN/o segment1/NNP/segment1 symbol/NN/symbol table/NN/table /./. segment/NN/segment 4/CD/4 main/NN/main program/NN/program segment/NN/segment 2/CD/2 logical/JJ/logical address/NN/address space/NN/space 8.7/CD/8.7 0/-NONE-/0 2/CD/2 3/CD/3 4/CD/4 limit/NN/limit base/NN/base 1000/CD/1000 1400/CD/1400 400/CD/400 6300/CD/6300 400/CD/400 4300/CD/4300 1100/CD/1100 3200/CD/3200 1000/CD/1000 4700/CD/4700 segment/NN/segment table/JJ/table figure/NN/figure 8.20/CD/8.20 example/NN/example of/IN/of segmentation/NNP/segmentation. 14001---1/CD/14001---1 segment/NN/segment o/NN/o 2400/CD/2400 3200/CD/3200 1-----1/CD/1-----1 segment/NN/segment 3/CD/3 4300/CD/4300 1/CD/1-- ~/CD/~ --1/-NONE-/--1 4700/CD/4700 segment/NN/segment 2/CD/2 segment/NN/segment 4/CD/4 5700/CD/5700 f--------1/-NONE-/f--------1 6300/CD/6300 /./. /./. s/NNS/s ~/:/~ gt/NN/gt \/:/\ 1e/CD/1e !/./! it/PRP/it 1/CD/1 6700/CD/6700 physical/JJ/physical memory/NN/memory 345/CD/345 onto/IN/onto location/NN/location 4300/CD/4300 +/CD/+ 53/CD/53 =/CD/= 4353/CD/4353. a/DT/a reference/NN/reference to/TO/to segment/NN/segment 3/CD/3 /,/, byte/JJ/byte 852/CD/852 /,/, is/VBZ/is mapped/VBN/mapped to/TO/to 3200/CD/3200 /CD/( the/DT/the base/NN/base of/IN/of segment/NN/segment 3/CD/3 /CD/) +/CD/+ 852/CD/852 =/CD/= 4052/CD/4052. a/DT/a reference/NN/reference to/TO/to byte/VB/byte 1222/CD/1222 of/IN/of segment/NN/segment 0/-NONE-/0 would/MD/would result/VB/result in/IN/in a/DT/a trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NN/system /,/, as/IN/as this/DT/this segment/NN/segment is/VBZ/is only/RB/only tooo/RB/tooo bytes/VBZ/bytes long/NNP/long. both/DT/both paging/VBG/paging and/CC/and segmentation/NN/segmentation have/VBP/have advantages/NNS/advantages and/CC/and disadvantages/NNP/disadvantages. in/IN/in fact/NN/fact some/DT/some architectures/NNS/architectures provide/VBP/provide both/NNP/both. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we discuss/VBP/discuss the/DT/the intel/NN/intel pentium/NN/pentium architecture/NN/architecture /,/, which/WDT/which supports/NNS/supports both/DT/both pure/NN/pure segmentation/NN/segmentation and/CC/and segmentation/NN/segmentation with/IN/with paging/NNP/paging. we/PRP/we do/VBP/do not/RB/not give/VB/give a/DT/a complete/JJ/complete description/NN/description of/IN/of the/DT/the memory-management/JJ/memory-management structure/NN/structure of/IN/of the/DT/the pentium/NN/pentium in/IN/in this/DT/this text/NNP/text. rather/RB/rather /,/, we/PRP/we present/VBP/present the/DT/the major/JJ/major ideas/NNS/ideas on/IN/on which/WDT/which it/PRP/it is/VBZ/is based/NNP/based. we/PRP/we conclude/VBP/conclude our/PRP$/our discussion/NN/discussion with/IN/with an/DT/an overview/NN/overview of/IN/of linux/NN/linux address/NN/address translation/NN/translation on/IN/on pentium/NN/pentium systems/NNP/systems. in/IN/in pentium/NN/pentium systems/NNS/systems /,/, the/DT/the cpu/NN/cpu generates/VBZ/generates logical/JJ/logical addresses/NNS/addresses /,/, which/WDT/which are/VBP/are given/VBN/given to/TO/to the/DT/the segmentation/NN/segmentation unit/NNP/unit. the/DT/the segmentation/NN/segmentation unit/NN/unit produces/NNS/produces a/DT/a linear/JJ/linear address/NN/address for/IN/for each/DT/each logical/JJ/logical address/NNP/address. the/DT/the linear/NN/linear address/NN/address is/VBZ/is then/RB/then given/VBN/given to/TO/to the/DT/the paging/NN/paging unit/NN/unit /,/, which/WDT/which in/IN/in turn/NN/turn generates/NNS/generates the/DT/the physical/JJ/physical address/NN/address in/IN/in main/NN/main memory/NNP/memory. thus/RB/thus /,/, the/DT/the segmentation/NN/segmentation and/CC/and paging/VBG/paging units/NNS/units form/NN/form the/DT/the equivalent/NN/equivalent of/IN/of the/DT/the memory-management/JJ/memory-management unit/NN/unit /:/( mmu/NN/mmu /:/) /./. this/DT/this scheme/NN/scheme is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.21/CD/8.21. 8.7.1/CD/8.7.1 pentium/NN/pentium segmentation/NN/segmentation the/DT/the pentium/NN/pentium architecture/NN/architecture allows/VBZ/allows a/DT/a segment/NN/segment to/TO/to be/VB/be as/RB/as large/JJ/large as/IN/as 4/CD/4 gb/NN/gb /,/, and/CC/and the/DT/the maximum/NN/maximum number/NN/number of/IN/of segments/NNS/segments per/IN/per process/NN/process is/VBZ/is 16/CD/16 k/NNP/k. the/DT/the logical-address/JJ/logical-address space/NN/space 346/CD/346 chapter/NN/chapter 8/CD/8 i/PRP/i cpu/VBP/cpu i/PRP/i figure/VBP/figure 8.21/CD/8.21 logical/JJ/logical to/TO/to physical/JJ/physical address/NN/address translation/NN/translation in/IN/in the/DT/the pentium/NNP/pentium. of/IN/of a/DT/a process/NN/process is/VBZ/is divided/VBN/divided into/IN/into two/CD/two partitions/NNP/partitions. the/DT/the first/JJ/first partition/NN/partition consists/NNS/consists of/IN/of up/IN/up to/TO/to 8/CD/8 k/NN/k segments/NNS/segments that/WDT/that are/VBP/are private/JJ/private to/TO/to that/DT/that process/NNP/process. the/DT/the second/JJ/second partition/NN/partition consists/NNS/consists of/IN/of up/IN/up to/TO/to 8/CD/8 k/NN/k segments/NNS/segments that/WDT/that are/VBP/are shared/VBN/shared all/DT/all the/DT/the processes/NNP/processes. information/NN/information about/IN/about the/DT/the first/JJ/first partition/NN/partition is/VBZ/is kept/VBN/kept in/IN/in the/DT/the information/NN/information about/IN/about the/DT/the second/JJ/second partition/NN/partition is/VBZ/is kept/VBN/kept in/IN/in the/DT/the each/DT/each entry/NN/entry in/IN/in the/DT/the ldt/NN/ldt and/CC/and gdt/NN/gdt consists/NNS/consists of/IN/of an/DT/an 8-byte/JJ/8-byte segment/NN/segment descriptor/NN/descriptor with/IN/with detailed/JJ/detailed information/NN/information about/IN/about a/DT/a particular/JJ/particular segment/NN/segment /,/, including/VBG/including the/DT/the base/NN/base location/NN/location and/CC/and limit/NN/limit of/IN/of that/DT/that segment/NNP/segment. the/DT/the logical/JJ/logical address/NN/address is/VBZ/is a/DT/a pair/NN/pair /:/( selector/NN/selector /,/, offset/VBN/offset /-NONE-/) /,/, where/WRB/where the/DT/the selector/NN/selector is/VBZ/is a/DT/a 16-bit/JJ/16-bit number/NN/number /:/: g/NN/g p/NN/p 13/CD/13 2/CD/2 in/IN/in which/WDT/which s/NNS/s designates/VBZ/designates the/DT/the segment/NN/segment number/NN/number /,/, g/NN/g indicates/VBZ/indicates whether/IN/whether the/DT/the segment/NN/segment is/VBZ/is in/IN/in the/DT/the gdt/NN/gdt or/CC/or ldt/NN/ldt /,/, and/CC/and p/VB/p deals/NNS/deals with/IN/with protection/NNP/protection. the/DT/the offset/NN/offset is/VBZ/is a/DT/a 32-bit/JJ/32-bit number/NN/number specifying/VBG/specifying the/DT/the location/NN/location of/IN/of the/DT/the byte/NN/byte /:/( or/CC/or word/NN/word /:/) within/IN/within the/DT/the segment/NN/segment in/IN/in question/NNP/question. the/DT/the machine/NN/machine has/VBZ/has six/CD/six segment/NN/segment registers/NNS/registers /,/, allowing/VBG/allowing six/CD/six segments/NNS/segments to/TO/to be/VB/be addressed/VBN/addressed at/IN/at any/DT/any one/CD/one time/NN/time by/IN/by a/DT/a process/NNP/process. it/PRP/it also/RB/also has/VBZ/has six/CD/six 8-byte/CD/8-byte microprogram/NN/microprogram registers/NNS/registers to/TO/to hold/VB/hold the/DT/the corresponding/NN/corresponding descriptors/NNS/descriptors from/IN/from either/DT/either the/DT/the ldt/NN/ldt or/CC/or gdt/NNP/gdt. this/DT/this cache/NN/cache lets/NNS/lets the/DT/the pentium/NN/pentium avoid/VBD/avoid having/VBG/having to/TO/to read/VB/read the/DT/the descriptor/NN/descriptor from/IN/from memory/NN/memory for/IN/for every/DT/every memory/NN/memory reference/NNP/reference. the/DT/the linear/NN/linear address/NN/address on/IN/on the/DT/the pentium/NN/pentium is/VBZ/is 32/CD/32 bits/NNS/bits long/RB/long and/CC/and is/VBZ/is formed/VBN/formed as/RB/as follows/NNP/follows. the/DT/the segment/NN/segment register/NN/register points/NNS/points to/TO/to the/DT/the appropriate/NN/appropriate entry/NN/entry in/IN/in the/DT/the ldt/NN/ldt or/CC/or gdt/NNP/gdt. the/DT/the base/NN/base and/CC/and limit/NN/limit information/NN/information about/IN/about the/DT/the segment/NN/segment in/IN/in question/NN/question is/VBZ/is used/VBN/used to/TO/to generate/VB/generate a/DT/a first/JJ/first /,/, the/DT/the limit/NN/limit is/VBZ/is used/VBN/used to/TO/to check/VB/check for/IN/for address/NN/address validity/NNP/validity. if/IN/if the/DT/the address/NN/address is/VBZ/is not/RB/not valid/JJ/valid /,/, a/DT/a memory/NN/memory fault/NN/fault is/VBZ/is generated/VBN/generated /,/, resulting/VBG/resulting in/IN/in a/DT/a trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NNP/system. if/IN/if it/PRP/it is/VBZ/is valid/JJ/valid /,/, then/RB/then the/DT/the value/NN/value of/IN/of the/DT/the offset/NN/offset is/VBZ/is added/VBN/added to/TO/to the/DT/the value/NN/value of/IN/of the/DT/the base/NN/base /,/, resulting/VBG/resulting in/IN/in a/DT/a 32-bit/JJ/32-bit linear/NN/linear address/NNP/address. this/DT/this is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.22/CD/8.22. in/IN/in the/DT/the following/JJ/following section/NN/section /,/, we/PRP/we discuss/VBP/discuss how/WRB/how the/DT/the paging/NN/paging unit/NN/unit turns/VBZ/turns this/DT/this linear/NN/linear address/NN/address into/IN/into a/DT/a physical/JJ/physical address/NNP/address. 8.7.2/CD/8.7.2 pentium/NN/pentium paging/VBG/paging the/DT/the pentium/NN/pentium architecture/NN/architecture allows/VBZ/allows a/DT/a page/NN/page size/NN/size of/IN/of either/DT/either 4/CD/4 kb/NN/kb or/CC/or 4/CD/4 mb/NNP/mb. for/IN/for 4-kb/CD/4-kb pages/NNS/pages /,/, the/DT/the pentium/NN/pentium uses/VBZ/uses a/DT/a two-level/JJ/two-level paging/NN/paging schence/NN/schence in/IN/in which/WDT/which the/DT/the division/NN/division of/IN/of the/DT/the 32-bit/JJ/32-bit linear/NN/linear address/NN/address is/VBZ/is as/IN/as follows/NNS/follows /:/: page/NN/page number/NN/number page/NN/page offset/NN/offset d/NN/d 10/CD/10 10/CD/10 12/CD/12 the/DT/the address-translation/NN/address-translation scheme/NN/scheme for/IN/for this/DT/this architecture/NN/architecture is/VBZ/is similar/JJ/similar to/TO/to the/DT/the scheme/NN/scheme shown/NN/shown in/IN/in figure/NN/figure 8.15/CD/8.15. the/DT/the intel/NN/intel pentium/NN/pentium address/NN/address translation/NN/translation is/VBZ/is shown/VBN/shown in/IN/in more/JJR/more 8.7/CD/8.7 347/CD/347 logical/JJ/logical address/NN/address offset/NN/offset +/:/+ 32-bit/CD/32-bit linear/NN/linear address/NN/address figure/NN/figure 8.22/CD/8.22 intel/NN/intel pentium/NN/pentium segmentation/NNP/segmentation. detail/NN/detail in/IN/in figure/NN/figure 8.23/CD/8.23. the/DT/the 10/CD/10 high-order/NN/high-order bits/NNS/bits reference/NN/reference an/DT/an entry/NN/entry in/IN/in the/DT/the outern'lost/JJ/outern'lost page/NN/page table/NN/table /,/, which/WDT/which the/DT/the pentium/NN/pentium terms/NNS/terms the/DT/the page/NN/page directory/NNP/directory. /NNP/( the/DT/the cr3/NNP/cr3 register/NN/register points/NNS/points to/TO/to the/DT/the page/NN/page directory/NN/directory for/IN/for the/DT/the current/JJ/current process/NNP/process. /NNP/) the/DT/the page/NN/page directory/NN/directory entry/NN/entry points/NNS/points to/TO/to an/DT/an inner/NN/inner page/NN/page table/NN/table that/WDT/that is/VBZ/is indexed/VBN/indexed by/IN/by the/DT/the contents/NNS/contents of/IN/of the/DT/the innermost/JJS/innermost 10/CD/10 bits/NNS/bits in/IN/in the/DT/the linear/NN/linear address/NNP/address. finally/RB/finally /,/, the/DT/the low-order/NN/low-order bits/VBZ/bits 0-11/CD/0-11 refer/NN/refer to/TO/to the/DT/the offset/NN/offset in/IN/in the/DT/the 4-kb/CD/4-kb page/NN/page pointed/VBD/pointed to/TO/to in/IN/in the/DT/the page/NN/page table/NNP/table. one/CD/one entry/NN/entry in/IN/in the/DT/the page/NN/page directory/NN/directory is/VBZ/is the/DT/the page/NN/page size/NN/size flag/NN/flag /,/, which-if/JJ/which-if setindicates/NNS/setindicates that/WDT/that the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page frame/NN/frame is/VBZ/is 4/CD/4 mb/NN/mb and/CC/and not/RB/not the/DT/the standard/JJ/standard 4/CD/4 kb/NNP/kb. if/IN/if this/DT/this flag/NN/flag is/VBZ/is set/VBN/set /,/, the/DT/the page/NN/page directory/NN/directory points/NNS/points directly/RB/directly to/TO/to the/DT/the 4-mb/CD/4-mb page/NN/page frame/NN/frame /,/, bypassing/VBG/bypassing the/DT/the inner/NN/inner page/NN/page table/NN/table ;/:/; and/CC/and the/DT/the 22/CD/22 low-order/NN/low-order bits/NNS/bits in/IN/in the/DT/the linear/NN/linear address/NN/address refer/NN/refer to/TO/to the/DT/the offset/NN/offset in/IN/in the/DT/the 4-mb/CD/4-mb page/NN/page frame/NNP/frame. 31/CD/31 cr3/-NONE-/cr3- registe/JJ/registe r/NN/r page/NN/page directory/NN/directory page/NN/page directory/NN/directory page/NN/page directory/NN/directory /:/( logical/JJ/logical address/NN/address /:/) page/NN/page table/NN/table 22/CD/22 21/CD/21 l/NN/l 1211/CD/1211 page/NN/page table/JJ/table /:/- i/PRP/i offset/VBP/offset 31/CD/31 22/CD/22 21/CD/21 offset/NN/offset j/NN/j 4-kb/CD/4-kb page/NN/page 4-mb/CD/4-mb page/NN/page figure/NN/figure 8.23/CD/8.23 paging/VBG/paging in/IN/in the/DT/the pentium/NN/pentium architecture/NNP/architecture. 0/-NONE-/0 0/-NONE-/0 3l/JJ/3l !/./! 8/CD/8 chapter/NN/chapter 8/CD/8 to/TO/to improve/VB/improve the/DT/the efficiency/NN/efficiency of/IN/of physical/JJ/physical memory/NN/memory use/NN/use /,/, intel/NN/intel pentium/NN/pentium page/NN/page tables/NNS/tables can/MD/can be/VB/be swapped/VBN/swapped to/TO/to disk/NNP/disk. in/IN/in this/DT/this case/NN/case /,/, an/DT/an invalid/JJ/invalid bit/NN/bit is/VBZ/is used/VBN/used in/IN/in the/DT/the page/NN/page directory/NN/directory entry/NN/entry to/TO/to indicate/VB/indicate whether/IN/whether the/DT/the table/NN/table to/TO/to which/WDT/which the/DT/the entry/NN/entry is/VBZ/is pointing/VBG/pointing is/VBZ/is in/IN/in memory/NN/memory or/CC/or on/IN/on disk/NNP/disk. if/IN/if the/DT/the table/NN/table is/VBZ/is on/IN/on disk/NN/disk /,/, the/DT/the operating/NN/operating system/NN/system can/MD/can use/VB/use the/DT/the other/JJ/other 31/CD/31 bits/NNS/bits to/TO/to specify/VB/specify the/DT/the disk/NN/disk location/NN/location of/IN/of the/DT/the table/NN/table ;/:/; the/DT/the table/NN/table then/RB/then can/MD/can be/VB/be brought/VBN/brought into/IN/into memory/NN/memory on/IN/on demand/NNP/demand. 8.7.3/CD/8.7.3 linux/NN/linux on/IN/on pentium/NN/pentium systems/NNS/systems as/IN/as an/DT/an illustration/NN/illustration /,/, consider/NN/consider the/DT/the linux/NN/linux operating/NN/operating system/NN/system running/VBG/running on/IN/on the/DT/the intel/NN/intel pentium/NN/pentium architecture/NNP/architecture. because/IN/because linux/NN/linux is/VBZ/is designed/VBN/designed to/TO/to run/VB/run on/IN/on a/DT/a variety/NN/variety of/IN/of processors/NN/processors- many/JJ/many of/IN/of which/WDT/which may/MD/may provide/VB/provide only/RB/only limited/VBN/limited support/NN/support for/IN/for segmentationlinux/NN/segmentationlinux does/VBZ/does not/RB/not rely/RB/rely on/IN/on segmentation/NN/segmentation and/CC/and uses/NNS/uses it/PRP/it minimally/NNP/minimally. on/IN/on the/DT/the pentium/NN/pentium /,/, linux/NN/linux uses/NNS/uses only/RB/only six/CD/six segments/NNS/segments /:/: a/DT/a segment/NN/segment for/IN/for kernel/NN/kernel code/NN/code a/DT/a segment/NN/segment for/IN/for kernel/NN/kernel data/NNS/data a/DT/a segment/NN/segment for/IN/for user/NN/user code/NN/code a/DT/a segment/NN/segment for/IN/for user/NN/user data/NNS/data a/DT/a task-state/JJ/task-state segment/NN/segment /:/( tss/NN/tss /:/) 1i/CD/1i a/DT/a default/NN/default ldt/NN/ldt segment/NN/segment the/DT/the segments/NNS/segments for/IN/for user/NN/user code/NN/code and/CC/and user/NN/user data/NNS/data are/VBP/are shared/VBN/shared by/IN/by all/DT/all processes/NNS/processes running/VBG/running in/IN/in user/NN/user mode/NNP/mode. this/DT/this is/VBZ/is possible/JJ/possible because/IN/because all/DT/all processes/NNS/processes use/VBP/use the/DT/the same/JJ/same logical/JJ/logical address/NN/address space/NN/space and/CC/and all/DT/all segment/NN/segment descriptors/NNS/descriptors are/VBP/are stored/VBN/stored in/IN/in the/DT/the global/JJ/global descriptor/NN/descriptor table/NN/table /:/( gdt/NN/gdt /:/) /./. furthermore/JJR/furthermore /,/, each/DT/each process/NN/process has/VBZ/has its/PRP$/its own/JJ/own task-state/JJ/task-state segment/NN/segment /:/( tss/NN/tss /:/) /,/, and/CC/and the/DT/the descriptor/NN/descriptor for/IN/for this/DT/this segment/NN/segment is/VBZ/is stored/VBN/stored in/IN/in the/DT/the gdt/NNP/gdt. the/DT/the tss/NN/tss is/VBZ/is used/VBN/used to/TO/to store/VB/store the/DT/the hardware/NN/hardware context/NN/context of/IN/of each/DT/each process/NN/process during/IN/during context/JJ/context switches/NNP/switches. the/DT/the default/NN/default ldt/NN/ldt segment/NN/segment is/VBZ/is normally/RB/normally shared/VBN/shared by/IN/by all/DT/all processes/NNS/processes and/CC/and is/VBZ/is usually/RB/usually not/RB/not used/NNP/used. however/RB/however /,/, if/IN/if a/DT/a process/NN/process requires/VBZ/requires its/PRP$/its own/JJ/own ldt/NN/ldt /,/, it/PRP/it can/MD/can create/VB/create one/CD/one and/CC/and use/NN/use that/IN/that instead/RB/instead of/IN/of the/DT/the default/NN/default ldt/NNP/ldt. as/IN/as noted/JJ/noted /,/, each/DT/each segment/NN/segment selector/NN/selector includes/VBZ/includes a/DT/a 2-bit/JJ/2-bit field/NN/field for/IN/for protection/NNP/protection. thus/RB/thus /,/, the/DT/the pentium/NN/pentium allows/VBZ/allows four/CD/four levels/NNS/levels of/IN/of protection/NNP/protection. of/IN/of these/DT/these four/CD/four levels/NNS/levels /,/, limlx/NN/limlx only/RB/only recognizes/VBZ/recognizes two/CD/two /:/: user/NN/user mode/NN/mode and/CC/and kernel/NN/kernel mode/NNP/mode. although/IN/although the/DT/the pentium/NN/pentium uses/VBZ/uses a/DT/a two-level/JJ/two-level paging/NN/paging model/NN/model /,/, linux/NN/linux is/VBZ/is designed/VBN/designed to/TO/to run/VB/run on/IN/on a/DT/a variety/NN/variety of/IN/of hardware/NN/hardware platforms/NNS/platforms /,/, many/JJ/many of/IN/of which/WDT/which are/VBP/are 64-bit/CD/64-bit platforms/NNS/platforms where/WRB/where two-level/JJ/two-level paging/NN/paging is/VBZ/is not/RB/not plausible/NNP/plausible. therefore/RB/therefore /,/, linux/NN/linux has/VBZ/has adopted/VBN/adopted a/DT/a threelevel/NN/threelevel paging/VBG/paging strategy/NN/strategy that/IN/that works/NNS/works well/RB/well for/IN/for both/DT/both 32-bit/JJ/32-bit and/CC/and 64-bit/JJ/64-bit architectures/NNP/architectures. the/DT/the linear/NN/linear address/NN/address in/IN/in linux/NN/linux is/VBZ/is broken/VBN/broken into/IN/into the/DT/the following/JJ/following four/CD/four parts/NNS/parts /:/: global/JJ/global directory/NN/directory middle/NN/middle directory/NN/directory page/NN/page table/NN/table figure/NN/figure 8.24/CD/8.24 highlights/NNS/highlights the/DT/the three-level/JJ/three-level paging/NN/paging model/NN/model in/IN/in linux/NNP/linux. the/DT/the number/NN/number of/IN/of bits/NNS/bits in/IN/in each/DT/each part/NN/part of/IN/of the/DT/the linear/JJ/linear address/NN/address varies/NNS/varies according/VBG/according to/TO/to architecture/NNP/architecture. however/RB/however /,/, as/IN/as described/VBN/described earlier/JJR/earlier in/IN/in this/DT/this section/NN/section /,/, the/DT/the pentium/NN/pentium architecture/NN/architecture only/RB/only uses/VBZ/uses a/DT/a two-level/JJ/two-level paging/NN/paging model/NNP/model. how/WRB/how /,/, then/RB/then /,/, does/VBZ/does linux/NN/linux apply/RB/apply 8.8/CD/8.8 lglobal/JJ/lglobal directory/NN/directory global/JJ/global directory/NN/directory cr3/NNP/cr3 __,.c__/NNP/__,.c__ ___/NNP/___ __l/NNP/__l register/NN/register 8.8/CD/8.8 /CD/( linear/JJ/linear address/NN/address /:/) middle/NN/middle directory/NN/directory figure/NN/figure 8.24/CD/8.24 three-level/JJ/three-level paging/NN/paging in/IN/in linux/NNP/linux. offset/NN/offset page/NN/page frame/NN/frame 349/CD/349 its/PRP$/its three-level/JJ/three-level model/NN/model on/IN/on the/DT/the pentium/NN/pentium in/IN/in this/DT/this situation/NN/situation /,/, the/DT/the size/NN/size of/IN/of the/DT/the middle/NN/middle directory/NN/directory is/VBZ/is zero/CD/zero bits/NNS/bits /,/, effectively/RB/effectively bypassing/VBG/bypassing the/DT/the middle/NN/middle directory/NNP/directory. each/DT/each task/NN/task in/IN/in linux/NN/linux has/VBZ/has its/PRP$/its own/JJ/own set/NN/set of/IN/of page/NN/page tables/NNS/tables and/CC/and -just/JJ/-just as/IN/as in/IN/in figure/NN/figure 8.23/CD/8.23 -the/NNP/-the cr3/NNP/cr3 register/NN/register points/NNS/points to/TO/to the/DT/the global/JJ/global directory/NN/directory for/IN/for the/DT/the task/NN/task currently/RB/currently executing/NNP/executing. during/IN/during a/DT/a context/NN/context switch/NN/switch /,/, the/DT/the value/NN/value of/IN/of the/DT/the cr3/NNP/cr3 register/NN/register is/VBZ/is saved/VBN/saved and/CC/and restored/VBD/restored in/IN/in the/DT/the tss/NN/tss segments/NNS/segments of/IN/of the/DT/the tasks/NNS/tasks involved/VBD/involved in/IN/in the/DT/the context/NN/context switch/NNP/switch. memory-management/NNP/memory-management algorithms/VBZ/algorithms for/IN/for multiprogrammed/VBN/multiprogrammed operating/VBG/operating systems/NNS/systems range/NN/range from/IN/from the/DT/the simple/JJ/simple single-user/NN/single-user system/NN/system approach/NN/approach to/TO/to paged/JJ/paged segmentation/NNP/segmentation. the/DT/the most/RBS/most important/JJ/important determinant/NN/determinant of/IN/of the/DT/the method/NN/method used/VBD/used in/IN/in a/DT/a particular/JJ/particular system/NN/system is/VBZ/is the/DT/the hardware/NN/hardware provided/NNP/provided. every/DT/every memory/NN/memory address/NN/address generated/VBD/generated by/IN/by the/DT/the cpu/NN/cpu must/MD/must be/VB/be checked/VBN/checked for/IN/for legality/NN/legality and/CC/and possibly/RB/possibly mapped/VBD/mapped to/TO/to a/DT/a physical/JJ/physical address/NNP/address. the/DT/the checking/NN/checking can/MD/can not/RB/not be/VB/be implemented/VBN/implemented /-NONE-/( efficiently/RB/efficiently /:/) in/IN/in software/NNP/software. hence/NN/hence /,/, we/PRP/we are/VBP/are constrained/VBN/constrained by/IN/by the/DT/the hardware/NN/hardware available/NNP/available. the/DT/the various/JJ/various memory-management/NN/memory-management algorithms/NNS/algorithms /:/( contiguous/JJ/contiguous allocation/NN/allocation /,/, paging/VBG/paging /,/, segmentation/NN/segmentation /,/, and/CC/and combinations/NNS/combinations of/IN/of paging/VBG/paging and/CC/and segmentation/NN/segmentation /:/) differ/NN/differ in/IN/in many/JJ/many aspects/NNP/aspects. in/IN/in comparing/NN/comparing different/NN/different memory-management/NN/memory-management strategies/NNS/strategies /,/, we/PRP/we use/VBP/use the/DT/the following/VBG/following considerations/NNS/considerations /:/: hardware/NN/hardware support/NNP/support. a/DT/a simple/JJ/simple base/NN/base register/NN/register or/CC/or a/DT/a base-limit/JJ/base-limit register/NN/register pair/NN/pair is/VBZ/is sufficient/JJ/sufficient for/IN/for the/DT/the single/NN/single- and/CC/and multiple-partition/NN/multiple-partition schemes/NNS/schemes /,/, whereas/IN/whereas paging/NN/paging and/CC/and segmentation/NN/segmentation need/VBP/need mapping/VBG/mapping tables/NNS/tables to/TO/to define/VB/define the/DT/the address/NN/address map/NNP/map. performance/NNP/performance. as/IN/as the/DT/the memory-management/JJ/memory-management algorithm/NN/algorithm becomes/VBZ/becomes more/JJR/more complex/JJ/complex /,/, the/DT/the time/NN/time required/VBN/required to/TO/to map/VB/map a/DT/a logical/JJ/logical address/NN/address to/TO/to a/DT/a physical/JJ/physical address/NN/address increases/NNP/increases. for/IN/for the/DT/the simple/JJ/simple systems/NNS/systems /,/, we/PRP/we need/VBP/need only/RB/only compare/JJ/compare or/CC/or add/JJ/add to/TO/to the/DT/the logical/JJ/logical address-operations/NNS/address-operations that/WDT/that are/VBP/are fast/NNP/fast. paging/VBG/paging and/CC/and segmentation/NN/segmentation can/MD/can be/VB/be as/RB/as fast/JJ/fast if/IN/if the/DT/the mapping/NN/mapping table/NN/table is/VBZ/is implemented/VBN/implemented in/IN/in fast/JJ/fast registers/NNP/registers. if/IN/if the/DT/the table/NN/table is/VBZ/is 350/CD/350 chapter/NN/chapter 8/CD/8 in/IN/in memory/NN/memory /,/, however/RB/however /,/, user/NN/user memory/NN/memory accesses/NNS/accesses can/MD/can be/VB/be degraded/VBN/degraded substantially/-NONE-/substantially. a/DT/a tlb/NN/tlb can/MD/can reduce/VB/reduce the/DT/the performance/NN/performance degradation/NN/degradation to/TO/to an/DT/an acceptable/JJ/acceptable level/NNP/level. fragmentation/NNP/fragmentation. a/DT/a multiprogrammed/VBN/multiprogrammed system/NN/system will/MD/will generally/RB/generally perform/VB/perform more/JJR/more efficiently/RB/efficiently if/IN/if it/PRP/it has/VBZ/has a/DT/a higher/JJR/higher level/NN/level of/IN/of multiprogramming/NNP/multiprogramming. for/IN/for a/DT/a given/VBN/given set/NN/set of/IN/of processes/NNS/processes /,/, we/PRP/we can/MD/can increase/VB/increase the/DT/the multiprogramming/NN/multiprogramming level/NN/level only/RB/only by/IN/by packing/NN/packing more/JJR/more processes/NNS/processes into/IN/into memory/NNP/memory. to/TO/to accomplish/VB/accomplish this/DT/this task/NN/task /,/, we/PRP/we must/MD/must reduce/VB/reduce memory/NN/memory waste/NN/waste /,/, or/CC/or fragmentation/NNP/fragmentation. systems/NNS/systems with/IN/with fixed-sized/JJ/fixed-sized allocation/NN/allocation units/NNS/units /,/, such/JJ/such as/IN/as the/DT/the single-partition/NN/single-partition scheme/NN/scheme and/CC/and paging/VBG/paging /,/, suffer/NN/suffer from/IN/from internal/JJ/internal fragmentation/NNP/fragmentation. systems/NNS/systems with/IN/with variable-sized/JJ/variable-sized allocation/NN/allocation units/NNS/units /,/, such/JJ/such as/IN/as the/DT/the multiple-partition/NN/multiple-partition scheme/NN/scheme and/CC/and segmentation/NN/segmentation /,/, suffer/VBP/suffer from/IN/from external/JJ/external fragmentation/NNP/fragmentation. relocation/NNP/relocation. one/CD/one solution/NN/solution to/TO/to the/DT/the external-fragmentation/NN/external-fragmentation problem/NN/problem is/VBZ/is compaction/NNP/compaction. compaction/NN/compaction involves/VBZ/involves shifting/VBG/shifting a/DT/a program/NN/program in/IN/in memory/NN/memory in/IN/in such/JJ/such a/DT/a way/NN/way that/WDT/that the/DT/the program/NN/program does/VBZ/does not/RB/not notice/VB/notice the/DT/the change/NNP/change. this/DT/this consideration/NN/consideration requires/VBZ/requires that/IN/that logical/JJ/logical addresses/NNS/addresses be/VB/be relocated/VBN/relocated dynamically/RB/dynamically /,/, at/IN/at execution/NN/execution time/NNP/time. if/IN/if addresses/NNS/addresses are/VBP/are relocated/VBN/relocated only/RB/only at/IN/at load/NN/load time/NN/time /,/, we/PRP/we can/MD/can not/RB/not compact/VB/compact storage/NNP/storage. swapping/NNP/swapping. swapping/NN/swapping can/MD/can be/VB/be added/VBN/added to/TO/to any/DT/any algorithm/NNP/algorithm. at/IN/at intervals/NNS/intervals determined/VBN/determined by/IN/by the/DT/the operating/NN/operating system/NN/system /,/, usually/RB/usually dictated/VBN/dictated by/IN/by cpu-scheduling/JJ/cpu-scheduling policies/NNS/policies /,/, processes/NNS/processes are/VBP/are copied/VBN/copied from/IN/from main/JJ/main memory/NN/memory to/TO/to a/DT/a backing/NN/backing store/NN/store and/CC/and later/JJ/later are/VBP/are copied/VBN/copied back/RB/back to/TO/to main/VB/main memory/NNP/memory. this/DT/this scheme/NN/scheme allows/VBZ/allows more/JJR/more processes/NNS/processes to/TO/to be/VB/be run/VBN/run than/IN/than can/MD/can be/VB/be fit/VBN/fit into/IN/into memory/NN/memory at/IN/at one/CD/one time/NNP/time. sharing/NNP/sharing. another/DT/another means/VBZ/means of/IN/of increasing/VBG/increasing the/DT/the multiprogramming/NN/multiprogramming level/NN/level is/VBZ/is to/TO/to share/VB/share code/NN/code and/CC/and data/NNS/data among/IN/among different/JJ/different users/NNP/users. sharing/NN/sharing generally/RB/generally requires/VBZ/requires that/IN/that either/DT/either paging/VBG/paging or/CC/or segmentation/NN/segmentation be/VB/be used/VBN/used to/TO/to provide/VB/provide small/JJ/small packets/NNS/packets of/IN/of information/NN/information /:/( pages/NNS/pages or/CC/or segments/NNS/segments /:/) that/IN/that can/MD/can be/VB/be shared/NNP/shared. sharing/NN/sharing is/VBZ/is a/DT/a means/VBZ/means of/IN/of running/VBG/running many/JJ/many processes/NNS/processes with/IN/with a/DT/a limited/VBN/limited amount/NN/amount of/IN/of memory/NN/memory /,/, but/CC/but shared/VBD/shared programs/NNS/programs and/CC/and data/NNS/data must/MD/must be/VB/be designed/VBN/designed carefully/-NONE-/carefully. protection/NNP/protection. if/IN/if paging/VBG/paging or/CC/or segmentation/NN/segmentation is/VBZ/is provided/VBN/provided /,/, different/JJ/different sections/NNS/sections of/IN/of a/DT/a user/NN/user program/NN/program can/MD/can be/VB/be declared/VBN/declared execute-only/JJ/execute-only /,/, read/JJ/read -only/JJ/-only /,/, or/CC/or read-write/NNP/read-write. this/DT/this restriction/NN/restriction is/VBZ/is necessary/JJ/necessary with/IN/with shared/JJ/shared code/NN/code or/CC/or data/NNS/data and/CC/and is/VBZ/is generally/RB/generally useful/JJ/useful in/IN/in any/DT/any case/NN/case to/TO/to provide/VB/provide simple/JJ/simple run-time/JJ/run-time checks/NNS/checks for/IN/for common/JJ/common programming/NN/programming errors/NNP/errors. 8.1/CD/8.1 explain/NN/explain the/DT/the difference/NN/difference between/IN/between internal/JJ/internal and/CC/and external/JJ/external fragmentation/NNP/fragmentation. 8.2/CD/8.2 compare/NN/compare the/DT/the memory/NN/memory organization/NN/organization schemes/VBZ/schemes of/IN/of contiguous/JJ/contiguous memory/NN/memory allocation/NN/allocation /,/, pure/NN/pure segmentation/NN/segmentation /,/, and/CC/and pure/NN/pure paging/VBG/paging with/IN/with respect/NN/respect to/TO/to the/DT/the following/VBG/following issues/NNS/issues /:/: a/NNP/a. external/JJ/external fragmentation/NN/fragmentation b/NNP/b. internal/JJ/internal fragmentation/NN/fragmentation c/NNP/c. ability/NN/ability to/TO/to share/VB/share code/NN/code across/IN/across processes/NNS/processes 351/CD/351 8.3/CD/8.3 why/WRB/why are/VBP/are segmentation/NN/segmentation and/CC/and paging/VBG/paging sometimes/RB/sometimes combined/VBN/combined into/IN/into one/CD/one scheme/NN/scheme 8.4/CD/8.4 most/JJS/most systems/NNS/systems allow/VBP/allow a/DT/a program/NN/program to/TO/to allocate/VB/allocate more/JJR/more memory/NN/memory to/TO/to its/PRP$/its address/NN/address space/NN/space during/IN/during execution/NNP/execution. allocation/NN/allocation of/IN/of data/NNS/data in/IN/in the/DT/the heap/NN/heap segments/NNS/segments of/IN/of programs/NNS/programs is/VBZ/is an/DT/an example/NN/example of/IN/of such/JJ/such allocated/JJ/allocated memory/NNP/memory. what/WP/what is/VBZ/is required/VBN/required to/TO/to support/VB/support dynamic/JJ/dynamic memory/NN/memory allocation/NN/allocation in/IN/in the/DT/the following/JJ/following schemes/NNS/schemes a/NNP/a. contiguous/JJ/contiguous memory/NN/memory allocation/NN/allocation b/NNP/b. pure/NN/pure segmentation/NN/segmentation c/NNP/c. pure/NN/pure paging/VBG/paging 8.5/CD/8.5 consider/NN/consider the/DT/the intel/NN/intel address-translation/NN/address-translation scheme/NN/scheme shown/NN/shown in/IN/in figure/NN/figure 8.22/CD/8.22. a/NNP/a. describe/NN/describe all/DT/all the/DT/the steps/NNS/steps taken/VBN/taken by/IN/by the/DT/the intel/NN/intel pentium/NN/pentium in/IN/in translatil/NN/translatil g/NN/g a/DT/a logical/JJ/logical address/NN/address into/IN/into a/DT/a physical/JJ/physical address/NNP/address. b/NNP/b. what/WP/what are/VBP/are the/DT/the advantages/NNS/advantages to/TO/to the/DT/the operating/NN/operating system/NN/system of/IN/of hardware/NN/hardware that/IN/that provides/VBZ/provides such/JJ/such complicated/JJ/complicated memory/NN/memory translation/NN/translation c/NNP/c. are/VBP/are there/RB/there any/DT/any disadvantages/NNS/disadvantages to/TO/to this/DT/this address-translation/NN/address-translation system/NN/system if/IN/if so/RB/so /,/, what/WDT/what are/VBP/are they/PRP/they if/IN/if not/RB/not /,/, why/WRB/why is/VBZ/is this/DT/this scheme/NN/scheme not/RB/not used/VBN/used by/IN/by every/DT/every manufacturer/NN/manufacturer 8.6/CD/8.6 what/WP/what is/VBZ/is the/DT/the purpose/NN/purpose of/IN/of paging/VBG/paging the/DT/the page/NN/page tables/NNS/tables 8.7/CD/8.7 explain/NN/explain why/WRB/why sharil/NN/sharil g/NN/g a/DT/a reentrant/NN/reentrant module/NN/module is/VBZ/is easier/JJR/easier when/WRB/when segmentation/NN/segmentation is/VBZ/is used/VBN/used than/IN/than when/WRB/when pure/NN/pure paging/VBG/paging is/VBZ/is used/NNP/used. 8.8/CD/8.8 on/IN/on a/DT/a system/NN/system with/IN/with paging/NN/paging /,/, a/DT/a process/NN/process can/MD/can not/RB/not access/VB/access memory/NN/memory that/WDT/that it/PRP/it does/VBZ/does not/RB/not own/NNP/own. why/WRB/why how/WRB/how could/MD/could the/DT/the operating/NN/operating system/NN/system allow/NN/allow access/NN/access to/TO/to other/JJ/other memory/NN/memory why/WRB/why should/MD/should it/PRP/it or/CC/or should/MD/should it/PRP/it not/RB/not 8.9/CD/8.9 compare/NN/compare the/DT/the segmented/VBN/segmented pagil/NN/pagil g/NN/g scheme/NN/scheme with/IN/with the/DT/the hashed/JJ/hashed page/NN/page table/NN/table scheme/NN/scheme for/IN/for handling/NN/handling large/JJ/large address/NN/address spaces/NNP/spaces. under/IN/under what/WP/what circumstances/NNS/circumstances is/VBZ/is one/CD/one scheme/NN/scheme preferable/JJ/preferable to/TO/to the/DT/the other/JJ/other 8.10/CD/8.10 consider/NN/consider a/DT/a paging/NN/paging system/NN/system with/IN/with the/DT/the page/NN/page table/NN/table stored/VBD/stored in/IN/in memory/NNP/memory. a/NNP/a. if/IN/if a/DT/a memory/NN/memory reference/NN/reference takes/VBZ/takes 200/CD/200 nanoseconds/NNS/nanoseconds /,/, how/WRB/how long/JJ/long does/VBZ/does a/DT/a paged/JJ/paged memory/NN/memory reference/NN/reference take/VB/take b/NNP/b. if/IN/if we/PRP/we add/VBP/add tlbs/NNS/tlbs /,/, and/CC/and 75/CD/75 percent/NN/percent of/IN/of all/DT/all page-table/JJ/page-table references/NNS/references are/VBP/are found/VBN/found in/IN/in the/DT/the tlbs/NNS/tlbs /,/, what/WP/what is/VBZ/is the/DT/the effective/JJ/effective memory/NN/memory reference/NN/reference time/NN/time /:/( assume/NN/assume that/IN/that finding/NN/finding a/DT/a page-table/JJ/page-table entry/NN/entry in/IN/in the/DT/the tlbs/NNS/tlbs takes/VBZ/takes zero/NN/zero time/NN/time /,/, if/IN/if the/DT/the entry/NN/entry is/VBZ/is there/NNP/there. /:/) 352/CD/352 chapter/NN/chapter 8/CD/8 8.11/CD/8.11 compare/NN/compare paging/VBG/paging with/IN/with segmentation/NN/segmentation with/IN/with respect/NN/respect to/TO/to the/DT/the amount/NN/amount of/IN/of memory/NN/memory required/VBN/required by/IN/by the/DT/the address/NN/address translation/NN/translation structures/NNS/structures in/IN/in order/NN/order to/TO/to convert/VB/convert virtual/JJ/virtual addresses/NNS/addresses to/TO/to physical/JJ/physical addresses/NNP/addresses. 8.12/CD/8.12 consider/NN/consider a/DT/a system/NN/system in/IN/in which/WDT/which a/DT/a program/NN/program can/MD/can be/VB/be separated/VBN/separated into/IN/into two/CD/two parts/NNS/parts /:/: code/NN/code and/CC/and data/NNP/data. the/DT/the cpu/NN/cpu knows/VBZ/knows whether/IN/whether it/PRP/it wants/VBZ/wants an/DT/an instruction/NN/instruction /:/( instruction/NN/instruction fetch/NN/fetch /:/) or/CC/or data/NNS/data /:/( data/NNS/data fetch/VBP/fetch or/CC/or store/JJR/store /:/) /./. therefore/RB/therefore /,/, two/CD/two baselimit/NN/baselimit register/NN/register pairs/NNS/pairs are/VBP/are provided/VBN/provided /:/: one/CD/one for/IN/for instructions/NNS/instructions and/CC/and one/CD/one for/IN/for data/NNP/data. the/DT/the instruction/NN/instruction base-limit/NN/base-limit register/NN/register pair/NN/pair is/VBZ/is automatically/RB/automatically read-only/RB/read-only /,/, so/RB/so programs/NNS/programs can/MD/can be/VB/be shared/VBN/shared among/IN/among different/JJ/different users/NNP/users. discuss/NN/discuss the/DT/the advantages/NNS/advantages and/CC/and disadvantages/NNS/disadvantages of/IN/of this/DT/this scheme/NNP/scheme. 8.13/CD/8.13 consider/NN/consider the/DT/the following/VBG/following process/NN/process for/IN/for generating/NN/generating binaries/NNP/binaries. a/DT/a compiler/NN/compiler is/VBZ/is used/VBN/used to/TO/to generate/VB/generate the/DT/the object/NN/object code/NN/code for/IN/for individual/JJ/individual modules/NNS/modules /,/, and/CC/and a/DT/a linkage/NN/linkage editor/NN/editor is/VBZ/is used/VBN/used to/TO/to combine/VB/combine multiple/NN/multiple object/NN/object modules/NNS/modules into/IN/into a/DT/a single/JJ/single program/NN/program bilcary/NNP/bilcary. how/WRB/how does/VBZ/does the/DT/the linkage/NN/linkage editor/NN/editor change/NN/change the/DT/the bindmg/NN/bindmg of/IN/of instructions/NNS/instructions and/CC/and data/NNS/data to/TO/to memory/NN/memory addresses/NNS/addresses what/WP/what information/NN/information needs/VBZ/needs to/TO/to be/VB/be passed/VBN/passed from/IN/from the/DT/the compiler/NN/compiler to/TO/to the/DT/the linkage/NN/linkage editor/NN/editor to/TO/to facilitate/VB/facilitate the/DT/the memory-binding/JJ/memory-binding tasks/NNS/tasks of/IN/of the/DT/the linkage/NN/linkage editor/NN/editor 8.14/CD/8.14 consider/NN/consider a/DT/a logical/JJ/logical address/NN/address space/NN/space of/IN/of 64/CD/64 pages/NNS/pages of/IN/of 1,024/CD/1,024 words/NNS/words each/DT/each /,/, mapped/VBD/mapped onto/IN/onto a/DT/a physical/JJ/physical memory/NN/memory of/IN/of 32/CD/32 frames/NNP/frames. a/NNP/a. how/WRB/how many/JJ/many bits/NNS/bits are/VBP/are there/RB/there in/IN/in the/DT/the logical/JJ/logical address/NN/address b/NNP/b. how/WRB/how many/JJ/many bits/NNS/bits are/VBP/are there/RB/there in/IN/in the/DT/the physical/JJ/physical address/NN/address 8.15/CD/8.15 consider/NN/consider the/DT/the hierarchical/JJ/hierarchical paging/NN/paging scheme/NN/scheme used/VBD/used by/IN/by the/DT/the vax/NN/vax architecture/NNP/architecture. how/WRB/how many/JJ/many memory/NN/memory operations/NNS/operations are/VBP/are performed/VBN/performed when/WRB/when a/DT/a user/NN/user program/NN/program executes/NNS/executes a/DT/a memory-load/JJ/memory-load operation/NN/operation 8.16/CD/8.16 given/VBN/given five/CD/five memory/NN/memory partitions/NNS/partitions of/IN/of 100/CD/100 kb/NN/kb /,/, 500/CD/500 kb/NN/kb /,/, 200/CD/200 kb/NN/kb /,/, 300/CD/300 kb/NN/kb /,/, and/CC/and 600/CD/600 kb/NN/kb /:/( ill/NN/ill order/NN/order /:/) /,/, how/WRB/how would/MD/would the/DT/the first-fit/JJ/first-fit /,/, best-fit/JJ/best-fit /,/, and/CC/and worst-fit/JJ/worst-fit algorithms/NNS/algorithms place/NN/place processes/NNS/processes of/IN/of 212/CD/212 kb/NN/kb /,/, 417/CD/417 kb/NN/kb /,/, 112/CD/112 kb/NN/kb /,/, and/CC/and 426/CD/426 kb/NN/kb /:/( in/IN/in order/NN/order /:/) which/WDT/which algorithm/NN/algorithm makes/VBZ/makes the/DT/the most/RBS/most efficient/JJ/efficient use/NN/use of/IN/of memory/NN/memory 8.17/CD/8.17 describe/NN/describe a/DT/a mechanism/NN/mechanism by/IN/by which/WDT/which one/CD/one segment/NN/segment could/MD/could belong/VB/belong to/TO/to the/DT/the address/NN/address space/NN/space of/IN/of two/CD/two different/JJ/different processes/NNP/processes. 8.18/CD/8.18 consider/NN/consider a/DT/a computer/NN/computer system/NN/system with/IN/with a/DT/a 32-bit/JJ/32-bit logical/JJ/logical address/NN/address and/CC/and 4-kb/CD/4-kb page/NN/page size/NNP/size. the/DT/the system/NN/system supports/NNS/supports up/IN/up to/TO/to 512mb/CD/512mb of/IN/of physical/JJ/physical memory/NNP/memory. how/WRB/how many/JJ/many entries/NNS/entries are/VBP/are there/RB/there in/IN/in each/DT/each of/IN/of the/DT/the following/JJ/following a/NNP/a. a/DT/a conventional/JJ/conventional single-level/NN/single-level page/NN/page table/NN/table b/NNP/b. an/DT/an inverted/JJ/inverted page/NN/page table/NN/table 353/CD/353 8.19/CD/8.19 assuming/VBG/assuming a/DT/a 1-kb/CD/1-kb page/NN/page size/NN/size /,/, what/WP/what are/VBP/are the/DT/the page/NN/page numbers/NNS/numbers and/CC/and offsets/NNS/offsets for/IN/for the/DT/the following/VBG/following address/NN/address references/NNS/references /:/( provided/VBN/provided as/IN/as decimal/JJ/decimal numbers/NNS/numbers /:/) /:/: a/NNP/a. 2375/CD/2375 b/NNP/b. 19366/CD/19366 c/NNP/c. 30000/CD/30000 d/NNP/d. 256/CD/256 e/NNP/e. 16385/CD/16385 8.20/CD/8.20 program/NN/program binaries/NNS/binaries in/IN/in many/JJ/many systems/NNS/systems are/VBP/are typically/RB/typically structured/VBN/structured as/IN/as follows/NNP/follows. code/NN/code is/VBZ/is stored/VBN/stored starting/VBG/starting with/IN/with a/DT/a small/JJ/small /,/, fixed/VBN/fixed virtual/JJ/virtual address/NN/address /,/, such/JJ/such as/IN/as 0/CD/0. the/DT/the code/NN/code segment/NN/segment is/VBZ/is followed/VBN/followed by/IN/by the/DT/the data/NNS/data segment/NN/segment that/IN/that is/VBZ/is used/VBN/used for/IN/for storing/NN/storing the/DT/the program/NN/program variables/NNP/variables. when/WRB/when the/DT/the program/NN/program starts/VBZ/starts executing/VBG/executing /,/, the/DT/the stack/NN/stack is/VBZ/is allocated/VBN/allocated at/IN/at the/DT/the other/JJ/other end/NN/end of/IN/of the/DT/the virtual/JJ/virtual address/NN/address space/NN/space and/CC/and is/VBZ/is allowed/VBN/allowed to/TO/to grow/VB/grow toward/IN/toward lower/JJR/lower virtual/JJ/virtual addresses/NNP/addresses. what/WP/what is/VBZ/is the/DT/the significance/NN/significance of/IN/of this/DT/this structure/NN/structure for/IN/for the/DT/the following/VBG/following schemes/NNS/schemes a/NNP/a. contiguous/JJ/contiguous memory/NN/memory allocation/NN/allocation b/NNP/b. pure/NN/pure segmentation/NN/segmentation c/NNP/c. pure/NN/pure paging/VBG/paging 8.21/CD/8.21 consider/NN/consider the/DT/the following/VBG/following segment/NN/segment table/NN/table /:/: segment/NN/segment base/NN/base length/NN/length 0/-NONE-/0 219/CD/219 600/CD/600 1/CD/1 2300/CD/2300 14/CD/14 2/CD/2 90/CD/90 100/CD/100 3/CD/3 1327/CD/1327 580/CD/580 4/CD/4 1952/CD/1952 96/CD/96 what/WP/what are/VBP/are the/DT/the physical/JJ/physical addresses/NNS/addresses for/IN/for the/DT/the following/VBG/following logical/JJ/logical addresses/NNS/addresses a/NNP/a. 0,430/CD/0,430 b/NNP/b. 1,10/CD/1,10 c/NNP/c. 2,500/CD/2,500 d/NNP/d. 3,400/CD/3,400 e/NNP/e. 4,112/CD/4,112 8.22/CD/8.22 consider/NN/consider a/DT/a logical/JJ/logical address/NN/address space/NN/space of/IN/of 32/CD/32 pages/NNS/pages with/IN/with 1,024/CD/1,024 words/NNS/words per/IN/per page/NN/page /,/, mapped/VBD/mapped onto/IN/onto a/DT/a physical/JJ/physical memory/NN/memory of/IN/of 16/CD/16 frames/NNP/frames. a/NNP/a. how/WRB/how many/JJ/many bits/NNS/bits are/VBP/are required/VBN/required in/NNP/in. the/DT/the logical/JJ/logical address/NN/address b/NNP/b. how/WRB/how many/JJ/many bits/NNS/bits are/VBP/are required/VBN/required in/IN/in the/DT/the physical/JJ/physical address/NN/address 354/CD/354 chapter/NN/chapter 8/CD/8 8.23/CD/8.23 sharing/NN/sharing segments/NNS/segments among/IN/among processes/NNS/processes without/IN/without requiring/VBG/requiring that/IN/that they/PRP/they have/VBP/have the/DT/the same/JJ/same segment/NN/segment number/NN/number is/VBZ/is possible/JJ/possible in/IN/in a/DT/a dynamically/RB/dynamically linked/VBN/linked segmentation/NN/segmentation system/NNP/system. a/NNP/a. define/NN/define a/DT/a system/NN/system that/WDT/that allows/VBZ/allows static/JJ/static linking/NN/linking and/CC/and sharing/VBG/sharing of/IN/of segments/NNS/segments without/IN/without requiring/VBG/requiring that/IN/that the/DT/the segment/NN/segment numbers/NNS/numbers be/VB/be the/DT/the same/NNP/same. b/NNP/b. describe/NN/describe a/DT/a paging/NN/paging scheme/NN/scheme that/WDT/that allows/VBZ/allows pages/NNS/pages to/TO/to be/VB/be shared/VBN/shared without/IN/without requiring/NN/requiring that/IN/that the/DT/the page/NN/page numbers/NNS/numbers be/VB/be the/DT/the same/NNP/same. 8.24/CD/8.24 assume/NN/assume that/WDT/that a/DT/a system/NN/system has/VBZ/has a/DT/a 32-bit/JJ/32-bit virtual/JJ/virtual address/NN/address with/IN/with a/DT/a 4-kb/CD/4-kb page/NN/page size/NNP/size. write/NN/write a/DT/a c/NN/c program/NN/program that/WDT/that is/VBZ/is passed/VBN/passed a/DT/a virtual/JJ/virtual address/NN/address /:/( in/IN/in decincal/JJ/decincal /NN/) on/IN/on the/DT/the command/NN/command line/NN/line and/CC/and have/VB/have it/PRP/it output/VB/output the/DT/the page/NN/page number/NN/number and/CC/and offset/VB/offset for/IN/for the/DT/the given/VBN/given address/NNP/address. as/IN/as an/DT/an example/NN/example /,/, your/PRP$/your program/NN/program would/MD/would run/VB/run as/IN/as follows/NNS/follows /:/: ./a.out/IN/./a.out 19986/CD/19986 your/PRP$/your program/NN/program would/MD/would output/VB/output /:/: the/DT/the address/NN/address 19986/CD/19986 contains/NNS/contains /:/: page/NN/page number/NN/number =/:/= 4/CD/4 offset/NN/offset =/:/= 3602/CD/3602 writing/VBG/writing this/DT/this program/NN/program will/MD/will require/VB/require using/VBG/using the/DT/the appropriate/NN/appropriate data/NNS/data type/NN/type to/TO/to store/VB/store 32/CD/32 bits/NNP/bits. we/PRP/we encourage/VBP/encourage you/PRP/you to/TO/to use/VB/use unsigned/VBN/unsigned data/NNS/data types/NNS/types as/IN/as well/NNP/well. dynamic/JJ/dynamic storage/NN/storage allocation/NN/allocation was/VBD/was discussed/VBN/discussed by/IN/by knuth/NN/knuth /:/[ 1973/CD/1973 /CD/] /CD/( section/NN/section 2.5/CD/2.5 /CD/) /,/, who/WP/who found/VBN/found through/IN/through simulation/NN/simulation results/NNS/results that/WDT/that first/JJ/first fit/NN/fit is/VBZ/is generally/RB/generally superior/JJ/superior to/TO/to best/JJS/best fit/NNP/fit. knuth/NN/knuth /:/[ 1973/CD/1973 /CD/] also/RB/also discussed/VBD/discussed the/DT/the 50-percent/JJ/50-percent rule/NNP/rule. the/DT/the concept/NN/concept of/IN/of paging/VBG/paging can/MD/can be/VB/be credited/VBN/credited to/TO/to the/DT/the designers/NNS/designers of/IN/of the/DT/the atlas/NNS/atlas system/NN/system /,/, which/WDT/which has/VBZ/has been/VBN/been described/VBN/described by/IN/by kilburn/NN/kilburn et/NN/et al/NNP/al. /NNP/[ 1961/CD/1961 /CD/] and/CC/and by/IN/by howarth/JJ/howarth et/NN/et al/NNP/al. /NNP/[ 1961/CD/1961 /CD/] /./. the/DT/the concept/NN/concept of/IN/of segmentation/NN/segmentation was/VBD/was first/JJ/first discussed/VBN/discussed by/IN/by dennis/NNS/dennis /:/[ 1965/CD/1965 /CD/] /./. paged/JJ/paged segmentation/NN/segmentation was/VBD/was first/JJ/first supported/VBN/supported in/IN/in the/DT/the ge/NN/ge 645/CD/645 /,/, on/IN/on which/WDT/which multics/NNS/multics was/VBD/was originally/RB/originally implemented/VBN/implemented /-NONE-/( organick/NN/organick /:/[ 1972/CD/1972 /CD/] and/CC/and daley/NN/daley and/CC/and dennis/VBZ/dennis /:/[ 1967/CD/1967 /CD/] /CD/) /./. inverted/VBN/inverted page/NN/page tables/NNS/tables are/VBP/are discussed/VBN/discussed in/IN/in an/DT/an article/NN/article about/IN/about the/DT/the ibm/NN/ibm rt/NN/rt storage/NN/storage manager/NN/manager by/IN/by chang/NN/chang and/CC/and mergen/NN/mergen /:/[ 1988/CD/1988 /CD/] /./. address/NN/address translation/NN/translation in/IN/in software/NN/software is/VBZ/is covered/VBN/covered in/IN/in jacob/NN/jacob and/CC/and mudge/NN/mudge /:/[ 1997/CD/1997 /CD/] /./. hennessy/NN/hennessy and/CC/and patterson/NN/patterson /:/[ 2002/CD/2002 /CD/] explains/NNS/explains the/DT/the hardware/NN/hardware aspects/NNS/aspects of/IN/of tlbs/NNS/tlbs /,/, caches/NNS/caches /,/, and/CC/and mmus/NNP/mmus. talluri/NN/talluri et/NN/et al/NNP/al. /NNP/[ 1995/CD/1995 /CD/] discusses/NNS/discusses page/NN/page tables/NNS/tables for/IN/for 64-bit/JJ/64-bit address/NN/address spaces/NNP/spaces. alternative/NN/alternative approaches/VBZ/approaches to/TO/to enforcing/VBG/enforcing memory/NN/memory protection/NN/protection are/VBP/are proposed/VBN/proposed and/CC/and studied/VBD/studied in/IN/in wahbe/NN/wahbe et/NN/et al/NNP/al. /NNP/[ 1993a/CD/1993a /CD/] /,/, chase/NN/chase et/NN/et al/NNP/al. /NNP/[ 1994/CD/1994 /CD/] /,/, bershad/VBD/bershad et/NN/et al/NNP/al. /NNP/[ 1995/CD/1995 /CD/] /,/, and/CC/and thorn/NN/thorn /:/[ 1997/CD/1997 /CD/] /./. dougan/NN/dougan et/NN/et al/NNP/al. /NNP/[ 1999/CD/1999 /CD/] and/CC/and jacob/NN/jacob and/CC/and mudge/NN/mudge /:/[ 2001/CD/2001 /CD/] discuss/NNS/discuss 355/CD/355 tedmiques/NNS/tedmiques for/IN/for managing/VBG/managing the/DT/the tlb/NNP/tlb. fang/NN/fang et/NN/et al/NNP/al. /NNP/[ 2001/CD/2001 /CD/] evaluate/NN/evaluate support/NN/support for/IN/for large/JJ/large pages/NNP/pages. tanenbaum/NN/tanenbaum /:/[ 2001/CD/2001 /CD/] discusses/NNS/discusses intel80386/NNP/intel80386 paging/NNP/paging. memory/NN/memory management/NN/management for/IN/for several/JJ/several architectures-such/JJ/architectures-such as/IN/as the/DT/the pentiunl/NN/pentiunl ii/NN/ii /,/, powerpc/NN/powerpc /,/, and/CC/and ultrasparcare/NN/ultrasparcare described/VBD/described by/IN/by jacob/NN/jacob and/CC/and mudge/NN/mudge /:/[ 1998a/CD/1998a /CD/] /./. segmentation/NN/segmentation on/IN/on lim1x/NNP/lim1x systems/NNS/systems is/VBZ/is presented/VBN/presented in/IN/in bovet/NN/bovet and/CC/and cesati/NN/cesati /:/[ 2002/CD/2002 /CD/] /./. 9.1/CD/9.1 c/NN/c er/NN/er in/IN/in chapter/NN/chapter 8/CD/8 /,/, we/PRP/we discussed/VBD/discussed various/JJ/various memory-management/JJ/memory-management strategies/NNS/strategies used/VBN/used in/IN/in computer/NN/computer systems/NNP/systems. all/DT/all these/DT/these strategies/NNS/strategies have/VBP/have the/DT/the same/JJ/same goal/NN/goal /:/: to/TO/to keep/VB/keep many/JJ/many processes/NNS/processes in/IN/in memory/NN/memory simultaneously/RB/simultaneously to/TO/to allow/VB/allow multiprogramming/NNP/multiprogramming. however/RB/however /,/, they/PRP/they tend/VBP/tend to/TO/to require/VB/require that/IN/that an/DT/an entire/JJ/entire process/NN/process be/VB/be in/IN/in memory/NN/memory before/IN/before it/PRP/it can/MD/can execute/NNP/execute. virtual/JJ/virtual memory/NN/memory is/VBZ/is a/DT/a tecrucique/NN/tecrucique that/WDT/that allows/VBZ/allows the/DT/the execution/NN/execution of/IN/of processes/NNS/processes that/WDT/that are/VBP/are not/RB/not completely/RB/completely in/IN/in memory/NNP/memory. one/CD/one major/JJ/major advantage/NN/advantage of/IN/of this/DT/this scheme/NN/scheme is/VBZ/is that/IN/that programs/NNS/programs can/MD/can be/VB/be larger/JJR/larger than/IN/than physical/JJ/physical memory/NNP/memory. further/RB/further /,/, virtual/JJ/virtual memory/NN/memory abstracts/NNS/abstracts main/JJ/main memory/NN/memory into/IN/into an/DT/an extremely/RB/extremely large/JJ/large /,/, uniform/NN/uniform array/NN/array of/IN/of storage/NN/storage /,/, separating/VBG/separating logical/JJ/logical memory/NN/memory as/IN/as viewed/VBN/viewed by/IN/by the/DT/the user/NN/user from/IN/from physical/JJ/physical memory/NNP/memory. this/DT/this technique/NN/technique frees/VBZ/frees programmers/NNS/programmers from/IN/from the/DT/the concerns/NNS/concerns of/IN/of memory-storage/JJ/memory-storage limitations/NNP/limitations. virtual/JJ/virtual memory/NN/memory also/RB/also allows/VBZ/allows processes/NNS/processes to/TO/to share/VB/share files/NNS/files easily/RB/easily and/CC/and to/TO/to implement/VB/implement shared/VBN/shared memory/NNP/memory. in/IN/in addition/NN/addition /,/, it/PRP/it provides/VBZ/provides an/DT/an efficient/NN/efficient mechanism/NN/mechanism for/IN/for process/NN/process creation/NNP/creation. virtual/JJ/virtual memory/NN/memory is/VBZ/is not/RB/not easy/JJ/easy to/TO/to implement/NN/implement /,/, however/RB/however /,/, and/CC/and may/MD/may substantially/RB/substantially decrease/VB/decrease performance/NN/performance if/IN/if it/PRP/it is/VBZ/is used/VBN/used carelessly/-NONE-/carelessly. in/IN/in this/DT/this chapter/NN/chapter /,/, we/PRP/we discuss/VBP/discuss virtual/JJ/virtual memory/NN/memory in/IN/in the/DT/the form/NN/form of/IN/of demand/NN/demand paging/VBG/paging and/CC/and examine/NN/examine its/PRP$/its complexity/NN/complexity and/CC/and cost/NNP/cost. to/TO/to describe/VB/describe the/DT/the benefits/NNS/benefits of/IN/of a/DT/a virtual/JJ/virtual memory/NN/memory system/NNP/system. to/TO/to explain/VB/explain the/DT/the concepts/NNS/concepts of/IN/of demand/NN/demand paging/VBG/paging /,/, page-replacement/JJ/page-replacement algorithms/NNS/algorithms /,/, and/CC/and allocation/NN/allocation of/IN/of page/NN/page frames/NNP/frames. to/TO/to discuss/VB/discuss the/DT/the principles/NNS/principles of/IN/of the/DT/the working-set/JJ/working-set model/NNP/model. the/DT/the memory-management/JJ/memory-management algorithms/NNS/algorithms outlined/VBN/outlined in/IN/in chapter/NN/chapter 8/CD/8 are/VBP/are necessary/JJ/necessary because/IN/because of/IN/of one/CD/one basic/JJ/basic requirement/NN/requirement /:/: the/DT/the instructions/NNS/instructions being/VBG/being executed/VBN/executed must/MD/must be/VB/be in/IN/in physical/JJ/physical memory/NNP/memory. the/DT/the first/JJ/first approach/NN/approach to/TO/to meeting/NN/meeting this/DT/this requirement/NN/requirement is/VBZ/is to/TO/to place/NN/place the/DT/the entire/JJ/entire logical/JJ/logical address/NN/address space/NN/space in/IN/in physical/JJ/physical memory/NNP/memory. dynamic/JJ/dynamic loading/NN/loading can/MD/can help/VB/help to/TO/to ease/VB/ease this/DT/this restriction/NN/restriction /,/, but/CC/but it/PRP/it generally/RB/generally requires/VBZ/requires special/JJ/special precautions/NNS/precautions and/CC/and extra/JJ/extra work/NN/work by/IN/by the/DT/the programmer/NNP/programmer. 357/CD/357 358/CD/358 chapter/NN/chapter 9/CD/9 the/DT/the requirement/NN/requirement that/IN/that instructions/NNS/instructions m.ust/JJ/m.ust be/VB/be in/IN/in physical/JJ/physical memory/NN/memory to/TO/to be/VB/be executed/VBN/executed seems/NNS/seems both/DT/both necessary/JJ/necessary and/CC/and reasonable/JJ/reasonable ;/:/; but/CC/but it/PRP/it is/VBZ/is also/RB/also unfortunate/JJ/unfortunate /,/, since/IN/since it/PRP/it limits/VBZ/limits the/DT/the size/NN/size of/IN/of a/DT/a program/NN/program to/TO/to the/DT/the size/NN/size of/IN/of physical/JJ/physical memory/NNP/memory. in/IN/in fact/NN/fact /,/, an/DT/an examination/NN/examination of/IN/of real/JJ/real programs/NNS/programs shows/VBZ/shows us/PRP/us that/IN/that /,/, in/IN/in many/JJ/many cases/NNS/cases /,/, the/DT/the entire/JJ/entire program/NN/program is/VBZ/is not/RB/not needed/NNP/needed. for/IN/for instance/NN/instance /,/, consider/NN/consider the/DT/the following/VBG/following /:/: programs/NNS/programs often/RB/often have/VBP/have code/VBN/code to/TO/to handle/VB/handle unusual/JJ/unusual error/NN/error conditions/NNP/conditions. since/IN/since these/DT/these errors/NNS/errors seldom/VBP/seldom /,/, if/IN/if ever/RB/ever /,/, occur/VBP/occur in/IN/in practice/NN/practice /,/, this/DT/this code/NN/code is/VBZ/is almost/RB/almost never/RB/never executed/NNP/executed. arrays,lists/NNS/arrays,lists /,/, and/CC/and tables/NNS/tables are/VBP/are often/RB/often allocated/VBN/allocated more/RBR/more memory/JJ/memory than/IN/than they/PRP/they actually/RB/actually need/NNP/need. an/DT/an array/NN/array may/MD/may be/VB/be declared/VBN/declared 100/CD/100 by/IN/by 100/CD/100 elements/NNS/elements /,/, even/RB/even though/IN/though it/PRP/it is/VBZ/is seldom/IN/seldom larger/JJR/larger than/IN/than 10/CD/10 by/IN/by 10/CD/10 elements/NNP/elements. an/DT/an assembler/NN/assembler symbol/NN/symbol table/NN/table may/MD/may have/VB/have room/NN/room for/IN/for 3,000/CD/3,000 symbols/NNS/symbols /,/, although/IN/although the/DT/the average/NN/average program/NN/program has/VBZ/has less/JJR/less than/IN/than 200/CD/200 symbols/NNP/symbols. certain/JJ/certain options/NNS/options and/CC/and features/NNS/features of/IN/of a/DT/a program/NN/program may/MD/may be/VB/be used/VBN/used rarely/-NONE-/rarely. for/IN/for instance/NN/instance /,/, the/DT/the routines/NNS/routines on/IN/on u.s/NNP/u.s. government/NN/government computers/NNS/computers that/WDT/that balance/NN/balance the/DT/the budget/NN/budget have/VBP/have not/RB/not been/VBN/been used/VBN/used in/IN/in many/JJ/many years/NNP/years. even/RB/even in/IN/in those/DT/those cases/NNS/cases where/WRB/where the/DT/the entire/JJ/entire program/NN/program is/VBZ/is needed/VBN/needed /,/, it/PRP/it may/MD/may not/RB/not all/DT/all be/VB/be needed/VBN/needed at/IN/at the/DT/the same/JJ/same time/NNP/time. the/DT/the ability/NN/ability to/TO/to execute/VB/execute a/DT/a program/NN/program that/WDT/that is/VBZ/is only/RB/only partially/RB/partially in/IN/in memory/NN/memory would/MD/would confer/VB/confer many/JJ/many benefits/NNS/benefits /:/: a/DT/a program/NN/program would/MD/would no/RB/no longer/RBR/longer be/VB/be constrained/VBN/constrained by/IN/by the/DT/the amount/NN/amount of/IN/of physical/JJ/physical memory/NN/memory that/WDT/that is/VBZ/is available/NNP/available. users/NNS/users would/MD/would be/VB/be able/JJ/able to/TO/to write/VB/write programs/NNS/programs for/IN/for an/DT/an extremely/RB/extremely large/JJ/large virtual/JJ/virtual address/NN/address space/NN/space /,/, simplifying/VBG/simplifying the/DT/the programming/NN/programming task/NNP/task. page/NN/page 0/-NONE-/0 page/NN/page 1/CD/1 page/NN/page 2/CD/2 page/NN/page v/NN/v virtual/JJ/virtual memory/NN/memory memory/NN/memory map/NN/map physical/JJ/physical memory/NN/memory figure/NN/figure 9.1/CD/9.1 diagram/NN/diagram showing/VBG/showing virtual/JJ/virtual memory/NN/memory that/WDT/that is/VBZ/is larger/JJR/larger than/IN/than physical/JJ/physical memory/NNP/memory. 9.1/CD/9.1 359/CD/359 because/IN/because each/DT/each user/NN/user program/NN/program could/MD/could take/VB/take less/RBR/less physical/JJ/physical memory/NN/memory /,/, more/RBR/more programs/NNS/programs could/MD/could be/VB/be run/VBN/run at/IN/at the/DT/the sance/NN/sance time/NN/time /,/, with/IN/with a/DT/a corresponding/NN/corresponding increase/NN/increase in/IN/in cpu/NN/cpu utilization/NN/utilization and/CC/and throughput/VBD/throughput but/CC/but with/IN/with no/DT/no increase/NN/increase in/IN/in response/NN/response time/NN/time or/CC/or turnaround/NN/turnaround time/NNP/time. less/RBR/less i/o/JJ/i/o would/MD/would be/VB/be needed/VBN/needed to/TO/to load/VB/load or/CC/or swap/VB/swap user/NN/user programs/NNS/programs into/IN/into memory/NN/memory /,/, so/RB/so each/DT/each user/NN/user program/NN/program would/MD/would run/VB/run faster/NNP/faster. thus/RB/thus /,/, running/VBG/running a/DT/a program/NN/program that/WDT/that is/VBZ/is not/RB/not entirely/RB/entirely in/IN/in memory/NN/memory would/MD/would benefit/VB/benefit both/DT/both the/DT/the system/NN/system and/CC/and the/DT/the user/NNP/user. involves/VBZ/involves the/DT/the separation/NN/separation of/IN/of logical/JJ/logical memory/NN/memory as/IN/as perceived/VBN/perceived by/IN/by users/NNS/users from/IN/from physical/JJ/physical memory/NNP/memory. this/DT/this separation/NN/separation allows/VBZ/allows an/DT/an extremely/RB/extremely large/JJ/large virtual/JJ/virtual memory/NN/memory to/TO/to be/VB/be provided/VBN/provided for/IN/for programmers/NNS/programmers when/WRB/when only/RB/only a/DT/a smaller/JJR/smaller physical/JJ/physical memory/NN/memory is/VBZ/is available/JJ/available /NN/( figure/NN/figure 9.1/CD/9.1 /CD/) /./. virtual/JJ/virtual memory/NN/memory makes/VBZ/makes the/DT/the task/NN/task of/IN/of programming/NN/programming much/RB/much easier/JJR/easier /,/, because/IN/because the/DT/the programmer/NN/programmer no/DT/no longer/NN/longer needs/VBZ/needs to/TO/to worry/VB/worry about/IN/about the/DT/the amount/NN/amount of/IN/of physical/JJ/physical memory/NN/memory available/JJ/available ;/:/; she/PRP/she can/MD/can concentrate/VB/concentrate instead/RB/instead on/IN/on the/DT/the problem/NN/problem to/TO/to be/VB/be programmed/NNP/programmed. the/DT/the address/NN/address space/NN/space of/IN/of a/DT/a process/NN/process refers/NNS/refers to/TO/to the/DT/the logical/JJ/logical /NN/( or/CC/or virtual/JJ/virtual /NN/) view/NN/view of/IN/of how/WRB/how a/DT/a process/NN/process is/VBZ/is stored/VBN/stored in/IN/in memory/NNP/memory. typically/RB/typically /,/, this/DT/this view/NN/view is/VBZ/is that/IN/that a/DT/a process/NN/process begins/VBZ/begins at/IN/at a/DT/a certain/JJ/certain logical/JJ/logical address-say/NN/address-say /,/, address/NN/address 0-and/CD/0-and exists/NNS/exists in/IN/in contiguous/JJ/contiguous memory/NN/memory /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 9.2/CD/9.2. recall/NN/recall from/IN/from chapter/NN/chapter 8/CD/8 /,/, though/IN/though /,/, that/IN/that in/IN/in fact/NN/fact physical/JJ/physical memory/NN/memory may/MD/may be/VB/be organized/VBN/organized in/IN/in page/NN/page frames/NNS/frames and/CC/and that/IN/that the/DT/the physical/JJ/physical page/NN/page frames/VBZ/frames assigned/VBN/assigned to/TO/to a/DT/a process/NN/process may/MD/may not/RB/not be/VB/be contiguous/NNP/contiguous. it/PRP/it is/VBZ/is up/RP/up to/TO/to the/DT/the memorymanagement/NN/memorymanagement unit/NN/unit /:/( mmu/NN/mmu /:/) to/TO/to map/VB/map logical/JJ/logical pages/NNS/pages to/TO/to physical/JJ/physical page/NN/page frames/VBZ/frames in/IN/in memory/NNP/memory. note/NN/note in/IN/in figure/NN/figure 9.2/CD/9.2 that/WDT/that we/PRP/we allow/VBP/allow for/IN/for the/DT/the heap/NN/heap to/TO/to grow/VB/grow upward/JJ/upward in/IN/in memory/NN/memory as/IN/as it/PRP/it is/VBZ/is used/VBN/used for/IN/for dynamic/JJ/dynamic memory/NN/memory allocation/NNP/allocation. similarly/RB/similarly /,/, we/PRP/we allow/VBP/allow for/IN/for the/DT/the stack/NN/stack to/TO/to grow/VB/grow downward/JJ/downward in/IN/in memory/NN/memory through/IN/through successive/JJ/successive function/NN/function calls/NNP/calls. the/DT/the large/JJ/large blank/NN/blank space/NN/space /:/( or/CC/or hole/NN/hole /:/) between/IN/between the/DT/the heap/NN/heap and/CC/and the/DT/the stack/NN/stack is/VBZ/is part/NN/part of/IN/of the/DT/the virtual/JJ/virtual address/NN/address figure/NN/figure 9.2/CD/9.2 virtual/JJ/virtual address/NN/address space/NNP/space. 360/CD/360 chapter/NN/chapter 9/CD/9 space/NN/space but/CC/but will/MD/will require/VB/require actual/JJ/actual physical/JJ/physical pages/NNS/pages only/RB/only if/IN/if the/DT/the heap/NN/heap or/CC/or stack/NN/stack grows/NNP/grows. virtual/JJ/virtual address/NN/address spaces/NNS/spaces that/WDT/that include/VBP/include holes/NNS/holes are/VBP/are known/VBN/known as/IN/as sparse/NN/sparse address/NN/address spaces/NNP/spaces. using/NN/using a/DT/a sparse/NN/sparse address/NN/address space/NN/space is/VBZ/is beneficial/JJ/beneficial because/IN/because the/DT/the holes/NNS/holes can/MD/can be/VB/be filled/VBN/filled as/IN/as the/DT/the stack/NN/stack or/CC/or heap/VB/heap segments/NNS/segments grow/NN/grow or/CC/or if/IN/if we/PRP/we wish/VBP/wish to/TO/to dynam.ically/RB/dynam.ically link/VB/link libraries/NNS/libraries /:/( or/CC/or possibly/RB/possibly other/JJ/other shared/VBN/shared objects/NNS/objects /:/) during/IN/during program/NN/program execution/NNP/execution. in/IN/in addition/NN/addition to/TO/to separating/VBG/separating logical/JJ/logical memory/NN/memory from/IN/from physical/JJ/physical memory/NN/memory /,/, virtual/JJ/virtual memory/NN/memory allows/VBZ/allows files/NNS/files and/CC/and memory/NN/memory to/TO/to be/VB/be shared/VBN/shared by/IN/by two/CD/two or/CC/or more/JJR/more processes/NNS/processes through/IN/through page/NN/page sharing/VBG/sharing /NN/( section/NN/section 8.4.4/CD/8.4.4 /CD/) /./. this/DT/this leads/NNS/leads to/TO/to the/DT/the following/VBG/following benefits/NNS/benefits /:/: system/NN/system libraries/NNS/libraries can/MD/can be/VB/be shared/VBN/shared by/IN/by several/JJ/several processes/NNS/processes through/IN/through mapping/VBG/mapping of/IN/of the/DT/the shared/VBN/shared object/NN/object into/IN/into a/DT/a virtual/JJ/virtual address/NN/address space/NNP/space. although/IN/although each/DT/each process/NN/process considers/NNS/considers the/DT/the shared/VBN/shared libraries/NNS/libraries to/TO/to be/VB/be part/NN/part of/IN/of its/PRP$/its virtual/JJ/virtual address/NN/address space/NN/space /,/, the/DT/the actual/JJ/actual pages/NNS/pages where/WRB/where the/DT/the libraries/NNS/libraries reside/VBP/reside in/IN/in physical/JJ/physical memory/NN/memory are/VBP/are shared/VBN/shared by/IN/by all/DT/all the/DT/the processes/NNS/processes /:/( figure/NN/figure 9.3/CD/9.3 /CD/) /./. typically/RB/typically /,/, a/DT/a library/NN/library is/VBZ/is mapped/VBN/mapped read-only/RB/read-only into/IN/into the/DT/the space/NN/space of/IN/of each/DT/each process/NN/process that/IN/that is/VBZ/is linked/VBN/linked with/IN/with it/NNP/it. similarly/RB/similarly /,/, virtual/JJ/virtual memory/NN/memory enables/NNS/enables processes/NNS/processes to/TO/to share/VB/share memory/NNP/memory. recall/NN/recall from/IN/from chapter/NN/chapter 3/CD/3 that/WDT/that two/CD/two or/CC/or more/JJR/more processes/NNS/processes can/MD/can communicate/VB/communicate through/IN/through the/DT/the use/NN/use of/IN/of shared/VBN/shared memory/NNP/memory. virtual/JJ/virtual memory/NN/memory allows/VBZ/allows one/CD/one process/NN/process to/TO/to create/VB/create a/DT/a region/NN/region of/IN/of memory/NN/memory that/IN/that it/PRP/it can/MD/can share/VB/share with/IN/with another/DT/another process/NNP/process. processes/VBZ/processes sharing/VBG/sharing this/DT/this region/NN/region consider/NN/consider it/PRP/it part/NN/part of/IN/of their/PRP$/their virtual/JJ/virtual address/NN/address space/NN/space /,/, yet/CC/yet the/DT/the actual/JJ/actual physical/JJ/physical pages/NNS/pages of/IN/of memory/NN/memory are/VBP/are shared/VBN/shared /,/, much/RB/much as/IN/as is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 9.3/CD/9.3. virtual/JJ/virtual memory/NN/memory can/MD/can allow/VB/allow pages/NNS/pages to/TO/to be/VB/be shared/VBN/shared during/IN/during process/NN/process creation/NN/creation with/IN/with the/DT/the fork/NN/fork /:/( /:/) system/NN/system calt/NN/calt thus/RB/thus speeding/VBG/speeding up/RP/up process/NN/process creation/NNP/creation. we/PRP/we further/RB/further explore/VBP/explore these-and/JJ/these-and other-benefits/NNS/other-benefits of/IN/of virtual/JJ/virtual memory/NN/memory later/JJ/later in/IN/in this/DT/this chapter/NNP/chapter. first/RB/first though/IN/though /,/, we/PRP/we discuss/VBP/discuss implementing/VBG/implementing virtual/JJ/virtual memory/NN/memory through/IN/through demand/NN/demand paging/NNP/paging. shared/VBD/shared library/JJ/library shared/VBN/shared pages/NNS/pages shared/VBN/shared library/NN/library figure/NN/figure 9.3/CD/9.3 shared/VBN/shared library/JJ/library using/NN/using virtual/JJ/virtual memory/NNP/memory. 9.2/CD/9.2 9.2/CD/9.2 361/CD/361 consider/NN/consider how/WRB/how an/DT/an executable/JJ/executable program/NN/program might/MD/might be/VB/be loaded/VBN/loaded from/IN/from disk/NN/disk into/IN/into n'lemory/NNP/n'lemory. one/CD/one option/NN/option is/VBZ/is to/TO/to load/VB/load the/DT/the entire/JJ/entire program/NN/program in/IN/in physical/JJ/physical memory/NN/memory at/IN/at program/NN/program execution/NN/execution time/NNP/time. however/RB/however /,/, a/DT/a problent/NN/problent with/IN/with this/DT/this approach/NN/approach is/VBZ/is that/IN/that we/PRP/we may/MD/may not/RB/not initially/RB/initially need/VBP/need the/DT/the entire/JJ/entire program/NN/program in/IN/in memory/NNP/memory. suppose/NN/suppose a/DT/a program/NN/program starts/VBZ/starts with/IN/with a/DT/a list/NN/list of/IN/of available/JJ/available options/NNS/options from/IN/from which/WDT/which the/DT/the user/NN/user is/VBZ/is to/TO/to select/NNP/select. loading/NN/loading the/DT/the entire/JJ/entire program/NN/program into/IN/into memory/NN/memory results/NNS/results in/IN/in loading/VBG/loading the/DT/the executable/JJ/executable code/NN/code for/IN/for all/DT/all options/NNS/options /,/, regardless/RB/regardless of/IN/of whether/IN/whether an/DT/an option/NN/option is/VBZ/is ultimately/RB/ultimately selected/VBN/selected by/IN/by the/DT/the user/NN/user or/CC/or not/NNP/not. an/DT/an alternative/NN/alternative strategy/NN/strategy is/VBZ/is to/TO/to load/VB/load pages/NNS/pages only/RB/only as/IN/as they/PRP/they are/VBP/are needed/NNP/needed. this/DT/this technique/NN/technique is/VBZ/is known/VBN/known as/IN/as paging/NN/paging and/CC/and is/VBZ/is commonly/RB/commonly used/VBN/used in/IN/in virtual/JJ/virtual memory/NN/memory systems/NNP/systems. with/IN/with demand-paged/JJ/demand-paged virtual/JJ/virtual memory/NN/memory /,/, pages/NNS/pages are/VBP/are only/RB/only loaded/VBN/loaded when/WRB/when they/PRP/they are/VBP/are demanded/VBN/demanded during/IN/during program/NN/program execution/NN/execution ;/:/; pages/NNS/pages that/WDT/that are/VBP/are never/RB/never accessed/VBN/accessed are/VBP/are thus/RB/thus never/RB/never loaded/VBN/loaded into/IN/into physical/JJ/physical memory/NNP/memory. a/DT/a demand-paging/JJ/demand-paging system/NN/system is/VBZ/is similar/JJ/similar to/TO/to a/DT/a paging/NN/paging system/NN/system with/IN/with swapping/NN/swapping /:/( figure/NN/figure 9.4/CD/9.4 /CD/) where/WRB/where processes/NNS/processes reside/VBP/reside in/IN/in secondary/JJ/secondary memory/NN/memory /:/( usually/RB/usually a/DT/a disk/NN/disk /:/) /./. when/WRB/when we/PRP/we want/VBP/want to/TO/to execute/VB/execute a/DT/a process/NN/process /,/, we/PRP/we swap/VBP/swap it/PRP/it into/IN/into memory/NNP/memory. rather/RB/rather than/IN/than swapping/VBG/swapping the/DT/the entire/JJ/entire process/NN/process into/IN/into memory/NN/memory /,/, however/RB/however /,/, we/PRP/we use/VBP/use a/DT/a a/DT/a lazy/NN/lazy swapper/NN/swapper never/RB/never swaps/VBZ/swaps a/DT/a page/NN/page into/IN/into memory/NN/memory unless/IN/unless that/DT/that page/NN/page will/MD/will be/VB/be needed/NNP/needed. since/IN/since we/PRP/we are/VBP/are now/RB/now viewing/VBG/viewing a/DT/a process/NN/process as/IN/as a/DT/a sequence/NN/sequence of/IN/of pages/NNS/pages /,/, rather/RB/rather than/IN/than as/IN/as one/CD/one large/JJ/large contiguous/JJ/contiguous address/NN/address space/NN/space /,/, use/VBP/use of/IN/of the/DT/the term/NN/term swapper/NN/swapper is/VBZ/is technically/RB/technically incorrect/NNP/incorrect. a/DT/a swapper/NN/swapper manipulates/VBZ/manipulates entire/JJ/entire processes/NNS/processes /,/, whereas/IN/whereas a/DT/a is/VBZ/is concerned/VBN/concerned with/IN/with the/DT/the individual/JJ/individual pages/NNS/pages of/IN/of a/DT/a process/NNP/process. we/PRP/we thus/VBZ/thus use/NN/use pager/NN/pager /,/, rather/RB/rather than/IN/than swapper/NN/swapper /,/, in/IN/in connection/NN/connection with/IN/with demand/NN/demand paging/NNP/paging. program/NN/program a/DT/a program/NN/program b/NN/b main/NN/main memory/NN/memory swap/NN/swap out/IN/out so/RB/so 90100110/CD/90100110 120130140150/CD/120130140150 swap/NN/swap in/IN/in 16017/CD/16017 figure/NN/figure 9.4/CD/9.4 transfer/NN/transfer of/IN/of a/DT/a paged/JJ/paged memory/NN/memory to/TO/to contiguous/JJ/contiguous disk/NN/disk space/NNP/space. 362/CD/362 chapter/NN/chapter 9/CD/9 9.2.1/CD/9.2.1 basic/JJ/basic concepts/NNS/concepts when/WRB/when a/DT/a process/NN/process is/VBZ/is to/TO/to be/VB/be swapped/VBN/swapped in/IN/in /,/, the/DT/the pager/NN/pager guesses/VBZ/guesses which/WDT/which pages/NNS/pages will/MD/will be/VB/be used/VBN/used before/IN/before the/DT/the process/NN/process is/VBZ/is swapped/VBN/swapped out/RP/out again/NNP/again. instead/RB/instead of/IN/of swapping/VBG/swapping in/IN/in a/DT/a whole/JJ/whole process/NN/process /,/, the/DT/the pager/NN/pager brings/VBZ/brings only/RB/only those/DT/those pages/NNS/pages into/IN/into memory/NNP/memory. thus/RB/thus /,/, it/PRP/it avoids/VBZ/avoids reading/VBG/reading into/IN/into memory/NN/memory pages/NNS/pages that/WDT/that will/MD/will not/RB/not be/VB/be used/VBN/used anyway/NN/anyway /,/, decreasing/VBG/decreasing the/DT/the swap/NN/swap time/NN/time and/CC/and the/DT/the amount/NN/amount of/IN/of physical/JJ/physical memory/NN/memory needed/NNP/needed. with/IN/with this/DT/this scheme/NN/scheme /,/, we/PRP/we need/VBP/need some/DT/some form/NN/form of/IN/of hardware/NN/hardware support/NN/support to/TO/to distinguish/VB/distinguish between/IN/between the/DT/the pages/NNS/pages that/WDT/that are/VBP/are in/IN/in memory/NN/memory and/CC/and the/DT/the pages/NNS/pages that/WDT/that are/VBP/are on/IN/on the/DT/the disk/NNP/disk. the/DT/the valid/JJ/valid -invalid/JJ/-invalid bit/NN/bit scheme/NN/scheme described/VBD/described in/IN/in section/NN/section 8.4.3/CD/8.4.3 can/MD/can be/VB/be used/VBN/used for/IN/for this/DT/this purpose/NNP/purpose. this/DT/this time/NN/time /,/, however/RB/however /,/, when/WRB/when this/DT/this bit/NN/bit is/VBZ/is set/VBN/set to/TO/to valid//NNP/valid/ '/POS/' the/DT/the associated/VBN/associated page/NN/page is/VBZ/is both/DT/both legal/JJ/legal and/CC/and in/IN/in n1.emory/NNP/n1.emory. if/IN/if the/DT/the bit/NN/bit is/VBZ/is set/VBN/set to/TO/to invalid//NNP/invalid/ '/POS/' the/DT/the page/NN/page either/DT/either is/VBZ/is not/RB/not valid/JJ/valid /NN/( that/WDT/that is/VBZ/is /,/, not/RB/not in/IN/in the/DT/the logical/JJ/logical address/NN/address space/NN/space of/IN/of the/DT/the process/NN/process /:/) or/CC/or is/VBZ/is valid/JJ/valid but/CC/but is/VBZ/is currently/RB/currently on/IN/on the/DT/the disk/NNP/disk. the/DT/the page-table/JJ/page-table entry/NN/entry for/IN/for a/DT/a page/NN/page that/WDT/that is/VBZ/is brought/VBN/brought into/IN/into memory/NN/memory is/VBZ/is set/VBN/set as/RB/as usuat/JJ/usuat but/CC/but the/DT/the page-table/JJ/page-table entry/NN/entry for/IN/for a/DT/a page/NN/page that/WDT/that is/VBZ/is not/RB/not currently/RB/currently in/IN/in memory/NN/memory is/VBZ/is either/DT/either simply/RB/simply marked/VBD/marked invalid/JJ/invalid or/CC/or contains/NNS/contains the/DT/the address/NN/address of/IN/of the/DT/the page/NN/page on/IN/on disk/NNP/disk. this/DT/this situation/NN/situation is/VBZ/is depicted/VBN/depicted in/IN/in figure/NN/figure 9.5/CD/9.5. notice/NN/notice that/WDT/that marking/VBG/marking a/DT/a page/NN/page invalid/VBD/invalid will/MD/will have/VB/have no/DT/no effect/NN/effect if/IN/if the/DT/the process/NN/process never/RB/never attempts/VBZ/attempts to/TO/to access/NN/access that/IN/that page/NNP/page. hence/NN/hence /,/, if/IN/if we/PRP/we guess/VBP/guess right/RB/right and/CC/and page/NN/page in/IN/in all/DT/all and/CC/and only/RB/only those/DT/those pages/NNS/pages that/IN/that are/VBP/are actually/RB/actually needed/VBN/needed /,/, the/DT/the process/NN/process will/MD/will run/VB/run exactly/RB/exactly as/IN/as though/IN/though we/PRP/we had/VBD/had brought/VBN/brought in/IN/in all/DT/all pages/NNP/pages. while/IN/while the/DT/the process/NN/process executes/VBZ/executes and/CC/and accesses/NNS/accesses pages/NNS/pages that/WDT/that are/VBP/are execution/NN/execution proceeds/NNS/proceeds normally/NNP/normally. 0/-NONE-/0 2/CD/2 3/CD/3 4/CD/4 5/CD/5 6/CD/6 7/CD/7 valid-invalid/JJ/valid-invalid frame/NN/frame bit/NN/bit '/''/' \/:/\ /./. i/PRP/i 0/-NONE-/0 4/CD/4 v/NN/v logical/JJ/logical memory/NN/memory physical/JJ/physical memory/NN/memory dod/NN/dod d/NN/d /:/[ 1j/CD/1j /CD/[ /./. @/CD/@ jtb/NN/jtb /:/] odd/JJ/odd figure/NN/figure 9.5/CD/9.5 page/NN/page table/JJ/table when/WRB/when some/DT/some pages/NNS/pages are/VBP/are not/RB/not in/IN/in main/JJ/main memory/NNP/memory. operating/NN/operating system/NN/system reference/NN/reference /:/( /,/, ;/:/; \/:/\ /,/, page/NN/page is/VBZ/is on/IN/on \/CD/\ /./. /:/: v/NN/v backing/NN/backing store/NN/store trap/NN/trap restart/NN/restart instruction/NN/instruction page/NN/page table/NN/table reset/NN/reset page/NN/page table/NN/table physical/JJ/physical memory/NN/memory 9.2/CD/9.2 0/-NONE-/0 bring/VBG/bring in/IN/in missing/NN/missing page/NN/page figure/NN/figure 9.6/CD/9.6 steps/NNS/steps in/IN/in handling/NN/handling a/DT/a page/NN/page fault/NNP/fault. 363/CD/363 but/CC/but what/WP/what happens/NNS/happens if/IN/if the/DT/the process/NN/process tries/NNS/tries to/TO/to access/NN/access a/DT/a page/NN/page that/WDT/that was/VBD/was not/RB/not brought/VBN/brought into/IN/into memory/NN/memory access/NN/access to/TO/to a/DT/a page/NN/page marked/VBN/marked invalid/JJ/invalid causes/NNS/causes a/DT/a the/DT/the paging/NN/paging hardware/NN/hardware /,/, in/IN/in translating/NN/translating the/DT/the address/NN/address through/IN/through the/DT/the page/NN/page table/NN/table /,/, will/MD/will notice/VB/notice that/IN/that the/DT/the invalid/JJ/invalid bit/NN/bit is/VBZ/is set/VBN/set /,/, causing/VBG/causing a/DT/a trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NNP/system. this/DT/this trap/NN/trap is/VBZ/is the/DT/the result/NN/result of/IN/of the/DT/the operating/NN/operating system/NN/system 's/POS/'s failure/NN/failure to/TO/to bring/VB/bring the/DT/the desired/VBN/desired page/NN/page into/IN/into memory/NNP/memory. the/DT/the procedure/NN/procedure for/IN/for handling/NN/handling this/DT/this page/NN/page fault/NN/fault is/VBZ/is straightforward/VBN/straightforward /-NONE-/( figure/NN/figure 9.6/CD/9.6 /CD/) /:/: we/PRP/we check/VBP/check an/DT/an internal/JJ/internal table/NN/table /:/( usually/RB/usually kept/VBD/kept with/IN/with the/DT/the process/NN/process control/NN/control block/NN/block /:/) for/IN/for this/DT/this process/NN/process to/TO/to determine/VB/determine whether/IN/whether the/DT/the reference/NN/reference was/VBD/was a/DT/a valid/JJ/valid or/CC/or an/DT/an invalid/JJ/invalid memory/NN/memory access/NNP/access. if/IN/if the/DT/the reference/NN/reference was/VBD/was invalid/JJ/invalid /,/, we/PRP/we terminate/VBP/terminate the/DT/the process/NNP/process. if/IN/if it/PRP/it was/VBD/was valid/JJ/valid /,/, but/CC/but we/PRP/we have/VBP/have not/RB/not yet/RB/yet brought/VBD/brought in/IN/in that/DT/that page/NN/page /,/, we/PRP/we now/RB/now page/VBP/page it/PRP/it in/NNP/in. we/PRP/we find/VBP/find a/DT/a free/JJ/free frame/NN/frame /:/( by/IN/by taking/NN/taking one/CD/one from/IN/from the/DT/the free-frame/JJ/free-frame list/NN/list /,/, for/IN/for example/NN/example /:/) /./. we/PRP/we schedule/VBP/schedule a/DT/a disk/NN/disk operation/NN/operation to/TO/to read/VB/read the/DT/the desired/VBN/desired page/NN/page into/IN/into the/DT/the newly/RB/newly allocated/VBN/allocated frame/NNP/frame. when/WRB/when the/DT/the disk/NN/disk read/NN/read is/VBZ/is complete/JJ/complete /,/, we/PRP/we modify/VBP/modify the/DT/the internal/JJ/internal table/NN/table kept/VBD/kept with/IN/with the/DT/the process/NN/process and/CC/and the/DT/the page/NN/page table/NN/table to/TO/to indicate/VB/indicate that/IN/that the/DT/the page/NN/page is/VBZ/is now/RB/now in/IN/in memory/NNP/memory. we/PRP/we restart/VBP/restart the/DT/the instruction/NN/instruction that/IN/that was/VBD/was interrupted/VBN/interrupted by/IN/by the/DT/the trap/NNP/trap. the/DT/the process/NN/process can/MD/can now/RB/now access/NN/access the/DT/the page/NN/page as/IN/as though/IN/though it/PRP/it had/VBD/had always/RB/always been/VBN/been in/IN/in memory/NNP/memory. in/IN/in the/DT/the extreme/NN/extreme case/NN/case /,/, we/PRP/we can/MD/can start/VB/start executing/VBG/executing a/DT/a process/NN/process with/IN/with no/DT/no pages/NNS/pages in/IN/in memory/NNP/memory. when/WRB/when the/DT/the operating/NN/operating system/NN/system sets/VBZ/sets the/DT/the instruction/NN/instruction pointer/NN/pointer to/TO/to the/DT/the first/JJ/first 364/CD/364 chapter/NN/chapter 9/CD/9 instruction/NN/instruction of/IN/of the/DT/the process/NN/process /,/, which/WDT/which is/VBZ/is on/IN/on a/DT/a non-memory-resident/JJ/non-memory-resident page/NN/page /,/, the/DT/the process/NN/process immediately/RB/immediately faults/VBZ/faults for/IN/for the/DT/the page/NNP/page. after/IN/after this/DT/this page/NN/page is/VBZ/is brought/VBN/brought into/IN/into memory/NN/memory /,/, the/DT/the process/NN/process continues/VBZ/continues to/TO/to execute/VB/execute /,/, faulting/VBG/faulting as/IN/as necessary/JJ/necessary until/IN/until every/DT/every page/NN/page that/IN/that it/PRP/it needs/VBZ/needs is/VBZ/is in/IN/in memory/NNP/memory. at/IN/at that/DT/that it/PRP/it can/MD/can execute/VB/execute with/IN/with no/DT/no more/JJR/more faults/NNP/faults. this/DT/this scheme/NN/scheme is/VBZ/is never/RB/never bring/VBG/bring a/DT/a page/NN/page into/IN/into memory/NN/memory until/IN/until it/PRP/it is/VBZ/is required/NNP/required. theoretically/RB/theoretically /,/, some/DT/some programs/NNS/programs could/MD/could access/VB/access several/JJ/several new/JJ/new pages/NNS/pages of/IN/of memory/NN/memory with/IN/with each/DT/each instruction/NN/instruction execution/NN/execution /:/( one/CD/one page/NN/page for/IN/for the/DT/the instruction/NN/instruction and/CC/and many/JJ/many for/IN/for data/NNS/data /:/) /,/, possibly/RB/possibly causing/VBG/causing multiple/NN/multiple page/NN/page faults/NNS/faults per/IN/per instruction/NNP/instruction. this/DT/this situation/NN/situation would/MD/would result/VB/result in/IN/in unacceptable/JJ/unacceptable system/NN/system performance/NNP/performance. fortunately/RB/fortunately /,/, analysis/NN/analysis of/IN/of running/VBG/running processes/NNS/processes shows/VBZ/shows that/IN/that this/DT/this behavior/NN/behavior is/VBZ/is exceedingly/RB/exceedingly unlikely/NNP/unlikely. programs/NNS/programs tend/VBP/tend to/TO/to have/VB/have described/VBN/described in/IN/in section/NN/section 9.6.1/CD/9.6.1 /,/, which/WDT/which results/NNS/results in/IN/in reasonable/JJ/reasonable performance/NN/performance from/IN/from demand/NN/demand paging/NNP/paging. the/DT/the hardware/NN/hardware to/TO/to support/VB/support demand/NN/demand paging/VBG/paging is/VBZ/is the/DT/the same/JJ/same as/IN/as the/DT/the hardware/NN/hardware for/IN/for paging/NN/paging and/CC/and swapping/VBG/swapping /:/: page/NN/page table/NNP/table. this/DT/this table/NN/table has/VBZ/has the/DT/the ability/NN/ability to/TO/to mark/VB/mark an/DT/an entry/NN/entry invalid/NN/invalid through/IN/through a/DT/a valid/JJ/valid -invalid/JJ/-invalid bit/NN/bit or/CC/or a/DT/a special/JJ/special value/NN/value of/IN/of protection/NN/protection bits/NNP/bits. secondary/JJ/secondary memory/NNP/memory. this/DT/this memory/NN/memory holds/VBZ/holds those/DT/those pages/NNS/pages that/IN/that are/VBP/are not/RB/not present/JJ/present in/IN/in main/JJ/main memory/NNP/memory. the/DT/the secondary/JJ/secondary memory/NN/memory is/VBZ/is usually/RB/usually a/DT/a high-speed/JJ/high-speed disk/NNP/disk. it/PRP/it is/VBZ/is known/VBN/known as/IN/as the/DT/the swap/NN/swap device/NN/device /,/, and/CC/and the/DT/the section/NN/section of/IN/of disk/NN/disk used/VBN/used for/IN/for this/DT/this purpose/NN/purpose is/VBZ/is known/VBN/known as/IN/as swap-space/NN/swap-space allocation/NN/allocation is/VBZ/is discussed/VBN/discussed in/IN/in chapter/NN/chapter 12/CD/12. a/DT/a crucial/JJ/crucial requirement/NN/requirement for/IN/for demand/NN/demand paging/VBG/paging is/VBZ/is the/DT/the ability/NN/ability to/TO/to restart/VB/restart any/DT/any instruction/NN/instruction after/IN/after a/DT/a page/NN/page fault/NNP/fault. because/IN/because we/PRP/we save/VBP/save the/DT/the state/NN/state /:/( registers/NNS/registers /,/, condition/NN/condition code/NN/code /,/, instruction/NN/instruction counter/NN/counter /:/) of/IN/of the/DT/the interrupted/VBN/interrupted process/NN/process when/WRB/when the/DT/the page/NN/page fault/NN/fault occurs/NNS/occurs /,/, we/PRP/we must/MD/must be/VB/be able/JJ/able to/TO/to restart/VB/restart the/DT/the process/NN/process in/IN/in exactly/RB/exactly the/DT/the same/JJ/same place/NN/place and/CC/and state/NN/state /,/, except/IN/except that/DT/that the/DT/the desired/VBN/desired page/NN/page is/VBZ/is now/RB/now in/IN/in memory/NN/memory and/CC/and is/VBZ/is accessible/NNP/accessible. in/IN/in most/JJS/most cases/NNS/cases /,/, this/DT/this requirement/NN/requirement is/VBZ/is easy/JJ/easy to/TO/to meet/NNP/meet. a/DT/a page/NN/page fault/NN/fault may/MD/may occur/VB/occur at/IN/at any/DT/any memory/NN/memory reference/NNP/reference. if/IN/if the/DT/the page/NN/page fault/NN/fault occurs/NNS/occurs on/IN/on the/DT/the instruction/NN/instruction fetch/NN/fetch /,/, we/PRP/we can/MD/can restart/VB/restart by/IN/by fetching/NN/fetching the/DT/the instruction/NN/instruction again/NNP/again. if/IN/if a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs while/IN/while we/PRP/we are/VBP/are fetching/VBG/fetching an/DT/an operand/NN/operand /,/, we/PRP/we must/MD/must fetch/VB/fetch and/CC/and decode/VB/decode the/DT/the instruction/NN/instruction again/RB/again and/CC/and then/RB/then fetch/VB/fetch the/DT/the operand/NNP/operand. as/IN/as a/DT/a worst-case/NN/worst-case example/NN/example /,/, consider/NN/consider a/DT/a three-address/JJ/three-address instruction/NN/instruction such/JJ/such as/IN/as add/JJ/add the/DT/the content/NN/content of/IN/of a/DT/a to/TO/to b/VB/b /,/, placing/VBG/placing the/DT/the result/NN/result in/IN/in c/NNP/c. these/DT/these are/VBP/are the/DT/the steps/NNS/steps to/TO/to execute/VB/execute this/DT/this instruction/NN/instruction /:/: fetch/NN/fetch and/CC/and decode/NN/decode the/DT/the instruction/NN/instruction /:/( add/NN/add /:/) /./. fetch/NN/fetch a/DT/a fetch/NN/fetch b/NNP/b. add/NN/add a/DT/a and/CC/and b/NNP/b. store/NN/store the/DT/the sum/NN/sum in/IN/in c/NNP/c. if/IN/if we/PRP/we fault/VBP/fault when/WRB/when we/PRP/we try/VBP/try to/TO/to store/VB/store inc/NN/inc /:/( because/IN/because c/NN/c is/VBZ/is in/IN/in a/DT/a page/NN/page not/RB/not currently/RB/currently in/IN/in memory/NN/memory /:/) /,/, we/PRP/we will/MD/will have/VB/have to/TO/to get/VB/get the/DT/the desired/VBN/desired page/NN/page /,/, bring/VB/bring it/PRP/it in/IN/in /,/, correct/JJ/correct the/DT/the page/NN/page table/NN/table /,/, and/CC/and restart/NN/restart the/DT/the instruction/NNP/instruction. the/DT/the restart/NN/restart will/MD/will require/VB/require fetching/VBG/fetching the/DT/the instruction/NN/instruction again/RB/again /,/, decoding/VBG/decoding it/PRP/it again/RB/again /,/, fetching/VBG/fetching the/DT/the two/CD/two operands/NNS/operands again/RB/again /,/, and/CC/and 9.2/CD/9.2 365/CD/365 then/RB/then adding/VBG/adding again/NNP/again. however/RB/however /,/, there/EX/there is/VBZ/is not/RB/not much/JJ/much repeated/VBN/repeated work/NN/work /:/( less/JJR/less than/IN/than one/CD/one complete/JJ/complete instruction/NN/instruction /:/) /,/, and/CC/and the/DT/the repetition/NN/repetition is/VBZ/is necessary/JJ/necessary only/RB/only when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNP/occurs. the/DT/the major/JJ/major difficulty/NN/difficulty arises/NNS/arises when/WRB/when one/CD/one instruction/NN/instruction may/MD/may modify/VB/modify several/JJ/several different/JJ/different locations/NNP/locations. for/IN/for example/NN/example /,/, consider/NN/consider the/DT/the ibm/NN/ibm system/NN/system 360/370/CD/360/370 mvc/NN/mvc /:/( move/NN/move character/NN/character /:/) instruction/NN/instruction /,/, which/WDT/which can/MD/can ncove/VB/ncove up/RP/up to/TO/to 256/CD/256 bytes/NNS/bytes from/IN/from one/CD/one location/NN/location to/TO/to another/DT/another /NN/( possibly/RB/possibly overlapping/VBG/overlapping /:/) location/NNP/location. if/IN/if either/DT/either block/NN/block /:/( source/NN/source or/CC/or destination/NN/destination /:/) straddles/NNS/straddles a/DT/a page/NN/page boundary/NN/boundary /,/, a/DT/a page/NN/page fault/NN/fault might/MD/might occur/VB/occur after/IN/after the/DT/the move/NN/move is/VBZ/is partially/RB/partially done/NNP/done. in/IN/in addition/NN/addition /,/, if/IN/if the/DT/the source/NN/source and/CC/and destination/NN/destination blocks/NNS/blocks overlap/VBP/overlap /,/, the/DT/the source/NN/source block/NN/block may/MD/may have/VB/have been/VBN/been modified/VBN/modified /,/, in/IN/in which/WDT/which case/NN/case we/PRP/we can/MD/can not/RB/not simply/RB/simply restart/VB/restart the/DT/the instruction/NNP/instruction. this/DT/this problem/NN/problem can/MD/can be/VB/be solved/VBN/solved in/IN/in two/CD/two different/JJ/different ways/NNP/ways. in/IN/in one/CD/one solution/NN/solution /,/, the/DT/the microcode/NN/microcode computes/VBZ/computes and/CC/and attempts/VBZ/attempts to/TO/to access/NN/access both/DT/both ends/NNS/ends of/IN/of both/DT/both blocks/NNP/blocks. if/IN/if a/DT/a page/NN/page fault/NN/fault is/VBZ/is going/VBG/going to/TO/to occm/VB/occm ~/:/~ it/PRP/it will/MD/will happen/VB/happen at/IN/at this/DT/this step/NN/step /,/, before/IN/before anything/NN/anything is/VBZ/is modified/NNP/modified. the/DT/the move/NN/move can/MD/can then/RB/then take/VB/take place/NN/place ;/:/; we/PRP/we know/VBP/know that/IN/that no/DT/no page/NN/page fault/NN/fault can/MD/can occur/VB/occur /,/, since/IN/since all/DT/all the/DT/the relevant/JJ/relevant pages/NNS/pages are/VBP/are in/IN/in memory/NNP/memory. the/DT/the other/JJ/other solution/NN/solution uses/NNS/uses temporary/JJ/temporary registers/NNS/registers to/TO/to hold/VB/hold the/DT/the values/NNS/values of/IN/of overwritten/NN/overwritten locations/NNP/locations. if/IN/if there/EX/there is/VBZ/is a/DT/a page/NN/page fault/NN/fault /,/, all/DT/all the/DT/the old/JJ/old values/NNS/values are/VBP/are written/VBN/written back/RB/back into/IN/into memory/NN/memory before/IN/before the/DT/the trap/NN/trap occurs/NNP/occurs. this/DT/this action/NN/action restores/VBZ/restores memory/NN/memory to/TO/to its/PRP$/its state/NN/state before/IN/before the/DT/the instruction/NN/instruction was/VBD/was started/VBN/started /,/, so/RB/so that/IN/that the/DT/the instruction/NN/instruction can/MD/can be/VB/be repeated/NNP/repeated. this/DT/this is/VBZ/is by/IN/by no/DT/no means/NNS/means the/DT/the only/JJ/only architectural/JJ/architectural problem/NN/problem resulting/VBG/resulting from/IN/from adding/VBG/adding paging/NN/paging to/TO/to an/DT/an existing/VBG/existing architecture/NN/architecture to/TO/to allow/VB/allow demand/NN/demand paging/VBG/paging /,/, but/CC/but it/PRP/it illustrates/VBZ/illustrates some/DT/some of/IN/of the/DT/the difficulties/NNS/difficulties involved/NNP/involved. paging/VBG/paging is/VBZ/is added/VBN/added between/IN/between the/DT/the cpu/NN/cpu and/CC/and the/DT/the memory/NN/memory in/IN/in a/DT/a computer/NN/computer system/NNP/system. it/PRP/it should/MD/should be/VB/be entirely/RB/entirely transparent/JJ/transparent to/TO/to the/DT/the user/NN/user process/NNP/process. thus/RB/thus /,/, people/NNS/people often/RB/often assume/VBP/assume that/IN/that paging/VBG/paging can/MD/can be/VB/be added/VBN/added to/TO/to any/DT/any system/NNP/system. although/IN/although this/DT/this assumption/NN/assumption is/VBZ/is true/JJ/true for/IN/for a/DT/a non-demand-paging/JJ/non-demand-paging environment/NN/environment /,/, where/WRB/where a/DT/a page/NN/page fault/NN/fault represents/VBZ/represents a/DT/a fatal/JJ/fatal errm/NN/errm ~/:/~ it/PRP/it is/VBZ/is not/RB/not true/JJ/true where/WRB/where a/DT/a page/NN/page fault/NN/fault means/VBZ/means only/RB/only that/IN/that an/DT/an additional/JJ/additional page/NN/page must/MD/must be/VB/be brought/VBN/brought into/IN/into memory/NN/memory and/CC/and the/DT/the process/NN/process restarted/NNP/restarted. 9.2.2/CD/9.2.2 performance/NN/performance of/IN/of demand/NN/demand paging/VBG/paging demand/NN/demand paging/VBG/paging can/MD/can significantly/RB/significantly affect/VB/affect the/DT/the performance/NN/performance of/IN/of a/DT/a computer/NN/computer system/NNP/system. to/TO/to see/VB/see why/WRB/why /,/, let/VB/let 's/POS/'s compute/JJ/compute the/DT/the effective/JJ/effective access/NN/access time/NN/time for/IN/for a/DT/a demand-paged/JJ/demand-paged memory/NNP/memory. for/IN/for most/JJS/most computer/NN/computer systems/NNS/systems /,/, the/DT/the memory-access/JJ/memory-access time/NN/time /,/, denoted/VBD/denoted ma/NN/ma /,/, ranges/NNS/ranges from/IN/from 10/CD/10 to/TO/to 200/CD/200 nanoseconds/NNP/nanoseconds. as/IN/as long/RB/long as/IN/as we/PRP/we have/VBP/have no/DT/no page/NN/page faults/NNS/faults /,/, the/DT/the effective/JJ/effective access/NN/access time/NN/time is/VBZ/is equal/JJ/equal to/TO/to the/DT/the memory/NN/memory access/NN/access time/NNP/time. if/IN/if /,/, howeve1/NNP/howeve1 ~/NNP/~ a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, we/PRP/we must/MD/must first/RB/first read/VB/read the/DT/the relevant/NN/relevant page/NN/page from/IN/from disk/NN/disk and/CC/and then/RB/then access/NN/access the/DT/the desired/VBN/desired word/NNP/word. let/NN/let p/NN/p be/VB/be the/DT/the probability/NN/probability of/IN/of a/DT/a page/NN/page fault/NN/fault /:/( 0/-NONE-/0 /:/: /:/: /:/: ;/:/; p/NN/p /:/: /:/: /:/: ;/:/; 1/CD/1 /CD/) /./. we/PRP/we would/MD/would expect/VB/expect p/NN/p to/TO/to be/VB/be close/JJ/close to/TO/to zero-that/JJ/zero-that is/VBZ/is /,/, we/PRP/we would/MD/would expect/VB/expect to/TO/to have/VB/have only/RB/only a/DT/a few/JJ/few page/NN/page faults/NNP/faults. the/DT/the t'tp/NNP/t'tp r/NN/r '/POS/' !/./! nrr/NN/nrr- access/NN/access is/VBZ/is then/RB/then effective/JJ/effective access/NN/access time/NN/time =/:/= /:/( 1/CD/1 /:/- p/NN/p /:/) x/NN/x ma/NN/ma +/:/+ p/NN/p x/NN/x page/NN/page fault/NN/fault time/NNP/time. to/TO/to compute/VB/compute the/DT/the effective/JJ/effective access/NN/access time/NN/time /,/, we/PRP/we must/MD/must know/VB/know how/WRB/how much/RB/much time/NN/time is/VBZ/is needed/VBN/needed to/TO/to service/NN/service a/DT/a page/NN/page fault/NNP/fault. a/DT/a page/NN/page fault/NN/fault causes/NNS/causes the/DT/the following/VBG/following sequence/NN/sequence to/TO/to occur/VB/occur /:/: trap/NN/trap to/TO/to the/DT/the operating/NN/operating system/NNP/system. save/NN/save the/DT/the user/NN/user registers/NNS/registers and/CC/and process/NN/process state/NNP/state. 366/CD/366 chapter/NN/chapter 9/CD/9 deterncine/NN/deterncine that/WDT/that the/DT/the interrupt/NN/interrupt was/VBD/was a/DT/a page/NN/page fault/NNP/fault. check/NN/check that/WDT/that the/DT/the page/NN/page reference/NN/reference was/VBD/was legal/JJ/legal and/CC/and determine/NN/determine the/DT/the location/NN/location of/IN/of the/DT/the page/NN/page on/IN/on the/DT/the disk/NN/disk issue/NN/issue a/DT/a read/NN/read from/IN/from the/DT/the disk/NN/disk to/TO/to a/DT/a free/JJ/free frame/NN/frame /:/: a/NNP/a. wait/NN/wait in/IN/in a/DT/a queue/NN/queue for/IN/for this/DT/this device/NN/device until/IN/until the/DT/the read/NN/read request/NN/request is/VBZ/is serviced/NNP/serviced. b/NNP/b. wait/NN/wait for/IN/for the/DT/the device/NN/device seek/NN/seek and//NN/and/ or/CC/or latency/NN/latency time/NNP/time. c/NNP/c. begin/NN/begin the/DT/the transfer/NN/transfer of/IN/of the/DT/the page/NN/page to/TO/to a/DT/a free/JJ/free frame/NNP/frame. while/IN/while waiting/VBG/waiting /,/, allocate/JJ/allocate the/DT/the cpu/NN/cpu to/TO/to some/DT/some other/JJ/other user/NN/user /:/( cpu/NN/cpu scheduling/NN/scheduling /,/, optional/JJ/optional /NN/) /./. receive/JJ/receive an/DT/an interrupt/JJ/interrupt from/IN/from the/DT/the disk/NN/disk i/0/-NONE-/i/0 subsystem/NN/subsystem /:/( i/0/-NONE-/i/0 completed/VBD/completed /:/) /./. save/NN/save the/DT/the registers/NNS/registers and/CC/and process/NN/process state/NN/state for/IN/for the/DT/the other/JJ/other user/NN/user /:/( if/IN/if step/NN/step 6/CD/6 is/VBZ/is executed/VBN/executed /-NONE-/) /./. determine/NN/determine that/WDT/that the/DT/the interrupt/NN/interrupt was/VBD/was from/IN/from the/DT/the disk/NN/disk correct/NN/correct the/DT/the page/NN/page table/NN/table and/CC/and other/JJ/other tables/NNS/tables to/TO/to show/VB/show that/IN/that the/DT/the desired/VBN/desired page/NN/page is/VBZ/is now/RB/now in/IN/in memory/NNP/memory. wait/NN/wait for/IN/for the/DT/the cpu/NN/cpu to/TO/to be/VB/be allocated/VBN/allocated to/TO/to this/DT/this process/NN/process again/NNP/again. restore/VB/restore the/DT/the user/NN/user registers/NNS/registers /,/, process/NN/process state/NN/state /,/, and/CC/and new/JJ/new page/NN/page table/JJ/table /,/, and/CC/and then/RB/then resume/VB/resume the/DT/the interrupted/VBN/interrupted instruction/NNP/instruction. not/RB/not all/DT/all of/IN/of these/DT/these steps/NNS/steps are/VBP/are necessary/JJ/necessary in/IN/in every/DT/every case/NNP/case. for/IN/for example/NN/example /,/, we/PRP/we are/VBP/are assuming/VBG/assuming that/IN/that /,/, in/IN/in step/NN/step 6/CD/6 /,/, the/DT/the cpu/NN/cpu is/VBZ/is allocated/VBN/allocated to/TO/to another/DT/another process/NN/process while/IN/while the/DT/the i/o/NNP/i/o occurs/NNP/occurs. this/DT/this arrangement/NN/arrangement allows/VBZ/allows multiprogramming/VBG/multiprogramming to/TO/to maintain/VB/maintain cpu/NN/cpu utilization/NN/utilization but/CC/but requires/VBZ/requires additional/JJ/additional time/NN/time to/TO/to resume/VB/resume the/DT/the page-fault/JJ/page-fault service/NN/service routine/NN/routine when/WRB/when the/DT/the i/0/NNP/i/0 transfer/NN/transfer is/VBZ/is complete/NNP/complete. in/IN/in any/DT/any case/NN/case /,/, we/PRP/we are/VBP/are faced/VBN/faced with/IN/with tlu/NN/tlu ee/NN/ee major/JJ/major components/NNS/components of/IN/of the/DT/the page-fault/JJ/page-fault service/NN/service time/NN/time /:/: service/NN/service the/DT/the page-fault/JJ/page-fault interrupt/NNP/interrupt. read/NN/read in/IN/in the/DT/the page/NNP/page. restart/NN/restart the/DT/the process/NNP/process. the/DT/the first/JJ/first and/CC/and third/JJ/third tasks/NNS/tasks can/MD/can be/VB/be reduced/VBN/reduced /,/, with/IN/with careful/JJ/careful coding/NN/coding /,/, to/TO/to several/JJ/several hundred/CD/hundred instructions/NNP/instructions. these/DT/these tasks/NNS/tasks may/MD/may take/VB/take from/IN/from 1/CD/1 to/TO/to 100/CD/100 microseconds/NNS/microseconds each/NNP/each. the/DT/the page-switch/JJ/page-switch time/NN/time /,/, however/RB/however /,/, will/MD/will probably/RB/probably be/VB/be close/JJ/close to/TO/to 8/CD/8 milliseconds/NNP/milliseconds. /NNP/( a/DT/a typical/JJ/typical hard/JJ/hard disk/NN/disk has/VBZ/has an/DT/an average/JJ/average latency/NN/latency of/IN/of 3/CD/3 milliseconds/NNS/milliseconds /,/, a/DT/a seek/NN/seek of/IN/of 5/CD/5 milliseconds/NNS/milliseconds /,/, and/CC/and a/DT/a transfer/NN/transfer time/NN/time of/IN/of 0.05/CD/0.05 milliseconds/NNP/milliseconds. thus/RB/thus /,/, the/DT/the total/JJ/total paging/NN/paging time/NN/time is/VBZ/is about/IN/about 8/CD/8 milliseconds/NNS/milliseconds /,/, including/VBG/including hardware/NN/hardware and/CC/and software/NN/software time/NNP/time. /NNP/) remember/NN/remember also/RB/also that/IN/that we/PRP/we are/VBP/are looking/VBG/looking at/IN/at only/RB/only the/DT/the device-service/NN/device-service time/NNP/time. if/IN/if a/DT/a queue/NN/queue of/IN/of processes/NNS/processes is/VBZ/is waiting/VBG/waiting for/IN/for the/DT/the device/NN/device /,/, we/PRP/we have/VBP/have to/TO/to add/VB/add device-queueing/JJ/device-queueing time/NN/time as/IN/as we/PRP/we wait/VBP/wait for/IN/for the/DT/the paging/VBG/paging device/NN/device to/TO/to be/VB/be free/JJ/free to/TO/to service/NN/service our/PRP$/our request/NN/request /,/, increasing/VBG/increasing even/RB/even more/JJR/more the/DT/the time/NN/time to/TO/to swap/NNP/swap. with/IN/with an/DT/an average/JJ/average page-fault/NN/page-fault service/NN/service time/NN/time of/IN/of 8/CD/8 milliseconds/NNS/milliseconds and/CC/and a/DT/a memoryaccess/NN/memoryaccess time/NN/time of/IN/of 200/CD/200 nanoseconds/NNS/nanoseconds /,/, the/DT/the effective/JJ/effective access/NN/access time/NN/time in/IN/in nanoseconds/NNS/nanoseconds is/VBZ/is 3/CD/3 9.3/CD/9.3 effective/JJ/effective access/NN/access time/NN/time =/:/= /:/( 1/CD/1 /:/- p/NN/p /:/) x/NN/x /:/( 200/CD/200 /CD/) +/CD/+ p/NN/p /:/( 8/CD/8 milliseconds/NNS/milliseconds /:/) =/:/= /:/( 1/CD/1 p/NN/p /:/) x/NN/x 200/CD/200 +/CD/+ p/NN/p x/NN/x 8,000,000/CD/8,000,000 =/CD/= 200/CD/200 +/CD/+ 7,999,800/CD/7,999,800 x/NN/x p/NNP/p. 367/CD/367 we/PRP/we see/VBP/see /,/, then/RB/then /,/, that/IN/that the/DT/the effective/JJ/effective access/NN/access time/NN/time is/VBZ/is directly/RB/directly proportional/JJ/proportional to/TO/to the/DT/the if/IN/if one/CD/one access/NN/access out/IN/out of/IN/of 1,000/CD/1,000 causes/NNS/causes a/DT/a page/NN/page fault/NN/fault /,/, the/DT/the effective/JJ/effective access/NN/access time/NN/time is/VBZ/is 8.2/CD/8.2 microseconds/NNP/microseconds. the/DT/the computer/NN/computer will/MD/will be/VB/be slowed/VBN/slowed down/RP/down by/IN/by a/DT/a factor/NN/factor of/IN/of 40/CD/40 because/IN/because of/IN/of demand/NN/demand paging/VBG/paging !/./! if/IN/if we/PRP/we want/VBP/want performance/NN/performance degradation/NN/degradation to/TO/to be/VB/be less/JJR/less than/IN/than 10/CD/10 percent/NN/percent /,/, we/PRP/we need/VBP/need 220/CD/220 200/CD/200 +/CD/+ 7,999,800/CD/7,999,800 x/NN/x p/NN/p /,/, 20/CD/20 7,999,800/CD/7,999,800 x/NN/x p/NN/p /,/, p/NN/p 0.0000025/CD/0.0000025. that/WDT/that is/VBZ/is /,/, to/TO/to keep/VB/keep the/DT/the slowdown/NN/slowdown due/JJ/due to/TO/to paging/VBG/paging at/IN/at a/DT/a reasonable/JJ/reasonable level/NN/level /,/, we/PRP/we can/MD/can allow/VB/allow fewer/JJR/fewer than/IN/than one/CD/one memory/NN/memory access/NN/access out/IN/out of/IN/of 399,990/CD/399,990 to/TO/to page-fault/NNP/page-fault. in/IN/in sum/NN/sum /,/, it/PRP/it is/VBZ/is important/JJ/important to/TO/to keep/VB/keep the/DT/the page-fault/JJ/page-fault rate/NN/rate low/JJ/low in/IN/in a/DT/a demand-paging/JJ/demand-paging system/NNP/system. otherwise/NN/otherwise /,/, the/DT/the effective/JJ/effective access/NN/access time/NN/time increases/NNS/increases /,/, slowing/VBG/slowing process/NN/process execution/NN/execution dramatically/NNP/dramatically. an/DT/an additional/JJ/additional aspect/NN/aspect of/IN/of demand/NN/demand paging/VBG/paging is/VBZ/is the/DT/the handling/NN/handling and/CC/and overall/JJ/overall use/NN/use of/IN/of swap/NN/swap space/NNP/space. disk/NN/disk i/0/-NONE-/i/0 to/TO/to swap/VB/swap space/NN/space is/VBZ/is generally/RB/generally faster/JJR/faster than/IN/than that/DT/that to/TO/to the/DT/the file/NN/file system/NNP/system. it/PRP/it is/VBZ/is faster/JJR/faster because/IN/because swap/NN/swap space/NN/space is/VBZ/is allocated/VBN/allocated in/IN/in much/JJ/much larger/NN/larger blocks/NNS/blocks /,/, and/CC/and file/VB/file lookups/NNS/lookups and/CC/and indirect/VB/indirect allocation/NN/allocation methods/NNS/methods are/VBP/are not/RB/not used/VBN/used /-NONE-/( chapter/NN/chapter 12/CD/12 /CD/) /./. the/DT/the system/NN/system can/MD/can therefore/VB/therefore gain/NN/gain better/RBR/better paging/VBG/paging throughput/NN/throughput by/IN/by copying/NN/copying an/DT/an entire/JJ/entire file/NN/file image/NN/image into/IN/into the/DT/the swap/NN/swap space/NN/space at/IN/at process/NN/process startup/NN/startup and/CC/and then/RB/then performing/VBG/performing demand/NN/demand paging/VBG/paging from/IN/from the/DT/the swap/NN/swap space/NNP/space. another/DT/another option/NN/option is/VBZ/is to/TO/to demand/NN/demand pages/NNS/pages from/IN/from the/DT/the file/NN/file system/NN/system initially/RB/initially but/CC/but to/TO/to write/VB/write the/DT/the pages/NNS/pages to/TO/to swap/VB/swap space/NN/space as/IN/as they/PRP/they are/VBP/are replaced/NNP/replaced. this/DT/this approach/NN/approach will/MD/will ensure/VB/ensure that/IN/that only/RB/only needed/VBN/needed pages/NNS/pages are/VBP/are read/VBN/read from/IN/from the/DT/the file/NN/file system/NN/system but/CC/but that/IN/that all/DT/all subsequent/JJ/subsequent paging/NN/paging is/VBZ/is done/VBN/done from/IN/from swap/NN/swap space/NNP/space. some/DT/some systems/NNS/systems attempt/VBP/attempt to/TO/to limit/VB/limit the/DT/the amount/NN/amount of/IN/of swap/NN/swap space/NN/space used/VBD/used through/IN/through demand/NN/demand paging/VBG/paging of/IN/of binary/JJ/binary files/NNP/files. demand/NN/demand pages/NNS/pages for/IN/for such/JJ/such files/NNS/files are/VBP/are brought/VBN/brought directly/RB/directly from/IN/from the/DT/the file/NN/file system/NNP/system. however/RB/however /,/, when/WRB/when page/NN/page replacement/NN/replacement is/VBZ/is called/VBN/called for/IN/for /,/, these/DT/these frames/NNS/frames can/MD/can simply/RB/simply be/VB/be overwritten/VBN/overwritten /-NONE-/( because/IN/because they/PRP/they are/VBP/are never/RB/never modified/VBN/modified /-NONE-/) /,/, and/CC/and the/DT/the pages/NNS/pages can/MD/can be/VB/be read/VBN/read in/IN/in from/IN/from the/DT/the file/NN/file system/NN/system again/RB/again if/IN/if needed/NNP/needed. using/VBG/using this/DT/this approach/NN/approach /,/, the/DT/the file/NN/file system/NN/system itself/PRP/itself serves/VBZ/serves as/IN/as the/DT/the backing/NN/backing store/NNP/store. howeve1/NNP/howeve1 ~/NNP/~ swap/NN/swap space/NN/space must/MD/must still/RB/still be/VB/be used/VBN/used for/IN/for pages/NNS/pages not/RB/not associated/VBN/associated with/IN/with a/DT/a file/JJ/file ;/:/; these/DT/these pages/NNS/pages include/VBP/include the/DT/the stack/NN/stack and/CC/and heap/VB/heap for/IN/for a/DT/a process/NNP/process. this/DT/this method/NN/method appears/VBZ/appears to/TO/to be/VB/be a/DT/a good/JJ/good compromise/NN/compromise and/CC/and is/VBZ/is used/VBN/used in/IN/in several/JJ/several systems/NNS/systems /,/, including/VBG/including solaris/NNS/solaris and/CC/and bsd/VBD/bsd unix/NNP/unix. in/IN/in section/NN/section 9/CD/9 .2/CD/.2 /,/, we/PRP/we illustrated/VBD/illustrated how/WRB/how a/DT/a process/NN/process can/MD/can start/VB/start quickly/RB/quickly by/IN/by merely/RB/merely demandpaging/VBG/demandpaging in/IN/in the/DT/the page/NN/page containing/VBG/containing the/DT/the first/JJ/first instruction/NNP/instruction. however/RB/however /,/, process/NN/process creation/NN/creation using/VBG/using the/DT/the fork/NN/fork /:/( /:/) system/NN/system call/NN/call may/MD/may initially/RB/initially bypass/VB/bypass the/DT/the need/NN/need for/IN/for demand/NN/demand paging/VBG/paging by/IN/by using/VBG/using a/DT/a technique/NN/technique similar/JJ/similar to/TO/to page/NN/page sharing/VBG/sharing /NN/( covered/VBN/covered in/IN/in section/NN/section 8.4.4/CD/8.4.4 /CD/) /./. this/DT/this technique/NN/technique provides/VBZ/provides for/IN/for rapid/JJ/rapid process/NN/process creation/NN/creation and/CC/and minimizes/VBZ/minimizes the/DT/the number/NN/number of/IN/of new/JJ/new pages/NNS/pages that/WDT/that must/MD/must be/VB/be allocated/VBN/allocated to/TO/to the/DT/the newly/RB/newly created/VBN/created process/NNP/process. 368/CD/368 chapter/NN/chapter 9/CD/9 physical/JJ/physical figure/NN/figure 9.7/CD/9.7 before/IN/before process/NN/process i/PRP/i modifies/VBZ/modifies page/NN/page c/NNP/c. recall/NN/recall thatthe/DT/thatthe fork/NN/fork /:/( /:/) system/NN/system call/NN/call creates/VBZ/creates a/DT/a child/NN/child process/NN/process that/WDT/that is/VBZ/is a/DT/a duplicate/NN/duplicate of/IN/of its/PRP$/its parent/NNP/parent. traditionally/RB/traditionally /,/, fork/NN/fork /:/( /:/) worked/VBD/worked by/IN/by creating/NN/creating a/DT/a copy/NN/copy of/IN/of the/DT/the parent/NN/parent 's/POS/'s address/NN/address space/NN/space for/IN/for the/DT/the child/NN/child /,/, duplicating/VBG/duplicating the/DT/the pages/NNS/pages belonging/VBG/belonging to/TO/to the/DT/the parent/NNP/parent. however/RB/however /,/, considering/VBG/considering that/IN/that many/JJ/many child/NN/child processes/NNS/processes invoke/VBP/invoke the/DT/the exec/NN/exec /:/( /:/) system/NN/system call/NN/call immediately/RB/immediately after/IN/after creation/NN/creation /,/, the/DT/the copying/NN/copying of/IN/of the/DT/the parent/NN/parent 's/POS/'s address/NN/address space/NN/space may/MD/may be/VB/be unnecessary/NNP/unnecessary. instead/RB/instead /,/, we/PRP/we can/MD/can use/VB/use a/DT/a technique/NN/technique known/VBN/known as/IN/as which/WDT/which works/NNS/works by/IN/by allowing/VBG/allowing the/DT/the parent/NN/parent and/CC/and child/NN/child processes/NNS/processes initially/RB/initially to/TO/to share/VB/share the/DT/the same/JJ/same pages/NNP/pages. these/DT/these shared/VBD/shared pages/NNS/pages are/VBP/are marked/VBN/marked as/IN/as copy-on-write/JJ/copy-on-write pages/NNS/pages /,/, meaning/VBG/meaning that/IN/that if/IN/if either/DT/either process/NN/process writes/VBZ/writes to/TO/to a/DT/a shared/VBN/shared page/NN/page /,/, a/DT/a copy/NN/copy of/IN/of the/DT/the shared/VBN/shared page/NN/page is/VBZ/is created/NNP/created. copy-on-write/JJ/copy-on-write is/VBZ/is illustrated/VBN/illustrated in/IN/in figures/NNS/figures 9.7/CD/9.7 and/CC/and figure/NN/figure 9.8/CD/9.8 /,/, which/WDT/which show/NN/show the/DT/the contents/NNS/contents of/IN/of the/DT/the physical/JJ/physical memory/NN/memory before/IN/before and/CC/and after/IN/after process/NN/process 1/CD/1 modifies/NNS/modifies page/NN/page c/NNP/c. for/IN/for example/NN/example /,/, assume/NN/assume that/IN/that the/DT/the child/NN/child process/NN/process attempts/VBZ/attempts to/TO/to modify/VB/modify a/DT/a page/NN/page containing/VBG/containing portions/NNS/portions of/IN/of the/DT/the stack/NN/stack /,/, with/IN/with the/DT/the pages/NNS/pages set/VBD/set to/TO/to be/VB/be copy-on-write/NNP/copy-on-write. the/DT/the operating/NN/operating system/NN/system will/MD/will create/VB/create a/DT/a copy/NN/copy of/IN/of this/DT/this page/NN/page /,/, nl.apping/JJ/nl.apping it/PRP/it to/TO/to the/DT/the address/NN/address space/NN/space of/IN/of the/DT/the child/NN/child process/NNP/process. the/DT/the child/NN/child process/NN/process will/MD/will then/RB/then modify/VB/modify its/PRP$/its copied/VBN/copied page/NN/page and/CC/and not/RB/not the/DT/the page/NN/page belonging/VBG/belonging to/TO/to the/DT/the parent/NN/parent process/NNP/process. obviously/RB/obviously /,/, when/WRB/when the/DT/the copy-on-write/JJ/copy-on-write technique/NN/technique is/VBZ/is used/VBN/used /,/, only/RB/only the/DT/the pages/NNS/pages that/WDT/that are/VBP/are modified/VBN/modified by/IN/by either/DT/either process/NN/process are/VBP/are copied/VBN/copied ;/:/; all/DT/all unmodified/VBN/unmodified pages/NNS/pages can/MD/can be/VB/be shared/VBN/shared by/IN/by the/DT/the parent/NN/parent and/CC/and child/NN/child processes/NNP/processes. note/NN/note /,/, too/RB/too /,/, process1/NNP/process1 physical/JJ/physical memory/NN/memory figure/NN/figure 9.8/CD/9.8 after/IN/after process/NN/process 1/CD/1 modifies/NNS/modifies page/NN/page c/NNP/c. process2/NNP/process2 9.4/CD/9.4 9.4/CD/9.4 369/CD/369 that/WDT/that only/RB/only pages/VBZ/pages that/IN/that can/MD/can be/VB/be nwdified/VBN/nwdified need/NN/need be/VB/be m/NN/m ~/:/~ arked/VBD/arked as/IN/as copy-on-write/NNP/copy-on-write. pages/NNS/pages that/WDT/that can/MD/can not/RB/not be/VB/be modified/VBN/modified /-NONE-/( pages/NNS/pages containing/VBG/containing executable/JJ/executable code/NN/code /:/) can/MD/can be/VB/be shared/VBN/shared by/IN/by the/DT/the parent/NN/parent and/CC/and child/NNP/child. copy-on-write/NNP/copy-on-write is/VBZ/is a/DT/a common/JJ/common technique/NN/technique used/VBN/used by/IN/by several/JJ/several operating/VBG/operating systems/NNS/systems /,/, including/VBG/including windows/NNS/windows xp/NN/xp /,/, linux/NN/linux /,/, and/CC/and solaris/NNP/solaris. when/WRB/when it/PRP/it is/VBZ/is determined/VBN/determined that/IN/that a/DT/a page/NN/page is/VBZ/is going/VBG/going to/TO/to be/VB/be duplicated/VBN/duplicated using/VBG/using copyon/NN/copyon- write/NN/write /,/, it/PRP/it is/VBZ/is important/JJ/important to/TO/to note/VB/note the/DT/the location/NN/location from/IN/from which/WDT/which the/DT/the free/JJ/free page/NN/page will/MD/will be/VB/be allocated/NNP/allocated. many/JJ/many operating/VBG/operating systems/NNS/systems provide/VB/provide a/DT/a of/IN/of free/JJ/free pages/NNS/pages for/IN/for such/JJ/such requests/NNP/requests. these/DT/these free/JJ/free pages/NNS/pages are/VBP/are typically/RB/typically allocated/VBN/allocated when/WRB/when the/DT/the stack/NN/stack or/CC/or heap/VB/heap for/IN/for a/DT/a process/NN/process must/MD/must expand/VB/expand or/CC/or when/WRB/when there/EX/there are/VBP/are copy-on-write/JJ/copy-on-write pages/NNS/pages to/TO/to be/VB/be managed/NNP/managed. operating/NN/operating systems/NNS/systems typically/RB/typically allocate/JJ/allocate these/DT/these pages/NNS/pages using/VBG/using a/DT/a technique/NN/technique known/VBN/known as/IN/as zem-fhl-on-den/JJ/zem-fhl-on-den /:/: 1and/CD/1and. zero-fill-on-demand/JJ/zero-fill-on-demand pages/NNS/pages have/VBP/have been/VBN/been zeroed-out/-NONE-/zeroed-out before/IN/before being/VBG/being allocated/VBN/allocated /,/, thus/RB/thus erasing/VBG/erasing the/DT/the previous/JJ/previous contents/NNP/contents. several/JJ/several versions/NNS/versions of/IN/of unix/NN/unix /:/( including/VBG/including solaris/NNS/solaris and/CC/and linux/NN/linux /:/) provide/VB/provide a/DT/a variation/NN/variation ofthe/NN/ofthe fork/NN/fork /:/( /:/) system/NN/system call-vfork/NN/call-vfork /:/( /:/) /:/( for/IN/for fori/NN/fori /:/( /:/) /:/- that/IN/that operates/NNS/operates differently/RB/differently from/IN/from fork/NN/fork /:/( /:/) with/IN/with copy-on-write/NNP/copy-on-write. with/IN/with vfork/NN/vfork /:/( /:/) /,/, the/DT/the parent/NN/parent process/NN/process is/VBZ/is suspended/VBN/suspended /,/, and/CC/and the/DT/the child/NN/child process/NN/process uses/NNS/uses the/DT/the address/NN/address space/NN/space of/IN/of the/DT/the parent/NNP/parent. because/IN/because vfork/NN/vfork /:/( /:/) does/VBZ/does not/RB/not use/VB/use copy-on-write/JJ/copy-on-write /,/, if/IN/if the/DT/the child/NN/child process/NN/process changes/NNS/changes any/DT/any pages/NNS/pages of/IN/of the/DT/the parent/NN/parent 's/POS/'s address/NN/address space/NN/space /,/, the/DT/the altered/VBN/altered pages/NNS/pages will/MD/will be/VB/be visible/JJ/visible to/TO/to the/DT/the parent/NN/parent once/RB/once it/PRP/it resumes/NNP/resumes. therefore/RB/therefore /,/, vf/IN/vf ork/NN/ork /:/( /:/) must/MD/must be/VB/be used/VBN/used with/IN/with caution/NN/caution to/TO/to ensure/VB/ensure that/IN/that the/DT/the child/NN/child process/NN/process does/VBZ/does not/RB/not modify/VB/modify the/DT/the address/NN/address space/NN/space of/IN/of the/DT/the parent/NNP/parent. vf/NN/vf or/CC/or k/NN/k /:/( /:/) is/VBZ/is intended/VBN/intended to/TO/to be/VB/be used/VBN/used when/WRB/when the/DT/the child/NN/child process/NN/process calls/VBZ/calls exec/NN/exec /:/( /:/) immediately/RB/immediately after/IN/after creation/NNP/creation. because/IN/because no/DT/no copying/VBG/copying of/IN/of pages/NNS/pages takes/VBZ/takes place/NN/place /,/, vf/NN/vf ork/NN/ork /:/( /:/) is/VBZ/is an/DT/an extremely/RB/extremely efficient/JJ/efficient method/NN/method of/IN/of process/NN/process creation/NN/creation and/CC/and is/VBZ/is sometimes/RB/sometimes used/VBN/used to/TO/to implement/VB/implement unix/NN/unix command-line/NN/command-line shell/NN/shell interfaces/NNP/interfaces. in/IN/in our/PRP$/our earlier/JJR/earlier discussion/NN/discussion of/IN/of the/DT/the page-fault/JJ/page-fault rate/NN/rate /,/, we/PRP/we assumed/VBD/assumed that/IN/that each/DT/each page/NN/page faults/NNS/faults at/IN/at most/JJS/most once/RB/once /,/, when/WRB/when it/PRP/it is/VBZ/is first/JJ/first referenced/NNP/referenced. this/DT/this representation/NN/representation is/VBZ/is not/RB/not strictly/RB/strictly accurate/JJ/accurate /,/, however/NNP/however. if/IN/if a/DT/a process/NN/process of/IN/of ten/NN/ten pages/NNS/pages actually/RB/actually uses/VBZ/uses only/RB/only half/DT/half of/IN/of them/PRP/them /,/, then/RB/then demand/NN/demand paging/VBG/paging saves/NNS/saves the/DT/the i/0/NN/i/0 necessary/JJ/necessary to/TO/to load/VB/load the/DT/the five/CD/five pages/NNS/pages that/WDT/that are/VBP/are never/RB/never used/NNP/used. we/PRP/we could/MD/could also/RB/also increase/VB/increase our/PRP$/our degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming by/IN/by running/VBG/running twice/NN/twice as/IN/as many/JJ/many processes/NNP/processes. thus/RB/thus /,/, if/IN/if we/PRP/we had/VBD/had forty/JJ/forty frames/NNS/frames /,/, we/PRP/we could/MD/could run/VB/run eight/CD/eight processes/NNS/processes /,/, rather/RB/rather than/IN/than the/DT/the four/CD/four that/WDT/that could/MD/could run/VB/run if/IN/if each/DT/each required/VBN/required ten/VBN/ten frames/NNS/frames /:/( five/CD/five of/IN/of which/WDT/which were/VBD/were never/RB/never used/VBN/used /-NONE-/) /./. if/IN/if we/PRP/we increase/VBP/increase our/PRP$/our degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming /,/, we/PRP/we are/VBP/are memory/NNP/memory. if/IN/if we/PRP/we run/VBP/run six/CD/six processes/NNS/processes /,/, each/DT/each of/IN/of which/WDT/which is/VBZ/is ten/VBN/ten pages/NNS/pages in/IN/in size/NN/size but/CC/but uses/VBZ/uses only/RB/only five/CD/five pages/NNS/pages /,/, we/PRP/we have/VBP/have higher/JJR/higher cpu/NN/cpu utilization/NN/utilization and/CC/and throughput/VBD/throughput /,/, ten/VBN/ten frames/NNS/frames to/TO/to spare/NNP/spare. it/PRP/it is/VBZ/is possible/JJ/possible /,/, however/RB/however /,/, that/IN/that each/DT/each of/IN/of these/DT/these processes/NNS/processes /,/, for/IN/for a/DT/a particular/JJ/particular data/NNS/data set/VBD/set /,/, may/MD/may suddenly/RB/suddenly try/VB/try to/TO/to use/VB/use all/DT/all ten/VBN/ten of/IN/of its/PRP$/its pages/NNS/pages /,/, resulting/VBG/resulting in/IN/in a/DT/a need/NN/need for/IN/for sixty/NN/sixty frames/NNS/frames when/WRB/when only/RB/only forty/JJ/forty are/VBP/are available/NNP/available. further/RBR/further /,/, consider/NN/consider that/WDT/that system/NN/system memory/NN/memory is/VBZ/is not/RB/not used/VBN/used only/RB/only for/IN/for holding/VBG/holding program/NN/program pages/NNP/pages. buffers/NNS/buffers for/IN/for i//JJ/i/ 0/-NONE-/0 also/RB/also consume/VBP/consume a/DT/a considerable/JJ/considerable amount/NN/amount of/IN/of memory/NNP/memory. this/DT/this use/NN/use can/MD/can increase/VB/increase the/DT/the strain/NN/strain on/IN/on memory-placement/JJ/memory-placement algorithms/NNP/algorithms. deciding/NN/deciding how/WRB/how much/JJ/much memory/NN/memory to/TO/to allocate/VB/allocate to/TO/to i/0/-NONE-/i/0 and/CC/and how/WRB/how much/JJ/much to/TO/to program/NN/program pages/NNS/pages is/VBZ/is a/DT/a significant/JJ/significant challenge/NNP/challenge. some/DT/some systems/NNS/systems allocate/VBP/allocate a/DT/a fixed/VBN/fixed percentage/NN/percentage of/IN/of memory/NN/memory for/IN/for i/0/-NONE-/i/0 buffers/NNS/buffers /,/, whereas/IN/whereas others/NNS/others allow/VBP/allow both/DT/both user/NN/user processes/NNS/processes and/CC/and the/DT/the i/0/NNP/i/0 subsystem/NN/subsystem to/TO/to compete/VB/compete for/IN/for all/PDT/all system/NN/system memory/NNP/memory. 370/CD/370 chapter/NN/chapter 9/CD/9 valid-invalid/JJ/valid-invalid pc/NN/pc-- /:/: /:/: -_/JJ/-_ =/NN/= '/:/'- ~/:/~ ~/:/~ =/:/= =/:/= /:/: !/./! came/VBD/came f/NN/f il/NN/il logical/JJ/logical memory/NN/memory for/IN/for user/NN/user 1/CD/1 page/NN/page table/JJ/table for/IN/for user/NN/user 1/CD/1 valid-invalid/JJ/valid-invalid 0/-NONE-/0 frame/NN/frame ~/:/~ bi/NN/bi ~/:/~ r/JJ/r--- ~/NN/~ v/NN/v v/NN/v ~/:/~ -------'/:/-------'-- '/''/' 2/CD/2 3/CD/3 logical/JJ/logical memory/NN/memory for/IN/for user/NN/user 2/CD/2 page/NN/page table/JJ/table for/IN/for user/NN/user 2/CD/2 0/-NONE-/0 monitor/NN/monitor 2/CD/2 3/CD/3 4/CD/4 5/CD/5 j/NN/j 6/CD/6 a/DT/a 7/CD/7 e/NN/e physical/JJ/physical memory/NN/memory figure/NN/figure 9.9/CD/9.9 need/NN/need for/IN/for page/NN/page replacement/NN/replacement over-allocation/NN/over-allocation of/IN/of memory/NN/memory manifests/NNS/manifests itself/PRP/itself as/IN/as follows/NNP/follows. while/IN/while a/DT/a user/NN/user process/NN/process is/VBZ/is executing/VBG/executing /,/, a/DT/a page/NN/page fault/NN/fault occurs/NNP/occurs. the/DT/the operating/NN/operating system/NN/system determines/NNS/determines where/WRB/where the/DT/the desired/VBN/desired page/NN/page is/VBZ/is residing/VBG/residing on/IN/on the/DT/the disk/NN/disk but/CC/but then/RB/then finds/VBZ/finds that/IN/that there/EX/there are/VBP/are no/DT/no free/JJ/free frames/NNS/frames on/IN/on the/DT/the free-frame/JJ/free-frame list/NN/list ;/:/; all/DT/all memory/NN/memory is/VBZ/is in/IN/in use/NN/use /:/( figure/NN/figure 9.9/CD/9.9 /CD/) /./. the/DT/the operating/NN/operating system/NN/system has/VBZ/has several/JJ/several options/NNS/options at/IN/at this/DT/this point/NNP/point. it/PRP/it could/MD/could terminate/VB/terminate the/DT/the user/NN/user process/NNP/process. however/RB/however /,/, demand/NN/demand paging/VBG/paging is/VBZ/is the/DT/the operating/NN/operating system/NN/system 's/POS/'s attempt/NN/attempt to/TO/to improve/VB/improve the/DT/the computer/NN/computer system/NN/system 's/POS/'s utilization/NN/utilization and/CC/and throughput/NNP/throughput. users/NNS/users should/MD/should not/RB/not be/VB/be aware/JJ/aware that/IN/that their/PRP$/their processes/NNS/processes are/VBP/are running/VBG/running on/IN/on a/DT/a paged/JJ/paged system-paging/JJ/system-paging should/MD/should be/VB/be logically/RB/logically transparent/JJ/transparent to/TO/to the/DT/the user/NNP/user. so/RB/so this/DT/this option/NN/option is/VBZ/is not/RB/not the/DT/the best/JJS/best choice/NNP/choice. the/DT/the operating/NN/operating system/NN/system could/MD/could instead/VB/instead swap/NN/swap out/IN/out a/DT/a process/NN/process /,/, freeing/VBG/freeing all/DT/all its/PRP$/its frames/NNS/frames and/CC/and reducing/VBG/reducing the/DT/the level/NN/level of/IN/of multiprogramming/NNP/multiprogramming. this/DT/this option/NN/option is/VBZ/is a/DT/a good/JJ/good one/CD/one in/IN/in certain/JJ/certain circumstances/NNS/circumstances /,/, and/CC/and we/PRP/we consider/VBP/consider it/PRP/it further/RB/further in/IN/in section/NN/section 9.6/CD/9.6. here/RB/here /,/, we/PRP/we discuss/VBP/discuss the/DT/the most/RBS/most common/JJ/common solution/NN/solution /:/: 9.4.1/CD/9.4.1 basic/JJ/basic page/NN/page replacement/NN/replacement page/NN/page replacement/NN/replacement takes/VBZ/takes the/DT/the following/VBG/following approach/NNP/approach. if/IN/if no/DT/no frame/NN/frame is/VBZ/is free/JJ/free /,/, we/PRP/we find/VBP/find one/CD/one that/WDT/that is/VBZ/is not/RB/not currently/RB/currently being/VBG/being used/VBN/used and/CC/and free/JJ/free it/NNP/it. we/PRP/we can/MD/can free/VB/free a/DT/a frame/NN/frame by/IN/by writing/NN/writing its/PRP$/its contents/NNS/contents to/TO/to swap/VB/swap space/NN/space and/CC/and changing/VBG/changing the/DT/the page/NN/page table/NN/table /:/( and/CC/and all/DT/all other/JJ/other tables/NNS/tables /:/) to/TO/to indicate/VB/indicate that/IN/that the/DT/the page/NN/page is/VBZ/is no/DT/no longer/NN/longer in/IN/in memory/NN/memory /:/( figure/NN/figure 9.10/CD/9.10 /CD/) /./. we/PRP/we can/MD/can now/RB/now use/VB/use the/DT/the freed/NN/freed frame/NN/frame to/TO/to hold/VB/hold the/DT/the page/NN/page for/IN/for which/WDT/which the/DT/the process/NN/process faulted/NNP/faulted. we/PRP/we modify/VBP/modify the/DT/the page-fault/JJ/page-fault service/NN/service routine/NN/routine to/TO/to include/VB/include page/NN/page replacement/NN/replacement /:/: find/NN/find the/DT/the location/NN/location of/IN/of the/DT/the desired/VBN/desired page/NN/page on/IN/on the/DT/the disk/NNP/disk. find/NN/find a/DT/a free/JJ/free frame/NN/frame /:/: a/NNP/a. if/IN/if there/EX/there is/VBZ/is a/DT/a free/JJ/free frame/NN/frame /,/, use/VBP/use it/NNP/it. 9.4/CD/9.4 371/CD/371 b/NNP/b. if/IN/if there/EX/there is/VBZ/is no/DT/no free/JJ/free frame/NN/frame /,/, use/VBP/use a/DT/a page-replacement/JJ/page-replacement algorithnc/NN/algorithnc to/TO/to select/VB/select a/DT/a c/NNP/c. write/NN/write the/DT/the victim/NN/victim frame/NN/frame to/TO/to the/DT/the disk/NN/disk ;/:/; change/NN/change the/DT/the page/NN/page and/CC/and frame/VBD/frame tables/NNS/tables accordingly/NNP/accordingly. read/NN/read the/DT/the desired/VBN/desired page/NN/page into/IN/into the/DT/the newly/RB/newly freed/VBN/freed frame/NN/frame ;/:/; change/NN/change the/DT/the page/NN/page and/CC/and frame/VBD/frame tables/NNP/tables. restart/NN/restart the/DT/the user/NN/user process/NNP/process. notice/NN/notice that/WDT/that /,/, if/IN/if no/DT/no frames/NNS/frames are/VBP/are free/JJ/free /,/, two/CD/two page/NN/page transfers/NNS/transfers /:/( one/CD/one out/IN/out and/CC/and one/CD/one in/IN/in /CD/) are/VBP/are required/NNP/required. this/DT/this situation/NN/situation effectively/RB/effectively doubles/VBZ/doubles the/DT/the page-fault/JJ/page-fault service/NN/service time/NN/time and/CC/and increases/VBZ/increases the/DT/the effective/JJ/effective access/NN/access time/NN/time accordingly/NNP/accordingly. we/PRP/we can/MD/can reduce/VB/reduce this/DT/this overhead/NN/overhead by/IN/by using/VBG/using a/DT/a /NN/( or/CC/or when/WRB/when this/DT/this scheme/NN/scheme is/VBZ/is used/VBN/used /,/, each/DT/each page/NN/page or/CC/or frame/VB/frame has/VBZ/has a/DT/a modify/NN/modify bit/NN/bit associated/VBN/associated with/IN/with it/PRP/it in/IN/in the/DT/the hardware/NNP/hardware. the/DT/the modify/NN/modify bit/NN/bit for/IN/for a/DT/a page/NN/page is/VBZ/is set/VBN/set by/IN/by the/DT/the hardware/NN/hardware whenever/NN/whenever any/DT/any word/NN/word or/CC/or byte/VB/byte in/IN/in the/DT/the page/NN/page is/VBZ/is written/VBN/written into/IN/into /,/, indicating/VBG/indicating that/IN/that the/DT/the page/NN/page has/VBZ/has been/VBN/been modified/NNP/modified. when/WRB/when we/PRP/we select/VBP/select a/DT/a page/NN/page for/IN/for replacement/NN/replacement /,/, we/PRP/we examine/VBP/examine its/PRP$/its modify/NN/modify bit/NNP/bit. if/IN/if the/DT/the bit/NN/bit is/VBZ/is set/VBN/set /,/, we/PRP/we know/VBP/know that/IN/that the/DT/the page/NN/page has/VBZ/has been/VBN/been modified/VBN/modified since/IN/since it/PRP/it was/VBD/was read/VBN/read in/IN/in from/IN/from the/DT/the disk/NNP/disk. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we must/MD/must write/VB/write the/DT/the page/NN/page to/TO/to the/DT/the disk/NNP/disk. if/IN/if the/DT/the modify/NN/modify bit/NN/bit is/VBZ/is not/RB/not set/VBN/set /,/, however/RB/however /,/, the/DT/the page/NN/page has/VBZ/has not/RB/not been/VBN/been modified/VBN/modified since/IN/since it/PRP/it was/VBD/was read/VBN/read into/IN/into memory/NNP/memory. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we need/VBP/need not/RB/not write/JJ/write the/DT/the memory/NN/memory page/NN/page to/TO/to the/DT/the disk/NN/disk /:/: it/PRP/it is/VBZ/is already/RB/already there/NNP/there. this/DT/this technique/NN/technique also/RB/also applies/VBZ/applies to/TO/to read-only/RB/read-only pages/NNS/pages /:/( for/IN/for example/NN/example /,/, pages/NNS/pages of/IN/of binary/JJ/binary code/NN/code /:/) /./. such/JJ/such pages/NNS/pages can/MD/can not/RB/not be/VB/be modified/VBN/modified ;/:/; thus/RB/thus /,/, they/PRP/they may/MD/may be/VB/be discarded/VBN/discarded when/WRB/when desired/NNP/desired. this/DT/this scheme/NN/scheme can/MD/can significantly/RB/significantly reduce/VB/reduce the/DT/the time/NN/time required/VBN/required to/TO/to service/NN/service a/DT/a page/NN/page fault/NN/fault /,/, since/IN/since it/PRP/it reduces/VBZ/reduces i/o/-NONE-/i/o time/NN/time by/IN/by one-half/JJ/one-half if/IN/if the/DT/the page/NN/page has/VBZ/has not/RB/not been/VBN/been modified/NNP/modified. frame/NN/frame valid-invalid/JJ/valid-invalid bit/NN/bit '/''/' \/:/\ /./. //:// physical/JJ/physical memory/NN/memory figure/NN/figure 9.10/CD/9.10 page/NN/page replacement/NN/replacement 372/CD/372 chapter/NN/chapter 9/CD/9 page/NN/page replacement/NN/replacement is/VBZ/is basic/JJ/basic to/TO/to demand/NN/demand paging/NNP/paging. it/PRP/it completes/VBZ/completes the/DT/the separation/NN/separation between/IN/between logical/JJ/logical memory/NN/memory and/CC/and physical/JJ/physical memory/NNP/memory. with/IN/with this/DT/this mechanism/NN/mechanism /,/, an/DT/an enormous/JJ/enormous virtual/JJ/virtual memory/NN/memory can/MD/can be/VB/be provided/VBN/provided for/IN/for programn'lers/NNS/programn'lers on/IN/on a/DT/a smaller/JJR/smaller physical/JJ/physical memory/NNP/memory. with/IN/with no/DT/no demand/NN/demand paging/VBG/paging /,/, user/NN/user addresses/NNS/addresses are/VBP/are mapped/VBN/mapped into/IN/into physical/JJ/physical addresses/NNS/addresses /,/, so/RB/so the/DT/the two/CD/two sets/NNS/sets of/IN/of addresses/NNS/addresses can/MD/can be/VB/be different/NNP/different. all/DT/all the/DT/the pages/NNS/pages of/IN/of a/DT/a process/NN/process still/RB/still must/MD/must be/VB/be in/IN/in physical/JJ/physical memory/NN/memory /,/, however/NNP/however. with/IN/with demand/NN/demand paging/VBG/paging /,/, the/DT/the size/NN/size of/IN/of the/DT/the logical/JJ/logical address/NN/address space/NN/space is/VBZ/is no/DT/no longer/NN/longer constrained/VBN/constrained by/IN/by physical/JJ/physical memory/NNP/memory. if/IN/if we/PRP/we have/VBP/have a/DT/a user/NN/user process/NN/process of/IN/of twenty/NN/twenty pages/NNS/pages /,/, we/PRP/we can/MD/can execute/VB/execute it/PRP/it in/IN/in ten/CD/ten frames/NNS/frames simply/RB/simply by/IN/by using/VBG/using demand/NN/demand paging/VBG/paging and/CC/and using/VBG/using a/DT/a replacement/NN/replacement algorithm/NN/algorithm to/TO/to find/VB/find a/DT/a free/JJ/free frame/NN/frame whenever/NN/whenever necessary/NNP/necessary. if/IN/if a/DT/a page/NN/page that/WDT/that has/VBZ/has been/VBN/been modified/VBN/modified is/VBZ/is to/TO/to be/VB/be replaced/VBN/replaced /,/, its/PRP$/its contents/NNS/contents are/VBP/are copied/VBN/copied to/TO/to the/DT/the disk/NNP/disk. a/DT/a later/JJ/later reference/NN/reference to/TO/to that/DT/that page/NN/page will/MD/will cause/VB/cause a/DT/a page/NN/page fault/NNP/fault. at/IN/at that/DT/that time/NN/time /,/, the/DT/the page/NN/page will/MD/will be/VB/be brought/VBN/brought back/RP/back into/IN/into memory/NN/memory /,/, perhaps/RB/perhaps replacing/VBG/replacing some/DT/some other/JJ/other page/NN/page in/IN/in the/DT/the process/NNP/process. we/PRP/we must/MD/must solve/VB/solve two/CD/two major/JJ/major problems/NNS/problems to/TO/to implement/VB/implement demand/NN/demand develop/VB/develop a/DT/a algorithm/NN/algorithm and/CC/and a/DT/a '/''/' '/POS/' '/''/' /:/- '/POS/' '/''/' l/NN/l tceme/NN/tceme ~/:/~ lu/NN/lu ~/:/~ ~/:/~ f/NN/f '/:/'- '/''/' ~/:/~ ~/:/~ ''h/JJ/''h '/''/' that/IN/that is/VBZ/is /,/, if/IN/if we/PRP/we have/VBP/have multiple/JJ/multiple processes/NNS/processes in/IN/in memory/NN/memory /,/, we/PRP/we must/MD/must decide/VB/decide how/WRB/how many/JJ/many frames/NNS/frames to/TO/to allocate/VB/allocate to/TO/to each/DT/each process/NN/process ;/:/; and/CC/and when/WRB/when page/NN/page replacement/NN/replacement is/VBZ/is required/VBN/required /,/, we/PRP/we must/MD/must select/VB/select the/DT/the frames/NNS/frames that/WDT/that are/VBP/are to/TO/to be/VB/be replaced/NNP/replaced. designing/NN/designing appropriate/NN/appropriate algorithms/NNS/algorithms to/TO/to solve/VB/solve these/DT/these problems/NNS/problems is/VBZ/is an/DT/an important/JJ/important task/NN/task /,/, because/IN/because disk/NN/disk i/0/-NONE-/i/0 is/VBZ/is so/RB/so expensive/NNP/expensive. even/RB/even slight/VBD/slight improvements/NNS/improvements in/IN/in demand-paging/JJ/demand-paging methods/NNS/methods yield/NN/yield large/JJ/large gains/NNS/gains in/IN/in system/NN/system performance/NNP/performance. there/EX/there are/VBP/are many/JJ/many different/JJ/different page-replacement/JJ/page-replacement algorithms/NNP/algorithms. every/DT/every operating/NN/operating system/NN/system probably/RB/probably has/VBZ/has its/PRP$/its own/JJ/own replacement/NN/replacement scheme/NNP/scheme. how/WRB/how do/VBP/do we/PRP/we select/VB/select a/DT/a particular/JJ/particular replacement/NN/replacement algorithm/NN/algorithm in/IN/in general/JJ/general /,/, we/PRP/we want/VBP/want the/DT/the one/CD/one with/IN/with the/DT/the lowest/JJS/lowest page-fault/JJ/page-fault rate/NNP/rate. we/PRP/we evaluate/VBP/evaluate an/DT/an algorithm/NN/algorithm by/IN/by running/NN/running it/PRP/it on/IN/on a/DT/a particular/JJ/particular string/NN/string of/IN/of memory/NN/memory references/NNS/references and/CC/and computing/VBG/computing the/DT/the number/NN/number of/IN/of page/NN/page faults/NNP/faults. the/DT/the string/NN/string of/IN/of memory/NN/memory references/NNS/references is/VBZ/is called/VBN/called a/DT/a reference/NN/reference we/PRP/we can/MD/can generate/VB/generate reference/NN/reference strings/NNS/strings artificially/RB/artificially /:/( by/IN/by using/NN/using a/DT/a random-number/NN/random-number generator/NN/generator /,/, for/IN/for example/NN/example /:/) /,/, or/CC/or we/PRP/we can/MD/can trace/VB/trace a/DT/a given/VBN/given system/NN/system and/CC/and record/VB/record the/DT/the address/NN/address of/IN/of each/DT/each memory/NN/memory reference/NNP/reference. the/DT/the latter/NN/latter choice/NN/choice produces/NNS/produces a/DT/a large/JJ/large number/NN/number of/IN/of data/NNS/data /:/( on/IN/on the/DT/the order/NN/order of/IN/of 1/CD/1 million/CD/million addresses/NNS/addresses per/IN/per second/JJ/second /NN/) /./. to/TO/to reduce/VB/reduce the/DT/the number/NN/number of/IN/of data/NNS/data /,/, we/PRP/we use/VBP/use two/CD/two facts/NNP/facts. first/JJ/first /,/, for/IN/for a/DT/a given/VBN/given page/NN/page size/NN/size /:/( and/CC/and the/DT/the page/NN/page size/NN/size is/VBZ/is generally/RB/generally fixed/VBN/fixed by/IN/by the/DT/the hardware/NN/hardware or/CC/or system/NN/system /:/) /,/, we/PRP/we need/VBP/need to/TO/to consider/VB/consider only/RB/only the/DT/the page/NN/page number/NN/number /,/, rather/RB/rather than/IN/than the/DT/the entire/JJ/entire address/NNP/address. second/JJ/second /,/, if/IN/if we/PRP/we have/VBP/have a/DT/a reference/NN/reference to/TO/to a/DT/a page/NN/page p/NN/p /,/, then/RB/then any/DT/any references/NNS/references to/TO/to page/VB/page p/NN/p that/WDT/that immediately/RB/immediately follow/VBP/follow will/MD/will never/RB/never cause/VB/cause a/DT/a page/NN/page fault/NNP/fault. page/NN/page p/NN/p will/MD/will be/VB/be in/IN/in memory/NN/memory after/IN/after the/DT/the first/JJ/first reference/NN/reference /,/, so/RB/so the/DT/the immediately/RB/immediately following/VBG/following references/NNS/references will/MD/will not/RB/not fault/NNP/fault. for/IN/for example/NN/example /,/, if/IN/if we/PRP/we trace/VBP/trace a/DT/a particular/JJ/particular process/NN/process /,/, we/PRP/we might/MD/might record/VB/record the/DT/the following/VBG/following address/NN/address sequence/NN/sequence /:/: 0100,0432,0101,0612,0102,0103,0104,0101,0611,0102,0103/CD/0100,0432,0101,0612,0102,0103,0104,0101,0611,0102,0103 /,/, 0104,0101,0610,0102,0103,0104,0101,0609,0102,0105/CD/0104,0101,0610,0102,0103,0104,0101,0609,0102,0105 at/IN/at 100/CD/100 bytes/NNS/bytes per/IN/per page/NN/page /,/, this/DT/this sequence/NN/sequence is/VBZ/is reduced/VBN/reduced to/TO/to the/DT/the following/VBG/following reference/NN/reference string/VBG/string /:/: 1/LS/1 /,/, 4/CD/4 /,/, 1/CD/1 /,/, 6/CD/6 /,/, 1/CD/1 /,/, 6/CD/6 /,/, 1/CD/1 /,/, 6/CD/6 /,/, 1/CD/1 /,/, 6/CD/6 /,/, 1/CD/1 9.4/CD/9.4 373/CD/373 16/CD/16 g/NN/g /:/) 14/CD/14 /:/: /:/: /:/: j/NN/j /./. ;/:/; 2/CD/2 12/CD/12 q/NN/q /:/) ol/NN/ol co/NN/co 10/CD/10 0/CD/0.. 0/-NONE-/0 8/CD/8 '/:/'- q/NN/q /:/) ..0/-NONE-/..0 6/CD/6 e/NN/e /:/: /:/: /:/: j/NN/j c/NN/c 4/CD/4 2/CD/2 2/CD/2 3/CD/3 4/CD/4 5/CD/5 6/CD/6 number/NN/number of/IN/of frames/NNS/frames figure/VBP/figure 9.1/CD/9.1 i/PRP/i graph/VBP/graph of/IN/of page/NN/page faults/NNS/faults versus/CC/versus number/NN/number of/IN/of frames/NNP/frames. to/TO/to determine/VB/determine the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults for/IN/for a/DT/a particular/JJ/particular reference/NN/reference string/VBG/string and/CC/and page-replacement/JJ/page-replacement algorithm/NN/algorithm /,/, we/PRP/we also/RB/also need/VBP/need to/TO/to know/VB/know the/DT/the number/NN/number of/IN/of page/NN/page frames/NNS/frames available/NNP/available. obviously/RB/obviously /,/, as/IN/as the/DT/the number/NN/number of/IN/of frames/NNS/frames available/JJ/available increases/NNS/increases /,/, the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults decreases/NNP/decreases. for/IN/for the/DT/the reference/NN/reference stril'lg/NN/stril'lg considered/VBD/considered previously/RB/previously /,/, for/IN/for example/NN/example /,/, if/IN/if we/PRP/we had/VBD/had three/CD/three or/CC/or more/JJR/more frames/NNS/frames /,/, we/PRP/we would/MD/would have/VB/have only/RB/only three/CD/three faultsone/NN/faultsone fault/NN/fault for/IN/for the/DT/the first/JJ/first reference/NN/reference to/TO/to each/DT/each page/NNP/page. in/IN/in contrast/NN/contrast /,/, with/IN/with only/RB/only one/CD/one frame/NN/frame available/JJ/available /,/, we/PRP/we would/MD/would have/VB/have a/DT/a replacement/NN/replacement with/IN/with every/DT/every reference/NN/reference /,/, resulting/VBG/resulting in/IN/in eleven/NN/eleven faults/NNP/faults. in/IN/in general/JJ/general /,/, we/PRP/we expect/VBP/expect a/DT/a curve/NN/curve such/JJ/such as/IN/as that/DT/that in/IN/in figure/NN/figure 9.11/CD/9.11. as/IN/as the/DT/the number/NN/number of/IN/of frames/NNS/frames increases/NNS/increases /,/, the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults drops/NNS/drops to/TO/to some/DT/some minimal/JJ/minimal level/NNP/level. of/IN/of course/NN/course /,/, adding/VBG/adding physical/JJ/physical memory/NN/memory increases/NNS/increases the/DT/the number/NN/number of/IN/of frames/NNP/frames. we/PRP/we next/JJ/next illustrate/NN/illustrate several/JJ/several page-replacement/JJ/page-replacement algorithms/NNP/algorithms. in/IN/in doing/VBG/doing so/RB/so /,/, we/PRP/we use/VBP/use the/DT/the reference/NN/reference string/VBG/string for/IN/for a/DT/a memory/NN/memory with/IN/with three/CD/three frames/NNP/frames. 9.4.2/CD/9.4.2 fifo/NN/fifo page/NN/page replacement/NN/replacement the/DT/the simplest/JJS/simplest page-replacement/JJ/page-replacement algorithm/NN/algorithm is/VBZ/is a/DT/a first-in/JJ/first-in /,/, first-out/JJ/first-out /NN/( fifo/NN/fifo /:/) algorithm/NNP/algorithm. a/DT/a fifo/NN/fifo replacement/NN/replacement algorithm/NN/algorithm associates/NNS/associates with/IN/with each/DT/each page/NN/page the/DT/the time/NN/time when/WRB/when that/DT/that page/NN/page was/VBD/was brought/VBN/brought into/IN/into memory/NNP/memory. when/WRB/when a/DT/a page/NN/page must/MD/must be/VB/be replaced/VBN/replaced /,/, the/DT/the oldest/JJS/oldest page/NN/page is/VBZ/is chosen/NNP/chosen. notice/NN/notice that/WDT/that it/PRP/it is/VBZ/is not/RB/not strictly/RB/strictly necessary/JJ/necessary to/TO/to record/VB/record the/DT/the time/NN/time when/WRB/when a/DT/a page/NN/page is/VBZ/is brought/VBN/brought in/NNP/in. we/PRP/we can/MD/can create/VB/create a/DT/a fifo/NN/fifo queue/NN/queue to/TO/to hold/VB/hold all/DT/all pages/NNS/pages in/IN/in memory/NNP/memory. we/PRP/we replace/VBP/replace the/DT/the page/NN/page at/IN/at the/DT/the head/NN/head of/IN/of the/DT/the queue/NNP/queue. when/WRB/when a/DT/a page/NN/page is/VBZ/is brought/VBN/brought into/IN/into memory/NN/memory /,/, we/PRP/we insert/VBP/insert it/PRP/it at/IN/at the/DT/the tail/NN/tail of/IN/of the/DT/the queue/NNP/queue. for/IN/for our/PRP$/our example/NN/example reference/NN/reference string/NN/string /,/, our/PRP$/our three/CD/three frames/NNS/frames are/VBP/are initially/RB/initially empty/NNP/empty. the/DT/the first/JJ/first three/CD/three references/NNS/references /:/( 7/CD/7 /,/, 0/-NONE-/0 /,/, 1/CD/1 /:/) cause/NN/cause page/NN/page faults/NNS/faults and/CC/and are/VBP/are brought/VBN/brought into/IN/into these/DT/these empty/JJ/empty frames/NNP/frames. the/DT/the next/JJ/next reference/NN/reference /:/( 2/CD/2 /CD/) replaces/NNS/replaces page/NN/page 7/CD/7 /,/, because/IN/because page/NN/page 7/CD/7 was/VBD/was brought/VBN/brought in/IN/in first/NNP/first. since/IN/since 0/-NONE-/0 is/VBZ/is the/DT/the next/JJ/next reference/NN/reference and/CC/and 0/-NONE-/0 is/VBZ/is already/RB/already in/IN/in memory/NN/memory /,/, we/PRP/we have/VBP/have no/DT/no fault/NN/fault for/IN/for this/DT/this reference/NNP/reference. the/DT/the first/JJ/first reference/NN/reference to/TO/to 3/CD/3 results/NNS/results in/IN/in replacement/NN/replacement of/IN/of page/NN/page 0/-NONE-/0 /,/, since/IN/since 374/CD/374 chapter/NN/chapter 9/CD/9 reference/NN/reference string/VBG/string 7/CD/7 0/-NONE-/0 2/CD/2 0/-NONE-/0 3/CD/3 0/-NONE-/0 4/CD/4 2/CD/2 3/CD/3 0/-NONE-/0 3/CD/3 2/CD/2 2/CD/2 0/-NONE-/0 7/CD/7 0/-NONE-/0 page/NN/page frames/VBZ/frames figure/NN/figure 9.12/CD/9.12 fifo/NN/fifo page-replacement/JJ/page-replacement algorithm/NNP/algorithm. it/PRP/it is/VBZ/is now/RB/now first/RB/first in/IN/in line/NNP/line. because/IN/because of/IN/of this/DT/this replacement/NN/replacement /,/, the/DT/the next/JJ/next reference/NN/reference /,/, to/TO/to 0/-NONE-/0 /,/, will/MD/will fault/NNP/fault. page/NN/page 1/CD/1 is/VBZ/is then/RB/then replaced/VBN/replaced by/IN/by page/NN/page 0/CD/0. this/DT/this process/NN/process continues/VBZ/continues as/IN/as shown/JJ/shown in/IN/in figure/NN/figure 9.12/CD/9.12. every/DT/every time/NN/time a/DT/a fault/NN/fault occurs/VBZ/occurs /,/, we/PRP/we show/VBP/show which/WDT/which pages/NNS/pages are/VBP/are in/IN/in our/PRP$/our three/CD/three frames/NNP/frames. there/RB/there are/VBP/are fifteen/VBN/fifteen faults/NNS/faults altogether/NNP/altogether. the/DT/the fifo/NN/fifo page-replacement/NN/page-replacement algorithm/NN/algorithm is/VBZ/is easy/JJ/easy to/TO/to lmderstand/VB/lmderstand and/CC/and program/NNP/program. however/RB/however /,/, its/PRP$/its performance/NN/performance is/VBZ/is not/RB/not always/RB/always good/NNP/good. on/IN/on the/DT/the one/CD/one hand/NN/hand /,/, the/DT/the page/NN/page replaced/VBD/replaced may/MD/may be/VB/be an/DT/an initialization/NN/initialization module/NN/module that/WDT/that was/VBD/was used/VBN/used a/DT/a long/JJ/long time/NN/time ago/RB/ago and/CC/and is/VBZ/is no/DT/no longer/NN/longer needed/NNP/needed. on/IN/on the/DT/the other/JJ/other hand/NN/hand /,/, it/PRP/it could/MD/could contain/VB/contain a/DT/a heavily/RB/heavily used/VBN/used variable/JJ/variable that/IN/that was/VBD/was initialized/VBN/initialized early/JJ/early and/CC/and is/VBZ/is in/IN/in constant/JJ/constant use/NNP/use. notice/NN/notice that/WDT/that /,/, even/RB/even if/IN/if we/PRP/we select/VBP/select for/IN/for replacement/NN/replacement a/DT/a page/NN/page that/WDT/that is/VBZ/is in/IN/in active/JJ/active use/NN/use /,/, everything/NN/everything still/RB/still works/VBZ/works correctly/NNP/correctly. after/IN/after we/PRP/we replace/VBP/replace an/DT/an active/JJ/active page/NN/page with/IN/with a/DT/a new/JJ/new one/CD/one /,/, a/DT/a fault/NN/fault occurs/VBZ/occurs almost/RB/almost immediately/RB/immediately to/TO/to retrieve/VB/retrieve the/DT/the active/JJ/active page/NNP/page. some/DT/some other/JJ/other page/NN/page must/MD/must be/VB/be replaced/VBN/replaced to/TO/to bring/VB/bring the/DT/the active/JJ/active page/NN/page back/RB/back into/IN/into memory/NNP/memory. thus/RB/thus /,/, a/DT/a bad/JJ/bad replacement/NN/replacement choice/NN/choice increases/NNS/increases the/DT/the page-fault/JJ/page-fault rate/NN/rate and/CC/and slows/VBZ/slows process/NN/process execution/NNP/execution. it/PRP/it does/VBZ/does not/RB/not /,/, however/RB/however /,/, cause/VB/cause incorrect/NN/incorrect execution/NNP/execution. to/TO/to illustrate/VB/illustrate the/DT/the problems/NNS/problems that/WDT/that are/VBP/are possible/JJ/possible with/IN/with a/DT/a fifo/NN/fifo page-replacement/NN/page-replacement algorithm/NN/algorithm /,/, we/PRP/we consider/VBP/consider the/DT/the following/VBG/following reference/NN/reference string/VBG/string /:/: 1/LS/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 4/CD/4 /,/, 1/CD/1 /,/, 2/CD/2 /,/, 5/CD/5 /,/, 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 4/CD/4 /,/, 5/CD/5 figure/NN/figure 9.13/CD/9.13 shows/NNS/shows the/DT/the curve/NN/curve of/IN/of page/NN/page faults/NNS/faults for/IN/for this/DT/this reference/NN/reference string/VBG/string versus/NN/versus the/DT/the number/NN/number of/IN/of available/JJ/available frames/NNP/frames. notice/NN/notice that/WDT/that the/DT/the number/NN/number of/IN/of faults/NNS/faults for/IN/for four/CD/four frames/NNS/frames /:/( ten/RB/ten /:/) is/VBZ/is greater/JJR/greater than/IN/than the/DT/the number/NN/number of/IN/of faults/NNS/faults for/IN/for three/CD/three frames/NNS/frames /:/( nine/CD/nine /CD/) !/./! this/DT/this most/RBS/most unexpected/JJ/unexpected result/NN/result is/VBZ/is known/VBN/known as/IN/as /./. for/IN/for some/DT/some page-replacement/JJ/page-replacement algorithms/NNS/algorithms /,/, the/DT/the page-fault/JJ/page-fault rate/NN/rate may/MD/may increase/VB/increase as/IN/as the/DT/the number/NN/number of/IN/of allocated/VBN/allocated frames/NNS/frames increases/NNP/increases. we/PRP/we would/MD/would expect/VB/expect that/IN/that giving/VBG/giving more/JJR/more memory/NN/memory to/TO/to a/DT/a process/NN/process would/MD/would improve/VB/improve its/PRP$/its performance/NNP/performance. in/IN/in some/DT/some early/JJ/early research/NN/research /,/, investigators/NNS/investigators noticed/VBD/noticed that/IN/that this/DT/this assumption/NN/assumption was/VBD/was not/RB/not always/RB/always true/NNP/true. belady/RB/belady 's/POS/'s anomaly/RB/anomaly was/VBD/was discovered/VBN/discovered as/IN/as a/DT/a result/NNP/result. 9.4.3/CD/9.4.3 optimal/JJ/optimal page/NN/page replacement/NN/replacement of/IN/of belady/JJ/belady 's/POS/'s anomaly/RB/anomaly was/VBD/was the/DT/the search/NN/search for/IN/for an/DT/an which/WDT/which has/VBZ/has the/DT/the lowest/JJS/lowest page-fault/JJ/page-fault rate/NN/rate of/IN/of all/DT/all algorithms/NNS/algorithms and/CC/and will/MD/will never/RB/never suffer/VB/suffer from/IN/from belady/JJ/belady 's/POS/'s anomaly/NNP/anomaly. such/JJ/such an/DT/an algorithm/NN/algorithm does/VBZ/does exist/NN/exist and/CC/and has/VBZ/has been/VBN/been called/VBN/called opt/NN/opt or/CC/or min/NNP/min. it/PRP/it is/VBZ/is simply/RB/simply this/DT/this /:/: replace/NN/replace the/DT/the page/NN/page that/IN/that will/MD/will not/RB/not be/VB/be used/VBN/used for/IN/for the/DT/the longest/JJS/longest period/NN/period of/IN/of time/NNP/time. 9.4/CD/9.4 375/CD/375 16/CD/16 ~/CD/~ /:/: /:/: /:/: 5/CD/5 2/CD/2 12/CD/12 cj/NN/cj /:/) moj/NN/moj 10/CD/10 0/CD/0.. 0/-NONE-/0 8/CD/8 cj/NN/cj _o/NNP/_o e/NN/e 6/CD/6 /:/: /:/: /:/: 5/CD/5 c/NN/c 4/CD/4 2/CD/2 number/NN/number of/IN/of frames/NNS/frames figure/VBP/figure 9.13/CD/9.13 page-fault/JJ/page-fault curve/NN/curve for/IN/for fifo/NN/fifo replacement/NN/replacement on/IN/on a/DT/a reference/NN/reference string/NNP/string. use/NN/use of/IN/of this/DT/this page-replacement/JJ/page-replacement algorithm/NN/algorithm guarantees/NNS/guarantees the/DT/the lowest/JJS/lowest possible/JJ/possible pagefault/NN/pagefault rate/NN/rate for/IN/for a/DT/a fixed/VBN/fixed number/NN/number of/IN/of frames/NNP/frames. for/IN/for example/NN/example /,/, on/IN/on our/PRP$/our sample/NN/sample reference/NN/reference string/VBG/string /,/, the/DT/the optimal/JJ/optimal page-replacement/JJ/page-replacement algorithm/NN/algorithm would/MD/would yield/VB/yield nine/CD/nine page/NN/page faults/NNS/faults /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 9.14/CD/9.14. the/DT/the first/JJ/first three/CD/three references/NNS/references cause/VBP/cause faults/NNS/faults that/IN/that fill/NN/fill the/DT/the three/CD/three empty/NN/empty frames/NNP/frames. the/DT/the reference/NN/reference to/TO/to page/NN/page 2/CD/2 replaces/NNS/replaces page/NN/page 7/CD/7 /,/, because/IN/because page/NN/page 7/CD/7 will/MD/will not/RB/not be/VB/be used/VBN/used until/IN/until reference/NN/reference 18/CD/18 /,/, whereas/IN/whereas page/NN/page 0/-NONE-/0 will/MD/will be/VB/be used/VBN/used at/IN/at 5/CD/5 /,/, and/CC/and page/NN/page 1/CD/1 at/IN/at 14/CD/14. the/DT/the reference/NN/reference to/TO/to page/NN/page 3/CD/3 replaces/NNS/replaces page/NN/page 1/CD/1 /,/, as/IN/as page/NN/page 1/CD/1 will/MD/will be/VB/be the/DT/the last/JJ/last of/IN/of the/DT/the three/CD/three pages/NNS/pages in/IN/in memory/NN/memory to/TO/to be/VB/be referenced/VBN/referenced again/-NONE-/again. with/IN/with only/RB/only nine/CD/nine page/NN/page faults/NNS/faults /,/, optimal/JJ/optimal replacement/NN/replacement is/VBZ/is much/JJ/much better/NN/better than/IN/than a/DT/a fifo/NN/fifo algorithm/NN/algorithm /,/, which/WDT/which results/NNS/results in/IN/in fifteen/CD/fifteen faults/NNP/faults. /NNP/( if/IN/if we/PRP/we ignore/VBP/ignore the/DT/the first/JJ/first three/CD/three /,/, which/WDT/which all/DT/all algorithms/NNS/algorithms must/MD/must suffer/VB/suffer /,/, then/RB/then optimal/JJ/optimal replacement/NN/replacement is/VBZ/is twice/NN/twice as/IN/as good/JJ/good as/IN/as fifo/NN/fifo replacement/NNP/replacement. /NNP/) irt/NN/irt fact/NN/fact /,/, no/DT/no replacement/NN/replacement algorithm/NN/algorithm can/MD/can process/NN/process this/DT/this reference/NN/reference string/VBG/string in/IN/in three/CD/three frames/NNS/frames with/IN/with fewer/JJR/fewer than/IN/than nine/CD/nine faults/NNP/faults. unfortunately/RB/unfortunately /,/, the/DT/the optimal/JJ/optimal page-replacement/JJ/page-replacement algorithm/NN/algorithm is/VBZ/is difficult/JJ/difficult to/TO/to implement/NN/implement /,/, because/IN/because it/PRP/it requires/VBZ/requires future/JJ/future knowledge/NN/knowledge of/IN/of the/DT/the reference/NN/reference string/NNP/string. /NNP/( we/PRP/we encountered/VBD/encountered a/DT/a similar/JJ/similar situation/NN/situation with/IN/with the/DT/the sjf/NN/sjf cpu-schedulin.g/NN/cpu-schedulin.g algorithm/NN/algorithm in/IN/in section/NN/section 5.3.2/CD/5.3.2. /CD/) as/IN/as a/DT/a result/NN/result /,/, the/DT/the optimal/JJ/optimal algorithm/NN/algorithm is/VBZ/is used/VBN/used mainly/RB/mainly for/IN/for comparison/NN/comparison studies/NNP/studies. for/IN/for instance/NN/instance /,/, it/PRP/it may/MD/may be/VB/be useful/JJ/useful to/TO/to know/VB/know that/IN/that /,/, although/IN/although a/DT/a new/JJ/new algorithm/NN/algorithm reference/NN/reference string/VBG/string 7/CD/7 0/-NONE-/0 2/CD/2 0/-NONE-/0 3/CD/3 0/-NONE-/0 4/CD/4 2/CD/2 3/CD/3 0/-NONE-/0 3/CD/3 2/CD/2 2/CD/2 0/-NONE-/0 7/CD/7 0/-NONE-/0 page/NN/page frames/VBZ/frames figure/NN/figure 9.14/CD/9.14 optimal/JJ/optimal page-replacement/JJ/page-replacement algorithm/NNP/algorithm. 376/CD/376 chapter/NN/chapter 9/CD/9 is/VBZ/is not/RB/not optimat/JJ/optimat it/PRP/it is/VBZ/is within/IN/within 12.3/CD/12.3 percent/NN/percent of/IN/of optimal/JJ/optimal at/IN/at worst/JJS/worst and/CC/and within/IN/within 4.7/CD/4.7 percent/NN/percent on/IN/on average/NNP/average. 9.4.4/CD/9.4.4 lru/NN/lru page/NN/page replacement/NN/replacement lf/NN/lf the/DT/the optimal/JJ/optimal algorithm/NN/algorithm is/VBZ/is not/RB/not feasible/JJ/feasible /,/, perhaps/RB/perhaps an/DT/an approximation/NN/approximation of/IN/of the/DT/the optimal/JJ/optimal algorithm/NN/algorithm is/VBZ/is possible/NNP/possible. the/DT/the key/JJ/key distinction/NN/distinction between/IN/between the/DT/the fifo/NN/fifo and/CC/and opt/NN/opt algorithms/NNS/algorithms /:/( other/JJ/other than/IN/than looking/VBG/looking backward/NN/backward versus/NN/versus forward/NN/forward in/IN/in time/NN/time /:/) is/VBZ/is that/IN/that the/DT/the fifo/NN/fifo algorithm/NN/algorithm uses/NNS/uses the/DT/the time/NN/time when/WRB/when a/DT/a page/NN/page was/VBD/was brought/VBN/brought into/IN/into memory/NN/memory /,/, whereas/VBZ/whereas the/DT/the opt/NN/opt algorithm/NN/algorithm uses/NNS/uses the/DT/the time/NN/time when/WRB/when a/DT/a page/NN/page is/VBZ/is to/TO/to be/VB/be used/NNP/used. if/IN/if we/PRP/we use/VBP/use the/DT/the recent/JJ/recent past/NN/past as/IN/as an/DT/an approximation/NN/approximation of/IN/of the/DT/the near/NN/near future/NN/future /,/, then/RB/then we/PRP/we can/MD/can replace/VB/replace the/DT/the that/WDT/that has/VBZ/has not/RB/not been/VBN/been used/VBN/used for/IN/for the/DT/the longest/JJS/longest period/NN/period of/IN/of time/NNP/time. this/DT/this approach/NN/approach is/VBZ/is the/DT/the lru/NN/lru replacement/NN/replacement associates/NNS/associates with/IN/with each/DT/each page/NN/page the/DT/the time/NN/time of/IN/of that/DT/that page/NN/page 's/POS/'s last/JJ/last use/NNP/use. when/WRB/when a/DT/a page/NN/page must/MD/must be/VB/be replaced/VBN/replaced /,/, lru/NN/lru chooses/NNS/chooses the/DT/the page/NN/page that/IN/that has/VBZ/has not/RB/not been/VBN/been used/VBN/used for/IN/for the/DT/the longest/JJS/longest period/NN/period of/IN/of time/NNP/time. we/PRP/we can/MD/can think/VB/think of/IN/of this/DT/this strategy/NN/strategy as/IN/as the/DT/the optimal/JJ/optimal page-replacement/JJ/page-replacement algorithm/NN/algorithm looking/VBG/looking backward/NN/backward in/IN/in time/NN/time /,/, rather/RB/rather than/IN/than forward/NNP/forward. /NNP/( strangely/RB/strangely /,/, if/IN/if we/PRP/we let/VBP/let sr/NN/sr be/VB/be the/DT/the reverse/NN/reverse of/IN/of a/DT/a reference/NN/reference strings/NNS/strings /,/, then/RB/then the/DT/the page-fault/NN/page-fault rate/NN/rate for/IN/for the/DT/the opt/NN/opt algorithm/NN/algorithm on/IN/on sis/NN/sis the/DT/the same/JJ/same as/IN/as the/DT/the page-fault/JJ/page-fault rate/NN/rate for/IN/for the/DT/the opt/NN/opt algorithm/NN/algorithm on/IN/on sr/NNP/sr. similarly/RB/similarly /,/, the/DT/the page-fault/JJ/page-fault rate/NN/rate for/IN/for the/DT/the lru/NN/lru algorithm/NN/algorithm on/IN/on sis/NN/sis the/DT/the same/JJ/same as/IN/as the/DT/the page-fault/JJ/page-fault rate/NN/rate for/IN/for the/DT/the lru/NN/lru algorithm/NN/algorithm on/IN/on sr/NNP/sr. /NNP/) the/DT/the result/NN/result of/IN/of applying/NN/applying lru/NN/lru replacement/NN/replacement to/TO/to our/PRP$/our example/NN/example reference/NN/reference string/NN/string is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 9.15/CD/9.15. the/DT/the lru/NN/lru algorithm/NN/algorithm produces/NNS/produces twelve/VBP/twelve faults/NNP/faults. notice/NN/notice that/WDT/that the/DT/the first/JJ/first five/CD/five faults/NNS/faults are/VBP/are the/DT/the same/JJ/same as/IN/as those/DT/those for/IN/for optimal/JJ/optimal replacement/NNP/replacement. when/WRB/when the/DT/the reference/NN/reference to/TO/to page/NN/page 4/CD/4 occurs/NNS/occurs /,/, however/RB/however /,/, lru/NN/lru replacement/NN/replacement sees/NNS/sees that/WDT/that /,/, of/IN/of the/DT/the three/CD/three frames/NNS/frames in/IN/in memory/NN/memory /,/, page/NN/page 2/CD/2 was/VBD/was used/VBN/used least/JJS/least recently/NNP/recently. thus/RB/thus /,/, the/DT/the lru/NN/lru algorithm/NN/algorithm replaces/NNS/replaces page/NN/page 2/CD/2 /,/, not/RB/not knowing/VBG/knowing that/IN/that page/NN/page 2/CD/2 is/VBZ/is about/IN/about to/TO/to be/VB/be used/NNP/used. when/WRB/when it/PRP/it then/RB/then faults/VBZ/faults for/IN/for page/NN/page 2/CD/2 /,/, the/DT/the lru/NN/lru algorithm/NN/algorithm replaces/NNS/replaces page/NN/page 3/CD/3 /,/, since/IN/since it/PRP/it is/VBZ/is now/RB/now the/DT/the least/JJS/least recently/RB/recently used/VBD/used of/IN/of the/DT/the three/CD/three pages/NNS/pages in/IN/in memory/NNP/memory. despite/IN/despite these/DT/these problems/NNS/problems /,/, lru/VBP/lru replacement/NN/replacement with/IN/with twelve/JJ/twelve faults/NNS/faults is/VBZ/is much/JJ/much better/NN/better than/IN/than fifo/NN/fifo replacement/NN/replacement with/IN/with fifteen/NNP/fifteen. the/DT/the lru/NN/lru policy/NN/policy is/VBZ/is often/RB/often used/VBN/used as/IN/as a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm and/CC/and is/VBZ/is considered/VBN/considered to/TO/to be/VB/be good/NNP/good. the/DT/the major/JJ/major problem/NN/problem is/VBZ/is how/WRB/how to/TO/to implement/VB/implement lru/NN/lru replacement/NNP/replacement. an/DT/an lru/NN/lru page-replacement/NN/page-replacement algorithm/NN/algorithm may/MD/may require/VB/require substantial/JJ/substantial hardware/NN/hardware assistance/NNP/assistance. the/DT/the problem/NN/problem is/VBZ/is to/TO/to determine/VB/determine an/DT/an order/NN/order for/IN/for the/DT/the frames/NNS/frames defined/VBD/defined by/IN/by the/DT/the time/NN/time of/IN/of last/JJ/last use/NNP/use. two/CD/two implementations/NNS/implementations are/VBP/are feasible/JJ/feasible /:/: counters/NNP/counters. in/IN/in the/DT/the simplest/NN/simplest case/NN/case /,/, we/PRP/we associate/VBP/associate with/IN/with each/DT/each page-table/JJ/page-table entry/NN/entry a/DT/a time-of-use/JJ/time-of-use field/NN/field and/CC/and add/VBD/add to/TO/to the/DT/the cpu/NN/cpu a/DT/a logical/JJ/logical clock/NN/clock or/CC/or counter/NNP/counter. the/DT/the clock/NN/clock is/VBZ/is reference/NN/reference string/VBG/string 7/CD/7 0/-NONE-/0 2/CD/2 0/-NONE-/0 3/CD/3 0/-NONE-/0 4/CD/4 2/CD/2 3/CD/3 0/-NONE-/0 3/CD/3 2/CD/2 2/CD/2 0/-NONE-/0 7/CD/7 0/-NONE-/0 page/NN/page frames/VBZ/frames figure/NN/figure 9.15/CD/9.15 lru/NN/lru page-replacement/JJ/page-replacement algorithm/NNP/algorithm. 9.4/CD/9.4 377/CD/377 incremented/VBN/incremented for/IN/for every/DT/every memory/NN/memory reference/NNP/reference. whenever/NN/whenever a/DT/a reference/NN/reference to/TO/to a/DT/a page/NN/page is/VBZ/is made/VBN/made /,/, the/DT/the contents/NNS/contents of/IN/of the/DT/the clock/NN/clock register/NN/register are/VBP/are copied/VBN/copied to/TO/to the/DT/the ti1ne-of-use/JJ/ti1ne-of-use field/NN/field in/IN/in the/DT/the page-table/JJ/page-table entry/NN/entry for/IN/for that/DT/that page/NNP/page. in/IN/in this/DT/this way/NN/way /,/, we/PRP/we always/RB/always have/VBP/have the/DT/the time/NN/time of/IN/of the/DT/the last/JJ/last reference/NN/reference to/TO/to each/DT/each page/NNP/page. we/PRP/we replace/VBP/replace the/DT/the page/NN/page with/IN/with the/DT/the smallest/JJS/smallest time/NN/time value/NNP/value. this/DT/this scheme/NN/scheme requires/VBZ/requires a/DT/a search/NN/search of/IN/of the/DT/the page/NN/page table/NN/table to/TO/to find/VB/find the/DT/the lru/NN/lru page/NN/page and/CC/and a/DT/a write/JJ/write to/TO/to memory/NN/memory /:/( to/TO/to the/DT/the time-of-use/JJ/time-of-use field/NN/field in/IN/in the/DT/the page/NN/page table/NN/table /:/) for/IN/for each/DT/each memory/NN/memory access/NNP/access. the/DT/the times/NNS/times must/MD/must also/RB/also be/VB/be m/PRP/m ~/:/~ aintained/VBD/aintained when/WRB/when page/NN/page tables/VBZ/tables are/VBP/are changed/VBN/changed /-NONE-/( due/JJ/due to/TO/to cpu/VB/cpu scheduling/NN/scheduling /:/) /./. overflow/NN/overflow of/IN/of the/DT/the clock/NN/clock must/MD/must be/VB/be considered/NNP/considered. stack/NN/stack another/DT/another approach/NN/approach to/TO/to implementing/NN/implementing lru/NN/lru replacement/NN/replacement is/VBZ/is to/TO/to keep/VB/keep a/DT/a stack/NN/stack of/IN/of page/NN/page numbers/NNP/numbers. whenever/NN/whenever a/DT/a page/NN/page is/VBZ/is referenced/VBN/referenced /,/, it/PRP/it is/VBZ/is removed/VBN/removed from/IN/from the/DT/the stack/NN/stack and/CC/and put/VBD/put on/IN/on the/DT/the top/NNP/top. in/IN/in this/DT/this way/NN/way /,/, the/DT/the most/RBS/most recently/RB/recently used/VBN/used page/NN/page is/VBZ/is always/RB/always at/IN/at the/DT/the top/JJ/top of/IN/of the/DT/the stack/NN/stack and/CC/and the/DT/the least/JJS/least recently/RB/recently used/VBD/used page/NN/page is/VBZ/is always/RB/always at/IN/at the/DT/the bottom/NN/bottom /:/( figure/NN/figure 9.16/CD/9.16 /CD/) /./. because/IN/because entries/NNS/entries must/MD/must be/VB/be removed/VBN/removed from/IN/from the/DT/the middle/NN/middle of/IN/of the/DT/the stack/NN/stack /,/, it/PRP/it is/VBZ/is best/JJS/best to/TO/to implement/VB/implement this/DT/this approach/NN/approach by/IN/by using/VBG/using a/DT/a doubly/RB/doubly linked/VBN/linked list/NN/list with/IN/with a/DT/a head/NN/head pointer/NN/pointer and/CC/and a/DT/a tail/NN/tail pointer/NNP/pointer. removing/NN/removing a/DT/a page/NN/page and/CC/and putting/VBG/putting it/PRP/it on/IN/on the/DT/the top/JJ/top of/IN/of the/DT/the stack/NN/stack then/RB/then requires/VBZ/requires changing/VBG/changing six/CD/six pointers/NNS/pointers at/IN/at worst/NNP/worst. each/DT/each update/NN/update is/VBZ/is a/DT/a little/RB/little more/RBR/more expensive/JJ/expensive /,/, but/CC/but there/EX/there is/VBZ/is no/DT/no search/NN/search for/IN/for a/DT/a replacement/NN/replacement ;/:/; the/DT/the tail/NN/tail pointer/NN/pointer points/NNS/points to/TO/to the/DT/the bottom/NN/bottom of/IN/of the/DT/the stack/NN/stack /,/, which/WDT/which is/VBZ/is the/DT/the lru/NN/lru page/NNP/page. this/DT/this approach/NN/approach is/VBZ/is particularly/RB/particularly appropriate/JJ/appropriate for/IN/for software/NN/software or/CC/or microcode/VB/microcode implementations/NNS/implementations of/IN/of lru/NN/lru replacement/NNP/replacement. like/IN/like optimal/JJ/optimal replacement/NN/replacement /,/, lru/NN/lru replacement/NN/replacement does/VBZ/does not/RB/not suffer/VB/suffer from/IN/from belady/JJ/belady 's/POS/'s both/DT/both belong/JJ/belong to/TO/to a/DT/a class/NN/class of/IN/of page-replacement/JJ/page-replacement algorithms/NNS/algorithms /,/, called/VBN/called si/NN/si /:/: ack/NN/ack that/IN/that can/MD/can never/RB/never exhibit/VB/exhibit belady/JJ/belady 's/POS/'s anomaly/NNP/anomaly. a/DT/a stack/NN/stack algorithm/NN/algorithm is/VBZ/is an/DT/an algorithm/NN/algorithm for/IN/for which/WDT/which it/PRP/it can/MD/can be/VB/be shown/VBN/shown that/IN/that the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in memory/NN/memory for/IN/for n/NN/n frames/NNS/frames is/VBZ/is always/RB/always a/DT/a subset/NN/subset of/IN/of the/DT/the set/NN/set of/IN/of pages/NNS/pages that/WDT/that would/MD/would be/VB/be in/IN/in memory/NN/memory with/IN/with n/NN/n +/:/+ 1/CD/1 frames/NNP/frames. for/IN/for lru/NN/lru replacement/NN/replacement /,/, the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in memory/NN/memory would/MD/would be/VB/be the/DT/the n/NN/n most/JJS/most recently/RB/recently referenced/VBD/referenced pages/NNP/pages. if/IN/if the/DT/the number/NN/number of/IN/of frames/NNS/frames is/VBZ/is increased/VBN/increased /,/, these/DT/these n/NN/n pages/NNS/pages will/MD/will still/RB/still be/VB/be the/DT/the most/JJS/most recently/RB/recently referenced/VBD/referenced and/CC/and so/RB/so will/MD/will still/RB/still be/VB/be in/IN/in memory/NNP/memory. note/NN/note that/IN/that neither/DT/neither implementation/NN/implementation of/IN/of lru/NN/lru would/MD/would be/VB/be conceivable/JJ/conceivable without/IN/without hardware/NN/hardware assistance/NN/assistance beyond/IN/beyond the/DT/the standard/JJ/standard tlb/NN/tlb registers/NNP/registers. the/DT/the updating/NN/updating of/IN/of the/DT/the reference/NN/reference string/VBG/string 4/CD/4 7/CD/7 0/-NONE-/0 7/CD/7 stack/NN/stack before/IN/before a/DT/a 0/-NONE-/0 2/CD/2 stack/NN/stack after/IN/after b/NN/b 2/CD/2 7/CD/7 2/CD/2 i/PRP/i l/VBP/l a/DT/a b/NN/b figure/NN/figure 9.16/CD/9.16 use/NN/use of/IN/of a/DT/a stack/NN/stack to/TO/to record/VB/record the/DT/the most/JJS/most recent/JJ/recent page/NN/page references/NNP/references. 378/CD/378 chapter/NN/chapter 9/CD/9 clock/NN/clock fields/NNS/fields or/CC/or stack/VBP/stack must/MD/must be/VB/be done/VBN/done for/IN/for every/DT/every memory/NN/memory reference/NNP/reference. if/IN/if we/PRP/we were/VBD/were to/TO/to use/VB/use an/DT/an interrupt/NN/interrupt for/IN/for every/DT/every reference/NN/reference to/TO/to allow/VB/allow software/NN/software to/TO/to update/VB/update such/JJ/such data/NNS/data structures/NNS/structures /,/, it/PRP/it would/MD/would slow/VB/slow every/DT/every memory/NN/memory reference/NN/reference by/IN/by a/DT/a factor/NN/factor of/IN/of at/IN/at least/JJS/least ten/NNS/ten /,/, hence/NN/hence slowing/VBG/slowing every/DT/every user/NN/user process/NN/process by/IN/by a/DT/a factor/NN/factor of/IN/of ten/NNP/ten. few/JJ/few systems/NNS/systems could/MD/could tolerate/VB/tolerate that/IN/that level/NN/level of/IN/of overhead/JJ/overhead for/IN/for memory/NN/memory management/NNP/management. 9.4.5/CD/9.4.5 lru-approximation/NN/lru-approximation page/NN/page replacement/NN/replacement few/JJ/few computer/NN/computer systems/NNS/systems provide/VB/provide sufficient/JJ/sufficient hardware/NN/hardware support/NN/support for/IN/for true/JJ/true lru/NN/lru page/NN/page replacement/NNP/replacement. some/DT/some systems/NNS/systems provide/VBP/provide no/DT/no hardware/NN/hardware support/NN/support /,/, and/CC/and other/JJ/other pagereplacement/NN/pagereplacement algorithms/NNS/algorithms /:/( such/JJ/such as/IN/as a/DT/a fifo/NN/fifo algorithm/NN/algorithm /:/) must/MD/must be/VB/be used/NNP/used. many/JJ/many systems/NNS/systems provide/VBP/provide some/DT/some help/NN/help /,/, however/RB/however /,/, in/IN/in the/DT/the form/NN/form of/IN/of a/DT/a the/DT/the reference/NN/reference bit/NN/bit for/IN/for a/DT/a page/NN/page is/VBZ/is set/VBN/set by/IN/by the/DT/the hardware/NN/hardware whenever/NN/whenever that/WDT/that page/NN/page is/VBZ/is referenced/VBN/referenced /-NONE-/( either/RB/either a/DT/a read/NN/read or/CC/or a/DT/a write/JJ/write to/TO/to any/DT/any byte/NN/byte in/IN/in the/DT/the page/NN/page /:/) /./. reference/NN/reference bits/NNS/bits are/VBP/are associated/VBN/associated with/IN/with each/DT/each entry/NN/entry in/IN/in the/DT/the page/NN/page table/NNP/table. initially/RB/initially /,/, all/DT/all bits/NNS/bits are/VBP/are cleared/VBN/cleared /-NONE-/( to/TO/to 0/-NONE-/0 /:/) by/IN/by the/DT/the operating/NN/operating system/NNP/system. as/IN/as a/DT/a user/NN/user process/NN/process executes/VBZ/executes /,/, the/DT/the bit/NN/bit associated/VBN/associated with/IN/with each/DT/each page/NN/page referenced/VBN/referenced is/VBZ/is set/VBN/set /-NONE-/( to/TO/to 1/CD/1 /CD/) by/IN/by the/DT/the hardware/NNP/hardware. after/IN/after some/DT/some time/NN/time /,/, we/PRP/we can/MD/can determine/VB/determine which/WDT/which pages/NNS/pages have/VBP/have been/VBN/been used/VBN/used and/CC/and which/WDT/which have/VBP/have not/RB/not been/VBN/been used/VBN/used by/IN/by examining/NN/examining the/DT/the reference/NN/reference bits/VBZ/bits /,/, although/IN/although we/PRP/we do/VBP/do not/RB/not know/VB/know the/DT/the order/NN/order of/IN/of use/NNP/use. this/DT/this information/NN/information is/VBZ/is the/DT/the basis/NN/basis for/IN/for many/JJ/many page-replacement/JJ/page-replacement algorithms/NNS/algorithms that/WDT/that approximate/NN/approximate lru/VBP/lru replacement/NNP/replacement. 9.4.5.1/CD/9.4.5.1 additional-reference-bits/NNS/additional-reference-bits algorithm/NN/algorithm we/PRP/we can/MD/can gain/VB/gain additional/JJ/additional ordering/NN/ordering information/NN/information by/IN/by recording/VBG/recording the/DT/the reference/NN/reference bits/VBZ/bits at/IN/at regular/JJ/regular intervals/NNP/intervals. we/PRP/we can/MD/can keep/VB/keep an/DT/an 8-bit/JJ/8-bit byte/NN/byte for/IN/for each/DT/each page/NN/page in/IN/in a/DT/a table/NN/table in/IN/in memory/NNP/memory. at/IN/at regular/JJ/regular intervals/NNS/intervals /:/( say/VBP/say /,/, every/DT/every 100/CD/100 milliseconds/NNS/milliseconds /:/) /,/, a/DT/a timer/NN/timer interrupt/NN/interrupt transfers/NNS/transfers control/NN/control to/TO/to the/DT/the operating/NN/operating system/NNP/system. the/DT/the operating/NN/operating system/NN/system shifts/NNS/shifts the/DT/the reference/NN/reference bit/NN/bit for/IN/for each/DT/each page/NN/page into/IN/into the/DT/the high-order/JJ/high-order bit/NN/bit of/IN/of its/PRP$/its 8-bit/JJ/8-bit byte/NN/byte /,/, shifting/VBG/shifting the/DT/the other/JJ/other bits/NNS/bits right/RB/right by/IN/by 1/CD/1 bit/NN/bit and/CC/and discarding/VBG/discarding the/DT/the low-order/JJ/low-order bit/NNP/bit. these/DT/these 8-bit/JJ/8-bit shift/NN/shift registers/NNS/registers contain/VBP/contain the/DT/the history/NN/history of/IN/of page/NN/page use/NN/use for/IN/for the/DT/the last/JJ/last eight/NN/eight time/NN/time periods/NNP/periods. if/IN/if the/DT/the shift/NN/shift register/NN/register contains/VBZ/contains 00000000/CD/00000000 /,/, for/IN/for example/NN/example /,/, then/RB/then the/DT/the page/NN/page has/VBZ/has not/RB/not been/VBN/been used/VBN/used for/IN/for eight/CD/eight time/NN/time periods/NNS/periods ;/:/; a/DT/a page/NN/page that/WDT/that is/VBZ/is used/VBN/used at/IN/at least/JJS/least once/RB/once in/IN/in each/DT/each period/NN/period has/VBZ/has a/DT/a shift/NN/shift register/NN/register value/NN/value of/IN/of 11111111/CD/11111111. a/DT/a page/NN/page with/IN/with a/DT/a history/NN/history register/NN/register value/NN/value of/IN/of 11000100/CD/11000100 has/VBZ/has been/VBN/been used/VBN/used more/RBR/more recently/RB/recently than/IN/than one/CD/one with/IN/with a/DT/a value/NN/value of/IN/of 01110111/CD/01110111. if/IN/if we/PRP/we interpret/VBP/interpret these/DT/these 8-bit/JJ/8-bit bytes/NNS/bytes as/IN/as unsigned/VBN/unsigned integers/NNS/integers /,/, the/DT/the page/NN/page with/IN/with the/DT/the lowest/JJS/lowest number/NN/number is/VBZ/is the/DT/the lru/NN/lru page/NN/page /,/, and/CC/and it/PRP/it can/MD/can be/VB/be replaced/NNP/replaced. notice/NN/notice that/WDT/that the/DT/the numbers/NNS/numbers are/VBP/are not/RB/not guaranteed/VBN/guaranteed to/TO/to be/VB/be unique/JJ/unique /,/, however/NNP/however. we/PRP/we can/MD/can either/VB/either replace/NN/replace /:/( swap/NN/swap out/IN/out /CD/) all/PDT/all pages/NNS/pages with/IN/with the/DT/the smallest/JJS/smallest value/NN/value or/CC/or use/VBP/use the/DT/the fifo/NN/fifo method/NN/method to/TO/to choose/VB/choose among/IN/among them/NNP/them. the/DT/the number/NN/number of/IN/of bits/NNS/bits of/IN/of history/NN/history included/VBD/included in/IN/in the/DT/the shift/NN/shift register/NN/register can/MD/can be/VB/be varied/VBN/varied /,/, of/IN/of course/NN/course /,/, and/CC/and is/VBZ/is selected/VBN/selected /-NONE-/( depending/VBG/depending on/IN/on the/DT/the hardware/NN/hardware available/JJ/available /NN/) to/TO/to make/VB/make the/DT/the updating/NN/updating as/IN/as fast/JJ/fast as/IN/as possible/NNP/possible. in/IN/in the/DT/the extreme/NN/extreme case/NN/case /,/, the/DT/the number/NN/number can/MD/can be/VB/be reduced/VBN/reduced to/TO/to zero/VB/zero /,/, leaving/VBG/leaving only/RB/only the/DT/the reference/NN/reference bit/NN/bit itself/NNP/itself. this/DT/this algorithm/NN/algorithm is/VBZ/is called/VBN/called the/DT/the 9.4.5.2/CD/9.4.5.2 second-chance/NN/second-chance algorithm/NN/algorithm the/DT/the basic/JJ/basic algorithm/NN/algorithm of/IN/of second-chance/NN/second-chance replacement/NN/replacement is/VBZ/is a/DT/a fifo/NN/fifo replacement/NN/replacement algorithm/NNP/algorithm. when/WRB/when a/DT/a page/NN/page has/VBZ/has been/VBN/been selected/VBN/selected /,/, however/RB/however /,/, we/PRP/we inspect/VBP/inspect its/PRP$/its reference/NN/reference bit/NNP/bit. if/IN/if the/DT/the value/NN/value is/VBZ/is 0/-NONE-/0 /,/, we/PRP/we proceed/VBD/proceed to/TO/to replace/VB/replace this/DT/this page/NN/page ;/:/; but/CC/but if/IN/if the/DT/the reference/NN/reference bit/NN/bit is/VBZ/is set/VBN/set to/TO/to 1/CD/1 /,/, we/PRP/we give/VBP/give the/DT/the page/NN/page a/DT/a second/JJ/second chance/NN/chance and/CC/and move/VB/move on/IN/on to/TO/to select/VB/select the/DT/the next/JJ/next next/JJ/next victim/NN/victim 9.4/CD/9.4 reference/NN/reference pages/NNS/pages reference/NN/reference pages/NNS/pages bits/VBZ/bits bits/NNS/bits circular/JJ/circular queue/NN/queue of/IN/of pages/NNS/pages circular/JJ/circular queue/NN/queue of/IN/of pages/NNS/pages /:/( a/DT/a /NN/) /:/( b/NN/b /:/) figure/NN/figure 9.17/CD/9.17 second-chance/NN/second-chance /:/( clock/NN/clock /:/) page-replacement/JJ/page-replacement algorithm/NNP/algorithm. 379/CD/379 fifo/NN/fifo page/NNP/page. when/WRB/when a/DT/a page/NN/page gets/VBZ/gets a/DT/a second/JJ/second chance/NN/chance /,/, its/PRP$/its reference/NN/reference bit/NN/bit is/VBZ/is cleared/VBN/cleared /,/, and/CC/and its/PRP$/its arrival/NN/arrival time/NN/time is/VBZ/is reset/VBN/reset to/TO/to the/DT/the current/JJ/current time/NNP/time. thus/RB/thus /,/, a/DT/a page/NN/page that/WDT/that is/VBZ/is given/VBN/given a/DT/a second/JJ/second chance/NN/chance will/MD/will not/RB/not be/VB/be replaced/VBN/replaced until/IN/until all/DT/all other/JJ/other pages/NNS/pages have/VBP/have been/VBN/been replaced/VBN/replaced /-NONE-/( or/CC/or given/VBN/given second/JJ/second chances/NNS/chances /:/) /./. in/IN/in addition/NN/addition /,/, if/IN/if a/DT/a page/NN/page is/VBZ/is used/VBN/used often/RB/often enough/RB/enough to/TO/to keep/VB/keep its/PRP$/its reference/NN/reference bit/NN/bit set/NN/set /,/, it/PRP/it will/MD/will never/RB/never be/VB/be replaced/NNP/replaced. one/CD/one way/NN/way to/TO/to implement/VB/implement the/DT/the second-chance/NN/second-chance algorithm/NN/algorithm /:/( sometimes/RB/sometimes referred/VBN/referred to/TO/to as/RB/as the/DT/the clock/NN/clock algorithm/NN/algorithm /:/) is/VBZ/is as/IN/as a/DT/a circular/JJ/circular queue/NNP/queue. a/DT/a poi11ter/NNP/poi11ter /NNP/( that/IN/that is/VBZ/is /,/, a/DT/a hand/NN/hand on/IN/on the/DT/the clock/NN/clock /:/) indicates/VBZ/indicates which/WDT/which page/NN/page is/VBZ/is to/TO/to be/VB/be replaced/VBN/replaced next/NNP/next. when/WRB/when a/DT/a frame/NN/frame is/VBZ/is needed/VBN/needed /,/, the/DT/the pointer/NN/pointer advances/NNS/advances until/IN/until it/PRP/it finds/VBZ/finds a/DT/a page/NN/page with/IN/with a/DT/a 0/-NONE-/0 reference/NN/reference bit/NNP/bit. as/IN/as it/PRP/it advances/VBZ/advances /,/, it/PRP/it clears/VBZ/clears the/DT/the reference/NN/reference bits/VBZ/bits /:/( figure/NN/figure 9.17/CD/9.17 /CD/) /./. once/RB/once a/DT/a victim/NN/victim page/NN/page is/VBZ/is found/VBN/found /,/, the/DT/the page/NN/page is/VBZ/is replaced/VBN/replaced /,/, and/CC/and the/DT/the new/JJ/new page/NN/page is/VBZ/is inserted/VBN/inserted in/IN/in the/DT/the circular/JJ/circular queue/NN/queue in/IN/in that/DT/that position/NNP/position. notice/NN/notice that/WDT/that /,/, in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, when/WRB/when all/DT/all bits/NNS/bits are/VBP/are set/VBN/set /,/, the/DT/the pointer/NN/pointer cycles/NNS/cycles through/IN/through the/DT/the whole/JJ/whole queue/NN/queue /,/, giving/VBG/giving each/DT/each page/NN/page a/DT/a second/JJ/second chance/NNP/chance. it/PRP/it clears/VBZ/clears all/DT/all the/DT/the reference/NN/reference bits/VBZ/bits before/IN/before selecting/VBG/selecting the/DT/the next/JJ/next page/NN/page for/IN/for replacement/NNP/replacement. second-chance/NN/second-chance replacement/NN/replacement degenerates/VBZ/degenerates to/TO/to fifo/VB/fifo replacement/NN/replacement if/IN/if all/DT/all bits/NNS/bits are/VBP/are set/NNP/set. 9.4.5.3/CD/9.4.5.3 enhanced/VBD/enhanced second-chance/JJ/second-chance algorithm/NN/algorithm we/PRP/we can/MD/can enhance/VB/enhance the/DT/the second-chance/NN/second-chance algorithm/NN/algorithm by/IN/by considering/NN/considering the/DT/the reference/NN/reference bit/NN/bit and/CC/and the/DT/the modify/NN/modify bit/NN/bit /:/( described/VBN/described in/IN/in section/NN/section 9.4.1/CD/9.4.1 /CD/) as/IN/as an/DT/an ordered/VBN/ordered pair/NNP/pair. with/IN/with these/DT/these two/CD/two bits/NNS/bits /,/, we/PRP/we have/VBP/have the/DT/the following/VBG/following four/CD/four possible/JJ/possible classes/NNS/classes /:/: /:/( 0/-NONE-/0 /,/, 0/-NONE-/0 /:/) neither/DT/neither recently/RB/recently used/VBN/used nor/CC/nor modified/VBN/modified -best/JJ/-best page/NN/page to/TO/to replace/VB/replace 380/CD/380 chapter/NN/chapter 9/CD/9 /CD/( 0/-NONE-/0 /,/, 1/CD/1 /:/) not/RB/not recently/RB/recently used/VBN/used hut/NN/hut modified-not/RB/modified-not quite/RB/quite as/IN/as good/JJ/good /,/, because/IN/because the/DT/the page/NN/page will/MD/will need/VB/need to/TO/to be/VB/be written/VBN/written out/RP/out before/RB/before replacement/NN/replacement /:/( 1/CD/1 /,/, 0/-NONE-/0 /:/) recently/RB/recently used/VBN/used but/CC/but clean-probably/RB/clean-probably will/MD/will be/VB/be used/VBN/used again/RB/again soon/RB/soon /:/( 1/CD/1 /,/, 1/CD/1 /:/) recently/RB/recently used/VBN/used and/CC/and modified/VBD/modified -probably/RB/-probably will/MD/will be/VB/be used/VBN/used again/RB/again soon/RB/soon /,/, and/CC/and the/DT/the page/NN/page will/MD/will be/VB/be need/VBN/need to/TO/to be/VB/be written/VBN/written out/RP/out to/TO/to disk/VB/disk before/IN/before it/PRP/it can/MD/can be/VB/be replaced/VBN/replaced each/DT/each page/NN/page is/VBZ/is in/IN/in one/CD/one of/IN/of these/DT/these four/CD/four classes/NNP/classes. when/WRB/when page/NN/page replacement/NN/replacement is/VBZ/is called/VBN/called for/IN/for /,/, we/PRP/we use/VBP/use the/DT/the same/JJ/same scheme/NN/scheme as/IN/as in/IN/in the/DT/the clock/NN/clock algorithm/NN/algorithm ;/:/; but/CC/but instead/RB/instead of/IN/of examining/VBG/examining whether/IN/whether the/DT/the page/NN/page to/TO/to which/WDT/which we/PRP/we are/VBP/are pointing/VBG/pointing has/VBZ/has the/DT/the reference/NN/reference bit/NN/bit set/NN/set to/TO/to 1/CD/1 /,/, we/PRP/we examine/VBP/examine the/DT/the class/NN/class to/TO/to which/WDT/which that/IN/that page/NN/page belongs/NNP/belongs. we/PRP/we replace/VBP/replace the/DT/the first/JJ/first page/NN/page encountered/VBN/encountered in/IN/in the/DT/the lowest/JJS/lowest nonempty/NN/nonempty class/NNP/class. notice/NN/notice that/WDT/that we/PRP/we may/MD/may have/VB/have to/TO/to scan/VB/scan the/DT/the circular/JJ/circular queue/NN/queue several/JJ/several times/NNS/times before/IN/before we/PRP/we find/VBP/find a/DT/a page/NN/page to/TO/to be/VB/be replaced/NNP/replaced. the/DT/the major/JJ/major difference/NN/difference between/IN/between this/DT/this algorithm/NN/algorithm and/CC/and the/DT/the simpler/NN/simpler clock/NN/clock algorithm/NN/algorithm is/VBZ/is that/IN/that here/RB/here we/PRP/we give/VBP/give preference/NN/preference to/TO/to those/DT/those pages/NNS/pages that/IN/that have/VBP/have been/VBN/been modified/VBN/modified to/TO/to reduce/VB/reduce the/DT/the number/NN/number of/IN/of i/os/NNS/i/os required/NNP/required. 9.4.6/CD/9.4.6 counting-based/JJ/counting-based page/NN/page replacement/NN/replacement there/EX/there are/VBP/are many/JJ/many other/JJ/other algorithms/NNS/algorithms that/IN/that can/MD/can be/VB/be used/VBN/used for/IN/for page/NN/page replacement/NNP/replacement. for/IN/for example/NN/example /,/, we/PRP/we can/MD/can keep/VB/keep a/DT/a counter/NN/counter of/IN/of the/DT/the number/NN/number of/IN/of references/NNS/references that/WDT/that have/VBP/have been/VBN/been made/VBN/made to/TO/to each/DT/each page/NN/page and/CC/and develop/VB/develop the/DT/the following/VBG/following two/CD/two schemes/NNP/schemes. the/DT/the least/JJS/least frequently/RB/frequently used/VBN/used /-NONE-/( lfu/RB/lfu /:/) page-replacement/JJ/page-replacement algorithm/NN/algorithm requires/VBZ/requires that/IN/that the/DT/the page/NN/page with/IN/with the/DT/the smallest/JJS/smallest count/NN/count be/VB/be replaced/NNP/replaced. the/DT/the reason/NN/reason for/IN/for this/DT/this selection/NN/selection is/VBZ/is that/IN/that an/DT/an actively/RB/actively used/VBN/used page/NN/page should/MD/should have/VB/have a/DT/a large/JJ/large reference/NN/reference count/NNP/count. a/DT/a problem/NN/problem arises/VBZ/arises /,/, however/RB/however /,/, when/WRB/when a/DT/a page/NN/page is/VBZ/is used/VBN/used heavily/RB/heavily during/IN/during the/DT/the initial/JJ/initial phase/NN/phase of/IN/of a/DT/a process/NN/process but/CC/but then/RB/then is/VBZ/is never/RB/never used/VBN/used again/NNP/again. since/IN/since it/PRP/it was/VBD/was used/VBN/used heavily/RB/heavily /,/, it/PRP/it has/VBZ/has a/DT/a large/JJ/large count/NN/count and/CC/and remains/VBZ/remains in/IN/in memory/NN/memory even/RB/even though/IN/though it/PRP/it is/VBZ/is no/DT/no longer/NN/longer needed/NNP/needed. one/CD/one solution/NN/solution is/VBZ/is to/TO/to shift/VB/shift the/DT/the counts/NNS/counts right/RB/right by/IN/by 1/CD/1 bit/NN/bit at/IN/at regular/JJ/regular intervals/NNS/intervals /,/, forming/VBG/forming an/DT/an exponentially/RB/exponentially decaying/VBG/decaying average/JJ/average usage/NN/usage count/NNP/count. the/DT/the most/RBS/most frequently/RB/frequently used/JJ/used /NN/( mfu/NN/mfu /:/) page-replacement/JJ/page-replacement algorithm/NN/algorithm is/VBZ/is based/VBN/based on/IN/on the/DT/the argument/NN/argument that/IN/that the/DT/the page/NN/page with/IN/with the/DT/the smallest/JJS/smallest count/NN/count was/VBD/was probably/RB/probably just/RB/just brought/VBN/brought in/IN/in and/CC/and has/VBZ/has yet/RB/yet to/TO/to be/VB/be used/NNP/used. as/IN/as you/PRP/you might/MD/might expect/VB/expect /,/, neither/DT/neither mfu/NN/mfu nor/CC/nor lfu/NN/lfu replacement/NN/replacement is/VBZ/is common/NNP/common. the/DT/the implementation/NN/implementation of/IN/of these/DT/these algorithms/NNS/algorithms is/VBZ/is expensive/JJ/expensive /,/, and/CC/and they/PRP/they do/VBP/do not/RB/not approxin'late/JJ/approxin'late opt/NN/opt replacement/NN/replacement well/NNP/well. 9.4.7/CD/9.4.7 page-buffering/JJ/page-buffering algorithms/NNS/algorithms other/JJ/other procedures/NNS/procedures are/VBP/are often/RB/often used/VBN/used in/IN/in addition/NN/addition to/TO/to a/DT/a specific/JJ/specific page-replacement/JJ/page-replacement algorithm/NNP/algorithm. for/IN/for example/NN/example /,/, systems/NNS/systems commonly/RB/commonly keep/VB/keep a/DT/a pool/NN/pool of/IN/of free/JJ/free frames/NNP/frames. when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, a/DT/a victim/NN/victim frame/NN/frame is/VBZ/is chosen/VBN/chosen as/RB/as before/NNP/before. however/RB/however /,/, the/DT/the desired/VBN/desired page/NN/page is/VBZ/is read/VBN/read into/IN/into a/DT/a free/JJ/free frame/NN/frame from/IN/from the/DT/the pool/NN/pool before/IN/before the/DT/the victim/NN/victim is/VBZ/is written/VBN/written out/NNP/out. this/DT/this procedure/NN/procedure allows/VBZ/allows the/DT/the process/NN/process to/TO/to restart/VB/restart as/IN/as soon/RB/soon as/IN/as possible/JJ/possible /,/, without/IN/without waiting/VBG/waiting for/IN/for the/DT/the victim/NN/victim page/NN/page to/TO/to be/VB/be written/VBN/written out/NNP/out. when/WRB/when the/DT/the victim/NN/victim is/VBZ/is later/JJ/later written/VBN/written out/RP/out /,/, its/PRP$/its frame/NN/frame is/VBZ/is added/VBN/added to/TO/to the/DT/the free-frame/JJ/free-frame pool/NNP/pool. 9.4/CD/9.4 381/CD/381 an/DT/an expansion/NN/expansion of/IN/of this/DT/this idea/NN/idea is/VBZ/is to/TO/to maintain/VB/maintain a/DT/a list/NN/list of/IN/of modified/JJ/modified pages/NNP/pages. whenever/NN/whenever the/DT/the paging/NN/paging device/NN/device is/VBZ/is idle/JJ/idle /,/, a/DT/a modified/JJ/modified page/NN/page is/VBZ/is selected/VBN/selected and/CC/and is/VBZ/is written/VBN/written to/TO/to the/DT/the disk/NNP/disk. its/PRP$/its modify/NN/modify bit/NN/bit is/VBZ/is then/RB/then reset/NNP/reset. this/DT/this scheme/NN/scheme increases/VBZ/increases the/DT/the probability/NN/probability that/IN/that a/DT/a page/NN/page will/MD/will be/VB/be clean/JJ/clean when/WRB/when it/PRP/it is/VBZ/is selected/VBN/selected for/IN/for replacement/NN/replacement and/CC/and will/MD/will not/RB/not need/VB/need to/TO/to be/VB/be written/VBN/written out/NNP/out. another/DT/another modification/NN/modification is/VBZ/is to/TO/to keep/VB/keep a/DT/a pool/NN/pool of/IN/of free/JJ/free frames/NNS/frames but/CC/but to/TO/to remember/VB/remember which/WDT/which page/NN/page was/VBD/was in/IN/in each/DT/each frame/NNP/frame. since/IN/since the/DT/the frame/NN/frame contents/NNS/contents are/VBP/are not/RB/not modified/VBN/modified when/WRB/when a/DT/a frame/NN/frame is/VBZ/is written/VBN/written to/TO/to the/DT/the disk/NN/disk /,/, the/DT/the old/JJ/old page/NN/page can/MD/can be/VB/be reused/VBN/reused directly/RB/directly fronc/JJ/fronc the/DT/the free-frame/JJ/free-frame pool/NN/pool if/IN/if it/PRP/it is/VBZ/is needed/VBN/needed before/IN/before that/IN/that frame/NN/frame is/VBZ/is reused/NNP/reused. no/DT/no i/o/NNP/i/o is/VBZ/is needed/VBN/needed in/IN/in this/DT/this case/NNP/case. when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, we/PRP/we first/RB/first check/VBP/check whether/IN/whether the/DT/the desired/VBN/desired page/NN/page is/VBZ/is in/IN/in the/DT/the free-frame/JJ/free-frame pool/NNP/pool. if/IN/if it/PRP/it is/VBZ/is not/RB/not /,/, we/PRP/we must/MD/must select/VB/select a/DT/a free/JJ/free frame/NN/frame and/CC/and read/VB/read into/IN/into it/NNP/it. this/DT/this technique/NN/technique is/VBZ/is used/VBN/used in/IN/in the/DT/the vax/vms/NNS/vax/vms system/NN/system along/IN/along with/IN/with a/DT/a fifo/NN/fifo replacement/NN/replacement algorithm/NNP/algorithm. when/WRB/when the/DT/the fifo/NN/fifo replacement/NN/replacement algorithm/NN/algorithm mistakenly/RB/mistakenly replaces/VBZ/replaces a/DT/a page/NN/page that/WDT/that is/VBZ/is still/RB/still in/IN/in active/JJ/active use/NN/use /,/, that/IN/that page/NN/page is/VBZ/is quickly/RB/quickly retrieved/VBN/retrieved from/IN/from the/DT/the free-frame/JJ/free-frame pool/NN/pool /,/, and/CC/and no/DT/no i/o/NN/i/o is/VBZ/is necessary/NNP/necessary. the/DT/the free-frame/JJ/free-frame buffer/NN/buffer provides/VBZ/provides protection/NN/protection against/IN/against the/DT/the relatively/RB/relatively poor/JJ/poor /,/, but/CC/but sirnple/NN/sirnple /,/, fifo/NN/fifo replacement/NN/replacement algorithm/NNP/algorithm. this/DT/this method/NN/method is/VBZ/is necessary/JJ/necessary because/IN/because the/DT/the early/JJ/early versions/NNS/versions of/IN/of vax/NN/vax did/VBD/did not/RB/not implement/VB/implement the/DT/the reference/NN/reference bit/NN/bit correctly/NNP/correctly. some/DT/some versions/NNS/versions of/IN/of the/DT/the unix/NN/unix system/NN/system use/NN/use this/DT/this method/NN/method in/IN/in conjunction/NN/conjunction with/IN/with the/DT/the second-chance/NN/second-chance algorithm/NNP/algorithm. it/PRP/it can/MD/can be/VB/be a/DT/a useful/JJ/useful augmentation/NN/augmentation to/TO/to any/DT/any pagereplacement/NN/pagereplacement algorithm/NN/algorithm /,/, to/TO/to reduce/VB/reduce the/DT/the penalty/NN/penalty incurred/VBD/incurred if/IN/if the/DT/the wrong/JJ/wrong victim/NN/victim page/NN/page is/VBZ/is selected/NNP/selected. 9.4.8/CD/9.4.8 applications/NNS/applications and/CC/and page/NN/page replacement/NN/replacement in/IN/in certain/JJ/certain cases/NNS/cases /,/, applications/NNS/applications accessing/VBG/accessing data/NNS/data through/IN/through the/DT/the operating/NN/operating system/NN/system 's/POS/'s virtual/JJ/virtual memory/NN/memory perform/NN/perform worse/NN/worse than/IN/than if/IN/if the/DT/the operating/NN/operating system/NN/system provided/VBD/provided no/DT/no buffering/NN/buffering at/IN/at all/NNP/all. a/DT/a typical/JJ/typical example/NN/example is/VBZ/is a/DT/a database/NN/database /,/, which/WDT/which provides/VBZ/provides its/PRP$/its own/JJ/own memory/NN/memory management/NN/management and/CC/and i/0/-NONE-/i/0 buffering/NNP/buffering. applications/NNS/applications like/IN/like this/DT/this understand/NN/understand their/PRP$/their memory/NN/memory use/NN/use and/CC/and disk/NN/disk use/NN/use better/NN/better than/IN/than does/VBZ/does an/DT/an operating/NN/operating system/NN/system that/WDT/that is/VBZ/is implementing/VBG/implementing algorithms/NNS/algorithms for/IN/for general-purpose/JJ/general-purpose use/NNP/use. if/IN/if the/DT/the operating/NN/operating system/NN/system is/VBZ/is buffering/VBG/buffering i/0/-NONE-/i/0 /,/, and/CC/and the/DT/the application/NN/application is/VBZ/is doing/VBG/doing so/RB/so as/IN/as well/RB/well /,/, then/RB/then twice/NN/twice the/DT/the memory/NN/memory is/VBZ/is being/VBG/being used/VBN/used for/IN/for a/DT/a set/NN/set of/IN/of i/0/NNP/i/0. in/IN/in another/DT/another example/NN/example /,/, data/NNS/data warehouses/NNS/warehouses frequently/RB/frequently perform/NN/perform massive/JJ/massive sequential/NN/sequential disk/NN/disk reads/NNS/reads /,/, followed/VBD/followed by/IN/by computations/NNS/computations and/CC/and writes/NNP/writes. the/DT/the lru/NN/lru algorithm/NN/algorithm would/MD/would be/VB/be removing/VBG/removing old/JJ/old pages/NNS/pages and/CC/and preserving/VBG/preserving new/JJ/new ones/NNS/ones /,/, while/IN/while the/DT/the application/NN/application would/MD/would more/RBR/more likely/JJ/likely be/VB/be reading/VBG/reading older/JJR/older pages/NNS/pages than/IN/than newer/JJR/newer ones/NNS/ones /:/( as/IN/as it/PRP/it starts/VBZ/starts its/PRP$/its sequential/JJ/sequential reads/NNS/reads again/RB/again /:/) /./. here/RB/here /,/, mfu/VBP/mfu would/MD/would actually/RB/actually be/VB/be more/RBR/more efficient/JJ/efficient than/IN/than lru/NNP/lru. because/IN/because of/IN/of such/JJ/such problems/NNS/problems /,/, some/DT/some operating/NN/operating systems/NNS/systems give/VBP/give special/JJ/special programs/NNS/programs the/DT/the ability/NN/ability to/TO/to use/VB/use a/DT/a disk/NN/disk partition/NN/partition as/IN/as a/DT/a large/JJ/large sequential/NN/sequential array/NN/array of/IN/of logical/JJ/logical blocks/NNS/blocks /,/, without/IN/without any/DT/any file-system/JJ/file-system data/NNS/data structures/NNP/structures. this/DT/this array/NN/array is/VBZ/is sometimes/RB/sometimes called/VBN/called the/DT/the raw/NN/raw disk/NN/disk /,/, and/CC/and i/o/NNP/i/o to/TO/to this/DT/this array/NN/array is/VBZ/is termed/VBN/termed raw/NN/raw i/0/NNP/i/0. raw/NN/raw i/0/-NONE-/i/0 bypasses/VBZ/bypasses all/DT/all the/DT/the filesystem/NN/filesystem services/NNS/services /,/, such/JJ/such as/IN/as file/JJ/file i/0/-NONE-/i/0 demand/NN/demand paging/VBG/paging /,/, file/JJ/file locking/NN/locking /,/, prefetching/VBG/prefetching /,/, space/NN/space allocation/NN/allocation /,/, file/NN/file names/VBZ/names /,/, and/CC/and directories/NNP/directories. note/NN/note that/IN/that although/IN/although certain/JJ/certain applications/NNS/applications are/VBP/are more/RBR/more efficient/JJ/efficient when/WRB/when implementing/VBG/implementing their/PRP$/their own/JJ/own special-purpose/JJ/special-purpose storage/NN/storage services/NNS/services on/IN/on a/DT/a raw/JJ/raw partition/NN/partition /,/, most/JJS/most applications/NNS/applications perform/NN/perform better/RBR/better when/WRB/when they/PRP/they use/VBP/use the/DT/the regular/JJ/regular file-system/NN/file-system services/NNP/services. 382/CD/382 chapter/NN/chapter 9/CD/9 9.5/CD/9.5 we/PRP/we turn/VBP/turn next/JJ/next to/TO/to the/DT/the issue/NN/issue of/IN/of allocation/NNP/allocation. how/WRB/how do/VBP/do we/PRP/we allocate/VB/allocate the/DT/the fixed/VBN/fixed amount/NN/amount of/IN/of free/JJ/free memory/NN/memory among/IN/among the/DT/the various/JJ/various processes/NNS/processes if/IN/if we/PRP/we have/VBP/have 93/CD/93 free/JJ/free frames/NNS/frames and/CC/and two/CD/two processes/NNS/processes /,/, how/WRB/how many/JJ/many frames/NNS/frames does/VBZ/does each/DT/each process/NN/process get/NN/get the/DT/the simplest/JJS/simplest case/NN/case is/VBZ/is the/DT/the single-user/JJ/single-user system/NNP/system. consider/NN/consider a/DT/a single-user/JJ/single-user system/NN/system with/IN/with 128/CD/128 kb/NN/kb of/IN/of memory/NN/memory composed/VBN/composed of/IN/of pages/NNS/pages 1/CD/1 kb/NN/kb in/IN/in size/NNP/size. this/DT/this system/NN/system has/VBZ/has 128/CD/128 frames/NNP/frames. the/DT/the operating/NN/operating system/NN/system may/MD/may take/VB/take 35/CD/35 kb/NN/kb /,/, leaving/VBG/leaving 93/CD/93 frames/NNS/frames for/IN/for the/DT/the user/NN/user process/NNP/process. under/IN/under pure/NN/pure demand/NN/demand paging/VBG/paging /,/, all/DT/all 93/CD/93 frames/NNS/frames would/MD/would initially/RB/initially be/VB/be put/VBN/put on/IN/on the/DT/the free-frame/JJ/free-frame list/NNP/list. when/WRB/when a/DT/a user/NN/user process/NN/process started/VBD/started execution/NN/execution /,/, it/PRP/it would/MD/would generate/VB/generate a/DT/a sequence/NN/sequence of/IN/of page/NN/page faults/NNP/faults. the/DT/the first/JJ/first 93/CD/93 page/NN/page faults/NNS/faults would/MD/would all/VB/all get/VB/get free/JJ/free frames/NNS/frames from/IN/from the/DT/the free-frame/JJ/free-frame list/NNP/list. when/WRB/when the/DT/the free-frame/JJ/free-frame list/NN/list was/VBD/was exhausted/VBN/exhausted /,/, a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm would/MD/would be/VB/be used/VBN/used to/TO/to select/VB/select one/CD/one of/IN/of the/DT/the 93/CD/93 in-memory/JJ/in-memory pages/NNS/pages to/TO/to be/VB/be replaced/VBN/replaced with/IN/with the/DT/the 94th/JJ/94th /,/, and/CC/and so/RB/so on/NNP/on. when/WRB/when the/DT/the process/NN/process terminated/VBD/terminated /,/, the/DT/the 93/CD/93 frames/NNS/frames would/MD/would once/RB/once again/RB/again be/VB/be placed/VBN/placed on/IN/on the/DT/the free-frame/JJ/free-frame list/NNP/list. there/RB/there are/VBP/are many/JJ/many variations/NNS/variations on/IN/on this/DT/this simple/NN/simple strategy/NNP/strategy. we/PRP/we can/MD/can require/VB/require that/IN/that the/DT/the operating/NN/operating system/NN/system allocate/NN/allocate all/DT/all its/PRP$/its buffer/NN/buffer and/CC/and table/JJ/table space/NN/space from/IN/from the/DT/the free-frame/JJ/free-frame list/NNP/list. when/WRB/when this/DT/this space/NN/space is/VBZ/is not/RB/not in/IN/in use/NN/use by/IN/by the/DT/the operating/NN/operating system/NN/system /,/, it/PRP/it can/MD/can be/VB/be used/VBN/used to/TO/to support/VB/support user/NN/user paging/NNP/paging. we/PRP/we can/MD/can try/VB/try to/TO/to keep/VB/keep three/CD/three free/JJ/free frames/NNS/frames reserved/VBD/reserved on/IN/on the/DT/the free-frame/JJ/free-frame list/NN/list at/IN/at all/DT/all times/NNP/times. thus/RB/thus /,/, when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, there/EX/there is/VBZ/is a/DT/a free/JJ/free frame/NN/frame available/JJ/available to/TO/to page/NN/page into/NNP/into. while/IN/while the/DT/the page/NN/page swap/NN/swap is/VBZ/is taking/VBG/taking place/NN/place /,/, a/DT/a replacement/NN/replacement can/MD/can be/VB/be selected/VBN/selected /,/, which/WDT/which is/VBZ/is then/RB/then written/VBN/written to/TO/to the/DT/the disk/NN/disk as/IN/as the/DT/the user/NN/user process/NN/process continues/VBZ/continues to/TO/to execute/NNP/execute. other/JJ/other variants/NNS/variants are/VBP/are also/RB/also possible/JJ/possible /,/, but/CC/but the/DT/the basic/JJ/basic strategy/NN/strategy is/VBZ/is clear/JJ/clear /:/: the/DT/the user/NN/user process/NN/process is/VBZ/is allocated/VBN/allocated any/DT/any free/JJ/free frame/NNP/frame. 9.5.1/CD/9.5.1 minimum/JJ/minimum number/NN/number of/IN/of frames/NNS/frames our/PRP$/our strategies/NNS/strategies for/IN/for the/DT/the allocation/NN/allocation of/IN/of frames/NNS/frames are/VBP/are constrained/VBN/constrained in/IN/in various/JJ/various ways/NNP/ways. we/PRP/we can/MD/can not/RB/not /,/, for/IN/for example/NN/example /,/, allocate/NN/allocate more/JJR/more than/IN/than the/DT/the total/JJ/total number/NN/number of/IN/of available/JJ/available frames/NNS/frames /:/( unless/IN/unless there/EX/there is/VBZ/is page/NN/page sharing/VBG/sharing /NN/) /./. we/PRP/we must/MD/must also/RB/also allocate/VB/allocate at/IN/at least/JJS/least a/DT/a minimum/JJ/minimum number/NN/number of/IN/of frames/NNP/frames. here/RB/here /,/, we/PRP/we look/VBP/look more/JJR/more closely/RB/closely at/IN/at the/DT/the latter/NN/latter requirement/NNP/requirement. one/CD/one reason/NN/reason for/IN/for allocating/NN/allocating at/IN/at least/JJS/least a/DT/a minimum/JJ/minimum number/NN/number of/IN/of frames/NNS/frames involves/NNS/involves performance/NNP/performance. obviously/RB/obviously /,/, as/IN/as the/DT/the number/NN/number of/IN/of frames/NNS/frames allocated/VBN/allocated to/TO/to each/DT/each process/NN/process decreases/NNS/decreases /,/, the/DT/the page-fault/JJ/page-fault rate/NN/rate increases/NNS/increases /,/, slowing/VBG/slowing process/NN/process execution/NNP/execution. in/IN/in addition/NN/addition /,/, remember/NN/remember that/IN/that when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs before/IN/before an/DT/an executing/NN/executing ilcstruction/NN/ilcstruction is/VBZ/is complete/JJ/complete /,/, the/DT/the instruction/NN/instruction must/MD/must be/VB/be restarted/NNP/restarted. consequently/NNP/consequently. we/PRP/we must/MD/must have/VB/have enough/RB/enough frames/VBZ/frames to/TO/to hold/VB/hold all/DT/all the/DT/the different/JJ/different pages/NNS/pages that/WDT/that any/DT/any single/JJ/single ilcstruction/NN/ilcstruction can/MD/can reference/NNP/reference. for/IN/for example/NN/example /,/, consider/NN/consider a/DT/a machine/NN/machine in/IN/in which/WDT/which all/DT/all memory-reference/NN/memory-reference instructions/NNS/instructions may/MD/may reference/VB/reference only/RB/only one/CD/one memory/NN/memory address/NNP/address. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we need/VBP/need at/IN/at least/JJS/least one/CD/one frame/NN/frame for/IN/for the/DT/the instruction/NN/instruction and/CC/and one/CD/one frame/NN/frame for/IN/for the/DT/the mernory/NN/mernory reference/NNP/reference. in/IN/in addition/NN/addition /,/, if/IN/if one-level/JJ/one-level indirect/NN/indirect addressing/VBG/addressing is/VBZ/is allowed/VBN/allowed /-NONE-/( for/IN/for example/NN/example /,/, a/DT/a load/NN/load instruction/NN/instruction on/IN/on page/NN/page 16/CD/16 can/MD/can refer/VB/refer to/TO/to an/DT/an address/NN/address on/IN/on page/NN/page 0/-NONE-/0 /,/, which/WDT/which is/VBZ/is an/DT/an indirect/JJ/indirect reference/NN/reference to/TO/to page/NN/page 23/CD/23 /CD/) /,/, then/RB/then paging/VBG/paging requires/NNS/requires at/IN/at least/JJS/least three/CD/three frames/NNS/frames per/IN/per process/NNP/process. think/NN/think about/IN/about what/WP/what might/MD/might happen/VB/happen if/IN/if a/DT/a process/NN/process had/VBD/had only/RB/only two/CD/two frames/NNP/frames. the/DT/the minimum/JJ/minimum number/NN/number of/IN/of frames/NNS/frames is/VBZ/is defined/VBN/defined by/IN/by the/DT/the computer/NN/computer architecture/NNP/architecture. for/IN/for example/NN/example /,/, the/DT/the move/NN/move instruction/NN/instruction for/IN/for the/DT/the pdp-11/NN/pdp-11 includes/VBZ/includes more/JJR/more than/IN/than one/CD/one word/NN/word for/IN/for some/DT/some addressing/VBG/addressing modes/NNS/modes /,/, and/CC/and thus/RB/thus the/DT/the ilcstruction/NN/ilcstruction itself/PRP/itself may/MD/may straddle/VB/straddle two/CD/two pages/NNP/pages. in/IN/in addition/NN/addition /,/, each/DT/each of/IN/of its/PRP$/its two/CD/two operands/NNS/operands may/MD/may be/VB/be indirect/JJ/indirect references/NNS/references /,/, for/IN/for a/DT/a total/JJ/total of/IN/of six/CD/six frames/NNP/frames. another/DT/another example/NN/example is/VBZ/is the/DT/the ibm/NN/ibm 370/CD/370 mvc/NN/mvc instruction/NNP/instruction. since/IN/since the/DT/the 9.5/CD/9.5 383/CD/383 instruction/NN/instruction is/VBZ/is from/IN/from storage/NN/storage location/NN/location to/TO/to storage/NN/storage location/NN/location /,/, it/PRP/it takes/VBZ/takes 6/CD/6 bytes/NNS/bytes and/CC/and can/MD/can straddle/VB/straddle two/CD/two pages/NNP/pages. the/DT/the block/NN/block of/IN/of characters/NNS/characters to/TO/to move/VB/move and/CC/and the/DT/the area/NN/area to/TO/to which/WDT/which it/PRP/it is/VBZ/is to/TO/to be/VB/be m.oved/JJ/m.oved can/MD/can each/DT/each also/RB/also straddle/JJ/straddle two/CD/two pages/NNP/pages. this/DT/this situation/NN/situation would/MD/would require/VB/require six/CD/six frames/NNP/frames. the/DT/the worst/JJS/worst case/NN/case occurs/NNS/occurs when/WRB/when the/DT/the mvc/NN/mvc instruction/NN/instruction is/VBZ/is the/DT/the operand/NN/operand of/IN/of an/DT/an execute/NN/execute instruction/NN/instruction that/WDT/that straddles/VBZ/straddles a/DT/a page/NN/page boundary/NN/boundary ;/:/; in/IN/in this/DT/this case/NN/case /,/, we/PRP/we need/VBP/need eight/CD/eight frames/NNP/frames. the/DT/the worst-case/NN/worst-case scenario/NN/scenario occurs/NNS/occurs in/IN/in computer/NN/computer architectures/NNS/architectures that/WDT/that allow/VBP/allow multiple/VBP/multiple levels/NNS/levels of/IN/of indirection/NN/indirection /:/( for/IN/for example/NN/example /,/, each/DT/each 16-bit/JJ/16-bit word/NN/word could/MD/could contain/VB/contain a/DT/a 15-bit/JJ/15-bit address/NN/address plus/CC/plus a/DT/a 1-bit/JJ/1-bit indirect/NN/indirect indicator/NN/indicator /:/) /./. theoretically/RB/theoretically /,/, a/DT/a simple/JJ/simple load/NN/load instruction/NN/instruction could/MD/could reference/VB/reference an/DT/an indirect/JJ/indirect address/NN/address that/WDT/that could/MD/could reference/VB/reference an/DT/an indirect/JJ/indirect address/NN/address /:/( on/IN/on another/DT/another page/NN/page /:/) that/IN/that could/MD/could also/RB/also reference/VB/reference an/DT/an indirect/JJ/indirect address/NN/address /:/( on/IN/on yet/RB/yet another/DT/another page/NN/page /:/) /,/, and/CC/and so/RB/so on/IN/on /,/, until/IN/until every/DT/every page/NN/page in/IN/in virtual/JJ/virtual memory/NN/memory had/VBD/had been/VBN/been touched/NNP/touched. thus/RB/thus /,/, in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, the/DT/the entire/JJ/entire virtual/JJ/virtual memory/NN/memory must/MD/must be/VB/be in/IN/in physical/JJ/physical memory/NNP/memory. to/TO/to overcome/VB/overcome this/DT/this difficulty/NN/difficulty /,/, we/PRP/we must/MD/must place/VB/place a/DT/a limit/NN/limit on/IN/on the/DT/the levels/NNS/levels of/IN/of indirection/NN/indirection /:/( for/IN/for example/NN/example /,/, limit/NN/limit an/DT/an instruction/NN/instruction to/TO/to at/IN/at most/JJS/most 16levels/NNS/16levels of/IN/of indirection/NN/indirection /:/) /./. when/WRB/when the/DT/the first/JJ/first indirection/NN/indirection occurs/NNS/occurs /,/, a/DT/a counter/NN/counter is/VBZ/is set/VBN/set to/TO/to 16/CD/16 ;/:/; the/DT/the counter/NN/counter is/VBZ/is then/RB/then decremented/VBN/decremented for/IN/for each/DT/each successive/JJ/successive irtdirection/NN/irtdirection for/IN/for this/DT/this instruction/NNP/instruction. if/IN/if the/DT/the counter/NN/counter is/VBZ/is decremented/VBN/decremented to/TO/to 0/-NONE-/0 /,/, a/DT/a trap/NN/trap occurs/VBZ/occurs /:/( excessive/JJ/excessive indirection/NN/indirection /:/) /./. this/DT/this limitation/NN/limitation reduces/NNS/reduces the/DT/the maximum/NN/maximum number/NN/number of/IN/of memory/NN/memory references/NNS/references per/IN/per instruction/NN/instruction to/TO/to 17/CD/17 /,/, requiring/VBG/requiring the/DT/the same/JJ/same number/NN/number of/IN/of frames/NNP/frames. whereas/IN/whereas the/DT/the minimum/JJ/minimum number/NN/number of/IN/of frames/NNS/frames per/IN/per process/NN/process is/VBZ/is defined/VBN/defined by/IN/by the/DT/the architecture/NN/architecture /,/, the/DT/the maximum/NN/maximum number/NN/number is/VBZ/is defined/VBN/defined by/IN/by the/DT/the amount/NN/amount of/IN/of available/JJ/available physical/JJ/physical memory/NNP/memory. in/IN/in between/IN/between /,/, we/PRP/we are/VBP/are still/RB/still left/VBN/left with/IN/with significant/JJ/significant choice/NN/choice in/IN/in frame/NN/frame allocation/NNP/allocation. 9.5.2/CD/9.5.2 allocation/NN/allocation algorithms/NNS/algorithms the/DT/the easiest/JJS/easiest way/NN/way to/TO/to split/VB/split m/NN/m frames/NNS/frames among/IN/among n/NN/n processes/NNS/processes is/VBZ/is to/TO/to give/VB/give everyone/NN/everyone an/DT/an equal/JJ/equal share/NN/share /,/, m/n/NNP/m/n frames/NNP/frames. for/IN/for instance/NN/instance /,/, if/IN/if there/EX/there are/VBP/are 93/CD/93 frames/NNS/frames and/CC/and five/CD/five processes/NNS/processes /,/, each/DT/each process/NN/process will/MD/will get/VB/get 18/CD/18 frames/NNP/frames. the/DT/the three/CD/three leftover/NN/leftover frames/NNS/frames can/MD/can be/VB/be used/VBN/used as/IN/as a/DT/a free-frame/JJ/free-frame buffer/NN/buffer pool/NNP/pool. this/DT/this scheme/NN/scheme is/VBZ/is called/VBN/called an/DT/an alternative/JJ/alternative is/VBZ/is to/TO/to recognize/VB/recognize that/IN/that various/JJ/various processes/NNS/processes will/MD/will need/VB/need differing/NN/differing amounts/NNS/amounts of/IN/of memory/NNP/memory. consider/NN/consider a/DT/a system/NN/system with/IN/with a/DT/a 1-kb/CD/1-kb frame/NN/frame size/NNP/size. if/IN/if a/DT/a small/JJ/small student/NN/student process/NN/process of/IN/of 10/CD/10 kb/NN/kb and/CC/and an/DT/an interactive/JJ/interactive database/NN/database of/IN/of 127/CD/127 kb/NN/kb are/VBP/are the/DT/the only/JJ/only two/CD/two processes/NNS/processes running/VBG/running in/IN/in a/DT/a system/NN/system with/IN/with 62/CD/62 free/JJ/free frames/NNS/frames /,/, it/PRP/it does/VBZ/does not/RB/not make/VB/make much/JJ/much sense/NN/sense to/TO/to give/VB/give each/DT/each process/NN/process 31/CD/31 frames/NNP/frames. the/DT/the student/NN/student process/NN/process does/VBZ/does not/RB/not need/VBP/need more/JJR/more than/IN/than 10/CD/10 frames/NNS/frames /,/, so/RB/so the/DT/the other/JJ/other 21/CD/21 are/VBP/are /,/, strictly/RB/strictly speaking/VBG/speaking /,/, wasted/NNP/wasted. to/TO/to solve/VB/solve this/DT/this problem/NN/problem /,/, we/PRP/we can/MD/can use/VB/use in/IN/in which/WDT/which we/PRP/we allocate/VBP/allocate available/JJ/available memory/NN/memory to/TO/to each/DT/each process/NN/process according/VBG/according to/TO/to its/PRP$/its size/NNP/size. let/NN/let the/DT/the size/NN/size of/IN/of the/DT/the virtual/JJ/virtual memory/NN/memory for/IN/for process/NN/process p/NN/p ;/:/; be/VB/be s/NNS/s ;/:/; /,/, and/CC/and define/NN/define s/NNS/s =/:/= ls/NNS/ls ;/:/; /./. then/RB/then /,/, if/IN/if the/DT/the total/JJ/total number/NN/number of/IN/of available/JJ/available frames/NNS/frames is/VBZ/is m/NN/m /,/, we/PRP/we allocate/VBP/allocate a/DT/a ;/:/; frames/VBZ/frames to/TO/to process/NN/process p/NN/p ;/:/; /,/, where/WRB/where a/DT/a ;/:/; is/VBZ/is approximately/RB/approximately a/DT/a ;/:/; =/:/= s/NNS/s ;/:/; /s/NNS//s x/VBP/x m/NNP/m. 384/CD/384 chapter/NN/chapter 9/CD/9 of/IN/of course/NN/course /,/, we/PRP/we must/MD/must adjust/VB/adjust each/DT/each ai/NN/ai to/TO/to be/VB/be an/DT/an integer/NN/integer that/IN/that is/VBZ/is greater/JJR/greater than/IN/than the/DT/the ncinimum/NN/ncinimum number/NN/number of/IN/of frames/NNS/frames required/VBN/required by/IN/by tl1e/NNP/tl1e instruction/NN/instruction set/VBD/set /,/, with/IN/with a/DT/a sum/NN/sum not/RB/not exceeding/VBG/exceeding m/NNP/m. with/IN/with proportional/JJ/proportional allocation/NN/allocation /,/, we/PRP/we would/MD/would split/VB/split 62/CD/62 frames/NNS/frames between/IN/between two/CD/two processes/NNS/processes /,/, one/CD/one of/IN/of 10/CD/10 pages/NNS/pages and/CC/and one/CD/one of/IN/of 127/CD/127 pages/NNS/pages /,/, by/IN/by allocating/NN/allocating 4/CD/4 frames/NNS/frames and/CC/and 57/CD/57 frames/NNS/frames /,/, respectively/RB/respectively /,/, since/IN/since 10/137/CD/10/137 x/NN/x 62/CD/62 ~/CD/~ 4/CD/4 /,/, and/CC/and 127/137/CD/127/137 x/NN/x 62/CD/62 ~/CD/~ 57/CD/57. in/IN/in this/DT/this way/NN/way /,/, both/DT/both processes/NNS/processes share/VBP/share the/DT/the available/JJ/available frames/NNS/frames according/VBG/according to/TO/to their/PRP$/their needs/NNS/needs /,/, rather/RB/rather than/IN/than equally/NNP/equally. in/IN/in both/DT/both equal/JJ/equal and/CC/and proportional/JJ/proportional allocation/NN/allocation /,/, of/IN/of course/NN/course /,/, the/DT/the allocation/NN/allocation may/MD/may vary/VB/vary according/VBG/according to/TO/to the/DT/the multiprogramming/NN/multiprogramming level/NNP/level. if/IN/if the/DT/the multiprogramming/NN/multiprogramming level/NN/level is/VBZ/is increased/VBN/increased /,/, each/DT/each process/NN/process will/MD/will lose/VB/lose some/DT/some frames/NNS/frames to/TO/to provide/VB/provide the/DT/the memory/NN/memory needed/VBD/needed for/IN/for the/DT/the new/JJ/new process/NNP/process. conversely/RB/conversely /,/, if/IN/if the/DT/the multiprogramming/NN/multiprogramming level/NN/level decreases/NNS/decreases /,/, the/DT/the frames/NNS/frames that/WDT/that were/VBD/were allocated/VBN/allocated to/TO/to the/DT/the departed/VBN/departed process/NN/process can/MD/can be/VB/be spread/VBN/spread over/RP/over the/DT/the remaining/VBG/remaining processes/NNP/processes. notice/NN/notice that/WDT/that /,/, with/IN/with either/DT/either equal/JJ/equal or/CC/or proportional/JJ/proportional allocation/NN/allocation /,/, a/DT/a high-priority/NN/high-priority process/NN/process is/VBZ/is treated/VBN/treated the/DT/the same/JJ/same as/IN/as a/DT/a low-priority/NN/low-priority process/NNP/process. by/IN/by its/PRP$/its definition/NN/definition /,/, however/RB/however /,/, we/PRP/we may/MD/may want/VB/want to/TO/to give/VB/give the/DT/the high-priority/NN/high-priority process/NN/process more/RBR/more memory/JJ/memory to/TO/to speed/VB/speed its/PRP$/its execution/NN/execution /,/, to/TO/to the/DT/the detriment/NN/detriment of/IN/of low-priority/NN/low-priority processes/NNP/processes. one/CD/one solution/NN/solution is/VBZ/is to/TO/to use/VB/use a/DT/a proportional/JJ/proportional allocation/NN/allocation scheme/NN/scheme wherein/NN/wherein the/DT/the ratio/NN/ratio of/IN/of frames/NNS/frames depends/NNS/depends not/RB/not on/IN/on the/DT/the relative/JJ/relative sizes/NNS/sizes of/IN/of processes/NNS/processes but/CC/but rather/RB/rather on/IN/on the/DT/the priorities/NNS/priorities of/IN/of processes/NNS/processes or/CC/or on/IN/on a/DT/a combination/NN/combination of/IN/of size/NN/size and/CC/and priority/NNP/priority. 9.5.3/CD/9.5.3 global/JJ/global versus/NN/versus local/JJ/local allocation/NN/allocation another/DT/another important/JJ/important factor/NN/factor in/IN/in the/DT/the way/NN/way frames/VBZ/frames are/VBP/are allocated/VBN/allocated to/TO/to the/DT/the various/JJ/various processes/NNS/processes is/VBZ/is page/NN/page replacement/NNP/replacement. with/IN/with multiple/NN/multiple processes/NNS/processes competing/VBG/competing for/IN/for frames/NNS/frames /,/, we/PRP/we can/MD/can classify/VB/classify page-replacement/JJ/page-replacement algorithms/NNS/algorithms into/IN/into two/CD/two broad/JJ/broad categories/NNS/categories /:/: ;/:/; .no/-NONE-/.no '/''/' '-c'u/-NONE-/'-c'u ~/:/~ '/''/' '/''/' and/CC/and local/JJ/local global/JJ/global replacement/NN/replacement allows/VBZ/allows a/DT/a process/NN/process to/TO/to a/DT/a replacement/NN/replacement frame/NN/frame from/IN/from the/DT/the set/NN/set of/IN/of all/DT/all frames/NNS/frames /,/, even/RB/even if/IN/if that/IN/that frame/NN/frame is/VBZ/is currently/RB/currently allocated/VBN/allocated to/TO/to some/DT/some other/JJ/other process/NN/process ;/:/; that/DT/that is/VBZ/is /,/, one/CD/one process/NN/process can/MD/can take/VB/take a/DT/a frame/NN/frame from/IN/from another/NNP/another. local/JJ/local replacement/NN/replacement requires/VBZ/requires that/IN/that each/DT/each process/NN/process select/NN/select from/IN/from only/RB/only its/PRP$/its own/JJ/own set/NN/set of/IN/of allocated/VBN/allocated frames/NNP/frames. for/IN/for example/NN/example /,/, consider/NN/consider an/DT/an allocation/NN/allocation scheme/NN/scheme wherein/NN/wherein we/PRP/we allow/VBP/allow high-priority/JJ/high-priority processes/NNS/processes to/TO/to select/VB/select frames/NNS/frames from/IN/from low-priority/JJ/low-priority processes/NNS/processes for/IN/for replacement/NNP/replacement. a/DT/a process/NN/process can/MD/can select/VB/select a/DT/a replacement/NN/replacement from/IN/from among/IN/among its/PRP$/its own/JJ/own frames/NNS/frames or/CC/or the/DT/the frames/NNS/frames of/IN/of any/DT/any lower-priority/JJ/lower-priority process/NNP/process. this/DT/this approach/NN/approach allows/VBZ/allows a/DT/a high-priority/NN/high-priority process/NN/process to/TO/to increase/VB/increase its/PRP$/its frame/NN/frame allocation/NN/allocation at/IN/at the/DT/the expense/NN/expense of/IN/of a/DT/a low-priority/NN/low-priority process/NNP/process. with/IN/with a/DT/a local/JJ/local replacement/NN/replacement strategy/NN/strategy /,/, the/DT/the number/NN/number of/IN/of frames/NNS/frames allocated/VBN/allocated to/TO/to a/DT/a process/NN/process does/VBZ/does not/RB/not change/NNP/change. with/IN/with global/JJ/global replacement/NN/replacement /,/, a/DT/a process/NN/process may/MD/may happen/VB/happen to/TO/to select/VB/select only/RB/only frames/VBZ/frames allocated/VBN/allocated to/TO/to other/JJ/other processes/NNS/processes /,/, thus/RB/thus increasing/VBG/increasing the/DT/the number/NN/number of/IN/of frames/NNS/frames allocated/VBN/allocated to/TO/to it/PRP/it /:/( assuming/VBG/assuming that/IN/that other/JJ/other processes/NNS/processes do/VBP/do not/RB/not choose/VB/choose its/PRP$/its frames/NNS/frames for/IN/for replacement/NN/replacement /:/) /./. one/CD/one problem/NN/problem with/IN/with a/DT/a global/JJ/global replacement/NN/replacement algorithm/NN/algorithm is/VBZ/is that/IN/that a/DT/a process/NN/process can/MD/can not/RB/not control/VB/control its/PRP$/its own/JJ/own page-fault/JJ/page-fault rate/NNP/rate. the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in memory/NN/memory for/IN/for a/DT/a process/NN/process depends/VBZ/depends not/RB/not only/RB/only on/IN/on the/DT/the paging/NN/paging behavior/NN/behavior of/IN/of that/DT/that process/NN/process but/CC/but also/RB/also on/IN/on the/DT/the paging/NN/paging behavior/NN/behavior of/IN/of other/JJ/other processes/NNP/processes. therefore/IN/therefore /,/, the/DT/the same/JJ/same process/NN/process may/MD/may perform/VB/perform quite/RB/quite 9.5/CD/9.5 385/CD/385 differently/RB/differently /:/( for/IN/for example/NN/example /,/, taking/VBG/taking 0.5/CD/0.5 seconds/NNS/seconds for/IN/for one/CD/one execution/NN/execution and/CC/and 10.3/CD/10.3 seconds/NNS/seconds for/IN/for the/DT/the next/JJ/next execution/NN/execution /:/) because/IN/because of/IN/of totally/RB/totally external/JJ/external circuntstances/NNP/circuntstances. such/JJ/such is/VBZ/is not/RB/not the/DT/the case/NN/case with/IN/with a/DT/a local/JJ/local replacement/NN/replacement algorithm/NNP/algorithm. under/IN/under local/JJ/local replacement/NN/replacement /,/, the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in memory/NN/memory for/IN/for a/DT/a process/NN/process is/VBZ/is affected/VBN/affected by/IN/by the/DT/the paging/VBG/paging behavior/NN/behavior of/IN/of only/RB/only that/IN/that process/NNP/process. local/JJ/local replacement/NN/replacement might/MD/might hinder/VB/hinder a/DT/a process/NN/process /,/, however/RB/however /,/, by/IN/by not/RB/not making/VBG/making available/JJ/available to/TO/to it/PRP/it other/JJ/other /,/, less/RBR/less used/VBN/used pages/NNS/pages of/IN/of memory/NNP/memory. thus/RB/thus /,/, global/JJ/global replacement/NN/replacement generally/RB/generally results/NNS/results in/IN/in greater/JJR/greater system/NN/system throughput/NN/throughput and/CC/and is/VBZ/is therefore/RB/therefore the/DT/the more/RBR/more common/JJ/common method/NNP/method. 9.5.4/CD/9.5.4 non-uniform/NN/non-uniform memory/NN/memory access/NN/access thus/RB/thus far/JJ/far in/IN/in our/PRP$/our coverage/NN/coverage of/IN/of virtual/JJ/virtual memory/NN/memory /,/, we/PRP/we have/VBP/have assumed/VBN/assumed that/IN/that all/DT/all main/JJ/main memory/NN/memory is/VBZ/is created/VBN/created equal-or/JJ/equal-or at/IN/at least/JJS/least that/IN/that it/PRP/it is/VBZ/is accessed/VBN/accessed equally/-NONE-/equally. on/IN/on many/JJ/many computer/NN/computer systems/NNS/systems /,/, that/IN/that is/VBZ/is not/RB/not the/DT/the case/NNP/case. often/RB/often /,/, in/IN/in systems/NNS/systems with/IN/with multiple/JJ/multiple cpus/NNS/cpus /:/( section/NN/section 1.3.2/CD/1.3.2 /CD/) /,/, a/DT/a given/VBN/given cpu/NN/cpu can/MD/can access/NN/access some/DT/some sections/NNS/sections of/IN/of main/JJ/main memory/NN/memory faster/NN/faster than/IN/than it/PRP/it can/MD/can access/VB/access others/NNP/others. these/DT/these performance/NN/performance differences/NNS/differences are/VBP/are caused/VBN/caused by/IN/by how/WRB/how cpus/JJ/cpus and/CC/and memory/NN/memory are/VBP/are interconnected/VBN/interconnected in/IN/in the/DT/the system/NNP/system. frequently/RB/frequently /,/, such/JJ/such a/DT/a system/NN/system is/VBZ/is made/VBN/made up/RP/up of/IN/of several/JJ/several system/NN/system boards/NNS/boards /,/, each/DT/each containing/VBG/containing multiple/NN/multiple cpus/NN/cpus and/CC/and some/DT/some memory/NNP/memory. the/DT/the system/NN/system boards/NNS/boards are/VBP/are interconnected/VBN/interconnected in/IN/in various/JJ/various ways/NNS/ways /,/, ranging/VBG/ranging from/IN/from system/NN/system busses/NNS/busses to/TO/to high-speed/JJ/high-speed network/NN/network connections/NNS/connections like/IN/like infiniband/NNP/infiniband. as/IN/as you/PRP/you might/MD/might expect/VB/expect /,/, the/DT/the cpus/NN/cpus on/IN/on a/DT/a particular/JJ/particular board/NN/board can/MD/can access/NN/access the/DT/the memory/NN/memory on/IN/on that/DT/that board/NN/board with/IN/with less/JJR/less delay/NN/delay than/IN/than they/PRP/they can/MD/can access/VB/access memory/NN/memory on/IN/on other/JJ/other boards/NNS/boards in/IN/in the/DT/the system/NNP/system. systems/NNS/systems in/IN/in which/WDT/which memory/NN/memory access/NN/access times/NNS/times vary/JJ/vary significantly/RB/significantly are/VBP/are known/VBN/known collectively/RB/collectively as/IN/as systems/NNS/systems /,/, and/CC/and without/IN/without exception/NN/exception /,/, they/PRP/they are/VBP/are slower/JJR/slower than/IN/than systems/NNS/systems in/IN/in which/WDT/which memory/NN/memory and/CC/and cpus/VBZ/cpus are/VBP/are located/VBN/located on/IN/on the/DT/the same/JJ/same motherboard/NNP/motherboard. managing/VBG/managing which/WDT/which page/NN/page frames/VBZ/frames are/VBP/are stored/VBN/stored at/IN/at which/WDT/which locations/NNS/locations can/MD/can significantly/RB/significantly affect/VB/affect performance/NN/performance in/IN/in numa/NN/numa systems/NNP/systems. if/IN/if we/PRP/we treat/VBP/treat memory/NN/memory as/IN/as uniform/NN/uniform in/IN/in such/JJ/such a/DT/a system/NN/system /,/, cpus/VBZ/cpus may/MD/may wait/VB/wait significantly/RB/significantly longer/JJR/longer for/IN/for memory/NN/memory access/NN/access than/IN/than if/IN/if we/PRP/we modify/VBP/modify memory/NN/memory allocation/NN/allocation algorithms/NNS/algorithms to/TO/to take/VB/take numa/NN/numa into/IN/into account/NNP/account. similar/JJ/similar changes/NNS/changes must/MD/must be/VB/be rnade/VBN/rnade to/TO/to the/DT/the scheduling/NN/scheduling system/NNP/system. the/DT/the goal/NN/goal of/IN/of these/DT/these changes/NNS/changes is/VBZ/is to/TO/to have/VB/have memory/NN/memory frames/NNS/frames allocated/VBD/allocated as/IN/as close/JJ/close as/IN/as possible/JJ/possible to/TO/to the/DT/the cpu/NN/cpu on/IN/on which/WDT/which the/DT/the process/NN/process is/VBZ/is running/NNP/running. the/DT/the definition/NN/definition of/IN/of close/JJ/close is/VBZ/is with/IN/with minimum/JJ/minimum latency/NN/latency /,/, which/WDT/which typically/RB/typically means/VBZ/means on/IN/on the/DT/the same/JJ/same system/NN/system board/NN/board as/IN/as the/DT/the cpu/NNP/cpu. the/DT/the algorithmic/JJ/algorithmic changes/NNS/changes consist/VBP/consist of/IN/of having/VBG/having the/DT/the scheduler/NN/scheduler track/NN/track the/DT/the last/JJ/last cpu/NN/cpu on/IN/on which/WDT/which each/DT/each process/NN/process ran/NNP/ran. if/IN/if the/DT/the scheduler/NN/scheduler tries/NNS/tries to/TO/to schedule/VB/schedule each/DT/each process/NN/process onto/IN/onto its/PRP$/its previous/JJ/previous cpu/NN/cpu /,/, and/CC/and the/DT/the memory-management/JJ/memory-management system/NN/system tries/NNS/tries to/TO/to allocate/VB/allocate frames/NNS/frames for/IN/for the/DT/the process/NN/process close/NN/close to/TO/to the/DT/the cpu/NN/cpu on/IN/on which/WDT/which it/PRP/it is/VBZ/is being/VBG/being scheduled/VBN/scheduled /,/, then/RB/then improved/VBN/improved cache/NN/cache hits/NNS/hits and/CC/and decreased/VBD/decreased memory/NN/memory access/NN/access times/NNS/times will/MD/will result/NNP/result. the/DT/the picture/NN/picture is/VBZ/is more/RBR/more complicated/JJ/complicated once/NN/once threads/NNS/threads are/VBP/are added/NNP/added. for/IN/for example/NN/example /,/, a/DT/a process/NN/process with/IN/with many/JJ/many running/VBG/running threads/NNS/threads may/MD/may end/VB/end up/RP/up with/IN/with those/DT/those threads/NNS/threads scheduled/VBN/scheduled on/IN/on many/JJ/many different/JJ/different system/NN/system boards/NNP/boards. how/WRB/how is/VBZ/is the/DT/the memory/NN/memory to/TO/to be/VB/be allocated/VBN/allocated in/IN/in this/DT/this case/NN/case solaris/VBZ/solaris solves/NNS/solves the/DT/the problem/NN/problem by/IN/by creating/NN/creating an/DT/an entity/NN/entity in/IN/in the/DT/the kernel/NNP/kernel. each/DT/each lgroup/NN/lgroup gathers/NNS/gathers together/RB/together close/JJ/close cpus/NN/cpus and/CC/and memory/NNP/memory. in/IN/in fact/NN/fact /,/, there/EX/there is/VBZ/is a/DT/a hierarchy/JJ/hierarchy of/IN/of lgroups/NNS/lgroups based/VBN/based on/IN/on the/DT/the amount/NN/amount of/IN/of latency/NN/latency between/IN/between the/DT/the groups/NNP/groups. solaris/VBZ/solaris tries/NNS/tries to/TO/to schedule/VB/schedule all/DT/all threads/NNS/threads of/IN/of a/DT/a process/NN/process and/CC/and allocate/JJ/allocate all/DT/all memory/NN/memory of/IN/of a/DT/a process/NN/process within/IN/within an/DT/an lgroup/NNP/lgroup. if/IN/if that/DT/that is/VBZ/is not/RB/not possible/JJ/possible /,/, it/PRP/it picks/VBZ/picks nearby/JJ/nearby lgroups/NNS/lgroups for/IN/for the/DT/the rest/NN/rest of/IN/of the/DT/the resources/NNS/resources needed/NNP/needed. in/IN/in this/DT/this manner/NN/manner /,/, overall/JJ/overall memory/NN/memory latency/NN/latency is/VBZ/is minimized/VBN/minimized /,/, and/CC/and cpu/VB/cpu cache/PRP/cache hit/VBD/hit rates/NNS/rates are/VBP/are maximized/NNP/maximized. 386/CD/386 chapter/NN/chapter 9/CD/9 9.6/CD/9.6 if/IN/if the/DT/the number/NN/number of/IN/of frames/NNS/frames allocated/VBN/allocated to/TO/to a/DT/a low-priority/NN/low-priority process/NN/process falls/NNS/falls below/IN/below the/DT/the minimum/JJ/minimum number/NN/number required/VBN/required by/IN/by the/DT/the computer/NN/computer architecture/NN/architecture /,/, we/PRP/we must/MD/must suspend/VB/suspend that/IN/that process/NN/process 's/POS/'s execution/NNP/execution. we/PRP/we should/MD/should then/RB/then page/VB/page out/RP/out its/PRP$/its remaining/VBG/remaining pages/NNS/pages /,/, freeing/VBG/freeing all/DT/all its/PRP$/its allocated/VBN/allocated frames/NNP/frames. this/DT/this provision/NN/provision introduces/VBZ/introduces a/DT/a swap-in/JJ/swap-in /,/, swap-out/JJ/swap-out level/NN/level of/IN/of intermediate/JJ/intermediate cpu/NN/cpu scheduling/NNP/scheduling. in/IN/in fact/NN/fact /,/, look/VBP/look at/IN/at any/DT/any process/NN/process that/WDT/that does/VBZ/does not/RB/not have/VB/have enough/RB/enough frames/NNP/frames. if/IN/if the/DT/the process/NN/process does/VBZ/does not/RB/not have/VB/have the/DT/the num.ber/JJ/num.ber of/IN/of frames/NNS/frames it/PRP/it needs/VBZ/needs to/TO/to support/VB/support pages/NNS/pages in/IN/in active/JJ/active use/NN/use /,/, it/PRP/it will/MD/will quickly/RB/quickly page-fault/NNP/page-fault. at/IN/at this/DT/this point/NN/point /,/, it/PRP/it must/MD/must replace/VB/replace some/DT/some page/NNP/page. however/RB/however /,/, since/IN/since all/DT/all its/PRP$/its pages/NNS/pages are/VBP/are in/IN/in active/JJ/active use/NN/use /,/, it/PRP/it must/MD/must replace/VB/replace a/DT/a page/NN/page that/WDT/that will/MD/will be/VB/be needed/VBN/needed again/RB/again right/RB/right away/NNP/away. consequently/RB/consequently /,/, it/PRP/it quickly/RB/quickly faults/VBZ/faults again/RB/again /,/, and/CC/and again/RB/again /,/, and/CC/and again/RB/again /,/, replacing/VBG/replacing pages/NNS/pages that/WDT/that it/PRP/it must/MD/must back/VB/back in/IN/in immediately/NNP/immediately. this/DT/this high/JJ/high paging/NN/paging activity/NN/activity is/VBZ/is called/VBN/called a/DT/a process/NN/process is/VBZ/is thrashing/VBG/thrashing if/IN/if it/PRP/it is/VBZ/is spending/VBG/spending more/JJR/more time/NN/time paging/VBG/paging than/IN/than executing/NNP/executing. 9.6.1/CD/9.6.1 cause/NN/cause of/IN/of thrashing/VBG/thrashing thrashing/NN/thrashing results/NNS/results in/IN/in severe/JJ/severe performance/NN/performance problems/NNP/problems. consider/NN/consider the/DT/the following/VBG/following scenario/NN/scenario /,/, which/WDT/which is/VBZ/is based/VBN/based on/IN/on the/DT/the actual/JJ/actual behavior/NN/behavior of/IN/of early/JJ/early paging/NN/paging systems/NNP/systems. the/DT/the operating/NN/operating system/NN/system monitors/NNS/monitors cpu/VBP/cpu utilization/NNP/utilization. if/IN/if cpu/NN/cpu utilization/NN/utilization is/VBZ/is too/RB/too low/JJ/low /,/, we/PRP/we increase/VBP/increase the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming by/IN/by introducing/VBG/introducing a/DT/a new/JJ/new process/NN/process to/TO/to the/DT/the system/NNP/system. a/DT/a global/JJ/global page-replacement/JJ/page-replacement algorithm/NN/algorithm is/VBZ/is used/VBN/used ;/:/; it/PRP/it replaces/VBZ/replaces pages/NNS/pages without/IN/without regard/NN/regard to/TO/to the/DT/the process/NN/process to/TO/to which/WDT/which they/PRP/they belong/VBP/belong. now/RB/now suppose/JJ/suppose that/IN/that a/DT/a process/NN/process enters/VBZ/enters a/DT/a new/JJ/new phase/NN/phase in/IN/in its/PRP$/its execution/NN/execution and/CC/and needs/VBZ/needs more/RBR/more frames/NNP/frames. it/PRP/it starts/VBZ/starts faulting/VBG/faulting and/CC/and taking/VBG/taking frames/NNS/frames away/RB/away from/IN/from other/JJ/other processes/NNP/processes. these/DT/these processes/NNS/processes need/VBP/need those/DT/those pages/NNS/pages /,/, however/RB/however /,/, and/CC/and so/RB/so they/PRP/they also/RB/also fault/VBD/fault /,/, taking/VBG/taking frames/NNS/frames from/IN/from other/JJ/other processes/NNP/processes. these/DT/these faulting/VBG/faulting processes/NNS/processes must/MD/must use/VB/use the/DT/the pagin.g/JJ/pagin.g device/NN/device to/TO/to swap/VB/swap pages/NNS/pages in/IN/in and/CC/and out/NNP/out. as/IN/as they/PRP/they queue/VBP/queue up/RP/up for/IN/for the/DT/the paging/VBG/paging device/NN/device /,/, the/DT/the ready/JJ/ready queue/NN/queue empties/NNP/empties. as/IN/as processes/NNS/processes wait/VBP/wait for/IN/for the/DT/the paging/VBG/paging device/NN/device /,/, cpu/NN/cpu utilization/NN/utilization decreases/NNP/decreases. the/DT/the cpu/NN/cpu scheduler/NN/scheduler sees/NNS/sees the/DT/the decreasing/VBG/decreasing cpu/NN/cpu utilization/NN/utilization and/CC/and increases/VBZ/increases the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming as/IN/as a/DT/a result/NNP/result. the/DT/the new/JJ/new process/NN/process tries/NNS/tries to/TO/to get/VB/get started/VBN/started by/IN/by taking/NN/taking frames/NNS/frames from/IN/from running/VBG/running processes/NNS/processes /,/, causing/VBG/causing more/JJR/more page/NN/page faults/NNS/faults and/CC/and a/DT/a longer/NN/longer queue/NN/queue for/IN/for the/DT/the paging/VBG/paging device/NNP/device. as/IN/as a/DT/a result/NN/result /,/, cpu/NN/cpu utilization/NN/utilization drops/NNS/drops even/RB/even further/JJ/further /,/, and/CC/and the/DT/the cpu/NN/cpu scheduler/NN/scheduler tries/NNS/tries to/TO/to increase/VB/increase the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming even/RB/even more/NNP/more. thrashing/NN/thrashing has/VBZ/has occurred/VBN/occurred /,/, and/CC/and system/NN/system throughput/NN/throughput plunges/NNP/plunges. the/DT/the pagefault/NN/pagefault rate/NN/rate increases/NNS/increases tremendously/NNP/tremendously. as/IN/as a/DT/a result/NN/result /,/, the/DT/the effective/JJ/effective m.emory-access/NN/m.emory-access time/NN/time increases/NNP/increases. no/DT/no work/NN/work is/VBZ/is getting/VBG/getting done/NN/done /,/, because/IN/because the/DT/the processes/NNS/processes are/VBP/are spending/VBG/spending all/DT/all their/PRP$/their time/NN/time paging/NNP/paging. this/DT/this phenomenon/NN/phenomenon is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 9.18/CD/9.18 /,/, in/IN/in which/WDT/which cpu/NN/cpu utilization/NN/utilization is/VBZ/is plotted/VBN/plotted against/IN/against the/DT/the degree/NN/degree of/IN/of multiprogramming/NNP/multiprogramming. as/IN/as the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming increases/NNS/increases /,/, cpu/VBP/cpu utilization/NN/utilization also/RB/also ilccreases/VBZ/ilccreases /,/, although/IN/although more/JJR/more slowly/RB/slowly /,/, until/IN/until a/DT/a maximum/NN/maximum is/VBZ/is reached/NNP/reached. if/IN/if the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming is/VBZ/is increased/VBN/increased even/RB/even further/RB/further /,/, thrashing/VBG/thrashing sets/NNS/sets in/IN/in /,/, and/CC/and cpu/VB/cpu utilization/NN/utilization drops/NNS/drops sharply/NNP/sharply. at/IN/at this/DT/this point/NN/point /,/, to/TO/to increase/VB/increase cpu/NN/cpu utilization/NN/utilization and/CC/and stop/VB/stop thrashing/VBG/thrashing /,/, we/PRP/we must/MD/must decrease/VB/decrease the/DT/the degree/NN/degree of/IN/of multiprogramming/NNP/multiprogramming. we/PRP/we can/MD/can limit/VB/limit the/DT/the effects/NNS/effects of/IN/of thrashing/VBG/thrashing by/IN/by using/VBG/using a/DT/a /NN/( or/CC/or with/IN/with local/JJ/local replacement/NN/replacement /,/, if/IN/if one/CD/one process/NN/process starts/NNS/starts thrashing/VBG/thrashing /,/, it/PRP/it can/MD/can not/RB/not frames/VBZ/frames from/IN/from another/DT/another process/NN/process and/CC/and cause/VB/cause the/DT/the latter/NN/latter to/TO/to thrash/VB/thrash as/IN/as well/NNP/well. however/RB/however /,/, the/DT/the problem/NN/problem is/VBZ/is not/RB/not entirely/RB/entirely solved/NNP/solved. if/IN/if processes/NNS/processes are/VBP/are 9.6/CD/9.6 387/CD/387 degree/CD/degree of/IN/of multiprogramming/NN/multiprogramming figure/NN/figure 9.18/CD/9.18 thrashing/NNP/thrashing. thrashing/NN/thrashing /,/, they/PRP/they will/MD/will be/VB/be in/IN/in the/DT/the queue/NN/queue for/IN/for the/DT/the paging/VBG/paging device/NN/device most/JJS/most of/IN/of the/DT/the time/NNP/time. the/DT/the average/JJ/average service/NN/service time/NN/time for/IN/for a/DT/a page/NN/page fault/NN/fault will/MD/will increase/VB/increase because/IN/because of/IN/of the/DT/the longer/NN/longer average/NN/average queue/NN/queue for/IN/for the/DT/the paging/VBG/paging device/NNP/device. thus/RB/thus /,/, the/DT/the effective/JJ/effective access/NN/access time/NN/time will/MD/will increase/VB/increase even/RB/even for/IN/for a/DT/a process/NN/process that/WDT/that is/VBZ/is not/RB/not thrashing/NNP/thrashing. to/TO/to prevent/VB/prevent thtashing/NN/thtashing /,/, we/PRP/we must/MD/must provide/VB/provide a/DT/a process/NN/process with/IN/with as/RB/as many/JJ/many frames/NNS/frames as/IN/as it/PRP/it needs/NNP/needs. but/CC/but how/WRB/how do/VBP/do we/PRP/we know/VB/know how/WRB/how many/JJ/many frames/NNS/frames it/PRP/it needs/VBZ/needs there/RB/there are/VBP/are several/JJ/several teclmiques/NNP/teclmiques. the/DT/the working-set/JJ/working-set strategy/NN/strategy /:/( section/NN/section 9.6.2/CD/9.6.2 /CD/) starts/NNS/starts by/IN/by looking/VBG/looking at/IN/at how/WRB/how frames/NNS/frames a/DT/a process/NN/process is/VBZ/is actually/RB/actually using/NNP/using. this/DT/this approach/NN/approach defines/VBZ/defines the/DT/the locality/NN/locality of/IN/of process/NN/process execution/NNP/execution. the/DT/the locality/NN/locality model/NN/model states/VBZ/states that/IN/that /,/, as/IN/as a/DT/a process/NN/process executes/VBZ/executes /,/, it/PRP/it moves/VBZ/moves from/IN/from locality/NN/locality to/TO/to locality/NNP/locality. a/DT/a locality/NN/locality is/VBZ/is a/DT/a set/NN/set of/IN/of pages/NNS/pages that/WDT/that are/VBP/are actively/RB/actively used/VBN/used together/RP/together /:/( figure/NN/figure 9.19/CD/9.19 /CD/) /./. a/DT/a program/NN/program is/VBZ/is generally/RB/generally composed/VBN/composed of/IN/of several/JJ/several different/JJ/different localities/NNS/localities /,/, which/WDT/which may/MD/may overlap/NNP/overlap. for/IN/for example/NN/example /,/, when/WRB/when a/DT/a function/NN/function is/VBZ/is called/VBN/called /,/, it/PRP/it defines/VBZ/defines a/DT/a new/JJ/new locality/NNP/locality. in/IN/in this/DT/this locality/NN/locality /,/, memory/NN/memory references/NNS/references are/VBP/are made/VBN/made to/TO/to the/DT/the instructions/NNS/instructions of/IN/of the/DT/the function/NN/function call/NN/call /,/, its/PRP$/its local/JJ/local variables/NNS/variables /,/, and/CC/and a/DT/a subset/NN/subset of/IN/of the/DT/the global/JJ/global variables/NNP/variables. when/WRB/when we/PRP/we exit/VBP/exit the/DT/the function/NN/function /,/, the/DT/the process/NN/process leaves/VBZ/leaves this/DT/this locality/NN/locality /,/, since/IN/since the/DT/the local/JJ/local variables/NNS/variables and/CC/and instructions/NNS/instructions of/IN/of the/DT/the function/NN/function are/VBP/are no/RB/no longer/RBR/longer in/IN/in active/JJ/active use/NNP/use. we/PRP/we may/MD/may return/VB/return to/TO/to this/DT/this locality/NN/locality later/NNP/later. thus/RB/thus /,/, we/PRP/we see/VBP/see that/IN/that localities/NNS/localities are/VBP/are defined/VBN/defined by/IN/by the/DT/the program/NN/program structure/NN/structure and/CC/and its/PRP$/its data/NNS/data structures/NNP/structures. the/DT/the locality/NN/locality model/NN/model states/VBZ/states that/IN/that all/DT/all programs/NNS/programs will/MD/will exhibit/VB/exhibit this/DT/this basic/JJ/basic memory/NN/memory reference/NN/reference structure/NNP/structure. note/NN/note that/IN/that the/DT/the locality/NN/locality model/NN/model is/VBZ/is the/DT/the unstated/VBN/unstated principle/NN/principle behind/IN/behind the/DT/the caching/NN/caching discussions/NNS/discussions so/RB/so far/RB/far in/IN/in this/DT/this book/NN/book if/IN/if accesses/NNS/accesses to/TO/to any/DT/any types/NNS/types of/IN/of data/NNS/data were/VBD/were random/NN/random rather/RB/rather than/IN/than patterned/VBN/patterned /,/, caching/NN/caching would/MD/would be/VB/be useless/NNP/useless. suppose/NN/suppose we/PRP/we allocate/VBP/allocate enough/RB/enough frames/VBZ/frames to/TO/to a/DT/a process/NN/process to/TO/to accommodate/VB/accommodate its/PRP$/its current/JJ/current locality/NNP/locality. it/PRP/it will/MD/will fault/VB/fault for/IN/for the/DT/the pages/NNS/pages in/IN/in its/PRP$/its locality/NN/locality until/IN/until all/DT/all these/DT/these pages/NNS/pages are/VBP/are in/IN/in memory/NN/memory ;/:/; then/RB/then /,/, it/PRP/it will/MD/will not/RB/not fault/VB/fault again/RB/again until/IN/until it/PRP/it changes/VBZ/changes localities/NNP/localities. if/IN/if we/PRP/we do/VBP/do not/RB/not allocate/VB/allocate enough/RB/enough frames/VBZ/frames to/TO/to accommodate/VB/accommodate the/DT/the size/NN/size of/IN/of the/DT/the current/JJ/current locality/NN/locality /,/, the/DT/the process/NN/process will/MD/will thrash/VB/thrash /,/, since/IN/since it/PRP/it can/MD/can not/RB/not keep/VB/keep in/IN/in memory/NN/memory all/DT/all the/DT/the pages/NNS/pages that/WDT/that it/PRP/it is/VBZ/is actively/RB/actively using/NNP/using. 9.6.2/CD/9.6.2 working-set/JJ/working-set model/NN/model as/IN/as mentioned/VBN/mentioned /,/, the/DT/the is/VBZ/is based/VBN/based on/IN/on the/DT/the assumption/NN/assumption of/IN/of locality/NNP/locality. this/DT/this model/NN/model uses/VBZ/uses a/DT/a paramete1/NNP/paramete1 ~/NNP/~ //NNP// '/POS/' /:/: /,/, /,/, to/TO/to define/VB/define the/DT/the vrindovv/NNP/vrindovv. the/DT/the idea/NN/idea 388/CD/388 chapter/NN/chapter 9/CD/9 32/CD/32 ~/CD/~ ~/CD/~ /:/---- ~/CD/~ ~/CD/~ =/CD/= =/CD/= ~/CD/~ ~/CD/~ ~/CD/~ ~/CD/~ ~/CD/~ wl/NN/wl ~/:/~ ~/:/~ #/#/# /:/- ~/CD/~ ~/CD/~ /:/-- ~/CD/~ ~/CD/~ ~/CD/~ /:/- \/CD/\ jjl/NN/jjl /:/: jlli111/NNP/jlli111 28/CD/28 /CD/( j/NN/j /:/) /:/( j/NN/j /:/) /:/( !/./! /:/: 0/-NONE-/0 0/-NONE-/0 /:/( lj/NN/lj 26/CD/26 i/PRP/i '/''/' c/NN/c 0/-NONE-/0 i/PRP/i e/VBP/e i/PRP/i /VBP/( lj/NN/lj e/NN/e execution/NN/execution time/NN/time /:/-------.. figure/NN/figure 9.19/CD/9.19 locality/NN/locality in/IN/in a/DT/a memory-reference/NN/memory-reference pattern/NNP/pattern. is/VBZ/is to/TO/to examine/VB/examine the/DT/the most/JJS/most recent/JJ/recent 6/CD/6 references/NNP/references. the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in the/DT/the most/RBS/most recent/JJ/recent 6/CD/6 page/NN/page references/NNS/references is/VBZ/is the/DT/the /NN/( figure/NN/figure 9.20/CD/9.20 /CD/) /./. if/IN/if a/DT/a page/NN/page is/VBZ/is in/IN/in active/JJ/active use/NN/use /,/, it/PRP/it will/MD/will be/VB/be in/IN/in the/DT/the working/VBG/working set/NNP/set. if/IN/if it/PRP/it is/VBZ/is no/DT/no longer/NN/longer being/VBG/being used/VBN/used /,/, it/PRP/it will/MD/will drop/VB/drop from/IN/from the/DT/the working/VBG/working set/NN/set 6/CD/6 time/NN/time units/NNS/units after/IN/after its/PRP$/its last/JJ/last reference/NNP/reference. thus/RB/thus /,/, the/DT/the working/VBG/working set/NN/set is/VBZ/is an/DT/an approximation/NN/approximation of/IN/of the/DT/the program/NN/program 's/POS/'s locality/NNP/locality. for/IN/for example/NN/example /,/, given/VBN/given the/DT/the sequence/NN/sequence of/IN/of memory/NN/memory references/NNS/references shown/IN/shown in/IN/in figure/NN/figure 9.20/CD/9.20 /,/, if/IN/if 6/CD/6 =/CD/= 10/CD/10 memory/NN/memory references/NNS/references /,/, then/RB/then the/DT/the working/VBG/working set/NN/set at/IN/at time/NN/time t1/NNP/t1 is/VBZ/is /NNP/{ 1/CD/1 /,/, 2/CD/2 /,/, 5/CD/5 /,/, 6/CD/6 /,/, 7/CD/7 /:/} /./. by/IN/by time/NN/time t2/NNP/t2 /,/, the/DT/the working/VBG/working set/NN/set has/VBZ/has changed/VBN/changed to/TO/to /NNP/{ 3/CD/3 /,/, 4/CD/4 /:/} /./. the/DT/the accuracy/NN/accuracy of/IN/of the/DT/the working/VBG/working set/NN/set depends/NNS/depends on/IN/on the/DT/the selection/NN/selection of/IN/of 6/CD/6. if/IN/if 6/CD/6 is/VBZ/is too/RB/too small/JJ/small /,/, it/PRP/it will/MD/will not/RB/not encompass/VB/encompass the/DT/the entire/JJ/entire locality/NN/locality ;/:/; if/IN/if 6/CD/6 is/VBZ/is too/RB/too large/JJ/large /,/, it/PRP/it may/MD/may overlap/VB/overlap 9.6/CD/9.6 page/NN/page reference/NN/reference table/NN/table /./. /./. /./. 2/CD/2 6/CD/6 1/CD/1 5/CD/5 7/CD/7 7/CD/7 7/CD/7 7/CD/7 5/CD/5 1/CD/1 6/CD/6 2/CD/2 3/CD/3 4/CD/4 1/CD/1 2/CD/2 3/CD/3 4/CD/4 4/CD/4 4/CD/4 3/CD/3 4/CD/4 3/CD/3 4/CD/4 4/CD/4 4/CD/4 1/CD/1 3/CD/3 2/CD/2 3/CD/3 4/CD/4 4/CD/4 4/CD/4 3/CD/3 4/CD/4 4/CD/4 4/CD/4 /./. ~/CD/~ ~/CD/~ r/NN/r ~/:/~ r/NN/r t1/NNP/t1 ws/VBZ/ws /:/( t1/NNP/t1 /:/) =/:/= /:/{ 1/CD/1 ,2,5,6,7/-NONE-/,2,5,6,7 /:/} figure/NN/figure 9.20/CD/9.20 working-set/JJ/working-set model/NNP/model. 389/CD/389 several/JJ/several localities/NNP/localities. in/IN/in the/DT/the extrem.e/JJ/extrem.e /,/, if/IN/if l/NNP/l. is/VBZ/is infinite/JJ/infinite /,/, the/DT/the working/VBG/working set/NN/set is/VBZ/is the/DT/the set/NN/set of/IN/of pages/NNS/pages touched/VBD/touched during/IN/during the/DT/the process/NN/process execution/NNP/execution. the/DT/the most/RBS/most important/JJ/important property/NN/property of/IN/of the/DT/the working/VBG/working set/NN/set /,/, then/RB/then /,/, is/VBZ/is its/PRP$/its size/NNP/size. if/IN/if we/PRP/we compute/VBP/compute the/DT/the working-set/JJ/working-set size/NN/size /,/, wss/NN/wss ;/:/; /,/, for/IN/for each/DT/each process/NN/process in/IN/in the/DT/the system/NN/system /,/, we/PRP/we can/MD/can then/RB/then consider/VB/consider that/DT/that where/WRB/where dis/VBZ/dis the/DT/the total/JJ/total demand/NN/demand for/IN/for frames/NNP/frames. each/DT/each process/NN/process is/VBZ/is actively/RB/actively using/VBG/using the/DT/the pages/NNS/pages in/IN/in its/PRP$/its working/NN/working set/NNP/set. thus/RB/thus /,/, process/NN/process i/PRP/i needs/VBZ/needs wss/NNS/wss ;/:/; frames/NNP/frames. if/IN/if the/DT/the total/JJ/total demand/NN/demand is/VBZ/is greater/JJR/greater than/IN/than the/DT/the total/JJ/total number/NN/number of/IN/of available/JJ/available frames/NNS/frames /:/( d/NN/d m/NN/m /:/) /,/, thrashing/VBG/thrashing will/MD/will occur/VB/occur /,/, because/IN/because some/DT/some processes/NNS/processes will/MD/will not/RB/not have/VB/have enough/RB/enough frames/NNP/frames. once/RB/once l/NNP/l. has/VBZ/has been/VBN/been selected/VBN/selected /,/, use/NN/use of/IN/of the/DT/the working-set/JJ/working-set model/NN/model is/VBZ/is simple/NNP/simple. the/DT/the operating/NN/operating system/NN/system monitors/NNS/monitors the/DT/the working/VBG/working set/NN/set of/IN/of each/DT/each process/NN/process and/CC/and allocates/VBZ/allocates to/TO/to that/DT/that working/VBG/working set/NN/set enough/RB/enough frames/VBZ/frames to/TO/to provide/VB/provide it/PRP/it with/IN/with its/PRP$/its working-set/JJ/working-set size/NNP/size. if/IN/if there/EX/there are/VBP/are enough/RB/enough extra/JJ/extra frames/NNS/frames /,/, another/DT/another process/NN/process can/MD/can be/VB/be initiated/NNP/initiated. if/IN/if the/DT/the sum/NN/sum of/IN/of the/DT/the working-set/JJ/working-set sizes/NNS/sizes increases/NNS/increases /,/, exceeding/VBG/exceeding the/DT/the total/JJ/total number/NN/number of/IN/of available/JJ/available frames/NNS/frames /,/, the/DT/the operating/NN/operating system/NN/system selects/NNS/selects a/DT/a process/NN/process to/TO/to suspend/NNP/suspend. the/DT/the process/NN/process 's/POS/'s pages/NNS/pages are/VBP/are written/VBN/written out/RP/out /:/( swapped/VBD/swapped /CD/) /,/, and/CC/and its/PRP$/its frames/NNS/frames are/VBP/are reallocated/VBN/reallocated to/TO/to other/JJ/other processes/NNP/processes. the/DT/the suspended/VBN/suspended process/NN/process can/MD/can be/VB/be restarted/VBN/restarted later/NNP/later. this/DT/this working-set/JJ/working-set strategy/NN/strategy prevents/NNS/prevents thrashing/VBG/thrashing while/IN/while keeping/VBG/keeping the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming as/IN/as high/JJ/high as/IN/as possible/NNP/possible. thus/RB/thus /,/, it/PRP/it optimizes/VBZ/optimizes cpu/PRP/cpu utilization/NNP/utilization. the/DT/the difficulty/NN/difficulty with/IN/with the/DT/the working-set/JJ/working-set model/NN/model is/VBZ/is keeping/VBG/keeping track/NN/track of/IN/of the/DT/the working/VBG/working set/NNP/set. the/DT/the working-set/JJ/working-set window/NN/window is/VBZ/is a/DT/a moving/NN/moving window/NNP/window. at/IN/at each/DT/each memory/NN/memory reference/NN/reference /,/, a/DT/a new/JJ/new reference/NN/reference appears/VBZ/appears at/IN/at one/CD/one end/NN/end and/CC/and the/DT/the oldest/JJS/oldest reference/NN/reference drops/NNS/drops off/IN/off the/DT/the other/JJ/other end/NNP/end. a/DT/a page/NN/page is/VBZ/is in/IN/in the/DT/the working/VBG/working set/NN/set if/IN/if it/PRP/it is/VBZ/is referenced/VBN/referenced anywhere/RB/anywhere in/IN/in the/DT/the working-set/JJ/working-set window/NNP/window. we/PRP/we can/MD/can approximate/VB/approximate the/DT/the working-set/JJ/working-set model/NN/model with/IN/with a/DT/a fixed-interval/JJ/fixed-interval timer/NN/timer interrupt/NN/interrupt and/CC/and a/DT/a reference/NN/reference bit/NNP/bit. for/IN/for example/NN/example /,/, assum.e/JJ/assum.e that/IN/that l/NNP/l. equals/NNS/equals 10,000/CD/10,000 references/NNS/references and/CC/and that/IN/that we/PRP/we can/MD/can cause/VB/cause a/DT/a timer/NN/timer interrupt/NN/interrupt every/DT/every 5,000/CD/5,000 references/NNP/references. when/WRB/when we/PRP/we get/VBP/get a/DT/a timer/NN/timer interrupt/NN/interrupt /,/, we/PRP/we copy/VBP/copy and/CC/and clear/JJ/clear the/DT/the reference-bit/JJ/reference-bit values/NNS/values for/IN/for each/DT/each page/NNP/page. thus/RB/thus /,/, if/IN/if a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, we/PRP/we can/MD/can examine/VB/examine the/DT/the current/JJ/current reference/NN/reference bit/NN/bit and/CC/and two/CD/two in-memory/JJ/in-memory bits/NNS/bits to/TO/to determine/VB/determine whether/IN/whether a/DT/a page/NN/page was/VBD/was used/VBN/used within/IN/within the/DT/the last/JJ/last 10,000/CD/10,000 to/TO/to 15,000/CD/15,000 references/NNP/references. if/IN/if it/PRP/it was/VBD/was used/VBN/used /,/, at/IN/at least/JJS/least one/CD/one of/IN/of these/DT/these bits/NNS/bits will/MD/will be/VB/be on/NNP/on. if/IN/if it/PRP/it has/VBZ/has not/RB/not been/VBN/been used/VBN/used /,/, these/DT/these bits/NNS/bits will/MD/will be/VB/be off/NNP/off. those/DT/those pages/NNS/pages with/IN/with at/IN/at least/JJS/least one/CD/one bit/NN/bit on/IN/on will/MD/will be/VB/be considered/VBN/considered to/TO/to be/VB/be in/IN/in the/DT/the working/VBG/working set/NNP/set. note/NN/note that/IN/that this/DT/this arrangement/NN/arrangement is/VBZ/is not/RB/not entirely/RB/entirely accurate/JJ/accurate /,/, because/IN/because we/PRP/we can/MD/can not/RB/not tell/VB/tell where/WRB/where /,/, within/IN/within an/DT/an interval/NN/interval of/IN/of 5,000/CD/5,000 /,/, a/DT/a reference/NN/reference occurred/NNP/occurred. we/PRP/we can/MD/can reduce/VB/reduce the/DT/the uncertainty/NN/uncertainty by/IN/by increasing/VBG/increasing the/DT/the number/NN/number of/IN/of history/NN/history bits/NNS/bits and/CC/and the/DT/the frequency/NN/frequency of/IN/of interrupts/NNS/interrupts /:/( for/IN/for example/NN/example /,/, 10/CD/10 bits/NNS/bits and/CC/and interrupts/NNS/interrupts every/DT/every 1,000/CD/1,000 references/NNS/references /:/) /./. however/RB/however /,/, the/DT/the cost/NN/cost to/TO/to service/NN/service these/DT/these more/RBR/more frequent/JJ/frequent interrupts/NNS/interrupts will/MD/will be/VB/be correspondingly/RB/correspondingly higher/NNP/higher. 390/CD/390 chapter/NN/chapter 9/CD/9 9.7/CD/9.7 number/NN/number of/IN/of frames/NNS/frames figure/VBP/figure 9.21/CD/9.21 page-fault/JJ/page-fault frequency/NNP/frequency. 9.6.3/CD/9.6.3 page-fault/JJ/page-fault frequency/NN/frequency the/DT/the working-set/JJ/working-set model/NN/model is/VBZ/is successful/JJ/successful /,/, and/CC/and knowledge/NN/knowledge of/IN/of the/DT/the working/VBG/working set/NN/set can/MD/can be/VB/be useful/JJ/useful for/IN/for prepaging/NN/prepaging /:/( section/NN/section 9.9.1/CD/9.9.1 /CD/) /,/, but/CC/but it/PRP/it seems/VBZ/seems a/DT/a clumsy/NN/clumsy way/NN/way to/TO/to control/NN/control thrashilcg/NNP/thrashilcg. a/DT/a strategy/NN/strategy that/WDT/that uses/VBZ/uses the/DT/the takes/NNS/takes a/DT/a more/RBR/more direct/JJ/direct approach/NNP/approach. the/DT/the specific/JJ/specific problem/NN/problem is/VBZ/is how/WRB/how to/TO/to prevent/VB/prevent thrashilcg/NNP/thrashilcg. thrashing/NN/thrashing has/VBZ/has a/DT/a high/JJ/high page-fault/JJ/page-fault rate/NNP/rate. thus/RB/thus /,/, we/PRP/we want/VBP/want to/TO/to control/NN/control the/DT/the page-fault/JJ/page-fault rate/NNP/rate. when/WRB/when it/PRP/it is/VBZ/is too/RB/too high/JJ/high /,/, we/PRP/we know/VBP/know that/IN/that the/DT/the process/NN/process needs/VBZ/needs more/JJR/more frames/NNP/frames. conversely/RB/conversely /,/, if/IN/if the/DT/the page-fault/JJ/page-fault rate/NN/rate is/VBZ/is too/RB/too low/JJ/low /,/, then/RB/then the/DT/the process/NN/process may/MD/may have/VB/have too/RB/too many/JJ/many frames/NNP/frames. we/PRP/we can/MD/can establish/VB/establish upper/JJ/upper and/CC/and lower/JJR/lower bounds/NNS/bounds on/IN/on the/DT/the desired/VBN/desired page-fault/JJ/page-fault rate/NN/rate /:/( figure/NN/figure 9.21/CD/9.21 /CD/) /./. if/IN/if the/DT/the actual/JJ/actual page-fault/NN/page-fault rate/NN/rate exceeds/VBZ/exceeds the/DT/the upper/JJ/upper limit/NN/limit /,/, we/PRP/we allocate/VBP/allocate the/DT/the process/NN/process another/DT/another frame/NN/frame ;/:/; if/IN/if the/DT/the page-fault/JJ/page-fault rate/NN/rate falls/NNS/falls below/IN/below the/DT/the lower/JJR/lower limit/NN/limit /,/, we/PRP/we remove/VBP/remove a/DT/a frame/NN/frame from/IN/from the/DT/the process/NNP/process. thus/RB/thus /,/, we/PRP/we can/MD/can directly/RB/directly measure/VB/measure and/CC/and control/NN/control the/DT/the page-fault/JJ/page-fault rate/NN/rate to/TO/to prevent/VB/prevent thrashing/NNP/thrashing. as/IN/as with/IN/with the/DT/the working-set/JJ/working-set strategy/NN/strategy /,/, we/PRP/we may/MD/may have/VB/have to/TO/to suspend/VB/suspend a/DT/a process/NNP/process. if/IN/if the/DT/the page-fault/JJ/page-fault rate/NN/rate ilccreases/NNS/ilccreases and/CC/and no/DT/no free/JJ/free frames/NNS/frames are/VBP/are available/JJ/available /,/, we/PRP/we must/MD/must select/VB/select some/DT/some process/NN/process and/CC/and suspend/VB/suspend it/NNP/it. the/DT/the freed/NN/freed frames/VBZ/frames are/VBP/are then/RB/then distributed/VBN/distributed to/TO/to processes/NNS/processes with/IN/with high/JJ/high page-fault/JJ/page-fault rates/NNP/rates. consider/NN/consider a/DT/a sequential/JJ/sequential read/NN/read of/IN/of a/DT/a file/NN/file on/IN/on disk/NN/disk using/VBG/using the/DT/the standard/JJ/standard system/NN/system calls/VBZ/calls open/JJ/open /NN/( /:/) ,read/JJ/,read /NN/( /:/) /,/, and/CC/and write/VB/write /:/( /:/) /./. each/DT/each file/NN/file access/NN/access requires/VBZ/requires a/DT/a system/NN/system call/NN/call and/CC/and disk/NN/disk access/NNP/access. alternatively/RB/alternatively /,/, we/PRP/we can/MD/can use/VB/use the/DT/the virtual/JJ/virtual memory/NN/memory techniques/NNS/techniques discussed/VBD/discussed so/RB/so far/RB/far to/TO/to treat/VB/treat file/JJ/file i/0/-NONE-/i/0 as/IN/as routine/JJ/routine memory/NN/memory accesses/NNP/accesses. this/DT/this approach/NN/approach /,/, known/VBN/known as/IN/as a/DT/a file/NN/file /,/, allows/VBZ/allows a/DT/a part/NN/part of/IN/of the/DT/the virtual/JJ/virtual address/NN/address space/NN/space to/TO/to be/VB/be logically/RB/logically associated/VBN/associated with/IN/with the/DT/the file/NNP/file. as/IN/as we/PRP/we shall/MD/shall see/VB/see /,/, this/DT/this can/MD/can lead/VB/lead to/TO/to significant/JJ/significant performance/NN/performance increases/NNS/increases when/WRB/when performing/VBG/performing i/0/NNP/i/0. 9.7/CD/9.7 391/CD/391 working/NN/working sets/NNS/sets and/CC/and page/NN/page faultrates/NNS/faultrates there/EX/there is/VBZ/is a/DT/a directrelationship/NN/directrelationship between/IN/between the/DT/the working/VBG/working set/NN/set of/IN/of a/DT/a process/NN/process and/CC/and its/PRP$/its page-fault/JJ/page-fault rate/NNP/rate. typically/RB/typically as/IN/as shown/JJ/shown in/IN/in figure/NN/figure 9.20/CD/9.20 /,/, the/DT/the working/VBG/working set/NN/set ofa/NN/ofa process/NN/process changes/NNS/changes pver/RB/pver time/NN/time as/IN/as references/NNS/references to/NNP/to. data/NNS/data and/CC/and code/NN/code sections/NNS/sections move/VB/move from/IN/from one/CD/one locality/NN/locality to/TO/to another/NNP/another. assuming/NN/assuming there/RB/there is/VBZ/is sufficient/JJ/sufficient memory/NN/memory to/TO/to store/VB/store the/DT/the working/VBG/working set/NN/set of/IN/of .a/NNP/.a process/NN/process /:/( that/IN/that is/VBZ/is /,/, the/DT/the processis/NN/processis 11.ot/CD/11.ot thrashing/VBG/thrashing /CD/) /,/, tbe/NN/tbe page-fault/NN/page-fault rate/NN/rate of/IN/of the/DT/the process/NN/process will/MD/will transition/VB/transition between/IN/between peaks/NNS/peaks and/CC/and valleys/NNS/valleys over/IN/over time/NNP/time. this/DT/this general/JJ/general behavior/NN/behavior is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 9.22/CD/9.22. page/NN/page fault/NN/fault rate/NN/rate working/VBG/working set/NN/set time/NN/time figure/NN/figure 9.22/CD/9.22 page/NN/page fault/NN/fault rate/NN/rate over/IN/over time/NNP/time. a/DT/a peak/NN/peak in/IN/in the/DT/the page-fault/JJ/page-fault rate/NN/rate occurs/NNS/occurs when/WRB/when we/PRP/we begin/VBP/begin demand-paging/JJ/demand-paging a/DT/a new/JJ/new locality/NNP/locality. however/RB/however /,/, once/RB/once the/DT/the working/VBG/working set/NN/set of/IN/of this/DT/this new/JJ/new locality/NN/locality is/VBZ/is in/IN/in memory/NN/memory /,/, the/DT/the page-fault/JJ/page-fault rate/NN/rate falls/NNP/falls. when/WRB/when the/DT/the process/NN/process moves/VBZ/moves to/TO/to a/DT/a new/JJ/new working/NN/working set/NN/set /,/, the/DT/the page/NNP/page.. /:/: fault/NN/fault rate/NN/rate rises/NNS/rises toward/IN/toward a/DT/a peak/NN/peak once/RB/once again/RB/again /,/, returning/VBG/returning to/TO/to a/DT/a lower/JJR/lower rate/NN/rate once/RB/once the/DT/the new/JJ/new working/NN/working set/NN/set is/VBZ/is loaded/VBN/loaded into/IN/into memory/NNP/memory. the/DT/the span/NN/span oftime/NN/oftime between/IN/between the/DT/the start/NN/start of/IN/of one/CD/one peak/NN/peak and/CC/and the/DT/the start/NN/start of/IN/of thenext/JJ/thenext peak/NN/peak represents/NNS/represents the/DT/the transition/NN/transition from/IN/from one/CD/one working/VBG/working set/NN/set to/TO/to another/NNP/another. 9.7.1/CD/9.7.1 basic/JJ/basic mechanism/NN/mechanism memory/NN/memory mapping/VBG/mapping a/DT/a file/NN/file is/VBZ/is accomplished/VBN/accomplished by/IN/by mapping/NN/mapping a/DT/a disk/NN/disk block/NN/block to/TO/to a/DT/a page/NN/page /:/( or/CC/or pages/NNS/pages /:/) in/IN/in memory/NNP/memory. initial/JJ/initial access/NN/access to/TO/to the/DT/the file/NN/file proceeds/VBZ/proceeds through/IN/through ordinary/JJ/ordinary demand/NN/demand paging/VBG/paging /,/, resulting/VBG/resulting in/IN/in a/DT/a page/NN/page fault/NNP/fault. however/RB/however /,/, a/DT/a page-sized/JJ/page-sized portion/NN/portion of/IN/of the/DT/the file/NN/file is/VBZ/is read/VBN/read from/IN/from the/DT/the file/NN/file system/NN/system into/IN/into a/DT/a physical/JJ/physical page/NN/page /:/( some/DT/some systems/NNS/systems may/MD/may opt/VB/opt to/TO/to read/VB/read in/IN/in more/JJR/more than/IN/than a/DT/a page-sized/JJ/page-sized chunk/NN/chunk of/IN/of memory/NN/memory at/IN/at a/DT/a time/NN/time /:/) /./. subsequent/NN/subsequent reads/NNS/reads and/CC/and writes/NNS/writes to/TO/to the/DT/the file/NN/file are/VBP/are handled/VBN/handled as/IN/as routine/JJ/routine memory/NN/memory accesses/NNS/accesses /,/, thereby/RB/thereby simplifying/VBG/simplifying file/NN/file access/NN/access and/CC/and usage/NN/usage by/IN/by allowing/NN/allowing the/DT/the system/NN/system to/TO/to manipulate/VB/manipulate files/NNS/files through/IN/through memory/NN/memory rather/RB/rather than/IN/than incurring/VBG/incurring the/DT/the overhead/JJ/overhead of/IN/of using/VBG/using the/DT/the read/NN/read /:/( /:/) and/CC/and write/JJ/write /NN/( /:/) system/NN/system calls/NNP/calls. similarly/RB/similarly /,/, as/IN/as file/JJ/file l/0/-NONE-/l/0 is/VBZ/is done/VBN/done in/IN/in memory/NNP/memory- as/IN/as opposed/VBN/opposed to/TO/to using/VBG/using system/NN/system calls/NNS/calls that/WDT/that involve/VB/involve disk/NN/disk i/0/-NONE-/i/0 /:/- file/JJ/file access/NN/access is/VBZ/is much/JJ/much faster/NN/faster as/IN/as well/NNP/well. note/NN/note that/IN/that writes/NNS/writes to/TO/to the/DT/the file/NN/file mapped/VBD/mapped in/IN/in memory/NN/memory are/VBP/are not/RB/not necessarily/RB/necessarily imm.ediate/JJ/imm.ediate /NN/( synchronous/JJ/synchronous /NN/) writes/NNS/writes to/TO/to the/DT/the file/NN/file on/IN/on disk/NNP/disk. some/DT/some systems/NNS/systems may/MD/may choose/VB/choose to/TO/to update/VB/update the/DT/the physical/JJ/physical file/NN/file when/WRB/when the/DT/the operating/NN/operating system/NN/system periodically/RB/periodically checks/VBZ/checks 392/CD/392 chapter/NN/chapter 9/CD/9 whether/IN/whether the/DT/the page/NN/page in/IN/in memory/NN/memory has/VBZ/has been/VBN/been modified/NNP/modified. when/WRB/when the/DT/the file/NN/file is/VBZ/is closed/VBN/closed /,/, all/DT/all the/DT/the memory-mapped/JJ/memory-mapped data/NNS/data are/VBP/are written/VBN/written back/RB/back to/TO/to disk/VB/disk and/CC/and ren/VB/ren loved/VBN/loved from/IN/from the/DT/the virtual/JJ/virtual memory/NN/memory of/IN/of the/DT/the process/NNP/process. some/DT/some operating/NN/operating systems/NNS/systems provide/VB/provide memory/NN/memory mapping/VBG/mapping only/RB/only through/IN/through a/DT/a specific/JJ/specific system/NN/system call/NN/call and/CC/and use/VBP/use the/DT/the standard/JJ/standard system/NN/system calls/VBZ/calls to/TO/to perform/NN/perform all/DT/all other/JJ/other file/NN/file i/0/NNP/i/0. however/RB/however /,/, some/DT/some systems/NNS/systems choose/VBP/choose to/TO/to memory-map/NNP/memory-map a/DT/a file/NN/file regardless/NN/regardless of/IN/of whether/IN/whether the/DT/the file/NN/file was/VBD/was specified/VBN/specified as/IN/as memory-mapped/NNP/memory-mapped. let/NN/let 's/POS/'s take/NN/take solaris/NN/solaris as/IN/as an/DT/an example/NNP/example. if/IN/if a/DT/a file/NN/file is/VBZ/is specified/VBN/specified as/RB/as memory-mapped/JJ/memory-mapped /NN/( using/VBG/using the/DT/the mmap/NN/mmap /:/( /:/) system/NN/system call/NN/call /:/) /,/, solaris/VBZ/solaris maps/RB/maps the/DT/the file/NN/file into/IN/into the/DT/the address/NN/address space/NN/space of/IN/of the/DT/the process/NNP/process. if/IN/if a/DT/a file/NN/file is/VBZ/is opened/VBN/opened and/CC/and accessed/VBN/accessed using/VBG/using ordinary/JJ/ordinary system/NN/system calls/VBZ/calls /,/, such/JJ/such as/IN/as open/JJ/open /NN/( /:/) /,/, read/VBD/read /:/( /CD/) /,/, and/CC/and write/VB/write /:/( /:/) /,/, solaris/VBZ/solaris still/RB/still memory-maps/RB/memory-maps the/DT/the file/NN/file ;/:/; however/RB/however /,/, the/DT/the file/NN/file is/VBZ/is mapped/VBN/mapped to/TO/to the/DT/the kernel/NN/kernel address/NN/address space/NNP/space. regardless/NN/regardless of/IN/of how/WRB/how the/DT/the file/NN/file is/VBZ/is opened/VBN/opened /,/, then/RB/then /,/, solaris/NNS/solaris treats/NNS/treats all/DT/all file/NN/file i/0/-NONE-/i/0 as/IN/as memory-mapped/JJ/memory-mapped /,/, allowing/VBG/allowing file/NN/file access/NN/access to/TO/to take/VB/take place/NN/place via/IN/via the/DT/the efficient/NN/efficient memory/NN/memory subsystem/NNP/subsystem. multiple/NN/multiple processes/NNS/processes may/MD/may be/VB/be allowed/VBN/allowed to/TO/to map/VB/map the/DT/the same/JJ/same file/NN/file concurrently/RB/concurrently /,/, to/TO/to allow/VB/allow sharing/NN/sharing of/IN/of data/NNP/data. writes/VBZ/writes by/IN/by any/DT/any of/IN/of the/DT/the processes/NNS/processes modify/VBP/modify the/DT/the data/NNS/data in/IN/in virtual/JJ/virtual memory/NN/memory and/CC/and can/MD/can be/VB/be seen/VBN/seen by/IN/by all/DT/all others/NNS/others that/WDT/that map/NN/map the/DT/the same/JJ/same section/NN/section of/IN/of the/DT/the file/NNP/file. given/NN/given our/PRP$/our earlier/JJR/earlier discussions/NNS/discussions of/IN/of virtual/JJ/virtual memory/NN/memory /,/, it/PRP/it should/MD/should be/VB/be clear/JJ/clear how/WRB/how the/DT/the sharing/NN/sharing of/IN/of memory-mapped/JJ/memory-mapped sections/NNS/sections of/IN/of memory/NN/memory is/VBZ/is implemented/VBN/implemented /:/: the/DT/the virtual/JJ/virtual memory/NN/memory map/NN/map of/IN/of each/DT/each sharing/VBG/sharing process/NN/process points/NNS/points to/TO/to the/DT/the same/JJ/same page/NN/page of/IN/of physical/JJ/physical memory-the/JJ/memory-the page/NN/page that/WDT/that holds/VBZ/holds a/DT/a copy/NN/copy of/IN/of the/DT/the disk/NN/disk block/NN/block this/DT/this memory/NN/memory sharing/VBG/sharing is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 9.23/CD/9.23. the/DT/the memory-mapping/JJ/memory-mapping system/NN/system calls/VBZ/calls can/MD/can also/RB/also support/VB/support copy-on-write/JJ/copy-on-write functionality/NN/functionality /,/, allowing/VBG/allowing processes/NNS/processes to/TO/to share/VB/share a/DT/a file/NN/file in/IN/in read-only/JJ/read-only mode/NN/mode but/CC/but to/TO/to have/VB/have their/PRP$/their own/JJ/own copies/NNS/copies of/IN/of any/DT/any data/NN/data they/PRP/they modify/NNP/modify. so/RB/so that/IN/that r/JJ/r--- i/NN/i i/PRP/i i/PRP/i 1/CD/1 /:/- r/NN/r /:/- /:/- ;/:/; i/PRP/i i/PRP/i 1/CD/1- 1/CD/1 i/PRP/i -1/-NONE-/-1- ii/VBP/ii i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i j---r/VBP/j---r '/''/' -rl..-r/JJ/-rl..-r i/PRP/i i/PRP/i i/PRP/i i/PRP/i -r/VBP/-r- '/''/' i/PRP/i i/PRP/i i/PRP/i i/PRP/i 1/CD/1 -1/-NONE-/-1 i/PRP/i i/PRP/i 1/CD/1- _/NNP/_,.. i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i f/VBP/f- +/:/+ /:/- =/:/= /:/-. /:/: .....c.c/JJ/.....c.c ~/NN/~ ..-'---r/NN/..-'---r ~/:/~ /:/- /,/, i/PRP/i i/PRP/i /:/- .l/JJ/.l- i/PRP/i j/VBP/j i/PRP/i i/PRP/i i/PRP/i 1/CD/1 i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i i/PRP/i l_/NNP/l_ ~/:/~ i/PRP/i process/VBP/process a/DT/a 1/CD/1 1/CD/1 1/CD/1 virtual/JJ/virtual memory/NN/memory /:/: ~/:/~ 1/CD/1 /:/- disk/NN/disk file/NN/file figure/NN/figure 9.23/CD/9.23 memory-mapped/JJ/memory-mapped files/NNP/files. process/NN/process b/NN/b virtual/JJ/virtual memory/NN/memory 9.7/CD/9.7 memory-mapped/JJ/memory-mapped file/NN/file figure/NN/figure 9.24/CD/9.24 shared/VBN/shared memory/NN/memory in/IN/in windows/NNS/windows using/VBG/using memory-mapped/JJ/memory-mapped 1/0/CD/1/0. 393/CD/393 access/NN/access to/TO/to the/DT/the shared/VBN/shared data/NNS/data is/VBZ/is coordinated/VBN/coordinated /,/, the/DT/the processes/NNS/processes involved/VBD/involved might/MD/might use/VB/use one/CD/one of/IN/of the/DT/the mechanisms/NNS/mechanisms for/IN/for achieving/VBG/achieving mutual/JJ/mutual exclusion/NN/exclusion described/VBD/described in/IN/in chapter/NN/chapter 6/CD/6. in/IN/in many/JJ/many ways/NNS/ways /,/, the/DT/the sharing/NN/sharing of/IN/of memory-mapped/JJ/memory-mapped files/NNS/files is/VBZ/is similar/JJ/similar to/TO/to shared/VBN/shared memory/NN/memory as/IN/as described/VBN/described in/IN/in section/NN/section 3.4.1/CD/3.4.1. not/RB/not all/DT/all systems/NNS/systems use/VBP/use the/DT/the same/JJ/same mechanism/NN/mechanism for/IN/for both/DT/both ;/:/; on/IN/on unix/NN/unix and/CC/and linux/NN/linux systems/NNS/systems /,/, for/IN/for example/NN/example /,/, memory/NN/memory mapping/VBG/mapping is/VBZ/is accomplished/VBN/accomplished with/IN/with the/DT/the mmap/NN/mmap /:/( /:/) system/NN/system call/NN/call /,/, whereas/VBZ/whereas shared/VBN/shared memory/NN/memory is/VBZ/is achieved/VBN/achieved with/IN/with the/DT/the posix-compliant/JJ/posix-compliant shmget/NN/shmget /:/( /:/) and/CC/and shmat/NN/shmat /:/( /:/) systems/NNS/systems calls/VBZ/calls /:/( section/NN/section 3.5.1/CD/3.5.1 /CD/) /./. on/IN/on windows/NNS/windows nt/VBP/nt /,/, 2000/CD/2000 /,/, and/CC/and xp/VB/xp systems/NNS/systems /,/, howeve1/NNP/howeve1 ~/NNP/~ shared/VBD/shared memory/NN/memory is/VBZ/is accomplished/VBN/accomplished by/IN/by memory/NN/memory mapping/VBG/mapping files/NNP/files. on/IN/on these/DT/these systems/NNS/systems /,/, processes/NNS/processes can/MD/can communicate/VB/communicate using/VBG/using shared/VBN/shared memory/NN/memory by/IN/by having/NN/having the/DT/the communicating/NN/communicating processes/NNS/processes memory-map/-NONE-/memory-map the/DT/the same/JJ/same file/NN/file into/IN/into their/PRP$/their virtual/JJ/virtual address/NN/address spaces/NNP/spaces. the/DT/the memorymapped/JJ/memorymapped file/NN/file serves/NNS/serves as/IN/as the/DT/the region/NN/region of/IN/of shared/VBN/shared memory/NN/memory between/IN/between the/DT/the communicating/NN/communicating processes/NNS/processes /:/( figure/NN/figure 9.24/CD/9.24 /CD/) /./. in/IN/in the/DT/the following/JJ/following section/NN/section /,/, we/PRP/we illustrate/VBP/illustrate support/NN/support in/IN/in the/DT/the win32/NNP/win32 api/NN/api for/IN/for shared/VBN/shared memory/NN/memory using/VBG/using memory-mapped/JJ/memory-mapped files/NNP/files. 9.7.2/CD/9.7.2 shared/VBD/shared memory/NN/memory in/IN/in the/DT/the win32/NNP/win32 api/NN/api the/DT/the general/JJ/general outline/NN/outline for/IN/for creating/NN/creating a/DT/a region/NN/region of/IN/of shared/VBN/shared memory/NN/memory using/VBG/using memorymapped/VBN/memorymapped files/NNS/files in/IN/in the/DT/the win32/NNP/win32 api/NN/api involves/VBZ/involves first/JJ/first creating/NN/creating a/DT/a file/NN/file mapping/VBG/mapping for/IN/for the/DT/the file/NN/file to/TO/to be/VB/be mapped/VBN/mapped and/CC/and then/RB/then establishing/VBG/establishing a/DT/a view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file in/IN/in a/DT/a process/NN/process 's/POS/'s virtual/JJ/virtual address/NN/address space/NNP/space. a/DT/a second/JJ/second process/NN/process can/MD/can then/RB/then open/VB/open and/CC/and create/VB/create a/DT/a view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file in/IN/in its/PRP$/its virtual/JJ/virtual address/NN/address space/NNP/space. the/DT/the mapped/JJ/mapped file/NN/file represents/NNS/represents the/DT/the shared-menwry/JJ/shared-menwry object/NN/object that/WDT/that will/MD/will enable/VB/enable communication/NN/communication to/TO/to take/VB/take place/NN/place between/IN/between the/DT/the processes/NNP/processes. we/PRP/we next/JJ/next illustrate/NN/illustrate these/DT/these steps/NNS/steps in/IN/in more/JJR/more detail/NNP/detail. in/IN/in this/DT/this example/NN/example /,/, a/DT/a producer/NN/producer process/NN/process first/RB/first creates/VBZ/creates a/DT/a shared-memory/JJ/shared-memory object/NN/object using/VBG/using the/DT/the memory-mapping/JJ/memory-mapping features/NNS/features available/JJ/available in/IN/in the/DT/the win32/NNP/win32 api/NNP/api. the/DT/the producer/NN/producer then/RB/then writes/VBZ/writes a/DT/a message/NN/message to/TO/to shared/VBN/shared m.emory/NNP/m.emory. after/IN/after that/DT/that /,/, a/DT/a consumer/NN/consumer process/NN/process opens/VBZ/opens a/DT/a mapping/NN/mapping to/TO/to the/DT/the shared-memory/JJ/shared-memory object/NN/object and/CC/and reads/NNS/reads the/DT/the message/NN/message written/VBN/written by/IN/by the/DT/the consum.er/NNP/consum.er. to/TO/to establish/VB/establish a/DT/a memory-mapped/JJ/memory-mapped file/NN/file /,/, a/DT/a process/NN/process first/RB/first opens/VBZ/opens the/DT/the file/NN/file to/TO/to be/VB/be mapped/VBN/mapped with/IN/with the/DT/the createfile/JJ/createfile /NN/( /:/) function/NN/function /,/, which/WDT/which returns/NNS/returns a/DT/a handle/NN/handle to/TO/to the/DT/the opened/VBN/opened file/NNP/file. the/DT/the process/NN/process then/RB/then creates/VBZ/creates a/DT/a mapping/NN/mapping of/IN/of this/DT/this file/NN/file handle/NN/handle using/VBG/using the/DT/the createfilemapping/VBG/createfilemapping /NN/( /:/) function/NNP/function. once/RB/once the/DT/the file/NN/file mapping/VBG/mapping is/VBZ/is established/VBN/established /,/, the/DT/the process/NN/process then/RB/then establishes/VBZ/establishes a/DT/a view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file in/IN/in its/PRP$/its virtual/JJ/virtual address/NN/address space/NN/space with/IN/with the/DT/the mapviewdffile/JJ/mapviewdffile /NN/( /:/) function/NNP/function. the/DT/the view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file represents/NNS/represents the/DT/the portion/NN/portion of/IN/of the/DT/the file/NN/file being/VBG/being mapped/VBN/mapped in/IN/in the/DT/the virtual/JJ/virtual address/NN/address space/NN/space of/IN/of the/DT/the process/NN/process 394/CD/394 chapter/NN/chapter 9/CD/9 #/#/# include/NN/include windows.h/NN/windows.h #/#/# include/NN/include stdio.h/NN/stdio.h int/NN/int main/NN/main /:/( int/NN/int argc/NN/argc /,/, char/NN/char argv/NN/argv /:/[ /:/] /:/) /:/{ /:/} handle/NN/handle hfile/NN/hfile /,/, hmapfile/JJ/hmapfile ;/:/; lpvoid/JJ/lpvoid lpmapaddress/NN/lpmapaddress ;/:/; hfile/NN/hfile =/:/= createfile/NN/createfile /:/( temp.txt/JJ/temp.txt /,/, //file/JJ///file name/NN/name genericjread/NN/genericjread i/PRP/i generic_write/NNP/generic_write /,/, ///NNP/// read/write/NNP/read/write access/NN/access 0/-NONE-/0 /,/, ii/NN/ii no/DT/no sharing/NN/sharing of/IN/of the/DT/the file/NN/file null/NN/null /,/, //default/JJ///default security/NN/security open_always/NNS/open_always /,/, //open/JJ///open new/JJ/new or/CC/or existing/VBG/existing file/JJ/file file_attribute_normal/NNP/file_attribute_normal /,/, //routine/JJ///routine file/NN/file attributes/NNS/attributes null/VBP/null /:/) ;/:/; //no/-NONE-///no file/RB/file template/JJ/template hmapfile/NN/hmapfile =/:/= createfilemapping/VBG/createfilemapping /:/( hfile/JJ/hfile /,/, //file/JJ///file handle/NN/handle null/NN/null /,/, //default/JJ///default security/NN/security pagejreadwrite/NN/pagejreadwrite /,/, //read/write/JJ///read/write access/NN/access to/TO/to mapped/VBD/mapped pages/NNS/pages 0/-NONE-/0 /,/, ii/NN/ii map/NN/map entire/NN/entire file/NN/file 0/-NONE-/0 /,/, text/NN/text /:/( sharedobject/NN/sharedobject /:/) /:/) ;/:/; //named/JJ///named shared/VBN/shared memory/NN/memory object/NN/object lpmapaddress/NN/lpmapaddress =/:/= mapviewdffile/NN/mapviewdffile /:/( hmapfile/NN/hmapfile /,/, //mapped/JJ///mapped object/NN/object handle/NN/handle filejmap_all_access/NN/filejmap_all_access /,/, //read/write/JJ///read/write access/NN/access 0/-NONE-/0 /,/, ii/NN/ii mapped/VBD/mapped view/NN/view of/IN/of entire/JJ/entire file/NN/file 0/-NONE-/0 /,/, 0/-NONE-/0 /:/) ;/:/; ii/NN/ii write/NN/write to/TO/to shared/VBN/shared memory/NN/memory sprintf/NN/sprintf /:/( lpmapaddress/NN/lpmapaddress /,/, shared/VBD/shared memory/NN/memory message/NN/message /:/) ;/:/; unmapviewoffile/NN/unmapviewoffile /:/( lpmapaddress/NN/lpmapaddress /:/) ;/:/; closehandle/NN/closehandle /:/( hfile/NN/hfile /:/) ;/:/; closehandle/NN/closehandle /:/( hmapfile/NN/hmapfile /:/) ;/:/; figure/NN/figure 9.25/CD/9.25 producer/NN/producer writing/VBG/writing to/TO/to shared/VBN/shared memory/NN/memory using/VBG/using the/DT/the win32/NNP/win32 api/NNP/api. -the/NNP/-the entire/NN/entire file/NN/file or/CC/or only/RB/only a/DT/a portion/NN/portion of/IN/of it/PRP/it may/MD/may be/VB/be mapped/NNP/mapped. we/PRP/we illustrate/VBP/illustrate this/DT/this sequence/NN/sequence in/IN/in the/DT/the program/NN/program shown/NN/shown in/IN/in figure/NN/figure 9/CD/9 .25/NNP/.25. /NNP/( we/PRP/we eliminate/VBP/eliminate much/RB/much of/IN/of the/DT/the error/NN/error checking/VBG/checking for/IN/for code/NN/code brevity/NNP/brevity. /NNP/) the/DT/the call/NN/call to/TO/to createfilemapping/NN/createfilemapping /:/( /:/) creates/NNS/creates a/DT/a named/VBN/named shared-memory/JJ/shared-memory object/NN/object called/VBN/called sharedobj/NN/sharedobj ect/NNP/ect. the/DT/the consumer/NN/consumer process/NN/process will/MD/will communicate/VB/communicate using/VBG/using this/DT/this shared-memory/JJ/shared-memory segment/NN/segment by/IN/by creating/NN/creating a/DT/a mapping/NN/mapping to/TO/to the/DT/the same/JJ/same named/VBN/named object/NNP/object. the/DT/the producer/NN/producer then/RB/then creates/VBZ/creates a/DT/a view/NN/view of/IN/of the/DT/the memory-mapped/JJ/memory-mapped file/NN/file in/IN/in its/PRP$/its virtual/JJ/virtual address/NN/address space/NNP/space. by/IN/by passing/VBG/passing the/DT/the last/JJ/last three/CD/three parameters/NNS/parameters the/DT/the value/NN/value 0/-NONE-/0 /,/, it/PRP/it indicates/VBZ/indicates that/IN/that the/DT/the mapped/JJ/mapped view/NN/view is/VBZ/is the/DT/the entire/JJ/entire file/NNP/file. it/PRP/it could/MD/could instead/VB/instead have/VB/have passed/VBN/passed values/NNS/values specifying/VBG/specifying an/DT/an offset/NN/offset and/CC/and size/NN/size /,/, thus/RB/thus creating/VBG/creating a/DT/a view/NN/view containing/VBG/containing only/RB/only a/DT/a subsection/NN/subsection of/IN/of the/DT/the file/NNP/file. /NNP/( it/PRP/it is/VBZ/is important/JJ/important to/TO/to note/VB/note that/IN/that the/DT/the entire/JJ/entire mapping/NN/mapping may/MD/may not/RB/not be/VB/be loaded/VBN/loaded #/#/# include/NN/include windows.h/NN/windows.h #/#/# include/NN/include stdio.h/NN/stdio.h int/NN/int main/NN/main /:/( int/NN/int argc/NN/argc /,/, char/NN/char argv/NN/argv /:/[ /:/] /:/) /:/{ handle/NN/handle hmapfile/NN/hmapfile ;/:/; lpvoid/JJ/lpvoid lpmapaddress/NN/lpmapaddress ;/:/; 9.7/CD/9.7 395/CD/395 hmapfile/JJ/hmapfile =/NN/= openfilemapping/VBG/openfilemapping /NN/( file_map_all_access/NN/file_map_all_access /,/, ///:/// r/w/JJ/r/w access/NN/access false/NN/false /,/, //no/NNP///no inheritance/NN/inheritance /:/} text/NN/text /:/( sharedobject/NN/sharedobject /:/) /:/) ;/:/; //name/JJ///name of/IN/of mapped/JJ/mapped file/NN/file object/NN/object lpmapaddress/NN/lpmapaddress =/:/= mapviewoffile/NN/mapviewoffile /:/( hmapfile/NN/hmapfile /,/, //mapped/JJ///mapped object/NN/object handle/NN/handle filejmap_all_access/NN/filejmap_all_access /,/, //read/write/JJ///read/write access/NN/access 0/-NONE-/0 /,/, ii/NN/ii mapped/VBD/mapped view/NN/view of/IN/of entire/JJ/entire file/NN/file 0/-NONE-/0 /,/, 0/-NONE-/0 /:/) ;/:/; ii/NN/ii read/NN/read from/IN/from shared/VBN/shared memory/NN/memory printf/NN/printf /:/( read/NN/read message/NN/message %/NN/% s/VBZ/s /,/, lpmapaddress/NN/lpmapaddress /:/) ;/:/; unmapviewoffile/NN/unmapviewoffile /:/( lpmapaddress/NN/lpmapaddress /:/) ;/:/; closehandle/NN/closehandle /:/( hmapfile/NN/hmapfile /:/) ;/:/; figure/NN/figure 9.26/CD/9.26 consumer/NN/consumer reading/NN/reading from/IN/from shared/VBN/shared memory/NN/memory using/VBG/using the/DT/the win32/NNP/win32 api/NNP/api. into/IN/into memory/NN/memory when/WRB/when the/DT/the mapping/NN/mapping is/VBZ/is established/NNP/established. rather/RB/rather /,/, the/DT/the mapped/JJ/mapped file/NN/file may/MD/may be/VB/be demand-paged/JJ/demand-paged /,/, thus/RB/thus bringing/VBG/bringing pages/NNS/pages into/IN/into memory/NN/memory only/RB/only as/IN/as they/PRP/they are/VBP/are accessed/NNP/accessed. /NNP/) the/DT/the mapviewoffile/NN/mapviewoffile /:/( /:/) fm1ction/NN/fm1ction returns/NNS/returns a/DT/a pointer/NN/pointer to/TO/to the/DT/the shared-memory/JJ/shared-memory object/NN/object ;/:/; any/DT/any accesses/NNS/accesses to/TO/to this/DT/this memory/NN/memory location/NN/location are/VBP/are thus/RB/thus accesses/NNS/accesses to/TO/to the/DT/the memory-mapped/JJ/memory-mapped file/NNP/file. in/IN/in this/DT/this ii1stance/NN/ii1stance /,/, the/DT/the producer/NN/producer process/NN/process writes/VBZ/writes the/DT/the message/NN/message shared/VBD/shared memory/NN/memory message/NN/message to/TO/to shared/VBN/shared memory/NNP/memory. a/DT/a program/NN/program illustrating/NN/illustrating how/WRB/how the/DT/the consumer/NN/consumer process/NN/process establishes/NNS/establishes a/DT/a view/NN/view of/IN/of the/DT/the named/VBN/named shared-memory/JJ/shared-memory object/NN/object is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 9.26/CD/9.26. this/DT/this program/NN/program is/VBZ/is somewhat/RB/somewhat simpler/JJR/simpler than/IN/than the/DT/the one/CD/one shown/NN/shown in/IN/in figure/NN/figure 9.25/CD/9.25 /,/, as/IN/as all/DT/all that/DT/that is/VBZ/is necessary/JJ/necessary is/VBZ/is for/IN/for the/DT/the process/NN/process to/TO/to create/VB/create a/DT/a mapping/NN/mapping to/TO/to the/DT/the existii1g/NNP/existii1g named/VBD/named shared-memory/JJ/shared-memory object/NNP/object. the/DT/the consumer/NN/consumer process/NN/process must/MD/must also/RB/also create/VB/create a/DT/a view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file /,/, just/RB/just as/IN/as the/DT/the producer/NN/producer process/NN/process did/VBD/did ii1/NNP/ii1 the/DT/the program/NN/program in/IN/in figure/NN/figure 9.25/CD/9.25. the/DT/the consumer/NN/consumer then/RB/then reads/VBZ/reads from/IN/from shared/VBN/shared memory/NN/memory the/DT/the message/NN/message shared/VBD/shared memory/NN/memory message/NN/message thatwas/VBD/thatwas written/VBN/written by/IN/by the/DT/the producer/NN/producer process/NNP/process. finally/RB/finally /,/, both/DT/both processes/NNS/processes remove/VBP/remove the/DT/the view/NN/view of/IN/of the/DT/the mapped/VBN/mapped file/NN/file with/IN/with a/DT/a call/NN/call to/TO/to unmapviewoffile/VB/unmapviewoffile /:/( /:/) /./. we/PRP/we provide/VBP/provide a/DT/a programming/NN/programming exercise/NN/exercise at/IN/at the/DT/the end/NN/end of/IN/of this/DT/this chapter/NN/chapter using/VBG/using shared/VBN/shared memory/NN/memory with/IN/with memory/NN/memory mapping/VBG/mapping in/IN/in the/DT/the win32/NNP/win32 api/NNP/api. 9.7.3/CD/9.7.3 memory-mapped/JJ/memory-mapped i/0/-NONE-/i/0 in/IN/in the/DT/the case/NN/case of/IN/of i/0/-NONE-/i/0 /,/, as/IN/as mentioned/VBN/mentioned in/IN/in section/NN/section 1.2.1/CD/1.2.1 /,/, each/DT/each i/0/-NONE-/i/0 controller/NN/controller includes/VBZ/includes registers/NNS/registers to/TO/to hold/VB/hold commands/NNS/commands and/CC/and the/DT/the data/NNS/data being/VBG/being transferred/NNP/transferred. usually/RB/usually /,/, special/JJ/special i/0/-NONE-/i/0 instructions/NNS/instructions allow/VBP/allow data/NNS/data transfers/NNS/transfers between/IN/between these/DT/these registers/NNS/registers and/CC/and system/NN/system memory/NNP/memory. 396/CD/396 chapter/NN/chapter 9/CD/9 9.8/CD/9.8 to/TO/to allow/VB/allow more/JJR/more convenient/JJ/convenient access/NN/access to/TO/to i/0/-NONE-/i/0 devices1/NNP/devices1 many/JJ/many computer/NN/computer architectures/NNS/architectures provide/VB/provide in/IN/in this/DT/this case//NN/case/ ranges/VBZ/ranges of/IN/of memory/NN/memory addresses/NNS/addresses are/VBP/are set/VBN/set aside/JJ/aside and/CC/and are/VBP/are mapped/VBN/mapped to/TO/to the/DT/the device/NN/device registers/NNP/registers. reads/NNS/reads and/CC/and writes/NNS/writes to/TO/to these/DT/these memory/NN/memory addresses/NNS/addresses cause/VBP/cause the/DT/the data/NNS/data to/TO/to be/VB/be transferred/VBN/transferred to/TO/to and/CC/and from/IN/from the/DT/the device/NN/device registers/NNP/registers. this/DT/this method/NN/method is/VBZ/is appropriate/JJ/appropriate for/IN/for devices/NNS/devices that/WDT/that have/VBP/have fast/RB/fast response/NN/response times//-NONE-/times/ such/JJ/such as/IN/as video/NN/video controllers/NNP/controllers. in/IN/in the/DT/the ibm/NN/ibm pc/NN/pc each/DT/each location/NN/location on/IN/on the/DT/the screen/NN/screen is/VBZ/is mapped/VBN/mapped to/TO/to a/DT/a n1.emory/JJ/n1.emory location/NNP/location. displaying/NN/displaying text/NN/text on/IN/on the/DT/the screen/NN/screen is/VBZ/is almost/RB/almost as/IN/as easy/JJ/easy as/IN/as writing/NN/writing the/DT/the text/NN/text into/IN/into the/DT/the appropriate/JJ/appropriate memory-mapped/JJ/memory-mapped locations/NNP/locations. memory-mapped/JJ/memory-mapped i/o/NN/i/o is/VBZ/is also/RB/also convenient/JJ/convenient for/IN/for other/JJ/other devices//NN/devices/ such/JJ/such as/IN/as the/DT/the serial/JJ/serial and/CC/and parallel/JJ/parallel ports/NNS/ports used/VBN/used to/TO/to connect/VB/connect modems/NNS/modems and/CC/and printers/NNS/printers to/TO/to a/DT/a computer/NNP/computer. the/DT/the cpu/NN/cpu transfers/NNS/transfers data/NNS/data through/IN/through these/DT/these kinds/NNS/kinds of/IN/of devices/NNS/devices by/IN/by reading/NN/reading and/CC/and writing/VBG/writing a/DT/a few/JJ/few device/NN/device registers//NN/registers/ called/VBN/called an/DT/an i/0/-NONE-/i/0 to/TO/to send/VB/send out/RP/out a/DT/a long/JJ/long string/NN/string of/IN/of bytes/NNS/bytes through/IN/through a/DT/a memory-mapped/JJ/memory-mapped serial/NN/serial port1/NNP/port1 the/DT/the cpu/NN/cpu writes/VBZ/writes one/CD/one data/NNS/data byte/VBP/byte to/TO/to the/DT/the data/NNS/data register/NN/register and/CC/and sets/NNS/sets a/DT/a bit/NN/bit in/IN/in the/DT/the control/NN/control register/NN/register to/TO/to signal/VB/signal that/IN/that the/DT/the byte/NN/byte is/VBZ/is available/NNP/available. the/DT/the device/NN/device takes/VBZ/takes the/DT/the data/NNS/data byte/VBP/byte and/CC/and then/RB/then clears/VBZ/clears the/DT/the bit/NN/bit in/IN/in the/DT/the control/NN/control register/NN/register to/TO/to signal/VB/signal that/IN/that it/PRP/it is/VBZ/is ready/RB/ready for/IN/for the/DT/the next/JJ/next byte/NNP/byte. then/RB/then the/DT/the cpu/NN/cpu can/MD/can transfer/VB/transfer the/DT/the next/JJ/next byte/NNP/byte. if/IN/if the/DT/the cpu/NN/cpu uses/VBZ/uses polling/VBG/polling to/TO/to watch/VB/watch the/DT/the control/NN/control bit//NN/bit/ constantly/RB/constantly looping/VBG/looping to/TO/to see/VB/see whether/IN/whether the/DT/the device/NN/device is/VBZ/is ready//JJ/ready/ this/DT/this method/NN/method of/IN/of operation/NN/operation is/VBZ/is called/VBN/called if/IN/if the/DT/the cpu/NN/cpu does/VBZ/does not/RB/not poll/VB/poll the/DT/the control/NN/control bit//NN/bit/ but/CC/but instead/RB/instead receives/VBZ/receives an/DT/an interrupt/JJ/interrupt when/WRB/when the/DT/the device/NN/device is/VBZ/is ready/JJ/ready for/IN/for the/DT/the next/JJ/next byte//NN/byte/ the/DT/the data/NNS/data transfer/VBP/transfer is/VBZ/is said/VBN/said to/TO/to be/VB/be when/WRB/when a/DT/a process/NN/process running/VBG/running in/IN/in user/NN/user rnode/NN/rnode requests/NNS/requests additional/JJ/additional memory//JJ/memory/ pages/NNS/pages are/VBP/are allocated/VBN/allocated from/IN/from the/DT/the list/NN/list of/IN/of free/JJ/free page/NN/page frames/VBZ/frames maintained/VBN/maintained by/IN/by the/DT/the kernel/NNP/kernel. this/DT/this list/NN/list is/VBZ/is typically/RB/typically populated/VBN/populated using/VBG/using a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm such/JJ/such as/IN/as those/DT/those discussed/VBN/discussed in/IN/in section/NN/section 9.4/CD/9.4 and/CC/and most/JJS/most likely/JJ/likely contains/NNS/contains free/JJ/free pages/NNS/pages scattered/VBN/scattered throughout/IN/throughout physical/JJ/physical memory//NN/memory/ as/IN/as explained/VBN/explained earlier/NNP/earlier. remember//NNP/remember/ too//NNP/too/ that/IN/that if/IN/if a/DT/a user/NN/user process/NN/process requests/NNS/requests a/DT/a single/JJ/single byte/NN/byte of/IN/of memory//NNP/memory/ internal/JJ/internal fragmentation/NN/fragmentation will/MD/will result//VB/result/ as/IN/as the/DT/the process/NN/process will/MD/will be/VB/be granted/VBN/granted an/DT/an entire/JJ/entire page/NN/page frame/NNP/frame. kernel/NN/kernel memory//-NONE-/memory/ however1/NNP/however1 is/VBZ/is often/RB/often allocated/VBN/allocated from/IN/from a/DT/a free-memory/JJ/free-memory pool/NN/pool different/JJ/different from/IN/from the/DT/the list/NN/list used/VBD/used to/TO/to satisfy/VB/satisfy ordinary/JJ/ordinary user-mode/JJ/user-mode processes/NNP/processes. there/RB/there are/VBP/are two/CD/two primary/JJ/primary reasons/NNS/reasons for/IN/for this/DT/this /:/: the/DT/the kernel/NN/kernel requests/NNS/requests memory/NN/memory for/IN/for data/NNS/data structures/NNS/structures of/IN/of varying/VBG/varying sizes/NNS/sizes /,/, some/DT/some of/IN/of which/WDT/which are/VBP/are less/RBR/less than/IN/than a/DT/a page/NN/page in/IN/in size/NNP/size. as/IN/as a/DT/a result1/NNP/result1 the/DT/the kernel/NN/kernel must/MD/must use/VB/use memory/NN/memory conservatively/RB/conservatively and/CC/and attempt/NN/attempt to/TO/to minimize/VB/minimize waste/NN/waste due/JJ/due to/TO/to fragmentation/NNP/fragmentation. this/DT/this is/VBZ/is especially/RB/especially important/JJ/important because/IN/because many/JJ/many operating/VBG/operating systems/NNS/systems do/VBP/do not/RB/not subject/VB/subject kernel/NN/kernel code/NN/code or/CC/or data/NNS/data to/TO/to the/DT/the paging/NN/paging system/NNP/system. 2/CD/2. pages/NNS/pages allocated/VBN/allocated to/TO/to user-mode/JJ/user-mode processes/NNS/processes do/VBP/do not/RB/not necessarily/RB/necessarily have/VB/have to/TO/to be/VB/be in/IN/in contiguous/JJ/contiguous physical/JJ/physical memory/NNP/memory. however//NNP/however/ certain/JJ/certain hardware/NN/hardware devices/NNS/devices interact/VBP/interact directly/RB/directly with/IN/with physical/JJ/physical memory-without/NN/memory-without the/DT/the benefit/NN/benefit of/IN/of a/DT/a virtual/JJ/virtual memory/NN/memory interface-and/NN/interface-and consequently/RB/consequently may/MD/may require/VB/require memory/NN/memory residing/VBG/residing in/IN/in physically/RB/physically contiguous/JJ/contiguous pages/NNP/pages. in/IN/in the/DT/the following/JJ/following sections//NN/sections/ we/PRP/we examine/VBP/examine two/CD/two strategies/NNS/strategies for/IN/for managing/VBG/managing free/JJ/free memory/NN/memory that/WDT/that is/VBZ/is assigned/VBN/assigned to/TO/to kernel/VB/kernel processes/NNS/processes /:/: the/DT/the buddy/NN/buddy system/NNP/system. and/CC/and slab/NN/slab allocation/NNP/allocation. 9.8/CD/9.8 397/CD/397 9.8.1/CD/9.8.1 buddy/NN/buddy system/NN/system tbe/NN/tbe buddy/NN/buddy system/NN/system allocates/VBZ/allocates memory/NN/memory from/IN/from a/DT/a fixed-size/JJ/fixed-size segment/NN/segment consisting/VBG/consisting of/IN/of physically/RB/physically contiguous/JJ/contiguous pages/NNP/pages. memory/NN/memory is/VBZ/is allocated/VBN/allocated from/IN/from this/DT/this segment/NN/segment using/VBG/using a/DT/a power-of-2/-NONE-/power-of-2 allocator/NN/allocator /,/, which/WDT/which satisfies/NNS/satisfies requests/VBZ/requests in/IN/in units/NNS/units sized/VBN/sized as/IN/as a/DT/a power/NN/power of/IN/of 2/CD/2 /CD/( 4/CD/4 kb/NN/kb /,/, 8/CD/8 kb/NN/kb /,/, 16/CD/16 kb/NN/kb /,/, and/CC/and so/RB/so forth/JJ/forth /NN/) /./. a/DT/a request/NN/request in/IN/in units/NNS/units not/RB/not appropriately/RB/appropriately sized/VBN/sized is/VBZ/is rounded/VBN/rounded up/RP/up to/TO/to the/DT/the next/JJ/next highest/NN/highest power/NN/power of/IN/of 2/CD/2. for/IN/for example/NN/example /,/, if/IN/if a/DT/a request/NN/request for/IN/for 11/CD/11 kb/NN/kb is/VBZ/is made/VBN/made /,/, it/PRP/it is/VBZ/is satisfied/VBN/satisfied with/IN/with a/DT/a 16-kb/CD/16-kb segment/NNP/segment. let/NN/let 's/POS/'s consider/NN/consider a/DT/a simple/JJ/simple example/NNP/example. assume/NN/assume the/DT/the size/NN/size of/IN/of a/DT/a memory/NN/memory segment/NN/segment is/VBZ/is initially/RB/initially 256/CD/256 kb/NN/kb and/CC/and the/DT/the kernel/NN/kernel requests/NNS/requests 21/CD/21 kb/NN/kb of/IN/of memory/NNP/memory. the/DT/the segment/NN/segment is/VBZ/is initially/RB/initially divided/VBN/divided into/IN/into two/CD/two buddies-which/JJ/buddies-which we/PRP/we will/MD/will call/VB/call al/JJ/al and/CC/and ar/NN/ar -each/JJ/-each 128/CD/128 kb/NN/kb in/IN/in size/NNP/size. one/CD/one of/IN/of these/DT/these buddies/NNS/buddies is/VBZ/is further/JJ/further divided/VBN/divided into/IN/into two/CD/two 64-kb/CD/64-kb buddiesbland/NN/buddiesbland br/-NONE-/br- however/RB/however /,/, the/DT/the next-highest/JJS/next-highest power/NN/power of/IN/of 2/CD/2 from/IN/from 21/CD/21 kb/NN/kb is/VBZ/is 32/CD/32 kb/NN/kb so/IN/so either/DT/either bt/NN/bt or/CC/or br/NN/br is/VBZ/is again/RB/again divided/VBN/divided into/IN/into two/CD/two 32-kb/CD/32-kb buddies/NNS/buddies /,/, cl/NN/cl and/CC/and cr/NNP/cr. one/CD/one of/IN/of these/DT/these buddies/NNS/buddies is/VBZ/is used/VBN/used to/TO/to satisfy/VB/satisfy the/DT/the 21-kb/CD/21-kb request/NNP/request. this/DT/this scheme/NN/scheme is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 9.27/CD/9.27 /,/, where/WRB/where cl/NN/cl is/VBZ/is the/DT/the segment/NN/segment allocated/VBD/allocated to/TO/to the/DT/the 21/CD/21 kb/NN/kb request/NNP/request. an/DT/an advantage/NN/advantage of/IN/of the/DT/the buddy/NN/buddy system/NN/system is/VBZ/is how/WRB/how quickly/RB/quickly adjacent/JJ/adjacent buddies/NNS/buddies can/MD/can be/VB/be combined/VBN/combined to/TO/to form/NN/form larger/JJR/larger segments/NNS/segments using/VBG/using a/DT/a teclmique/NN/teclmique known/VBN/known as/IN/as coalescing/NNP/coalescing. in/IN/in figure/NN/figure 9.27/CD/9.27 /,/, for/IN/for example/NN/example /,/, when/WRB/when the/DT/the kernel/NN/kernel releases/NNS/releases the/DT/the cl/NN/cl unit/NN/unit it/PRP/it was/VBD/was allocated/VBN/allocated /,/, the/DT/the system/NN/system can/MD/can coalesce/VB/coalesce c/NN/c l/NN/l and/CC/and c/NN/c r/NN/r into/IN/into a/DT/a 64-kb/CD/64-kb segment/NNP/segment. this/DT/this segment/NN/segment /,/, b/NN/b l/NN/l /,/, can/MD/can in/IN/in turn/NN/turn be/VB/be coalesced/VBN/coalesced with/IN/with its/PRP$/its buddy/NN/buddy b/NN/b r/NN/r to/TO/to form/NN/form a/DT/a 128-kb/CD/128-kb segment/NNP/segment. ultimately/RB/ultimately /,/, we/PRP/we can/MD/can end/VB/end up/RP/up with/IN/with the/DT/the original256-kb/JJ/original256-kb segment/NNP/segment. the/DT/the obvious/JJ/obvious drawback/NN/drawback to/TO/to the/DT/the buddy/NN/buddy system/NN/system is/VBZ/is that/IN/that rounding/VBG/rounding up/RP/up to/TO/to the/DT/the next/JJ/next highest/NN/highest power/NN/power of/IN/of 2/CD/2 is/VBZ/is very/RB/very likely/JJ/likely to/TO/to cause/VB/cause fragmentation/NN/fragmentation within/IN/within allocated/VBN/allocated segments/NNP/segments. for/IN/for example/NN/example /,/, a/DT/a 33-kb/CD/33-kb request/NN/request can/MD/can only/RB/only be/VB/be satisfied/VBN/satisfied with/IN/with a/DT/a 64/CD/64- kb/NN/kb segment/NNP/segment. in/IN/in fact/NN/fact /,/, we/PRP/we can/MD/can not/RB/not guarantee/VB/guarantee that/IN/that less/JJR/less than/IN/than 50/CD/50 percent/NN/percent of/IN/of the/DT/the allocated/VBN/allocated unit/NN/unit will/MD/will be/VB/be wasted/VBN/wasted due/JJ/due to/TO/to internal/JJ/internal fragmentation/NNP/fragmentation. in/IN/in the/DT/the following/JJ/following section/NN/section /,/, we/PRP/we explore/VBP/explore a/DT/a memory/NN/memory allocation/NN/allocation scheme/NN/scheme where/WRB/where no/DT/no space/NN/space is/VBZ/is lost/VBN/lost due/JJ/due to/TO/to fragmentation/NNP/fragmentation. physically/RB/physically contiguous/JJ/contiguous pages/NNS/pages 256/CD/256 kb/NN/kb figure/NN/figure 9.27/CD/9.27 buddy/NN/buddy system/NN/system allocation/NNP/allocation. 398/CD/398 chapter/NN/chapter 9/CD/9 9.8.2/CD/9.8.2 slab/NN/slab allocation/NN/allocation a/DT/a second/JJ/second strategy/NN/strategy for/IN/for allocating/NN/allocating kernel/NN/kernel memory/NN/memory is/VBZ/is known/VBN/known as/IN/as a/DT/a is/VBZ/is made/VBN/made up/RP/up of/IN/of one/CD/one or/CC/or nwre/NN/nwre physically/RB/physically contiguous/JJ/contiguous pages/NNP/pages. a/DT/a consists/NNS/consists of/IN/of one/CD/one or/CC/or more/JJR/more slabs/NNP/slabs. there/RB/there is/VBZ/is a/DT/a single/JJ/single cache/NN/cache for/IN/for each/DT/each unique/JJ/unique kernel/NN/kernel data/NNS/data structure/NN/structure -for/NN/-for example/NN/example /,/, a/DT/a separate/JJ/separate cache/NN/cache for/IN/for the/DT/the data/NNS/data structure/VBP/structure representing/VBG/representing process/NN/process descriptors/NNS/descriptors /,/, a/DT/a separate/JJ/separate cache/NN/cache for/IN/for file/NN/file objects/NNS/objects /,/, a/DT/a separate/JJ/separate cache/NN/cache for/IN/for semaphores/NNS/semaphores /,/, and/CC/and so/RB/so forth/NNP/forth. each/DT/each cache/NN/cache is/VBZ/is populated/VBN/populated with/IN/with that/DT/that are/VBP/are instantiations/NNS/instantiations of/IN/of the/DT/the kernel/NN/kernel data/NNS/data structure/NN/structure the/DT/the cache/NN/cache represents/NNP/represents. for/IN/for example/NN/example /,/, the/DT/the cache/NN/cache representing/VBG/representing semaphores/NNS/semaphores stores/NNS/stores instances/NNS/instances of/IN/of semaphore/JJR/semaphore objects/NNS/objects /,/, the/DT/the cache/NN/cache representing/VBG/representing process/NN/process descriptors/NNS/descriptors stores/NNS/stores instances/NNS/instances of/IN/of process/NN/process descriptor/NN/descriptor objects/NNS/objects /,/, and/CC/and so/RB/so forth/NNP/forth. the/DT/the relationship/NN/relationship between/IN/between slabs/NNS/slabs /,/, caches/NNS/caches /,/, and/CC/and objects/NNS/objects is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 9.28/CD/9.28. the/DT/the figure/NN/figure shows/VBZ/shows two/CD/two kernel/NN/kernel objects/NNS/objects 3/CD/3 kb/NN/kb in/IN/in size/NN/size and/CC/and three/CD/three objects/NNS/objects 7/CD/7 kb/NN/kb in/IN/in size/NNP/size. these/DT/these objects/NNS/objects are/VBP/are stored/VBN/stored in/IN/in their/PRP$/their respective/JJ/respective caches/NNP/caches. the/DT/the slab-allocation/NN/slab-allocation algorithm/NN/algorithm uses/NNS/uses caches/VBZ/caches to/TO/to store/VB/store kernel/NN/kernel objects/NNP/objects. when/WRB/when a/DT/a cache/NN/cache is/VBZ/is created/VBN/created /,/, a/DT/a number/NN/number of/IN/of objects-which/JJ/objects-which are/VBP/are initially/RB/initially marked/VBN/marked as/IN/as free-are/JJ/free-are allocated/VBN/allocated to/TO/to the/DT/the cache/NNP/cache. the/DT/the number/NN/number of/IN/of objects/NNS/objects in/IN/in the/DT/the cache/NN/cache depends/VBZ/depends on/IN/on the/DT/the size/NN/size of/IN/of the/DT/the associated/VBN/associated slab/NNP/slab. for/IN/for example/NN/example /,/, a/DT/a 12-kb/CD/12-kb slab/NN/slab /:/( made/VBN/made up/RP/up of/IN/of three/CD/three continguous/JJ/continguous 4-kb/CD/4-kb pages/NNS/pages /:/) could/MD/could store/VB/store six/CD/six 2-kb/CD/2-kb objects/NNP/objects. initially/RB/initially /,/, all/DT/all objects/NNS/objects in/IN/in the/DT/the cache/NN/cache are/VBP/are marked/VBN/marked as/IN/as free/NNP/free. when/WRB/when a/DT/a new/JJ/new object/NN/object for/IN/for a/DT/a kernel/NN/kernel data/NN/data structure/NN/structure is/VBZ/is needed/VBN/needed /,/, the/DT/the allocator/NN/allocator can/MD/can assign/VB/assign any/DT/any free/JJ/free object/NN/object from/IN/from the/DT/the cache/NN/cache to/TO/to satisfy/VB/satisfy the/DT/the request/NNP/request. the/DT/the object/NN/object assigned/VBD/assigned from/IN/from the/DT/the cache/NN/cache is/VBZ/is marked/VBN/marked as/RB/as used/NNP/used. let/VB/let 's/POS/'s consider/NN/consider a/DT/a scenario/NN/scenario in/IN/in which/WDT/which the/DT/the kernel/NN/kernel requests/NNS/requests memory/NN/memory from/IN/from the/DT/the slab/NN/slab allocator/NN/allocator for/IN/for an/DT/an object/NN/object representing/VBG/representing a/DT/a process/NN/process descriptor/NNP/descriptor. in/IN/in linux/NN/linux systems/NNS/systems /,/, a/DT/a process/NN/process descriptor/NN/descriptor is/VBZ/is of/IN/of the/DT/the type/NN/type struct/NN/struct task_struct/NN/task_struct /,/, which/WDT/which requires/VBZ/requires approximately/RB/approximately 1.7/CD/1.7 kb/NN/kb of/IN/of memory/NNP/memory. when/WRB/when the/DT/the linux/NN/linux kernel/NN/kernel creates/VBZ/creates a/DT/a new/JJ/new task/NN/task /,/, it/PRP/it requests/VBZ/requests the/DT/the necessary/JJ/necessary memory/NN/memory for/IN/for the/DT/the struct/NN/struct task_struct/NN/task_struct object/NN/object from/IN/from its/PRP$/its cache/NNP/cache. the/DT/the cache/NN/cache will/MD/will fulfill/VB/fulfill the/DT/the request/NN/request using/VBG/using a/DT/a struct/NN/struct task_struct/NN/task_struct object/NN/object that/WDT/that has/VBZ/has already/RB/already been/VBN/been allocated/VBN/allocated in/IN/in a/DT/a slab/NN/slab and/CC/and is/VBZ/is marked/VBN/marked as/RB/as free/NNP/free. in/IN/in linux/NN/linux /,/, a/DT/a slab/NN/slab may/MD/may be/VB/be in/IN/in one/CD/one of/IN/of three/CD/three possible/JJ/possible states/NNS/states /:/: kernel/NN/kernel objects/NNS/objects slabs/NNS/slabs 3-kb/CD/3-kb objects/NNS/objects 7-kb/CD/7-kb objects/NNS/objects figure/NN/figure 9.28/CD/9.28 slab/NN/slab allocation/NNP/allocation. physically/RB/physically contiguous/JJ/contiguous pages/NNS/pages 9.9/CD/9.9 9.9/CD/9.9 full/NNP/full. all/DT/all objects/NNS/objects in/IN/in the/DT/the slab/NN/slab are/VBP/are marked/VBN/marked as/IN/as used/NNP/used. empty/NNP/empty. all/DT/all objects/NNS/objects in/IN/in the/DT/the slab/NN/slab are/VBP/are marked/VBN/marked as/IN/as free/NNP/free. partial/NNP/partial. the/DT/the slab/NN/slab consists/VBZ/consists of/IN/of both/DT/both used/VBN/used and/CC/and free/JJ/free objects/NNP/objects. 399/CD/399 the/DT/the slab/NN/slab allocator/NN/allocator first/RB/first attempts/VBZ/attempts to/TO/to satisfy/VB/satisfy the/DT/the request/NN/request with/IN/with a/DT/a free/JJ/free object/NN/object in/IN/in a/DT/a partial/JJ/partial slab/NNP/slab. if/IN/if none/NN/none exist/NN/exist /,/, a/DT/a free/JJ/free object/NN/object is/VBZ/is assigned/VBN/assigned from/IN/from an/DT/an empty/NN/empty slab/NNP/slab. if/IN/if no/DT/no empty/NN/empty slabs/NNS/slabs are/VBP/are available/JJ/available /,/, a/DT/a new/JJ/new slab/NN/slab is/VBZ/is allocated/VBN/allocated from/IN/from contiguous/JJ/contiguous physical/JJ/physical pages/NNS/pages and/CC/and assigned/VBD/assigned to/TO/to a/DT/a cache/NN/cache ;/:/; memory/NN/memory for/IN/for the/DT/the object/NN/object is/VBZ/is allocated/VBN/allocated from/IN/from this/DT/this slab/NNP/slab. the/DT/the slab/NN/slab allocator/NN/allocator provides/VBZ/provides two/CD/two main/JJ/main benefits/NNS/benefits /:/: no/DT/no memory/NN/memory is/VBZ/is wasted/VBN/wasted due/JJ/due to/TO/to fragmentation/NNP/fragmentation. fragn/NN/fragn entation/NN/entation is/VBZ/is not/RB/not an/DT/an issue/NN/issue because/IN/because each/DT/each unique/JJ/unique kernel/NN/kernel data/NNS/data structure/NN/structure has/VBZ/has an/DT/an associated/VBN/associated cache/NN/cache /,/, and/CC/and each/DT/each cache/NN/cache is/VBZ/is made/VBN/made up/RP/up of/IN/of one/CD/one or/CC/or more/JJR/more slabs/NNS/slabs that/WDT/that are/VBP/are divided/VBN/divided into/IN/into chunks/NNS/chunks the/DT/the size/NN/size of/IN/of the/DT/the objects/NNS/objects being/VBG/being represented/NNP/represented. thus/RB/thus /,/, when/WRB/when the/DT/the kernel/NN/kernel requests/NNS/requests memory/NN/memory for/IN/for an/DT/an object/NN/object /,/, the/DT/the slab/NN/slab allocator/NN/allocator returns/NNS/returns the/DT/the exact/JJ/exact amount/NN/amount of/IN/of memory/NN/memory required/VBN/required to/TO/to represent/VB/represent the/DT/the object/NNP/object. memory/NN/memory requests/NNS/requests can/MD/can be/VB/be satisfied/VBN/satisfied quickly/-NONE-/quickly. the/DT/the slab/NN/slab allocation/NN/allocation scheme/NN/scheme is/VBZ/is thus/RB/thus particularly/RB/particularly effective/JJ/effective for/IN/for mm/NN/mm aging/VBG/aging memory/NN/memory when/WRB/when objects/NNS/objects are/VBP/are frequently/RB/frequently allocated/VBN/allocated and/CC/and deallocated/VBN/deallocated /,/, as/IN/as is/VBZ/is often/RB/often the/DT/the case/NN/case with/IN/with requests/NNS/requests from/IN/from the/DT/the kernel/NNP/kernel. the/DT/the act/NN/act of/IN/of allocating-and/JJ/allocating-and releasing-memory/JJ/releasing-memory can/MD/can be/VB/be a/DT/a time-consuming/JJ/time-consuming process/NNP/process. however/RB/however /,/, objects/VBZ/objects are/VBP/are created/VBN/created in/IN/in advance/NN/advance and/CC/and thus/RB/thus can/MD/can be/VB/be quickly/RB/quickly allocated/VBN/allocated from/IN/from the/DT/the cache/NNP/cache. furthermore/NN/furthermore /,/, when/WRB/when the/DT/the kernel/NN/kernel has/VBZ/has finished/VBN/finished with/IN/with an/DT/an object/NN/object and/CC/and releases/NNS/releases it/PRP/it /,/, it/PRP/it is/VBZ/is marked/VBN/marked as/RB/as free/JJ/free and/CC/and returned/VBD/returned to/TO/to its/PRP$/its cache/NN/cache /,/, thus/RB/thus making/VBG/making it/PRP/it immediately/RB/immediately available/JJ/available for/IN/for subsequent/NN/subsequent requests/NNS/requests fi/VBP/fi om/NN/om the/DT/the kernel/NNP/kernel. the/DT/the slab/NN/slab allocator/NN/allocator first/RB/first appeared/VBD/appeared in/IN/in the/DT/the solaris/NN/solaris 2.4/CD/2.4 kernel/NNP/kernel. because/IN/because of/IN/of its/PRP$/its general-purpose/JJ/general-purpose nature/NN/nature /,/, this/DT/this allocator/NN/allocator is/VBZ/is now/RB/now also/RB/also used/VBD/used for/IN/for certain/JJ/certain user-mode/JJ/user-mode memory/NN/memory requests/NNS/requests in/IN/in solaris/NNP/solaris. linux/NN/linux originally/RB/originally used/VBN/used the/DT/the buddy/NN/buddy system/NN/system ;/:/; however/RB/however /,/, beginning/NN/beginning with/IN/with version/NN/version 2.2/CD/2.2 /,/, the/DT/the linux/NN/linux kernel/NN/kernel adopted/VBD/adopted the/DT/the slab/NN/slab allocator/NNP/allocator. the/DT/the major/JJ/major decisions/NNS/decisions that/WDT/that we/PRP/we make/VBP/make for/IN/for a/DT/a paging/NN/paging system/NN/system are/VBP/are the/DT/the selections/NNS/selections of/IN/of a/DT/a replacement/NN/replacement algorithm/NN/algorithm and/CC/and an/DT/an allocation/NN/allocation policy/NN/policy /,/, which/WDT/which we/PRP/we discussed/VBD/discussed earlier/RBR/earlier in/IN/in this/DT/this chapter/NNP/chapter. there/RB/there are/VBP/are many/JJ/many other/JJ/other considerations/NNS/considerations as/IN/as well/RB/well /,/, and/CC/and we/PRP/we discuss/VBP/discuss several/JJ/several of/IN/of them/PRP/them here/NNP/here. 9.9.1/CD/9.9.1 prepaging/VBG/prepaging an/DT/an obvious/JJ/obvious property/NN/property of/IN/of pure/NN/pure demand/NN/demand paging/VBG/paging is/VBZ/is the/DT/the large/JJ/large number/NN/number of/IN/of page/NN/page faults/NNS/faults that/WDT/that occur/VBP/occur when/WRB/when a/DT/a process/NN/process is/VBZ/is started/NNP/started. this/DT/this situation/NN/situation results/NNS/results from/IN/from trying/VBG/trying to/TO/to get/VB/get the/DT/the initial/JJ/initial locality/NN/locality into/IN/into memory/NNP/memory. the/DT/the same/JJ/same situation/NN/situation may/MD/may arise/VB/arise at/IN/at other/JJ/other times/NNP/times. for/IN/for instance/NN/instance /,/, when/WRB/when a/DT/a swapped-out/JJ/swapped-out process/NN/process is/VBZ/is restarted/VBN/restarted /,/, all/DT/all its/PRP$/its are/VBP/are on/IN/on the/DT/the disk/NN/disk /,/, and/CC/and each/DT/each must/MD/must be/VB/be brought/VBN/brought in/IN/in by/IN/by its/PRP$/its own/JJ/own page/NN/page fault/NNP/fault. is/VBZ/is an/DT/an attempt/NN/attempt to/TO/to prevent/VB/prevent this/DT/this high/JJ/high level/NN/level of/IN/of initial/JJ/initial paging/NNP/paging. the/DT/the strategy/NN/strategy is/VBZ/is to/TO/to bring/VB/bring into/IN/into memory/NN/memory at/IN/at 400/CD/400 chapter/NN/chapter 9/CD/9 one/CD/one tin1.e/JJ/tin1.e all/DT/all the/DT/the pages/NNS/pages that/WDT/that will/MD/will be/VB/be needed/NNP/needed. some/DT/some operating/NN/operating systerns-notably/RB/systerns-notably solaris-prepage/JJ/solaris-prepage the/DT/the page/NN/page frames/VBZ/frames for/IN/for small/JJ/small files/NNP/files. in/IN/in a/DT/a system/NN/system using/VBG/using the/DT/the working-set/JJ/working-set model/NN/model /,/, for/IN/for example/NN/example /,/, we/PRP/we keep/VBP/keep with/IN/with each/DT/each process/NN/process a/DT/a list/NN/list of/IN/of the/DT/the pages/NNS/pages in/IN/in its/PRP$/its working/NN/working set/NNP/set. if/IN/if we/PRP/we must/MD/must suspend/VB/suspend a/DT/a process/NN/process /:/( due/JJ/due to/TO/to an/DT/an i/0/NN/i/0 wait/NN/wait or/CC/or a/DT/a lack/NN/lack of/IN/of free/JJ/free frames/NNS/frames /:/) /,/, we/PRP/we remember/VBP/remember the/DT/the working/VBG/working set/NN/set for/IN/for that/DT/that process/NNP/process. when/WRB/when the/DT/the process/NN/process is/VBZ/is to/TO/to be/VB/be resumed/VBN/resumed /-NONE-/( because/IN/because i/0/-NONE-/i/0 has/VBZ/has finished/VBN/finished or/CC/or enough/RB/enough free/JJ/free frames/NNS/frames have/VBP/have become/VBN/become available/JJ/available /NN/) /,/, we/PRP/we automatically/RB/automatically bring/VBG/bring back/RB/back into/IN/into memory/NN/memory its/PRP$/its entire/JJ/entire working/VBG/working set/NN/set before/IN/before restarting/NN/restarting the/DT/the process/NNP/process. prepaging/NN/prepaging may/MD/may offer/VB/offer an/DT/an advantage/NN/advantage in/IN/in some/DT/some cases/NNP/cases. the/DT/the question/NN/question is/VBZ/is simply/RB/simply whether/IN/whether the/DT/the cost/NN/cost of/IN/of using/VBG/using prepaging/NN/prepaging is/VBZ/is less/JJR/less than/IN/than the/DT/the cost/NN/cost of/IN/of servicing/NN/servicing the/DT/the corresponding/NN/corresponding page/NN/page faults/NNP/faults. it/PRP/it may/MD/may well/RB/well be/VB/be the/DT/the case/NN/case that/IN/that many/JJ/many of/IN/of the/DT/the pages/NNS/pages brought/VBD/brought back/RP/back into/IN/into memory/NN/memory by/IN/by prepaging/NN/prepaging will/MD/will not/RB/not be/VB/be used/NNP/used. assume/NN/assume that/WDT/that s/VBZ/s pages/NNS/pages are/VBP/are prepaged/VBN/prepaged and/CC/and a/DT/a fraction/NN/fraction a/DT/a of/IN/of these/DT/these s/NNS/s pages/NNS/pages is/VBZ/is actually/RB/actually used/VBN/used /-NONE-/( 0/-NONE-/0 /:/: '/''/' /:/: /:/: /:/: a/DT/a /:/: '/POS/' /:/: /:/: /:/: 1/LS/1 /:/) /./. the/DT/the question/NN/question is/VBZ/is whether/IN/whether the/DT/the cost/NN/cost of/IN/of the/DT/the s/NNS/s .a/-NONE-/.a saved/VBD/saved page/NN/page faults/NNS/faults is/VBZ/is greater/JJR/greater or/CC/or less/JJR/less than/IN/than the/DT/the cost/NN/cost of/IN/of prepaging/VBG/prepaging s/NNS/s /./. /:/( 1/CD/1 /:/- a/DT/a /NN/) unnecessary/NN/unnecessary pages/NNP/pages. if/IN/if a/DT/a is/VBZ/is close/JJ/close to/TO/to 0/-NONE-/0 /,/, prepaging/NN/prepaging loses/NNS/loses ;/:/; if/IN/if a/DT/a is/VBZ/is close/JJ/close to/TO/to 1/CD/1 /,/, prepaging/VBG/prepaging wins/NNP/wins. 9.9.2/CD/9.9.2 page/NN/page size/NN/size the/DT/the designers/NNS/designers of/IN/of an/DT/an operating/NN/operating system/NN/system for/IN/for an/DT/an existing/VBG/existing machine/NN/machine seldom/NN/seldom have/VBP/have a/DT/a choice/NN/choice concerning/VBG/concerning the/DT/the page/NN/page size/NNP/size. however/RB/however /,/, when/WRB/when new/JJ/new machines/NNS/machines are/VBP/are being/VBG/being designed/VBN/designed /,/, a/DT/a decision/NN/decision regarding/VBG/regarding the/DT/the best/JJS/best page/NN/page size/NN/size must/MD/must be/VB/be made/NNP/made. as/IN/as you/PRP/you might/MD/might expect/VB/expect /,/, there/EX/there is/VBZ/is no/DT/no single/JJ/single best/JJS/best page/NN/page size/NNP/size. rather/RB/rather /,/, there/EX/there is/VBZ/is a/DT/a set/NN/set of/IN/of factors/NNS/factors that/WDT/that support/NN/support various/VBZ/various sizes/NNP/sizes. page/NN/page sizes/VBZ/sizes are/VBP/are invariably/RB/invariably powers/NNS/powers of/IN/of 2/CD/2 /,/, generally/RB/generally ranging/VBG/ranging from/IN/from 4,096/CD/4,096 /CD/( 212/CD/212 /CD/) to/TO/to 4,194,304/CD/4,194,304 /CD/( 222/CD/222 /CD/) bytes/NNP/bytes. how/WRB/how do/VBP/do we/PRP/we select/VB/select a/DT/a page/NN/page size/NN/size one/CD/one concern/NN/concern is/VBZ/is the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page table/NNP/table. for/IN/for a/DT/a given/VBN/given virtual/JJ/virtual memory/NN/memory space/NN/space /,/, decreasing/VBG/decreasing the/DT/the page/NN/page size/NN/size increases/NNS/increases the/DT/the number/NN/number of/IN/of pages/NNS/pages and/CC/and hence/NN/hence the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page table/NNP/table. for/IN/for a/DT/a virtual/JJ/virtual memory/NN/memory of/IN/of 4/CD/4 mb/NN/mb /:/( 222/CD/222 /CD/) /,/, for/IN/for example/NN/example /,/, there/EX/there would/MD/would be/VB/be 4,096/CD/4,096 pages/NNS/pages of/IN/of 1,024/CD/1,024 bytes/NNS/bytes but/CC/but only/RB/only 512/CD/512 pages/NNS/pages of/IN/of 8,192/CD/8,192 bytes/NNP/bytes. because/IN/because each/DT/each active/JJ/active process/NN/process must/MD/must have/VB/have its/PRP$/its own/JJ/own copy/NN/copy of/IN/of the/DT/the page/NN/page table/NN/table /,/, a/DT/a large/JJ/large page/NN/page size/NN/size is/VBZ/is desirable/NNP/desirable. memory/NN/memory is/VBZ/is better/RBR/better utilized/VBN/utilized with/IN/with smaller/JJR/smaller pages/NNS/pages /,/, however/NNP/however. if/IN/if a/DT/a process/NN/process is/VBZ/is allocated/VBN/allocated memory/NN/memory starting/VBG/starting at/IN/at location/NN/location 00000/CD/00000 and/CC/and continuing/VBG/continuing until/IN/until it/PRP/it has/VBZ/has as/RB/as much/JJ/much as/IN/as it/PRP/it needs/VBZ/needs /,/, it/PRP/it probably/RB/probably will/MD/will not/RB/not end/VB/end exactly/RB/exactly on/IN/on a/DT/a page/NN/page boundary/NNP/boundary. thus/RB/thus /,/, a/DT/a part/NN/part of/IN/of the/DT/the final/JJ/final page/NN/page must/MD/must be/VB/be allocated/VBN/allocated /-NONE-/( because/IN/because pages/NNS/pages are/VBP/are the/DT/the units/NNS/units of/IN/of allocation/NN/allocation /:/) but/CC/but will/MD/will be/VB/be unused/VBN/unused /-NONE-/( creating/VBG/creating internal/JJ/internal fragmentation/NN/fragmentation /:/) /./. assuming/VBG/assuming independence/NN/independence of/IN/of process/NN/process size/NN/size and/CC/and page/NN/page size/NN/size /,/, we/PRP/we can/MD/can expect/VB/expect that/IN/that /,/, on/IN/on the/DT/the average/NN/average /,/, half/DT/half of/IN/of the/DT/the final/JJ/final page/NN/page of/IN/of each/DT/each process/NN/process will/MD/will be/VB/be wasted/NNP/wasted. this/DT/this loss/NN/loss is/VBZ/is only/RB/only 256/CD/256 bytes/NNS/bytes for/IN/for a/DT/a page/NN/page of/IN/of 512/CD/512 bytes/NNS/bytes but/CC/but is/VBZ/is 4,096/CD/4,096 bytes/NNS/bytes for/IN/for a/DT/a page/NN/page of/IN/of 8,192/CD/8,192 bytes/NNP/bytes. to/TO/to minimize/VB/minimize internal/JJ/internal fragmentation/NN/fragmentation /,/, then/RB/then /,/, we/PRP/we need/VBP/need a/DT/a small/JJ/small page/NN/page size/NNP/size. another/DT/another problem/NN/problem is/VBZ/is the/DT/the time/NN/time required/VBN/required to/TO/to read/VB/read or/CC/or write/VB/write a/DT/a page/NNP/page. i/0/NNP/i/0 time/NN/time is/VBZ/is composed/VBN/composed of/IN/of seek/NN/seek /,/, latency/NN/latency /,/, and/CC/and transfer/VB/transfer times/NNP/times. transfer/NN/transfer time/NN/time is/VBZ/is proportional/JJ/proportional to/TO/to the/DT/the amount/NN/amount transferred/VBD/transferred /CD/( that/IN/that is/VBZ/is /,/, the/DT/the page/NN/page size/NN/size /:/) -a/NNP/-a fact/NN/fact that/IN/that would/MD/would seem/VB/seem to/TO/to argue/VB/argue for/IN/for a/DT/a small/JJ/small page/NN/page size/NNP/size. howeve1/NNP/howeve1 ~/NNP/~ as/IN/as we/PRP/we shall/MD/shall see/VB/see in/IN/in section/NN/section 12.1.1/CD/12.1.1 /,/, latency/NN/latency and/CC/and seek/NN/seek time/NN/time normally/RB/normally dwarf/NN/dwarf transfer/NN/transfer time/NNP/time. at/IN/at a/DT/a transfer/NN/transfer rate/NN/rate of/IN/of 2/CD/2 mb/NN/mb per/IN/per second/JJ/second /,/, it/PRP/it takes/VBZ/takes only/RB/only 0.2/CD/0.2 milliseconds/NNS/milliseconds to/TO/to transfer/VB/transfer 512/CD/512 bytes/NNP/bytes. latency/NN/latency time/NN/time /,/, though/RB/though /,/, is/VBZ/is perhaps/RB/perhaps 8/CD/8 milliseconds/NNS/milliseconds and/CC/and seek/VB/seek time/NN/time 20/CD/20 milliseconds/NNP/milliseconds. of/IN/of the/DT/the total/JJ/total i/0/NN/i/0 time/NN/time /:/( 28.2/CD/28.2 milliseconds/NNS/milliseconds /:/) /,/, therefore/RB/therefore /,/, only/RB/only 1/CD/1 percent/NN/percent is/VBZ/is attributable/JJ/attributable to/TO/to the/DT/the actual/JJ/actual transfer/NNP/transfer. doubling/NN/doubling the/DT/the page/NN/page size/NN/size increases/NNS/increases i/0/-NONE-/i/0 time/NN/time to/TO/to only/RB/only 28.4/CD/28.4 milliseconds/NNP/milliseconds. it/PRP/it takes/VBZ/takes 28.4/CD/28.4 milliseconds/NNS/milliseconds to/TO/to read/VB/read a/DT/a single/JJ/single page/NN/page of/IN/of 1,024/CD/1,024 bytes/NNS/bytes but/CC/but 9.9/CD/9.9 401/CD/401 56.4/CD/56.4 milliseconds/NNS/milliseconds to/TO/to read/VB/read the/DT/the sam.e/JJ/sam.e amount/NN/amount as/IN/as two/CD/two pages/NNS/pages of/IN/of 512/CD/512 bytes/NNS/bytes each/NNP/each. thus/RB/thus /,/, a/DT/a desire/NN/desire to/TO/to minimize/VB/minimize 1/0/CD/1/0 time/NN/time argues/NNS/argues for/IN/for a/DT/a larger/JJR/larger page/NN/page size/NNP/size. with/IN/with a/DT/a smaller/JJR/smaller page/NN/page size/NN/size /,/, though/IN/though /,/, to/TO/to tall/VB/tall /0/-NONE-//0 should/MD/should be/VB/be reduced/VBN/reduced /,/, since/IN/since locality/NN/locality will/MD/will be/VB/be improved/NNP/improved. a/DT/a smaller/JJR/smaller page/NN/page size/NN/size allows/VBZ/allows each/DT/each page/NN/page to/TO/to match/VB/match program/NN/program locality/NN/locality more/RBR/more accurately/NNP/accurately. for/IN/for example/NN/example /,/, consider/NN/consider a/DT/a process/NN/process 200/CD/200 kb/NN/kb in/IN/in size/NN/size /,/, of/IN/of which/WDT/which only/RB/only half/VBP/half /:/( 100/CD/100 kb/NN/kb /:/) is/VBZ/is actually/RB/actually used/VBN/used in/IN/in an/DT/an execution/NNP/execution. if/IN/if we/PRP/we have/VBP/have only/RB/only one/CD/one large/JJ/large page/NN/page /,/, we/PRP/we must/MD/must bring/VB/bring in/IN/in the/DT/the entire/JJ/entire page/NN/page /,/, a/DT/a total/NN/total of/IN/of 200/CD/200 kb/NN/kb transferred/VBD/transferred and/CC/and allocated/NNP/allocated. if/IN/if instead/RB/instead we/PRP/we had/VBD/had pages/NNS/pages of/IN/of only/RB/only 1/CD/1 byte/NN/byte /,/, then/RB/then we/PRP/we could/MD/could bring/VB/bring in/IN/in only/RB/only the/DT/the 100/CD/100 kb/NN/kb that/WDT/that are/VBP/are actually/RB/actually used/VBN/used /,/, resulting/VBG/resulting in/IN/in only/RB/only 100/CD/100 kb/NN/kb transferred/VBD/transferred and/CC/and allocated/NNP/allocated. with/IN/with a/DT/a smaller/JJR/smaller page/NN/page size/NN/size /,/, we/PRP/we have/VBP/have better/JJR/better allowing/VBG/allowing us/PRP/us to/TO/to isolate/VB/isolate only/RB/only the/DT/the memory/NN/memory that/IN/that is/VBZ/is actually/RB/actually needed/NNP/needed. with/IN/with a/DT/a larger/JJR/larger page/NN/page size/NN/size /,/, we/PRP/we must/MD/must allocate/VB/allocate and/CC/and transfer/VB/transfer not/RB/not only/RB/only what/WP/what is/VBZ/is needed/VBN/needed but/CC/but also/RB/also anything/NN/anything else/RB/else that/IN/that happens/NNS/happens to/TO/to be/VB/be in/IN/in the/DT/the page/NN/page /,/, whether/IN/whether it/PRP/it is/VBZ/is needed/VBN/needed or/CC/or not/NNP/not. thus/RB/thus /,/, a/DT/a smaller/JJR/smaller page/NN/page size/NN/size should/MD/should result/VB/result in/IN/in less/JJR/less i/0/-NONE-/i/0 and/CC/and less/JJR/less total/JJ/total allocated/VBN/allocated memory/NNP/memory. but/CC/but did/VBD/did you/PRP/you notice/NN/notice that/WDT/that with/IN/with a/DT/a page/NN/page size/NN/size of/IN/of 1/CD/1 byte/NN/byte /,/, we/PRP/we would/MD/would have/VB/have a/DT/a page/NN/page fault/NN/fault for/IN/for each/DT/each byte/NN/byte a/DT/a process/NN/process of/IN/of 200/CD/200 kb/NN/kb that/IN/that used/VBN/used only/RB/only half/DT/half of/IN/of that/DT/that memory/NN/memory would/MD/would generate/VB/generate only/RB/only one/CD/one page/NN/page fault/NN/fault with/IN/with a/DT/a page/NN/page size/NN/size of/IN/of 200/CD/200 kb/NN/kb but/CC/but 102,400/CD/102,400 page/NN/page faults/NNS/faults with/IN/with a/DT/a page/NN/page size/NN/size of/IN/of 1/CD/1 byte/NNP/byte. each/DT/each page/NN/page fault/NN/fault generates/VBZ/generates the/DT/the large/JJ/large amount/NN/amount of/IN/of overhead/NN/overhead needed/VBN/needed for/IN/for processing/NN/processing the/DT/the interrupt/NN/interrupt /,/, saving/VBG/saving registers/NNS/registers /,/, replacing/VBG/replacing a/DT/a page/NN/page /,/, queueing/VBG/queueing for/IN/for the/DT/the paging/VBG/paging device/NN/device /,/, and/CC/and updating/VBG/updating tables/NNP/tables. to/TO/to minimize/VB/minimize the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults /,/, we/PRP/we need/VBP/need to/TO/to have/VB/have a/DT/a large/JJ/large page/NN/page size/NNP/size. other/JJ/other factors/NNS/factors must/MD/must be/VB/be considered/VBN/considered as/IN/as well/RB/well /:/( such/JJ/such as/IN/as the/DT/the relationship/NN/relationship between/IN/between page/NN/page size/NN/size and/CC/and sector/NN/sector size/NN/size on/IN/on the/DT/the paging/NN/paging device/NN/device /:/) /./. the/DT/the problem/NN/problem has/VBZ/has no/DT/no best/JJS/best answer/NNP/answer. as/IN/as we/PRP/we have/VBP/have seen/VBN/seen /,/, some/DT/some factors/NNS/factors /VBP/( internal/JJ/internal fragmentation/NN/fragmentation /,/, locality/NN/locality /:/) argue/NN/argue for/IN/for a/DT/a small/JJ/small page/NN/page size/NN/size /,/, whereas/VBZ/whereas others/NNS/others /:/( table/JJ/table size/NN/size /,/, i/0/-NONE-/i/0 time/NN/time /:/) argue/NN/argue for/IN/for a/DT/a large/JJ/large page/NN/page size/NNP/size. however/RB/however /,/, the/DT/the historical/JJ/historical trend/NN/trend is/VBZ/is toward/IN/toward larger/JJR/larger page/NN/page sizes/NNP/sizes. indeed/RB/indeed /,/, the/DT/the first/JJ/first edition/NN/edition of/IN/of operating/NN/operating system/NN/system concepts/NNS/concepts /:/( 1983/CD/1983 /CD/) used/VBN/used 4,096/CD/4,096 bytes/NNS/bytes as/IN/as the/DT/the upper/JJ/upper bound/NN/bound on/IN/on page/NN/page sizes/NNS/sizes /,/, and/CC/and this/DT/this value/NN/value was/VBD/was the/DT/the most/JJS/most common/JJ/common page/NN/page size/NN/size in/IN/in 1990/CD/1990. modern/JJ/modern systems/NNS/systems may/MD/may now/RB/now use/VB/use much/JJ/much larger/JJR/larger page/NN/page sizes/NNS/sizes /,/, as/IN/as we/PRP/we will/MD/will see/VB/see in/IN/in the/DT/the following/JJ/following section/NNP/section. 9.9.3/CD/9.9.3 tlb/NN/tlb reach/NN/reach in/IN/in chapter/NN/chapter 8/CD/8 /,/, we/PRP/we introduced/VBD/introduced the/DT/the of/IN/of the/DT/the tlb/NNP/tlb. recall/NN/recall that/WDT/that the/DT/the hit/NN/hit ratio/NN/ratio for/IN/for the/DT/the tlb/NN/tlb refers/NNS/refers to/TO/to the/DT/the percentage/NN/percentage of/IN/of virtual/JJ/virtual address/NN/address translations/NNS/translations that/WDT/that are/VBP/are resolved/VBN/resolved in/IN/in the/DT/the tlb/NN/tlb rather/RB/rather than/IN/than the/DT/the page/NN/page table/NNP/table. clearly/RB/clearly /,/, the/DT/the hit/NN/hit ratio/NN/ratio is/VBZ/is related/VBN/related to/TO/to the/DT/the number/NN/number of/IN/of entries/NNS/entries in/IN/in the/DT/the tlb/NN/tlb /,/, and/CC/and the/DT/the way/NN/way to/TO/to increase/VB/increase the/DT/the hit/NN/hit ratio/NN/ratio is/VBZ/is by/IN/by increasing/VBG/increasing the/DT/the number/NN/number of/IN/of entries/NNS/entries in/IN/in the/DT/the tlb/NNP/tlb. this/DT/this /,/, however/RB/however /,/, does/VBZ/does not/RB/not come/VB/come cheaply/RB/cheaply /,/, as/IN/as the/DT/the associative/JJ/associative memory/NN/memory used/VBN/used to/TO/to construct/VB/construct the/DT/the tlb/NN/tlb is/VBZ/is both/DT/both expensive/JJ/expensive and/CC/and power/NN/power hungry/NNP/hungry. related/VBD/related to/TO/to the/DT/the hit/NN/hit ratio/NN/ratio is/VBZ/is a/DT/a similar/JJ/similar metric/JJ/metric /:/: the/DT/the the/DT/the tlb/NN/tlb reach/NN/reach refers/NNS/refers to/TO/to the/DT/the amount/NN/amount of/IN/of memory/NN/memory accessible/JJ/accessible from/IN/from the/DT/the tlb/NN/tlb and/CC/and is/VBZ/is simply/RB/simply the/DT/the number/NN/number of/IN/of entries/NNS/entries multiplied/VBN/multiplied by/IN/by the/DT/the page/NN/page size/NNP/size. ideally/RB/ideally /,/, the/DT/the working/VBG/working set/NN/set for/IN/for a/DT/a process/NN/process is/VBZ/is stored/VBN/stored in/IN/in the/DT/the tlb/NNP/tlb. if/IN/if it/PRP/it is/VBZ/is not/RB/not /,/, the/DT/the process/NN/process will/MD/will spend/VB/spend a/DT/a considerable/JJ/considerable amount/NN/amount of/IN/of time/NN/time resolving/VBG/resolving memory/NN/memory references/NNS/references in/IN/in the/DT/the page/NN/page table/NN/table rather/RB/rather than/IN/than the/DT/the tlb/NNP/tlb. if/IN/if we/PRP/we double/VBP/double the/DT/the number/NN/number of/IN/of entries/NNS/entries in/IN/in the/DT/the tlb/NN/tlb /,/, we/PRP/we double/JJ/double the/DT/the tlb/NN/tlb reach/NNP/reach. however/RB/however /,/, for/IN/for some/DT/some memory-intensive/JJ/memory-intensive applications/NNS/applications /,/, this/DT/this may/MD/may still/RB/still prove/VB/prove insufficient/NN/insufficient for/IN/for storing/NN/storing the/DT/the working/VBG/working set/NNP/set. another/DT/another approacl1/NNP/approacl1 for/IN/for increasing/VBG/increasing the/DT/the tlb/NN/tlb reach/NN/reach is/VBZ/is to/TO/to either/DT/either increase/NN/increase the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page or/CC/or provide/VB/provide multiple/JJ/multiple page/NN/page sizes/NNP/sizes. if/IN/if we/PRP/we increase/VBP/increase the/DT/the page/NN/page size-say/NN/size-say /,/, 402/CD/402 chapter/NN/chapter 9/CD/9 from/IN/from 8/CD/8 kb/NN/kb to/TO/to 32/CD/32 kb-we/JJ/kb-we quadruple/NN/quadruple the/DT/the tlb/NN/tlb reach/NNP/reach. however/RB/however /,/, this/DT/this may/MD/may lead/VB/lead to/TO/to an/DT/an increase/NN/increase in/IN/in fragmentation/NN/fragmentation for/IN/for some/DT/some applications/NNS/applications that/WDT/that do/VBP/do not/RB/not require/VB/require such/JJ/such a/DT/a large/JJ/large page/NN/page size/NN/size as/IN/as 32/CD/32 kb/NNP/kb. alternatively/RB/alternatively /,/, an/DT/an operating/NN/operating system/NN/system may/MD/may provide/VB/provide several/JJ/several different/JJ/different page/NN/page sizes/NNP/sizes. for/IN/for example/NN/example /,/, the/DT/the ultrasparc/NN/ultrasparc supports/NNS/supports page/NN/page sizes/NNS/sizes of/IN/of 8/CD/8 kb/NN/kb /,/, 64/CD/64 kb/NN/kb /,/, 512/CD/512 kb/NN/kb /,/, and/CC/and 4mb/CD/4mb. of/IN/of these/DT/these available/JJ/available pages/NNS/pages sizes/VBZ/sizes /,/, solaris/VBZ/solaris uses/NNS/uses both/DT/both 8-kb/CD/8-kb and/CC/and 4-mb/CD/4-mb page/NN/page sizes/NNP/sizes. and/CC/and with/IN/with a/DT/a 64-entry/JJ/64-entry tlb/NN/tlb /,/, the/DT/the tlb/NN/tlb reach/NN/reach for/IN/for solaris/NNS/solaris ranges/NNS/ranges from/IN/from 512/CD/512 kb/NN/kb with/IN/with 8-kb/CD/8-kb pages/NNS/pages to/TO/to 256mb/CD/256mb with/IN/with 4-mb/CD/4-mb pages/NNP/pages. for/IN/for the/DT/the majority/NN/majority of/IN/of applications/NNS/applications /,/, the/DT/the 8-kb/CD/8-kb page/NN/page size/NN/size is/VBZ/is sufficient/JJ/sufficient /,/, although/IN/although solaris/NNS/solaris maps/NNS/maps the/DT/the first/JJ/first 4/CD/4 mb/NN/mb of/IN/of kernel/NN/kernel code/NN/code and/CC/and data/NNS/data with/IN/with two/CD/two 4-mb/CD/4-mb pages/NNP/pages. solaris/VBZ/solaris also/RB/also allows/VBZ/allows applications-such/JJ/applications-such as/IN/as databases-to/JJ/databases-to take/NN/take advantage/NN/advantage of/IN/of the/DT/the large/JJ/large 4-mb/CD/4-mb page/NN/page size/NNP/size. providing/NN/providing support/NN/support for/IN/for multiple/NN/multiple page/NN/page sizes/VBZ/sizes requires/NNS/requires the/DT/the operating/NN/operating system/NN/system -not/NN/-not hardware-to/-NONE-/hardware-to manage/NN/manage the/DT/the tlb/NNP/tlb. for/IN/for example/NN/example /,/, one/CD/one of/IN/of the/DT/the fields/NNS/fields in/IN/in a/DT/a tlb/NN/tlb entry/NN/entry must/MD/must indicate/VB/indicate the/DT/the size/NN/size of/IN/of the/DT/the page/NN/page frame/NN/frame corresponding/VBG/corresponding to/TO/to the/DT/the tlb/NN/tlb entry/NNP/entry. managing/VBG/managing the/DT/the tlb/NN/tlb in/IN/in software/NN/software and/CC/and not/RB/not hardware/VB/hardware comes/VBZ/comes at/IN/at a/DT/a cost/NN/cost in/IN/in performance/NNP/performance. howeve1/NNP/howeve1 ~/NNP/~ the/DT/the increased/VBN/increased hit/NN/hit ratio/NN/ratio and/CC/and tlb/NN/tlb reach/NN/reach offset/NN/offset the/DT/the performance/NN/performance costs/NNP/costs. indeed/RB/indeed /,/, recent/JJ/recent trends/NNS/trends indicate/VBP/indicate a/DT/a move/NN/move toward/IN/toward softwaremanaged/JJ/softwaremanaged tlbs/NNS/tlbs and/CC/and operating-system/JJ/operating-system support/NN/support for/IN/for multiple/NN/multiple page/NN/page sizes/NNP/sizes. the/DT/the ultrasparc/NN/ultrasparc /,/, mips/NNS/mips /,/, and/CC/and alpha/NN/alpha architectures/NNS/architectures employ/VBP/employ software-managed/JJ/software-managed tlbs/NNP/tlbs. the/DT/the powerpc/NN/powerpc and/CC/and pentium/NN/pentium manage/NN/manage the/DT/the tlb/NN/tlb in/IN/in hardware/NNP/hardware. 9.9.4/CD/9.9.4 inverted/VBD/inverted page/NN/page tables/NNS/tables section/NN/section 8.5.3/CD/8.5.3 introduced/VBN/introduced the/DT/the concept/NN/concept of/IN/of the/DT/the inverted/JJ/inverted page/NN/page table/NNP/table. the/DT/the purpose/NN/purpose of/IN/of this/DT/this form/NN/form of/IN/of page/NN/page management/NN/management is/VBZ/is to/TO/to reduce/VB/reduce the/DT/the amount/NN/amount of/IN/of physical/JJ/physical memory/NN/memory needed/VBN/needed to/TO/to track/VB/track virtual-to-physical/JJ/virtual-to-physical address/NN/address translations/NNP/translations. we/PRP/we accomplish/VBP/accomplish this/DT/this savings/NNS/savings by/IN/by creating/VBG/creating a/DT/a table/JJ/table that/IN/that has/VBZ/has one/CD/one entry/NN/entry per/IN/per page/NN/page of/IN/of physical/JJ/physical memory/NN/memory /,/, indexed/VBN/indexed by/IN/by the/DT/the pair/NN/pair process-id/JJ/process-id /,/, page-number/JJ/page-number /./. because/IN/because they/PRP/they keep/VBP/keep information/NN/information about/IN/about which/WDT/which virtual/JJ/virtual memory/NN/memory page/NN/page is/VBZ/is stored/VBN/stored in/IN/in each/DT/each physical/JJ/physical frame/NN/frame /,/, inverted/VBD/inverted page/NN/page tables/NNS/tables reduce/VB/reduce the/DT/the amount/NN/amount of/IN/of physical/JJ/physical memory/NN/memory needed/VBN/needed to/TO/to store/VB/store this/DT/this information/NNP/information. however/RB/however /,/, the/DT/the inverted/JJ/inverted page/NN/page table/NN/table no/DT/no longer/NN/longer contains/VBZ/contains complete/JJ/complete information/NN/information about/IN/about the/DT/the logical/JJ/logical address/NN/address space/NN/space of/IN/of a/DT/a process/NN/process /,/, and/CC/and that/IN/that information/NN/information is/VBZ/is required/VBN/required if/IN/if a/DT/a referenced/VBN/referenced page/NN/page is/VBZ/is not/RB/not currently/RB/currently in/IN/in memory/NNP/memory. demand/NN/demand paging/VBG/paging requires/NNS/requires this/DT/this information/NN/information to/TO/to process/NN/process page/NN/page faults/NNP/faults. for/IN/for the/DT/the information/NN/information to/TO/to be/VB/be available/JJ/available /,/, an/DT/an external/JJ/external page/NN/page table/NN/table /:/( one/CD/one per/NN/per process/NN/process /:/) must/MD/must be/VB/be kept/NNP/kept. each/DT/each such/JJ/such table/JJ/table looks/NNS/looks like/IN/like the/DT/the traditional/JJ/traditional per-process/JJ/per-process page/NN/page table/NN/table and/CC/and contains/VBZ/contains information/NN/information on/IN/on where/WRB/where each/DT/each virtual/JJ/virtual page/NN/page is/VBZ/is located/NNP/located. but/CC/but do/VBP/do external/JJ/external page/NN/page tables/NNS/tables negate/VBP/negate the/DT/the utility/NN/utility of/IN/of inverted/JJ/inverted page/NN/page tables/NNS/tables since/IN/since these/DT/these tables/NNS/tables are/VBP/are referenced/VBN/referenced only/RB/only when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, they/PRP/they do/VBP/do not/RB/not need/VB/need to/TO/to be/VB/be available/JJ/available quickly/NNP/quickly. instead/RB/instead /,/, they/PRP/they are/VBP/are themselves/PRP/themselves paged/VBD/paged in/IN/in and/CC/and out/IN/out of/IN/of memory/NN/memory as/IN/as necessary/NNP/necessary. unfortunately/RB/unfortunately /,/, a/DT/a page/NN/page fault/NN/fault may/MD/may now/RB/now cause/VB/cause the/DT/the virtual/JJ/virtual memory/NN/memory n1.anager/NN/n1.anager to/TO/to generate/VB/generate another/DT/another page/NN/page fault/NN/fault as/IN/as it/PRP/it pages/VBZ/pages in/IN/in the/DT/the external/JJ/external page/NN/page table/NN/table it/PRP/it needs/VBZ/needs to/TO/to locate/VB/locate the/DT/the virtual/JJ/virtual page/NN/page on/IN/on the/DT/the backing/NN/backing store/NNP/store. this/DT/this special/JJ/special case/NN/case requires/VBZ/requires careful/JJ/careful handling/NN/handling in/IN/in the/DT/the kernel/NN/kernel and/CC/and a/DT/a delay/NN/delay in/IN/in the/DT/the page-lookup/JJ/page-lookup processing/NNP/processing. 9.9.5/CD/9.9.5 program/NN/program structure/NN/structure demand/NN/demand paging/VBG/paging is/VBZ/is designed/VBN/designed to/TO/to be/VB/be transparent/JJ/transparent to/TO/to the/DT/the user/NN/user program/NNP/program. in/IN/in many/JJ/many cases/NNS/cases /,/, the/DT/the user/NN/user is/VBZ/is completely/RB/completely unaware/JJ/unaware of/IN/of the/DT/the paged/JJ/paged nature/NN/nature of/IN/of memory/NNP/memory. in/IN/in other/JJ/other cases/NNS/cases /,/, however/RB/however /,/, system/NN/system performance/NN/performance can/MD/can be/VB/be improved/VBN/improved if/IN/if the/DT/the user/NN/user /:/( or/CC/or compiler/JJR/compiler /:/) has/VBZ/has an/DT/an awareness/NN/awareness of/IN/of the/DT/the underlying/VBG/underlying demand/NN/demand paging/NNP/paging. 9.9/CD/9.9 403/CD/403 let/NN/let 's/POS/'s look/NN/look at/IN/at a/DT/a contrived/VBN/contrived but/CC/but informative/JJ/informative example/NNP/example. assume/NN/assume that/WDT/that pages/VBZ/pages are/VBP/are 128/CD/128 words/NNS/words in/IN/in size/NNP/size. consider/NN/consider a/DT/a c/NN/c program/NN/program whose/WP$/whose function/NN/function is/VBZ/is to/TO/to initialize/VB/initialize to/TO/to 0/-NONE-/0 each/DT/each element/NN/element of/IN/of a/DT/a 128-by-128/CD/128-by-128 array/NNP/array. the/DT/the following/VBG/following code/NN/code is/VBZ/is typical/JJ/typical /:/: inti/NN/inti /,/, j/NN/j ;/:/; int/NN/int /:/[ 128j/CD/128j /CD/[ 128j/CD/128j data/NNS/data ;/:/; for/IN/for /CD/( j/NN/j =/:/= 0/-NONE-/0 ;/:/; j/NN/j 128/CD/128 ;/:/; j/NN/j +/:/+ +/:/+ /:/) for/IN/for /CD/( i/PRP/i =/VBP/= 0/-NONE-/0 ;/:/; i/PRP/i 128/CD/128 ;/:/; i/PRP/i +/VBP/+ +/:/+ /:/) data/NNS/data /VBP/[ ij/NN/ij /:/[ jj/NN/jj =/:/= 0/-NONE-/0 ;/:/; notice/NN/notice that/IN/that the/DT/the array/NN/array is/VBZ/is stored/VBN/stored row/NN/row major/JJ/major ;/:/; that/DT/that is/VBZ/is /,/, the/DT/the array/NN/array is/VBZ/is stored/VBN/stored data/NNS/data /:/[ oj/NN/oj /:/[ oj/NN/oj /,/, data/NNS/data /:/[ oj/NN/oj /:/[ 1j/CD/1j /,/, /,/, data/NNS/data /:/[ oj/NN/oj /:/[ 127j/CD/127j /,/, data/NNS/data /:/[ 1j/CD/1j /CD/[ oj/NN/oj /,/, data/NNS/data /:/[ 1j/CD/1j /CD/[ 1j/CD/1j /,/, /,/, data/NNS/data /:/[ 127j/CD/127j /CD/[ 127j/CD/127j. for/IN/for pages/NNS/pages of/IN/of 128/CD/128 words/NNS/words /,/, each/DT/each row/NN/row takes/VBZ/takes one/CD/one page/NNP/page. thus/RB/thus /,/, the/DT/the preceding/NN/preceding code/NN/code zeros/NNS/zeros one/CD/one word/NN/word in/IN/in each/DT/each page/NN/page /,/, then/RB/then another/DT/another word/NN/word in/IN/in each/DT/each page/NN/page /,/, and/CC/and so/RB/so on/NNP/on. if/IN/if the/DT/the operating/NN/operating system/NN/system allocates/VBZ/allocates fewer/JJR/fewer than/IN/than 128/CD/128 frames/NNS/frames to/TO/to the/DT/the entire/JJ/entire program/NN/program /,/, then/RB/then its/PRP$/its execution/NN/execution will/MD/will result/VB/result in/IN/in 128/CD/128 x/NN/x 128/CD/128 =/CD/= 16,384/CD/16,384 page/NN/page faults/NNP/faults. in/IN/in contrast/NN/contrast /,/, suppose/NN/suppose we/PRP/we change/VBP/change the/DT/the code/NN/code to/TO/to inti/VB/inti /,/, j/NN/j ;/:/; int/NN/int /:/[ 128j/CD/128j /CD/[ 128j/CD/128j data/NNS/data ;/:/; for/IN/for /CD/( i/PRP/i =/VBP/= 0/-NONE-/0 ;/:/; i/PRP/i 128/CD/128 ;/:/; i/PRP/i +/VBP/+ +/:/+ /:/) for/IN/for /CD/( j/NN/j =/:/= 0/-NONE-/0 ;/:/; j/NN/j 128/CD/128 ;/:/; j/NN/j +/:/+ +/:/+ /:/) data/NNS/data /VBP/[ ij/NN/ij /:/[ jj/NN/jj =/:/= 0/-NONE-/0 ;/:/; this/DT/this code/NN/code zeros/VBZ/zeros all/DT/all the/DT/the words/NNS/words on/IN/on one/CD/one page/NN/page before/IN/before starting/VBG/starting the/DT/the next/JJ/next page/NN/page /,/, reducing/VBG/reducing the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults to/TO/to 128/CD/128. careful/JJ/careful selection/NN/selection of/IN/of data/NNS/data structures/NNS/structures and/CC/and programming/NN/programming structures/NNS/structures can/MD/can increase/VB/increase locality/NN/locality and/CC/and hence/NN/hence lower/JJR/lower the/DT/the page-fault/JJ/page-fault rate/NN/rate and/CC/and the/DT/the number/NN/number of/IN/of pages/NNS/pages in/IN/in the/DT/the working/VBG/working set/NNP/set. for/IN/for example/NN/example /,/, a/DT/a stack/NN/stack has/VBZ/has good/JJ/good locality/NN/locality /,/, since/IN/since access/NN/access is/VBZ/is always/RB/always made/VBN/made to/TO/to the/DT/the top/NNP/top. a/DT/a hash/NN/hash table/NN/table /,/, in/IN/in contrast/NN/contrast /,/, is/VBZ/is designed/VBN/designed to/TO/to scatter/VB/scatter references/NNS/references /,/, producing/VBG/producing bad/JJ/bad locality/NNP/locality. of/IN/of course/NN/course /,/, locality/NN/locality of/IN/of reference/NN/reference is/VBZ/is just/RB/just one/CD/one measure/NN/measure of/IN/of the/DT/the efficiency/NN/efficiency of/IN/of the/DT/the use/NN/use of/IN/of a/DT/a data/NN/data structure/NNP/structure. other/JJ/other heavily/RB/heavily weighted/VBN/weighted factors/NNS/factors include/VBP/include search/NN/search speed/NN/speed /,/, total/JJ/total number/NN/number of/IN/of memory/NN/memory references/NNS/references /,/, and/CC/and total/JJ/total number/NN/number of/IN/of pages/NNS/pages touched/NNP/touched. at/IN/at a/DT/a later/JJ/later stage/NN/stage /,/, the/DT/the compiler/NN/compiler and/CC/and loader/NN/loader can/MD/can have/VB/have a/DT/a sigicificant/JJ/sigicificant effect/NN/effect on/IN/on paging/NNP/paging. separating/NN/separating code/NN/code and/CC/and data/NNS/data and/CC/and generating/VBG/generating reentrant/NN/reentrant code/NN/code means/VBZ/means that/DT/that code/NN/code pages/NNS/pages can/MD/can be/VB/be read-only/RB/read-only and/CC/and hence/NN/hence will/MD/will never/RB/never be/VB/be modified/NNP/modified. clean/NN/clean pages/NNS/pages do/VBP/do not/RB/not have/VB/have to/TO/to be/VB/be paged/VBN/paged out/RP/out to/TO/to be/VB/be replaced/NNP/replaced. the/DT/the loader/NN/loader can/MD/can avoid/VB/avoid placing/VBG/placing routines/NNS/routines across/IN/across page/NN/page boundaries/NNS/boundaries /,/, keeping/VBG/keeping each/DT/each routine/NN/routine completely/RB/completely in/IN/in one/CD/one page/NNP/page. routines/NNS/routines that/WDT/that call/NN/call each/DT/each other/JJ/other many/JJ/many times/NNS/times can/MD/can be/VB/be packed/VBN/packed into/IN/into the/DT/the same/JJ/same page/NNP/page. this/DT/this packaging/NN/packaging is/VBZ/is a/DT/a variant/JJ/variant of/IN/of the/DT/the bin-packing/JJ/bin-packing problem/NN/problem of/IN/of operations/NNS/operations research/NN/research /:/: try/NN/try to/TO/to pack/VB/pack the/DT/the variable-sized/JJ/variable-sized load/NN/load segments/NNS/segments into/IN/into the/DT/the fixed-sized/JJ/fixed-sized pages/NNS/pages so/IN/so that/IN/that interpage/NN/interpage references/NNS/references are/VBP/are minimized/NNP/minimized. such/JJ/such an/DT/an approach/NN/approach is/VBZ/is particularly/RB/particularly useful/JJ/useful for/IN/for large/JJ/large page/NN/page sizes/NNP/sizes. the/DT/the choice/NN/choice of/IN/of programming/NN/programming language/NN/language can/MD/can affect/VB/affect paging/VBG/paging as/IN/as well/NNP/well. for/IN/for example/NN/example /,/, c/NN/c and/CC/and c/NN/c +/:/+ +/:/+ use/NN/use pointers/NNS/pointers frequently/RB/frequently /,/, and/CC/and pointers/NNS/pointers tend/VBP/tend to/TO/to randomize/VB/randomize access/NN/access to/TO/to memory/NN/memory /,/, thereby/RB/thereby potentially/RB/potentially diminishing/VBG/diminishing a/DT/a process/NN/process 's/POS/'s locality/NNP/locality. some/DT/some studies/NNS/studies have/VBP/have shown/VBN/shown that/IN/that object-oriented/JJ/object-oriented programs/NNS/programs also/RB/also tend/VBP/tend to/TO/to have/VB/have a/DT/a poor/JJ/poor locality/NN/locality of/IN/of reference/NNP/reference. 404/CD/404 chapter/NN/chapter 9/CD/9 9.9.6/CD/9.9.6 1/0/CD/1/0 interlock/NN/interlock when/WRB/when demand/NN/demand paging/VBG/paging is/VBZ/is used/VBN/used /,/, we/PRP/we sometimes/RB/sometimes need/VBP/need to/TO/to allow/VB/allow some/DT/some of/IN/of the/DT/the pages/NNS/pages to/TO/to be/VB/be in/IN/in n/NN/n emory/NNP/emory. one/CD/one such/JJ/such situation/NN/situation occurs/NNS/occurs when/WRB/when i/0/-NONE-/i/0 is/VBZ/is done/VBN/done to/TO/to or/CC/or from/IN/from user/NN/user /:/( virtual/JJ/virtual /NN/) memory/NNP/memory. l/0/-NONE-/l/0 is/VBZ/is often/RB/often implemented/VBN/implemented by/IN/by a/DT/a separate/JJ/separate i/0/NN/i/0 processor/NNP/processor. for/IN/for example/NN/example /,/, a/DT/a controller/NN/controller for/IN/for a/DT/a usb/NN/usb storage/NN/storage device/NN/device is/VBZ/is generally/RB/generally given/VBN/given the/DT/the number/NN/number of/IN/of bytes/NNS/bytes to/TO/to transfer/VB/transfer and/CC/and a/DT/a memory/NN/memory address/NN/address for/IN/for the/DT/the buffer/NN/buffer /:/( figure/NN/figure 9.29/CD/9.29 /CD/) /./. when/WRB/when the/DT/the transfer/NN/transfer is/VBZ/is complete/JJ/complete /,/, the/DT/the cpu/NN/cpu is/VBZ/is interrupted/NNP/interrupted. we/PRP/we must/MD/must be/VB/be sure/JJ/sure the/DT/the following/VBG/following sequence/NN/sequence of/IN/of events/NNS/events does/VBZ/does not/RB/not occur/VB/occur /:/: a/DT/a process/NN/process issues/NNS/issues an/DT/an i/0/-NONE-/i/0 request/NN/request and/CC/and is/VBZ/is put/VBN/put in/RP/in a/DT/a queue/NN/queue for/IN/for that/DT/that i/o/JJ/i/o device/NNP/device. meanwhile/RB/meanwhile /,/, the/DT/the cpu/NN/cpu is/VBZ/is given/VBN/given to/TO/to other/JJ/other processes/NNP/processes. these/DT/these processes/NNS/processes cause/VBP/cause page/NN/page faults/NNS/faults ;/:/; and/CC/and one/CD/one of/IN/of them/PRP/them /,/, using/VBG/using a/DT/a global/JJ/global replacement/NN/replacement algorithm/NN/algorithm /,/, replaces/NNS/replaces the/DT/the page/NN/page containing/VBG/containing the/DT/the memory/NN/memory buffer/NN/buffer for/IN/for the/DT/the waiting/VBG/waiting process/NNP/process. the/DT/the pages/NNS/pages are/VBP/are paged/VBN/paged out/NNP/out. some/DT/some time/NN/time later/JJ/later /,/, when/WRB/when the/DT/the i/o/NNP/i/o request/NN/request advances/NNS/advances to/TO/to the/DT/the head/NN/head of/IN/of the/DT/the device/NN/device queue/NN/queue /,/, the/DT/the i/o/NNP/i/o occurs/VBZ/occurs to/TO/to the/DT/the specified/VBN/specified address/NNP/address. however/RB/however /,/, this/DT/this frame/NN/frame is/VBZ/is now/RB/now being/VBG/being used/VBN/used for/IN/for a/DT/a different/JJ/different page/NN/page belonging/VBG/belonging to/TO/to another/DT/another process/NNP/process. there/RB/there are/VBP/are two/CD/two common/JJ/common solutions/NNS/solutions to/TO/to this/DT/this problem/NNP/problem. one/CD/one solution/NN/solution is/VBZ/is never/RB/never to/TO/to execute/VB/execute i/0/-NONE-/i/0 to/TO/to user/VB/user memory/NNP/memory. instead/RB/instead /,/, data/NNS/data are/VBP/are always/RB/always copied/VBN/copied between/IN/between system/NN/system memory/NN/memory and/CC/and user/NN/user memory/NNP/memory. i/0/-NONE-/i/0 takes/VBZ/takes place/NN/place only/RB/only between/IN/between system/NN/system memory/NN/memory and/CC/and the/DT/the i/0/NNP/i/0 device/NNP/device. to/TO/to write/VB/write a/DT/a block/NN/block on/IN/on tape/NN/tape /,/, we/PRP/we first/RB/first copy/VBP/copy the/DT/the block/NN/block to/TO/to system/NN/system memory/NN/memory and/CC/and then/RB/then write/VB/write it/PRP/it to/TO/to tape/NNP/tape. this/DT/this extra/JJ/extra copying/NN/copying may/MD/may result/VB/result in/IN/in unacceptably/RB/unacceptably high/JJ/high overhead/NNP/overhead. another/DT/another solution/NN/solution is/VBZ/is to/TO/to allow/VB/allow pages/NNS/pages to/TO/to be/VB/be locked/VBN/locked into/IN/into memory/NNP/memory. here/RB/here /,/, a/DT/a lock/NN/lock bit/NN/bit is/VBZ/is associated/VBN/associated with/IN/with every/DT/every frame/NNP/frame. if/IN/if the/DT/the frame/NN/frame is/VBZ/is locked/VBN/locked /,/, it/PRP/it can/MD/can not/RB/not be/VB/be selected/VBN/selected for/IN/for replacement/NNP/replacement. under/IN/under this/DT/this approach/NN/approach /,/, to/TO/to write/VB/write a/DT/a block/NN/block on/IN/on tape/NN/tape /,/, we/PRP/we lock/VBP/lock into/IN/into memory/NN/memory the/DT/the pages/NNS/pages containing/VBG/containing the/DT/the block/NNP/block. the/DT/the system/NN/system can/MD/can then/RB/then continue/VB/continue as/IN/as usual/NNP/usual. locked/VBD/locked pages/NNS/pages can/MD/can not/RB/not be/VB/be replaced/NNP/replaced. when/WRB/when the/DT/the i/o/NNP/i/o is/VBZ/is complete/JJ/complete /,/, the/DT/the pages/NNS/pages are/VBP/are unlocked/NNP/unlocked. figure/NN/figure 9.29/CD/9.29 the/DT/the reason/NN/reason why/WRB/why frames/NNS/frames used/VBN/used for/IN/for 1/0/CD/1/0 must/MD/must be/VB/be in/IN/in memory/NNP/memory. 9.10/CD/9.10 9.10/CD/9.10 405/CD/405 lock/NN/lock bits/NNS/bits are/VBP/are used/VBN/used in/IN/in various/JJ/various situations/NNP/situations. frequently/RB/frequently /,/, some/DT/some or/CC/or all/DT/all of/IN/of the/DT/the operating-system/JJ/operating-system kernel/NN/kernel is/VBZ/is locked/VBN/locked into/IN/into memory/NN/memory /,/, as/IN/as many/JJ/many operating/NN/operating systems/NNS/systems can/MD/can not/RB/not tolerate/VB/tolerate a/DT/a page/NN/page fault/NN/fault caused/VBD/caused by/IN/by the/DT/the kernel/NNP/kernel. another/DT/another use/NN/use for/IN/for a/DT/a lock/NN/lock bit/NN/bit involves/VBZ/involves normal/JJ/normal page/NN/page replacement/NNP/replacement. consider/NN/consider the/DT/the following/VBG/following sequence/NN/sequence of/IN/of events/NNS/events /:/: a/DT/a low-priority/NN/low-priority process/NN/process faults/NNP/faults. selecting/NN/selecting a/DT/a replacement/NN/replacement frame/NN/frame /,/, the/DT/the paging/NN/paging system/NN/system reads/NNS/reads the/DT/the necessary/JJ/necessary page/NN/page into/IN/into memory/NNP/memory. ready/JJ/ready to/TO/to continue/VB/continue /,/, the/DT/the low-priority/NN/low-priority process/NN/process enters/NNS/enters the/DT/the ready/JJ/ready queue/NN/queue and/CC/and waits/NNS/waits for/IN/for the/DT/the cpu/NNP/cpu. since/IN/since it/PRP/it is/VBZ/is a/DT/a low-priority/NN/low-priority process/NN/process /,/, it/PRP/it may/MD/may not/RB/not be/VB/be selected/VBN/selected by/IN/by the/DT/the cpu/NN/cpu scheduler/NN/scheduler for/IN/for a/DT/a time/NNP/time. while/IN/while the/DT/the low-priority/NN/low-priority process/NN/process waits/NNS/waits /,/, a/DT/a high-priority/NN/high-priority process/NN/process faults/NNP/faults. looking/NN/looking for/IN/for a/DT/a replacement/NN/replacement /,/, the/DT/the paging/NN/paging system/NN/system sees/NNS/sees a/DT/a page/NN/page that/WDT/that is/VBZ/is in/IN/in memory/NN/memory but/CC/but has/VBZ/has not/RB/not been/VBN/been referenced/VBN/referenced or/CC/or modified/VBN/modified /:/: it/PRP/it is/VBZ/is the/DT/the page/NN/page that/IN/that the/DT/the low-priority/NN/low-priority process/NN/process just/RB/just brought/VBD/brought in/NNP/in. this/DT/this page/NN/page looks/VBZ/looks like/IN/like a/DT/a perfect/NN/perfect replacement/NN/replacement /:/: it/PRP/it is/VBZ/is clean/JJ/clean and/CC/and will/MD/will not/RB/not need/VB/need to/TO/to be/VB/be written/VBN/written out/RP/out /,/, and/CC/and it/PRP/it apparently/RB/apparently has/VBZ/has not/RB/not been/VBN/been used/VBN/used for/IN/for a/DT/a long/JJ/long time/NNP/time. whether/IN/whether the/DT/the high-priority/NN/high-priority process/NN/process should/MD/should be/VB/be able/JJ/able to/TO/to replace/VB/replace the/DT/the low-priority/NN/low-priority process/NN/process is/VBZ/is a/DT/a policy/NN/policy decision/NNP/decision. after/IN/after all/DT/all /,/, we/PRP/we are/VBP/are simply/RB/simply delaying/VBG/delaying the/DT/the low-priority/NN/low-priority process/NN/process for/IN/for the/DT/the benefit/NN/benefit of/IN/of the/DT/the high-priority/NN/high-priority process/NNP/process. however/RB/however /,/, we/PRP/we are/VBP/are wasting/VBG/wasting the/DT/the effort/NN/effort spent/NN/spent to/TO/to bring/VB/bring in/IN/in the/DT/the page/NN/page for/IN/for the/DT/the low-priority/NN/low-priority process/NNP/process. if/IN/if we/PRP/we decide/VBP/decide to/TO/to prevent/VB/prevent replacement/NN/replacement of/IN/of a/DT/a newly/RB/newly brought-in/JJ/brought-in page/NN/page until/IN/until it/PRP/it can/MD/can be/VB/be used/VBN/used at/IN/at least/JJS/least once/RB/once /,/, then/RB/then we/PRP/we can/MD/can use/VB/use the/DT/the lock/NN/lock bit/NN/bit to/TO/to implement/VB/implement this/DT/this mechanism/NNP/mechanism. when/WRB/when a/DT/a page/NN/page is/VBZ/is selected/VBN/selected for/IN/for replacement/NN/replacement /,/, its/PRP$/its lock/NN/lock bit/NN/bit is/VBZ/is turned/VBN/turned on/IN/on ;/:/; it/PRP/it remains/VBZ/remains on/IN/on until/IN/until the/DT/the faulting/NN/faulting process/NN/process is/VBZ/is again/RB/again dispatched/NNP/dispatched. using/VBG/using a/DT/a lock/NN/lock bit/NN/bit can/MD/can be/VB/be dangerous/JJ/dangerous /:/: the/DT/the lock/NN/lock bit/NN/bit may/MD/may get/VB/get turned/VBN/turned on/IN/on but/CC/but never/RB/never turned/VBD/turned off/NNP/off. should/MD/should this/DT/this situation/NN/situation occur/NN/occur /:/( because/IN/because of/IN/of a/DT/a bug/NN/bug in/IN/in the/DT/the operating/NN/operating system/NN/system /,/, for/IN/for example/NN/example /:/) /,/, the/DT/the locked/VBN/locked frame/NN/frame becomes/VBZ/becomes unusable/NNP/unusable. on/IN/on a/DT/a single-user/JJ/single-user system/NN/system /,/, the/DT/the overuse/NN/overuse of/IN/of locking/VBG/locking would/MD/would hurt/VB/hurt only/RB/only the/DT/the user/NN/user doing/VBG/doing the/DT/the locking/NNP/locking. multiuser/NN/multiuser systems/NNS/systems must/MD/must be/VB/be less/RBR/less trusting/VBG/trusting of/IN/of users/NNP/users. for/IN/for instance/NN/instance /,/, solaris/VBZ/solaris allows/VBZ/allows locking/VBG/locking hints/NNS/hints /,/, but/CC/but it/PRP/it is/VBZ/is free/JJ/free to/TO/to disregard/VB/disregard these/DT/these hints/NNS/hints if/IN/if the/DT/the free-frame/JJ/free-frame pool/NN/pool becomes/VBZ/becomes too/RB/too small/JJ/small or/CC/or if/IN/if an/DT/an individual/NN/individual process/NN/process requests/NNS/requests that/WDT/that too/RB/too many/JJ/many pages/NNS/pages be/VB/be locked/VBN/locked in/IN/in memory/NNP/memory. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we describe/VBP/describe how/WRB/how windows/NNS/windows xp/VBP/xp and/CC/and solaris/NNS/solaris implement/NN/implement virtual/JJ/virtual memory/NNP/memory. 9.10.1/CD/9.10.1 windows/VBZ/windows xp/NN/xp windows/VBZ/windows xp/NN/xp implements/NNS/implements virtual/JJ/virtual memory/NN/memory using/VBG/using demand/NN/demand paging/VBG/paging with/IN/with clustering/VBG/clustering handles/NNS/handles page/NN/page faults/NNS/faults by/IN/by bringing/VBG/bringing in/IN/in not/RB/not only/RB/only the/DT/the faultil1.g/JJ/faultil1.g page/NN/page also/RB/also several/JJ/several pages/NNS/pages following/VBG/following the/DT/the faulting/NN/faulting page/NNP/page. when/WRB/when a/DT/a process/NN/process is/VBZ/is first/JJ/first created/VBN/created /,/, it/PRP/it is/VBZ/is assigned/VBN/assigned a/DT/a working-set/JJ/working-set minimum/JJ/minimum and/CC/and maximum/NNP/maximum. the/DT/the is/VBZ/is the/DT/the minimum/JJ/minimum number/NN/number of/IN/of pages/NNS/pages the/DT/the process/NN/process is/VBZ/is guaranteed/VBN/guaranteed to/TO/to in/IN/in memory/NNP/memory. if/IN/if sufficient/NN/sufficient memory/NN/memory is/VBZ/is available/JJ/available /,/, a/DT/a process/NN/process may/MD/may be/VB/be assigned/VBN/assigned as/IN/as many/JJ/many pages/NNS/pages as/IN/as its/PRP$/its for/IN/for most/JJS/most applications/NNS/applications /,/, the/DT/the value/NN/value of/IN/of working-set/JJ/working-set minimum/JJ/minimum and/CC/and working-set/JJ/working-set maximum/NN/maximum is/VBZ/is 50/CD/50 and/CC/and 345/CD/345 pages/NNS/pages /,/, respectively/NNP/respectively. /NNP/( in/IN/in some/DT/some circumstances/NNS/circumstances /,/, a/DT/a process/NN/process may/MD/may be/VB/be allowed/VBN/allowed to/TO/to exceed/VB/exceed its/PRP$/its working-set/JJ/working-set maximum/NNP/maximum. /NNP/) the/DT/the virtual/JJ/virtual memory/NN/memory manager/NN/manager maintains/VBZ/maintains a/DT/a list/NN/list of/IN/of free/JJ/free page/NN/page frames/NNP/frames. associated/VBD/associated with/IN/with this/DT/this list/NN/list is/VBZ/is a/DT/a threshold/NN/threshold value/NN/value that/WDT/that is/VBZ/is used/VBN/used to/TO/to 406/CD/406 chapter/NN/chapter 9/CD/9 indicate/NN/indicate whether/IN/whether sufficient/NN/sufficient free/JJ/free memory/NN/memory is/VBZ/is available/NNP/available. if/IN/if a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs for/IN/for a/DT/a process/NN/process that/WDT/that is/VBZ/is below/IN/below its/PRP$/its working-set/JJ/working-set maximum/NN/maximum /,/, the/DT/the virtual/JJ/virtual memory/NN/memory manager/NN/manager allocates/VBZ/allocates a/DT/a page/NN/page from/IN/from this/DT/this list/NN/list of/IN/of free/JJ/free pages/NNP/pages. if/IN/if a/DT/a process/NN/process that/WDT/that is/VBZ/is at/IN/at its/PRP$/its working-set/JJ/working-set rnaximum/NN/rnaximum incurs/NNS/incurs a/DT/a page/NN/page fault/NN/fault /,/, it/PRP/it must/MD/must select/VB/select a/DT/a page/NN/page for/IN/for replacement/NN/replacement using/VBG/using a/DT/a local/JJ/local page-replacement/JJ/page-replacement policy/NNP/policy. when/WRB/when the/DT/the amount/NN/amount of/IN/of free/JJ/free memory/NN/memory falls/NNS/falls below/IN/below the/DT/the threshold/NN/threshold /,/, the/DT/the virtual/JJ/virtual memory/NN/memory manager/NN/manager uses/NNS/uses a/DT/a tactic/JJ/tactic known/NN/known as/IN/as to/TO/to restore/VB/restore the/DT/the value/NN/value above/IN/above the/DT/the threshold/NNP/threshold. automatic/JJ/automatic working-set/JJ/working-set trimming/NN/trimming works/NNS/works by/IN/by evaluating/VBG/evaluating the/DT/the number/NN/number of/IN/of pages/NNS/pages allocated/VBN/allocated to/TO/to processes/NNP/processes. if/IN/if a/DT/a process/NN/process has/VBZ/has been/VBN/been allocated/VBN/allocated more/RBR/more pages/NNS/pages than/IN/than its/PRP$/its working-set/JJ/working-set minimum/JJ/minimum /,/, the/DT/the virtual/JJ/virtual memory/NN/memory manager/NN/manager removes/NNS/removes pages/NNS/pages until/IN/until the/DT/the process/NN/process reaches/VBZ/reaches its/PRP$/its working-set/JJ/working-set minimum/NNP/minimum. a/DT/a process/NN/process that/WDT/that is/VBZ/is at/IN/at its/PRP$/its working-set/JJ/working-set minimum/JJ/minimum may/MD/may be/VB/be allocated/VBN/allocated pages/NNS/pages from/IN/from the/DT/the free-page-frame/JJ/free-page-frame list/NN/list once/RB/once sufficient/JJ/sufficient free/JJ/free memory/NN/memory is/VBZ/is available/NNP/available. the/DT/the algorithm/NN/algorithm used/VBD/used to/TO/to determine/VB/determine which/WDT/which page/NN/page to/TO/to remove/VB/remove from/IN/from a/DT/a working/VBG/working set/NN/set depends/NNS/depends on/IN/on the/DT/the type/NN/type of/IN/of processor/NNP/processor. on/IN/on single-processor/NNP/single-processor 80x86/CD/80x86 systems/NNS/systems /,/, windows/VBZ/windows xp/NN/xp uses/NNS/uses a/DT/a variation/NN/variation of/IN/of the/DT/the clock/NN/clock algorithm/NN/algorithm discussed/VBD/discussed in/IN/in section/NN/section 9.4.5.2/CD/9.4.5.2. on/IN/on alpha/NN/alpha and/CC/and multiprocessor/NN/multiprocessor x86/NNP/x86 systems/NNS/systems /,/, clearing/VBG/clearing the/DT/the reference/NN/reference bit/NN/bit may/MD/may require/VB/require invalidatil/NN/invalidatil g/NN/g the/DT/the entry/NN/entry in/IN/in the/DT/the translation/NN/translation look-aside/JJ/look-aside buffer/NN/buffer on/IN/on other/JJ/other processors/NNP/processors. rather/RB/rather than/IN/than incurring/VBG/incurring this/DT/this overhead/NN/overhead /,/, windows/VBZ/windows xp/NN/xp uses/NNS/uses a/DT/a variation/NN/variation on/IN/on the/DT/the fifo/NN/fifo algorithm/NN/algorithm discussed/VBD/discussed in/IN/in section/NN/section 9.4.2/CD/9.4.2. 9.10.2/CD/9.10.2 solaris/NNS/solaris in/IN/in solaris/NNS/solaris /,/, when/WRB/when a/DT/a thread/NN/thread incurs/NNS/incurs a/DT/a page/NN/page fault/NN/fault /,/, the/DT/the kernel/NN/kernel assigns/NNS/assigns a/DT/a page/NN/page to/TO/to the/DT/the faulting/NN/faulting thread/NN/thread from/IN/from the/DT/the list/NN/list of/IN/of free/JJ/free pages/NNS/pages it/PRP/it maintains/NNP/maintains. therefore/RB/therefore /,/, it/PRP/it is/VBZ/is imperative/JJ/imperative that/IN/that the/DT/the kernel/NN/kernel keep/VB/keep a/DT/a sufficient/NN/sufficient amount/NN/amount of/IN/of free/JJ/free memory/NN/memory available/NNP/available. associated/VBD/associated with/IN/with this/DT/this list/NN/list of/IN/of free/JJ/free pages/NNS/pages is/VBZ/is a/DT/a parameter-zotsfree-that/JJ/parameter-zotsfree-that represents/NNS/represents a/DT/a threshold/NN/threshold to/TO/to begin/VB/begin paging/NNP/paging. the/DT/the lotsfree/NN/lotsfree parameter/NN/parameter is/VBZ/is typically/RB/typically set/VBN/set to/TO/to 1/64/CD/1/64 the/DT/the size/NN/size of/IN/of the/DT/the physical/JJ/physical memory/NNP/memory. four/CD/four times/NNS/times per/IN/per second/JJ/second /,/, the/DT/the kernel/NN/kernel checks/NNS/checks whether/IN/whether the/DT/the amount/NN/amount of/IN/of free/JJ/free memory/NN/memory is/VBZ/is less/JJR/less than/IN/than lotsfree/NNP/lotsfree. if/IN/if the/DT/the number/NN/number of/IN/of free/JJ/free pages/NNS/pages falls/NNS/falls below/IN/below lotsfree/JJ/lotsfree /,/, a/DT/a process/NN/process known/VBN/known as/IN/as a/DT/a pageout/NN/pageout starts/VBZ/starts up/NNP/up. the/DT/the pageout/NN/pageout process/NN/process is/VBZ/is similar/JJ/similar to/TO/to the/DT/the second-chance/NN/second-chance algorithm/NN/algorithm described/VBD/described in/IN/in section/NN/section 9.4.5.2/CD/9.4.5.2 /,/, except/IN/except that/DT/that it/PRP/it uses/VBZ/uses two/CD/two hands/NNS/hands while/IN/while scanning/VBG/scanning pages/NNS/pages /,/, rather/RB/rather than/IN/than one/NNP/one. the/DT/the pageout/NN/pageout process/NN/process works/NNS/works as/IN/as follows/NNS/follows /:/: the/DT/the front/NN/front hand/NN/hand of/IN/of the/DT/the clock/NN/clock scans/NNS/scans all/DT/all pages/NNS/pages in/IN/in memory/NN/memory /,/, setting/VBG/setting the/DT/the reference/NN/reference bit/NN/bit to/TO/to 0/CD/0. later/JJ/later /,/, the/DT/the back/NN/back hand/NN/hand of/IN/of the/DT/the clock/NN/clock examines/NNS/examines the/DT/the reference/NN/reference bit/NN/bit for/IN/for the/DT/the pages/NNS/pages in/IN/in memory/NN/memory /,/, appending/VBG/appending each/DT/each page/NN/page whose/WP$/whose reference/NN/reference bit/NN/bit is/VBZ/is still/RB/still set/VBN/set to/TO/to 0/-NONE-/0 to/TO/to the/DT/the free/JJ/free list/NN/list and/CC/and writing/VBG/writing to/TO/to disk/VB/disk its/PRP$/its contents/NNS/contents if/IN/if modified/NNP/modified. solaris/VBZ/solaris maintains/NNS/maintains a/DT/a cache/NN/cache list/NN/list of/IN/of pages/NNS/pages that/WDT/that have/VBP/have been/VBN/been freed/VBN/freed but/CC/but have/VBP/have not/RB/not yet/RB/yet been/VBN/been overwritten/NNP/overwritten. the/DT/the free/JJ/free list/NN/list contains/NNS/contains frames/VBZ/frames that/IN/that have/VBP/have invalid/VBN/invalid contents/NNP/contents. pages/NNS/pages can/MD/can be/VB/be reclaimed/VBN/reclaimed from/IN/from the/DT/the cache/NN/cache list/NN/list if/IN/if they/PRP/they are/VBP/are accessed/VBN/accessed before/IN/before being/VBG/being moved/VBN/moved to/TO/to the/DT/the free/JJ/free list/NNP/list. the/DT/the pageout/NN/pageout algorithm/NN/algorithm uses/NNS/uses several/JJ/several parameters/NNS/parameters to/TO/to control/NN/control the/DT/the rate/NN/rate at/IN/at which/WDT/which pages/NNS/pages are/VBP/are scam/NN/scam ed/VBN/ed /-NONE-/( known/VBN/known as/IN/as the/DT/the scanrate/NN/scanrate /:/) /./. the/DT/the scanrate/NN/scanrate is/VBZ/is expressed/VBN/expressed in/IN/in pages/NNS/pages per/IN/per second/JJ/second and/CC/and ranges/NNS/ranges from/IN/from slowscan/JJ/slowscan to/TO/to fastscan/NNP/fastscan. when/WRB/when free/JJ/free memory/NN/memory falls/NNS/falls below/IN/below lotsfree/JJ/lotsfree /,/, scanning/VBG/scanning occurs/NNS/occurs at/IN/at slowscan/JJ/slowscan pages/NNS/pages per/IN/per second/JJ/second and/CC/and progresses/NNS/progresses to/TO/to fastscan/VB/fastscan /,/, depending/VBG/depending on/IN/on the/DT/the amount/NN/amount of/IN/of free/JJ/free memory/NN/memory available/NNP/available. the/DT/the default/NN/default value/NN/value of/IN/of slowscan/NN/slowscan is/VBZ/is 100/CD/100 pages/NNS/pages per/IN/per second/JJ/second ;/:/; fasts/NNS/fasts can/MD/can is/VBZ/is typically/RB/typically set/VBN/set to/TO/to the/DT/the value/NN/value /:/( total/JJ/total physical/JJ/physical pages/NNS/pages /:/) /2/-NONE-//2 pages/NNS/pages per/IN/per second/JJ/second /,/, with/IN/with a/DT/a maximum/NN/maximum of/IN/of 8,192/CD/8,192 pages/NNS/pages per/IN/per second/NNP/second. this/DT/this is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 9.30/CD/9.30 /CD/( withfastscan/NN/withfastscan set/NN/set to/TO/to the/DT/the maximum/NN/maximum /:/) /./. the/DT/the distance/NN/distance /:/( in/IN/in pages/NNS/pages /:/) between/IN/between the/DT/the hands/NNS/hands of/IN/of the/DT/the clock/NN/clock is/VBZ/is determil/NN/determil ed/VBN/ed by/IN/by a/DT/a system/NN/system parameter/NN/parameter /,/, handspread/NNP/handspread. the/DT/the amount/NN/amount of/IN/of time/NN/time between/IN/between the/DT/the front/NN/front hand/NN/hand 's/POS/'s 9.11/CD/9.11 8192/CD/8192 fastscan/NN/fastscan cll/NN/cll 7/CD/7 c/NN/c /:/( 1j/CD/1j u/NN/u en/NN/en 100/CD/100 slowscan/NN/slowscan minfree/NN/minfree desfree/NN/desfree amount/NN/amount of/IN/of free/JJ/free memory/NN/memory figure/NN/figure 9.30/CD/9.30 solaris/NNS/solaris page/NN/page scanner/NNP/scanner. 9.11/CD/9.11 407/CD/407 lotsfree/CD/lotsfree clearing/VBG/clearing a/DT/a bit/NN/bit and/CC/and the/DT/the back/NN/back hand/NN/hand 's/POS/'s investigating/NN/investigating its/PRP$/its value/NN/value depends/NNS/depends on/IN/on the/DT/the scanrate/NN/scanrate and/CC/and the/DT/the handspread/NNP/handspread. if/IN/if scam-ate/JJ/scam-ate is/VBZ/is 100/CD/100 pages/NNS/pages per/IN/per second/JJ/second and/CC/and handspread/JJ/handspread is/VBZ/is 1,024/CD/1,024 pages/NNS/pages /,/, 10/CD/10 seconds/NNS/seconds can/MD/can pass/VB/pass between/IN/between the/DT/the time/NN/time a/DT/a bit/NN/bit is/VBZ/is set/VBN/set by/IN/by the/DT/the front/NN/front hand/NN/hand and/CC/and the/DT/the time/NN/time it/PRP/it is/VBZ/is checked/VBN/checked by/IN/by the/DT/the back/NN/back hand/NNP/hand. however/RB/however /,/, because/IN/because of/IN/of the/DT/the demands/NNS/demands placed/VBD/placed on/IN/on the/DT/the memory/NN/memory system/NN/system /,/, a/DT/a scanrate/NN/scanrate of/IN/of several/JJ/several thousand/CD/thousand is/VBZ/is not/RB/not uncommon/NNP/uncommon. this/DT/this means/VBZ/means that/IN/that the/DT/the amount/NN/amount of/IN/of time/NN/time between/IN/between clearing/VBG/clearing and/CC/and investigating/VBG/investigating a/DT/a bit/NN/bit is/VBZ/is often/RB/often a/DT/a few/JJ/few seconds/NNP/seconds. as/IN/as mentioned/VBN/mentioned above/IN/above /,/, the/DT/the pageout/NN/pageout process/NN/process checks/NNS/checks memory/NN/memory four/CD/four times/NNS/times per/IN/per second/NNP/second. however/RB/however /,/, if/IN/if free/JJ/free memory/NN/memory falls/NNS/falls below/IN/below desfree/JJ/desfree /NN/( figure/NN/figure 9.30/CD/9.30 /CD/) /,/, pageout/IN/pageout will/MD/will nm/VB/nm 100/CD/100 times/NNS/times per/IN/per second/JJ/second with/IN/with the/DT/the intention/NN/intention of/IN/of keeping/VBG/keeping at/IN/at least/JJS/least desfree/JJ/desfree free/JJ/free memory/NN/memory available/NNP/available. if/IN/if the/DT/the pageout/NN/pageout process/NN/process is/VBZ/is unable/JJ/unable to/TO/to keep/VB/keep the/DT/the amount/NN/amount of/IN/of free/JJ/free memory/NN/memory at/IN/at desfree/NN/desfree for/IN/for a/DT/a 30-second/JJ/30-second average/NN/average /,/, the/DT/the kernel/NN/kernel begins/VBZ/begins swapping/VBG/swapping processes/NNS/processes /,/, thereby/RB/thereby freeing/VBG/freeing all/DT/all pages/NNS/pages allocated/VBN/allocated to/TO/to swapped/VBN/swapped processes/NNP/processes. in/IN/in general/JJ/general /,/, the/DT/the kernel/NN/kernel looks/VBZ/looks for/IN/for processes/NNS/processes that/WDT/that have/VBP/have been/VBN/been idle/JJ/idle for/IN/for long/RB/long periods/NNS/periods of/IN/of time/NNP/time. if/IN/if the/DT/the system/NN/system is/VBZ/is unable/JJ/unable to/TO/to maintain/VB/maintain the/DT/the amount/NN/amount of/IN/of free/JJ/free memory/NN/memory at/IN/at minfree/NN/minfree /,/, the/DT/the pageout/NN/pageout process/NN/process is/VBZ/is called/VBN/called for/IN/for every/DT/every request/NN/request for/IN/for a/DT/a new/JJ/new page/NNP/page. recent/JJ/recent releases/NNS/releases of/IN/of the/DT/the solaris/NNS/solaris kernel/VBP/kernel have/VBP/have provided/VBN/provided enhancements/NNS/enhancements of/IN/of the/DT/the paging/NN/paging algorithm/NNP/algorithm. one/CD/one such/JJ/such enhancement/NN/enhancement involves/VBZ/involves recognizing/VBG/recognizing pages/NNS/pages from/IN/from shared/VBN/shared libraries/NNP/libraries. pages/NNS/pages belonging/VBG/belonging to/TO/to libraries/NNS/libraries that/IN/that are/VBP/are being/VBG/being shared/VBN/shared by/IN/by several/JJ/several processes-even/JJ/processes-even if/IN/if they/PRP/they are/VBP/are eligible/JJ/eligible to/TO/to be/VB/be claimed/VBN/claimed by/IN/by the/DT/the scannerare/NN/scannerare skipped/VBD/skipped during/IN/during the/DT/the page-scanning/JJ/page-scanning process/NNP/process. another/DT/another enhancement/NN/enhancement concerns/NNS/concerns distinguishing/VBG/distinguishing pages/NNS/pages that/WDT/that have/VBP/have been/VBN/been allocated/VBN/allocated to/TO/to processes/NNS/processes from/IN/from pages/NNS/pages allocated/VBN/allocated to/TO/to regularfiles/NNP/regularfiles. this/DT/this is/VBZ/is known/VBN/known as/IN/as and/CC/and is/VBZ/is covered/VBN/covered in/IN/in section/NN/section 11.6.2/CD/11.6.2. it/PRP/it is/VBZ/is desirable/JJ/desirable to/TO/to be/VB/be able/JJ/able to/TO/to execute/VB/execute a/DT/a process/NN/process whose/WP$/whose logical/JJ/logical address/NN/address space/NN/space is/VBZ/is larger/JJR/larger than/IN/than the/DT/the available/JJ/available physical/JJ/physical address/NN/address space/NNP/space. virtual/JJ/virtual memory/NN/memory is/VBZ/is a/DT/a technique/NN/technique 408/CD/408 chapter/NN/chapter 9/CD/9 that/WDT/that enables/VBZ/enables us/PRP/us to/TO/to map/VB/map a/DT/a large/JJ/large logical/JJ/logical address/NN/address space/NN/space onto/IN/onto a/DT/a smaller/JJR/smaller physical/JJ/physical menlory/NNP/menlory. virtual/JJ/virtual memory/NN/memory allows/VBZ/allows us/PRP/us to/TO/to run/VB/run extremely/RB/extremely large/JJ/large processes/NNS/processes and/CC/and to/TO/to raise/VB/raise the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming /,/, increasing/VBG/increasing cpu/NN/cpu utilization/NNP/utilization. further/RB/further /,/, it/PRP/it frees/VBZ/frees application/NN/application programmers/NNS/programmers from/IN/from worrying/VBG/worrying about/IN/about memory/NN/memory availability/NNP/availability. in/IN/in addition/NN/addition /,/, with/IN/with virtual/JJ/virtual memory/NN/memory /,/, several/JJ/several processes/NNS/processes can/MD/can share/VB/share system/NN/system libraries/NNS/libraries and/CC/and memory/NNP/memory. virtual/JJ/virtual memory/NN/memory also/RB/also enables/VBZ/enables us/PRP/us to/TO/to use/VB/use an/DT/an efficient/NN/efficient type/NN/type of/IN/of process/NN/process creation/NN/creation known/VBN/known as/IN/as copy-on-write/JJ/copy-on-write /,/, wherein/NN/wherein parent/NN/parent and/CC/and child/NN/child processes/NNS/processes share/NN/share actual/JJ/actual pages/NNS/pages of/IN/of memory/NNP/memory. virtual/JJ/virtual memory/NN/memory is/VBZ/is commonly/RB/commonly implemented/VBN/implemented by/IN/by demand/NN/demand paging/NNP/paging. pure/NN/pure demand/NN/demand paging/VBG/paging never/RB/never brings/VBZ/brings in/IN/in a/DT/a page/NN/page until/IN/until that/DT/that page/NN/page is/VBZ/is referenced/NNP/referenced. the/DT/the first/JJ/first reference/NN/reference causes/NNS/causes a/DT/a page/NN/page fault/NN/fault to/TO/to the/DT/the operating/NN/operating system/NNP/system. the/DT/the operating-system/JJ/operating-system kernel/NN/kernel consults/NNS/consults an/DT/an internal/JJ/internal table/NN/table to/TO/to determine/VB/determine where/WRB/where the/DT/the page/NN/page is/VBZ/is located/VBN/located on/IN/on the/DT/the backing/NN/backing store/NNP/store. it/PRP/it then/RB/then finds/VBZ/finds a/DT/a free/JJ/free frame/NN/frame and/CC/and reads/NNS/reads the/DT/the page/NN/page in/IN/in from/IN/from the/DT/the backing/NN/backing store/NNP/store. the/DT/the page/NN/page table/NN/table is/VBZ/is updated/VBN/updated to/TO/to reflect/VB/reflect this/DT/this change/NN/change /,/, and/CC/and the/DT/the instruction/NN/instruction that/IN/that caused/VBN/caused the/DT/the page/NN/page fault/NN/fault is/VBZ/is restarted/NNP/restarted. this/DT/this approach/NN/approach allows/VBZ/allows a/DT/a process/NN/process to/TO/to run/VB/run even/RB/even though/IN/though its/PRP$/its entire/JJ/entire memory/NN/memory image/NN/image is/VBZ/is not/RB/not in/IN/in main/JJ/main memory/NN/memory at/IN/at once/NNP/once. as/IN/as long/RB/long as/IN/as the/DT/the page-fault/JJ/page-fault rate/NN/rate is/VBZ/is reasonably/RB/reasonably low/JJ/low /,/, performance/NN/performance is/VBZ/is acceptable/NNP/acceptable. we/PRP/we can/MD/can use/VB/use demand/NN/demand paging/VBG/paging to/TO/to reduce/VB/reduce the/DT/the number/NN/number of/IN/of frames/NNS/frames allocated/VBN/allocated to/TO/to a/DT/a process/NNP/process. this/DT/this arrangement/NN/arrangement can/MD/can increase/VB/increase the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming /:/( allowing/VBG/allowing more/JJR/more processes/NNS/processes to/TO/to be/VB/be available/JJ/available for/IN/for execution/NN/execution at/IN/at one/CD/one time/NN/time /:/) and-in/JJ/and-in theory/NN/theory /,/, at/IN/at least-the/DT/least-the cpu/NN/cpu utilization/NN/utilization of/IN/of the/DT/the system/NNP/system. it/PRP/it also/RB/also allows/VBZ/allows processes/NNS/processes to/TO/to be/VB/be run/VBN/run even/RB/even though/IN/though their/PRP$/their memory/NN/memory requirements/NNS/requirements exceed/VB/exceed the/DT/the total/JJ/total available/JJ/available physical/JJ/physical memory/NNP/memory. such/JJ/such processes/NNS/processes run/VBP/run in/IN/in virtual/JJ/virtual memory/NNP/memory. if/IN/if total/JJ/total memory/NN/memory requirements/NNS/requirements exceed/VB/exceed the/DT/the capacity/NN/capacity of/IN/of physical/JJ/physical memory/NN/memory /,/, then/RB/then it/PRP/it may/MD/may be/VB/be necessary/JJ/necessary to/TO/to replace/VB/replace pages/NNS/pages from/IN/from memory/NN/memory to/TO/to free/JJ/free frames/NNS/frames for/IN/for new/JJ/new pages/NNP/pages. various/JJ/various page-replacement/JJ/page-replacement algorithms/NNS/algorithms are/VBP/are used/NNP/used. fifo/NN/fifo page/NN/page replacement/NN/replacement is/VBZ/is easy/JJ/easy to/TO/to program/NN/program but/CC/but suffers/NNS/suffers from/IN/from belady/JJ/belady 's/POS/'s anomaly/NNP/anomaly. optimal/NN/optimal page/NN/page replacement/NN/replacement requires/VBZ/requires future/JJ/future knowledge/NNP/knowledge. lru/NN/lru replacement/NN/replacement is/VBZ/is an/DT/an approximation/NN/approximation of/IN/of optimal/JJ/optimal page/NN/page replacement/NN/replacement /,/, but/CC/but even/RB/even it/PRP/it may/MD/may be/VB/be difficult/JJ/difficult to/TO/to implement/NNP/implement. most/JJS/most page-replacement/JJ/page-replacement algorithms/NNS/algorithms /,/, such/JJ/such as/IN/as the/DT/the second-chance/NN/second-chance algorithm/NN/algorithm /,/, are/VBP/are approximations/NNS/approximations of/IN/of lru/NN/lru replacement/NNP/replacement. in/IN/in addition/NN/addition to/TO/to a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm /,/, a/DT/a frame-allocation/NN/frame-allocation policy/NN/policy is/VBZ/is needed/NNP/needed. allocation/NN/allocation can/MD/can be/VB/be fixed/VBN/fixed /,/, suggesting/NN/suggesting local/JJ/local page/NN/page replacement/NN/replacement /,/, or/CC/or dynamic/JJ/dynamic /,/, suggesting/VBG/suggesting global/JJ/global replacement/NNP/replacement. the/DT/the working-set/JJ/working-set model/NN/model assumes/VBZ/assumes that/IN/that processes/NNS/processes execute/VBP/execute in/IN/in localities/NNP/localities. the/DT/the working/VBG/working set/NN/set is/VBZ/is the/DT/the set/NN/set of/IN/of pages/NNS/pages in/IN/in the/DT/the current/JJ/current locality/NNP/locality. accordingly/RB/accordingly /,/, each/DT/each process/NN/process should/MD/should be/VB/be allocated/VBN/allocated enough/JJ/enough frames/NNS/frames for/IN/for its/PRP$/its current/JJ/current working/VBG/working set/NNP/set. if/IN/if a/DT/a process/NN/process does/VBZ/does not/RB/not have/VB/have enough/RB/enough memory/JJ/memory for/IN/for its/PRP$/its working/VBG/working set/NN/set /,/, it/PRP/it will/MD/will thrash/VB/thrash. providing/VBG/providing enough/RB/enough frames/VBZ/frames to/TO/to each/DT/each process/NN/process to/TO/to avoid/VB/avoid thrashing/NN/thrashing may/MD/may require/VB/require process/NN/process swapping/VBG/swapping and/CC/and schedulil/NN/schedulil g/NNP/g. most/JJS/most operating/VBG/operating systems/NNS/systems provide/VB/provide features/NNS/features for/IN/for memory/NN/memory mappil1g/NNP/mappil1g files/NNS/files /,/, thus/RB/thus allowing/VBG/allowing file/NN/file i/0/-NONE-/i/0 to/TO/to be/VB/be treated/VBN/treated as/IN/as routine/JJ/routine memory/NN/memory access/NNP/access. the/DT/the win32/NNP/win32 api/NN/api implements/NNS/implements shared/VBD/shared memory/NN/memory through/IN/through memory/NN/memory mappil1g/NNP/mappil1g files/NNP/files. kernel/NN/kernel processes/NNS/processes typically/RB/typically req1.1ire/JJ/req1.1ire memory/NN/memory to/TO/to be/VB/be allocated/VBN/allocated using/VBG/using pages/NNS/pages that/WDT/that are/VBP/are physically/RB/physically contiguous/NNP/contiguous. the/DT/the buddy/NN/buddy system/NN/system allocates/VBZ/allocates memory/NN/memory to/TO/to kernel/VB/kernel processes/NNS/processes in/IN/in units/NNS/units sized/VBN/sized according/VBG/according to/TO/to a/DT/a power/NN/power of/IN/of 2/CD/2 /,/, which/WDT/which often/RB/often results/VBZ/results in/IN/in fragmentation/NNP/fragmentation. slab/NN/slab allocators/NNS/allocators assign/VBP/assign kernel/NN/kernel data/NNS/data structures/NNS/structures to/TO/to caches/NNS/caches associated/VBN/associated with/IN/with slabs/NNS/slabs /,/, which/WDT/which are/VBP/are made/VBN/made up/RP/up of/IN/of one/CD/one or/CC/or more/JJR/more physically/RB/physically contiguous/JJ/contiguous pages/NNP/pages. with/IN/with slab/NN/slab allocation/NN/allocation /,/, no/DT/no memory/NN/memory is/VBZ/is wasted/VBN/wasted due/JJ/due to/TO/to fragmentation/NN/fragmentation /,/, and/CC/and memory/NN/memory requests/NNS/requests can/MD/can be/VB/be satisfied/VBN/satisfied quickly/-NONE-/quickly. 409/CD/409 in/IN/in addition/NN/addition to/TO/to reqmnng/VB/reqmnng that/IN/that we/PRP/we solve/VBP/solve the/DT/the major/JJ/major problems/NNS/problems of/IN/of page/NN/page replacement/NN/replacement and/CC/and frame/VBD/frame allocation/NN/allocation /,/, the/DT/the proper/NN/proper design/NN/design of/IN/of a/DT/a paging/NN/paging systern/NN/systern requires/VBZ/requires that/IN/that we/PRP/we consider/VBP/consider prep/NN/prep aging/VBG/aging /,/, page/NN/page size/NN/size /,/, tlb/NN/tlb reach/NN/reach /,/, inverted/VBD/inverted page/NN/page tables/NNS/tables /,/, program/NN/program structure/NN/structure /,/, i/0/-NONE-/i/0 interlock/NN/interlock /,/, and/CC/and other/JJ/other issues/NNP/issues. 9.1/CD/9.1 assume/NN/assume there/RB/there is/VBZ/is a/DT/a 1,024-kb/CD/1,024-kb segment/NN/segment where/WRB/where memory/NN/memory is/VBZ/is allocated/VBN/allocated using/VBG/using the/DT/the buddy/NN/buddy system/NNP/system. using/VBG/using figure/NN/figure 9.27/CD/9.27 as/IN/as a/DT/a guide/NN/guide /,/, draw/NN/draw a/DT/a tree/NN/tree illustrating/VBG/illustrating how/WRB/how the/DT/the following/VBG/following memory/NN/memory requests/NNS/requests are/VBP/are allocated/VBN/allocated /:/: request/NN/request 240/CD/240 bytes/NNS/bytes request/NN/request 120/CD/120 bytes/NNS/bytes request/NN/request 60/CD/60 bytes/NNS/bytes request/NN/request 130/CD/130 bytes/NNS/bytes next/JJ/next modify/NN/modify the/DT/the tree/NN/tree for/IN/for the/DT/the followilcg/NN/followilcg releases/NNS/releases of/IN/of memory/NNP/memory. perform/NN/perform coalescing/VBG/coalescing whenever/NN/whenever possible/JJ/possible /:/: release/NN/release 240/CD/240 bytes/NNS/bytes release/NN/release 60/CD/60 bytes/NNS/bytes release/NN/release 120/CD/120 bytes/NNS/bytes 9.2/CD/9.2 consider/NN/consider the/DT/the page/NN/page table/NN/table for/IN/for a/DT/a system/NN/system with/IN/with 12-bit/CD/12-bit virtual/JJ/virtual and/CC/and physical/JJ/physical addresses/NNS/addresses with/IN/with 256-byte/JJ/256-byte pages/NNP/pages. the/DT/the list/NN/list of/IN/of free/JJ/free page/NN/page frames/VBZ/frames is/VBZ/is d/VBN/d /,/, e/NN/e /,/, f/NN/f /:/( that/IN/that is/VBZ/is /,/, dis/VBZ/dis at/IN/at the/DT/the head/NN/head of/IN/of the/DT/the list/NN/list e/NN/e is/VBZ/is second/JJ/second /,/, and/CC/and f/NN/f is/VBZ/is last/JJ/last /NN/) /./. 410/CD/410 chapter/NN/chapter 9/CD/9 convert/NN/convert the/DT/the following/VBG/following virtual/JJ/virtual addresses/NNS/addresses to/TO/to their/PRP$/their equivalent/NN/equivalent physical/JJ/physical addresses/NNS/addresses in/IN/in hexadecimal/NNP/hexadecimal. all/DT/all numbers/NNS/numbers are/VBP/are given/VBN/given in/IN/in hexadecimal/NNP/hexadecimal. /NNP/( a/DT/a dash/NN/dash for/IN/for a/DT/a page/NN/page frame/NN/frame indicates/VBZ/indicates that/IN/that the/DT/the page/NN/page is/VBZ/is not/RB/not in/IN/in memory/NNP/memory. /NNP/) 9ef/CD/9ef 111/CD/111 700/CD/700 off/IN/off 9.3/CD/9.3 a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm should/MD/should minimize/VB/minimize the/DT/the number/NN/number of/IN/of page/NN/page faults/NNP/faults. we/PRP/we can/MD/can achieve/VB/achieve this/DT/this minimization/NN/minimization by/IN/by distributing/NN/distributing heavily/RB/heavily used/VBN/used pages/NNS/pages evenly/RB/evenly over/IN/over all/DT/all of/IN/of memory/NN/memory /,/, rather/RB/rather than/IN/than having/VBG/having them/PRP/them compete/JJ/compete for/IN/for a/DT/a small/JJ/small number/NN/number of/IN/of page/NN/page frames/NNP/frames. we/PRP/we can/MD/can associate/VB/associate with/IN/with each/DT/each page/NN/page frame/NN/frame a/DT/a counter/NN/counter of/IN/of the/DT/the number/NN/number of/IN/of pages/NNS/pages associated/VBN/associated with/IN/with that/DT/that frame/NNP/frame. then/RB/then /,/, to/TO/to replace/VB/replace a/DT/a page/NN/page /,/, we/PRP/we can/MD/can search/VB/search for/IN/for the/DT/the page/NN/page frame/NN/frame with/IN/with the/DT/the smallest/JJS/smallest counter/NNP/counter. a/NNP/a. define/NN/define a/DT/a page-replacement/JJ/page-replacement algorithm/NN/algorithm using/VBG/using this/DT/this basic/JJ/basic idea/NNP/idea. specifically/RB/specifically address/VBZ/address these/DT/these problems/NNS/problems /:/: i/NNP/i. what/WP/what is/VBZ/is the/DT/the initial/JJ/initial value/NN/value of/IN/of the/DT/the counters/NNS/counters ii/NNP/ii. when/WRB/when are/VBP/are counters/NNS/counters increased/VBN/increased iii/NNP/iii. when/WRB/when are/VBP/are counters/NNS/counters decreased/VBN/decreased 1v/CD/1v. how/WRB/how is/VBZ/is the/DT/the page/NN/page to/TO/to be/VB/be replaced/VBN/replaced selected/VBN/selected b/NNP/b. how/WRB/how many/JJ/many page/NN/page faults/NNS/faults occur/VBP/occur for/IN/for your/PRP$/your algorithm/NN/algorithm for/IN/for the/DT/the following/VBG/following reference/NN/reference string/VBG/string with/IN/with four/CD/four page/NN/page frames/NNS/frames 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 4/CD/4 /,/, 5/CD/5 /,/, 3/CD/3 /,/, 4/CD/4 /,/, 1/CD/1 /,/, 6/CD/6 /,/, 7/CD/7 /,/, 8/CD/8 /,/, 7/CD/7 /,/, 8/CD/8 /,/, 9/CD/9 /,/, 7/CD/7 /,/, 8/CD/8 /,/, 9/CD/9 /,/, 5/CD/5 /,/, 4/CD/4 /,/, 5/CD/5 /,/, 4/CD/4 /,/, 2/CD/2. c/NNP/c. what/WP/what is/VBZ/is the/DT/the minimum/JJ/minimum number/NN/number of/IN/of page/NN/page faults/NNS/faults for/IN/for an/DT/an optimal/JJ/optimal pagereplacement/NN/pagereplacement strategy/NN/strategy for/IN/for the/DT/the reference/NN/reference string/VBG/string in/IN/in part/NN/part b/NN/b with/IN/with four/CD/four page/NN/page frames/NNS/frames 9.4/CD/9.4 consider/NN/consider a/DT/a demand-paging/JJ/demand-paging system/NN/system with/IN/with the/DT/the following/VBG/following time-measured/JJ/time-measured utilizations/NNS/utilizations /:/: cpu/NN/cpu utilization/NN/utilization paging/VBG/paging disk/NN/disk other/JJ/other i/0/-NONE-/i/0 devices/NNS/devices 20/CD/20 %/NN/% 97.7/CD/97.7 %/NN/% 5/CD/5 %/NN/% for/IN/for each/DT/each of/IN/of the/DT/the following/JJ/following /,/, say/VBP/say whether/IN/whether it/PRP/it will/MD/will /VB/( or/CC/or is/VBZ/is likely/JJ/likely to/TO/to /VB/) improve/JJ/improve cpu/NN/cpu utilization/NNP/utilization. explain/NN/explain your/PRP$/your answers/NNP/answers. a/NNP/a. install/NN/install a/DT/a faster/NN/faster cpu/NNP/cpu. b/NNP/b. install/NN/install a/DT/a bigger/NN/bigger paging/VBG/paging disk/NNP/disk. c/NNP/c. increase/NN/increase the/DT/the degree/NN/degree of/IN/of multiprogramming/NNP/multiprogramming. d/NNP/d. decrease/NN/decrease the/DT/the degree/NN/degree of/IN/of multiprogramming/NNP/multiprogramming. 411/CD/411 e/NNP/e. install/NN/install more/JJR/more main/JJ/main n1.enl0ry/NNP/n1.enl0ry. f/NNP/f. install/NN/install a/DT/a faster/NN/faster hard/NN/hard disk/NN/disk or/CC/or multiple/VB/multiple controllers/NNS/controllers with/IN/with multiple/JJ/multiple hard/JJ/hard disks/NNP/disks. g/NNP/g. add/VBD/add prepaging/VBG/prepaging to/TO/to the/DT/the page-fetch/JJ/page-fetch algorithms/NNP/algorithms. h/NNP/h. increase/NN/increase the/DT/the page/NN/page size/NNP/size. 9.5/CD/9.5 consider/NN/consider a/DT/a demand-paged/JJ/demand-paged computer/NN/computer system/NN/system where/WRB/where the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming is/VBZ/is currently/RB/currently fixed/VBN/fixed at/IN/at four/NNP/four. the/DT/the system/NN/system was/VBD/was recently/RB/recently measured/VBN/measured to/TO/to determine/VB/determine utilization/NN/utilization of/IN/of the/DT/the cpu/NN/cpu and/CC/and the/DT/the paging/NN/paging disk/NNP/disk. the/DT/the results/NNS/results are/VBP/are one/CD/one of/IN/of the/DT/the following/JJ/following alternatives/NNP/alternatives. for/IN/for each/DT/each case/NN/case /,/, what/WP/what is/VBZ/is happening/VBG/happening can/MD/can the/DT/the degree/NN/degree of/IN/of multiprogramming/VBG/multiprogramming be/VB/be increased/VBN/increased to/TO/to increase/VB/increase the/DT/the cpu/NN/cpu utilization/NN/utilization is/VBZ/is the/DT/the paging/NN/paging helping/VBG/helping a/NNP/a. cpu/NN/cpu utilization/NN/utilization 13/CD/13 percent/NN/percent ;/:/; disk/NN/disk utilization/NN/utilization 97/CD/97 percent/NN/percent b/NNP/b. cpu/NN/cpu utilization/NN/utilization 87/CD/87 percent/NN/percent ;/:/; disk/NN/disk utilization/NN/utilization 3/CD/3 percent/NN/percent c/NNP/c. cpu/NN/cpu utilization/NN/utilization 13/CD/13 percent/NN/percent ;/:/; disk/NN/disk utilization/NN/utilization 3/CD/3 percent/NN/percent 9.6/CD/9.6 consider/NN/consider a/DT/a demand-paging/JJ/demand-paging system/NN/system with/IN/with a/DT/a paging/NN/paging disk/NN/disk that/WDT/that has/VBZ/has an/DT/an average/JJ/average access/NN/access and/CC/and transfer/VB/transfer time/NN/time of/IN/of 20/CD/20 milliseconds/NNP/milliseconds. addresses/NNS/addresses are/VBP/are translated/VBN/translated through/IN/through a/DT/a page/NN/page table/NN/table in/IN/in main/JJ/main memory/NN/memory /,/, with/IN/with an/DT/an access/NN/access time/NN/time of/IN/of 1/CD/1 microsecond/NN/microsecond per/IN/per memory/NN/memory access/NNP/access. thus/RB/thus /,/, each/DT/each memory/NN/memory reference/NN/reference through/IN/through the/DT/the page/NN/page table/NN/table takes/VBZ/takes two/CD/two accesses/NNP/accesses. to/TO/to improve/VB/improve this/DT/this time/NN/time /,/, we/PRP/we have/VBP/have added/VBN/added an/DT/an associative/JJ/associative memory/NN/memory that/WDT/that reduces/VBZ/reduces access/NN/access time/NN/time to/TO/to one/CD/one memory/NN/memory reference/NN/reference if/IN/if the/DT/the page-table/JJ/page-table entry/NN/entry is/VBZ/is in/IN/in the/DT/the associative/JJ/associative memory/NNP/memory. assume/NN/assume that/WDT/that 80/CD/80 percent/NN/percent of/IN/of the/DT/the accesses/NNS/accesses are/VBP/are in/IN/in the/DT/the associative/JJ/associative memory/NN/memory and/CC/and that/IN/that /,/, of/IN/of those/DT/those remaining/VBG/remaining /,/, 10/CD/10 percent/NN/percent /:/( or/CC/or 2/CD/2 percent/NN/percent of/IN/of the/DT/the total/JJ/total /NN/) cause/NN/cause page/NN/page faults/NNP/faults. what/WP/what is/VBZ/is the/DT/the effective/JJ/effective memory/NN/memory access/NN/access time/NN/time 9.7/CD/9.7 a/DT/a simplified/JJ/simplified view/NN/view of/IN/of thread/NN/thread states/NNS/states is/VBZ/is ready/JJ/ready /,/, running/VBG/running /,/, and/CC/and blocked/VBD/blocked /,/, where/WRB/where a/DT/a thread/JJ/thread is/VBZ/is either/DT/either ready/JJ/ready and/CC/and waiting/VBG/waiting to/TO/to be/VB/be scheduled/VBN/scheduled /,/, is/VBZ/is running/VBG/running on/IN/on the/DT/the processor/NN/processor /,/, or/CC/or is/VBZ/is blocked/VBN/blocked /-NONE-/( i.e/NNP/i.e. is/VBZ/is waiting/VBG/waiting for/IN/for i/0/NNP/i/0. /:/) this/DT/this is/VBZ/is illustrated/VBN/illustrated in/IN/in figure/NN/figure 9.31/CD/9.31. assuming/VBG/assuming a/DT/a thread/NN/thread is/VBZ/is in/IN/in the/DT/the running/NN/running state/NN/state /,/, answer/NN/answer the/DT/the following/VBG/following questions/NNS/questions /:/: /:/( be/VB/be sure/JJ/sure to/TO/to explain/VB/explain your/PRP$/your answer/NNP/answer. /NNP/) a/NNP/a. will/MD/will the/DT/the thread/NN/thread change/NN/change state/NN/state if/IN/if it/PRP/it incurs/VBZ/incurs a/DT/a page/NN/page fault/NN/fault if/IN/if so/RB/so /,/, to/TO/to what/WP/what new/JJ/new state/NN/state figure/NN/figure 9.31/CD/9.31 thread/NN/thread state/NN/state diagram/NN/diagram for/IN/for exercise/NN/exercise 9.7/CD/9.7. 412/CD/412 chapter/NN/chapter 9/CD/9 b/NNP/b. will/MD/will the/DT/the thread/NN/thread change/NN/change state/NN/state if/IN/if it/PRP/it generates/VBZ/generates a/DT/a tlb/NN/tlb miss/NN/miss that/WDT/that is/VBZ/is resolved/VBN/resolved in/IN/in the/DT/the page/NN/page table/NN/table if/IN/if so/RB/so /,/, to/TO/to what/WP/what new/JJ/new state/NN/state c/NNP/c. will/MD/will the/DT/the thread/NN/thread change/NN/change state/NN/state if/IN/if an/DT/an address/NN/address reference/NN/reference is/VBZ/is resolved/VBN/resolved in/IN/in the/DT/the page/NN/page table/NN/table if/IN/if so/RB/so /,/, to/TO/to what/WP/what new/JJ/new state/NN/state 9.8/CD/9.8 discuss/NN/discuss the/DT/the hardware/NN/hardware support/NN/support required/VBN/required to/TO/to support/VB/support demand/NN/demand paging/NNP/paging. 9.9/CD/9.9 consider/NN/consider the/DT/the following/VBG/following page/NN/page reference/NN/reference string/VBG/string /:/: 1/LS/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 4/CD/4 /,/, 2/CD/2 /,/, 1/CD/1 /,/, 5/CD/5 /,/, 6/CD/6 /,/, 2/CD/2 /,/, 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 7/CD/7 /,/, 6/CD/6 /,/, 3/CD/3 /,/, 2/CD/2 /,/, 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, 6/CD/6. how/WRB/how many/JJ/many page/NN/page faults/NNS/faults would/MD/would occur/VB/occur for/IN/for the/DT/the following/VBG/following replacement/NN/replacement algorithms/NNS/algorithms /,/, assuming/VBG/assuming one/CD/one /,/, two/CD/two /,/, three/CD/three /,/, four/CD/four /,/, five/CD/five /,/, six/CD/six /,/, and/CC/and seven/CD/seven frames/NNS/frames remember/NN/remember that/IN/that all/DT/all frames/NNS/frames are/VBP/are initially/RB/initially empty/JJ/empty /,/, so/RB/so your/PRP$/your first/JJ/first unique/NN/unique pages/NNS/pages will/MD/will cost/VB/cost one/CD/one fault/NN/fault each/NNP/each. lru/NN/lru replacement/NN/replacement fifo/NN/fifo replacement/NN/replacement optimal/NN/optimal replacement/NN/replacement 9.10/CD/9.10 consider/NN/consider a/DT/a system/NN/system that/WDT/that allocates/VBZ/allocates pages/NNS/pages of/IN/of different/JJ/different sizes/NNS/sizes to/TO/to its/PRP$/its processes/NNP/processes. what/WP/what are/VBP/are the/DT/the advantages/NNS/advantages of/IN/of such/JJ/such a/DT/a paging/NN/paging scheme/NN/scheme what/WP/what modifications/NNS/modifications to/TO/to the/DT/the virtual/JJ/virtual memory/NN/memory system/NN/system provide/VB/provide this/DT/this functionality/NN/functionality 9.11/CD/9.11 discuss/NNS/discuss situations/NNS/situations in/IN/in which/WDT/which the/DT/the most/RBS/most frequently/RB/frequently used/JJ/used page-replacement/JJ/page-replacement algorithm/NN/algorithm generates/NNS/generates fewer/JJR/fewer page/NN/page faults/NNS/faults than/IN/than the/DT/the least/JJS/least recently/RB/recently used/VBD/used page-replacement/JJ/page-replacement algorithm/NNP/algorithm. also/RB/also discuss/VBZ/discuss under/IN/under what/WP/what circumstances/NNS/circumstances the/DT/the opposite/JJ/opposite holds/NNP/holds. 9.12/CD/9.12 under/IN/under what/WP/what circumstances/NNS/circumstances do/VBP/do page/NN/page faults/NNS/faults occur/VBP/occur describe/NN/describe the/DT/the actions/NNS/actions taken/VBN/taken by/IN/by the/DT/the operating/NN/operating system/NN/system when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNP/occurs. 9.13/CD/9.13 suppose/NN/suppose that/WDT/that a/DT/a machine/NN/machine provides/VBZ/provides instructions/NNS/instructions that/IN/that can/MD/can access/NN/access memory/NN/memory locations/NNS/locations using/VBG/using the/DT/the one-level/NNP/one-level indirect/NN/indirect addressing/VBG/addressing scheme/NNP/scheme. what/WP/what sequence/NN/sequence of/IN/of page/NN/page faults/NNS/faults is/VBZ/is ilccurred/VBN/ilccurred when/WRB/when all/DT/all of/IN/of the/DT/the pages/NNS/pages of/IN/of a/DT/a program/NN/program are/VBP/are currently/RB/currently nonresident/JJ/nonresident and/CC/and the/DT/the first/JJ/first instruction/NN/instruction of/IN/of the/DT/the program/NN/program is/VBZ/is an/DT/an indirect/JJ/indirect memory-load/JJ/memory-load operation/NN/operation what/WP/what happens/NNS/happens when/WRB/when the/DT/the operating/NN/operating system/NN/system is/VBZ/is using/VBG/using a/DT/a per-process/JJ/per-process frame/NN/frame allocation/NN/allocation technique/NN/technique and/CC/and only/RB/only two/CD/two pages/NNS/pages are/VBP/are allocated/VBN/allocated to/TO/to this/DT/this process/NN/process 9.14/CD/9.14 consider/NN/consider a/DT/a system/NN/system that/WDT/that provides/VBZ/provides support/NN/support for/IN/for user-level/JJ/user-level and/CC/and kernellevel/NN/kernellevel threads/NNP/threads. the/DT/the mapping/NN/mapping in/IN/in this/DT/this system/NN/system is/VBZ/is one/CD/one to/TO/to one/CD/one /CD/( there/EX/there is/VBZ/is a/DT/a corresponding/NN/corresponding kernel/NN/kernel thread/NN/thread for/IN/for each/DT/each user/NN/user thread/NN/thread /:/) /./. does/VBZ/does a/DT/a multithreaded/VBN/multithreaded process/NN/process consist/NN/consist of/IN/of /NNP/( a/DT/a /NN/) a/DT/a working/VBG/working set/NN/set for/IN/for the/DT/the entire/JJ/entire process/NN/process or/CC/or /CD/( b/NN/b /:/) a/DT/a working/NN/working set/NN/set for/IN/for each/DT/each thread/NN/thread explain/NNP/explain. 413/CD/413 9.15/CD/9.15 what/WP/what is/VBZ/is the/DT/the copy-on-write/JJ/copy-on-write feature/NN/feature /,/, and/CC/and under/IN/under what/WP/what circumstances/NNS/circumstances is/VBZ/is it/PRP/it beneficial/JJ/beneficial to/TO/to use/VB/use this/DT/this feature/NN/feature what/WP/what hardware/NN/hardware support/NN/support is/VBZ/is required/VBN/required to/TO/to implement/VB/implement this/DT/this feature/NN/feature 9.16/CD/9.16 consider/NN/consider the/DT/the two-dimensional/JJ/two-dimensional array/NN/array a/DT/a /:/: int/NN/int a/DT/a /NN/[ /:/] /:/[ /:/] =/:/= new/JJ/new int/NN/int /:/[ 100/CD/100 /CD/] /CD/[ 100/CD/100 /CD/] ;/:/; where/WRB/where a/DT/a /JJ/[ oj/NN/oj /:/[ oj/NN/oj is/VBZ/is at/IN/at location/NN/location 200/CD/200 in/IN/in a/DT/a paged/JJ/paged memory/NN/memory system/NN/system with/IN/with pages/NNS/pages of/IN/of size/NN/size 200/CD/200. a/DT/a small/JJ/small process/NN/process that/WDT/that manipulates/VBZ/manipulates the/DT/the matrix/NN/matrix resides/VBZ/resides in/IN/in page/NN/page 0/-NONE-/0 /./( locations/NNS/locations 0/-NONE-/0 to/TO/to 199/CD/199 /CD/) /./. thus/RB/thus /,/, every/DT/every instruction/NN/instruction fetch/NN/fetch will/MD/will be/VB/be from/IN/from page/NN/page 0/CD/0. for/IN/for three/CD/three page/NN/page frames/NNS/frames /,/, how/WRB/how many/JJ/many page/NN/page faults/NNS/faults are/VBP/are generated/VBN/generated by/IN/by the/DT/the following/JJ/following array-initialization/NN/array-initialization loops/NNS/loops /,/, using/VBG/using lru/NN/lru replacement/NN/replacement and/CC/and assuming/VBG/assuming that/IN/that page/NN/page frame/VBD/frame 1/CD/1 contains/NNS/contains the/DT/the process/NN/process and/CC/and the/DT/the other/JJ/other two/CD/two are/VBP/are initially/RB/initially empty/JJ/empty a/NNP/a. for/IN/for /NNP/( int/NN/int j/NN/j =/:/= 0/-NONE-/0 ;/:/; j/NN/j 100/CD/100 ;/:/; j/NN/j +/:/+ +/:/+ /:/) for/IN/for /CD/( int/NN/int i/PRP/i =/VBP/= 0/-NONE-/0 ;/:/; i/PRP/i 100/CD/100 ;/:/; i/PRP/i +/VBP/+ +/:/+ /:/) a/DT/a /NN/[ i/PRP/i /VBP/] /:/[ j/NN/j /:/] =/:/= 0/-NONE-/0 ;/:/; b/NNP/b. for/IN/for /NNP/( int/NN/int i/PRP/i =/VBP/= 0/-NONE-/0 ;/:/; i/PRP/i 100/CD/100 ;/:/; i/PRP/i +/VBP/+ +/:/+ /:/) for/IN/for /CD/( int/NN/int j/NN/j =/:/= 0/-NONE-/0 ;/:/; j/NN/j 100/CD/100 ;/:/; j/NN/j +/:/+ +/:/+ /:/) a/DT/a /NN/[ i/PRP/i /VBP/] /:/[ j/NN/j /:/] =/:/= 0/-NONE-/0 ;/:/; 9.17/CD/9.17 discuss/NN/discuss situations/NNS/situations in/IN/in which/WDT/which the/DT/the least/JJS/least frequently/RB/frequently used/VBN/used page-replacement/JJ/page-replacement algorithm/NN/algorithm generates/NNS/generates fewer/JJR/fewer page/NN/page faults/NNS/faults than/IN/than the/DT/the least/JJS/least recently/RB/recently used/VBD/used page-replacement/JJ/page-replacement algorithm/NNP/algorithm. also/RB/also discuss/VBZ/discuss under/IN/under what/WP/what circumstances/NNS/circumstances the/DT/the opposite/JJ/opposite holds/NNP/holds. 9.18/CD/9.18 what/WP/what is/VBZ/is the/DT/the cause/NN/cause of/IN/of thrashing/VBG/thrashing how/WRB/how does/VBZ/does the/DT/the system/NN/system detect/NN/detect thrashing/VBG/thrashing once/RB/once it/PRP/it detects/VBZ/detects thrashing/VBG/thrashing /,/, what/WP/what can/MD/can the/DT/the system/NN/system do/VBP/do to/TO/to eliminate/VB/eliminate this/DT/this problem/NN/problem 9.19/CD/9.19 assume/NN/assume that/WDT/that you/PRP/you are/VBP/are monitoring/VBG/monitoring the/DT/the rate/NN/rate at/IN/at which/WDT/which the/DT/the pointer/NN/pointer in/IN/in the/DT/the clock/NN/clock algorithm/NN/algorithm /:/( which/WDT/which indicates/VBZ/indicates the/DT/the candidate/NN/candidate page/NN/page for/IN/for replacement/NN/replacement /:/) moves/NNP/moves. what/WP/what can/MD/can you/PRP/you say/VB/say about/IN/about the/DT/the system/NN/system if/IN/if you/PRP/you notice/VBP/notice the/DT/the following/VBG/following behavior/NN/behavior /:/: a/NNP/a. pointer/NN/pointer is/VBZ/is moving/VBG/moving fast/NNP/fast. b/NNP/b. pointer/NN/pointer is/VBZ/is moving/VBG/moving slow/NNP/slow. 9.20/CD/9.20 the/DT/the vax/vms/NNS/vax/vms system/NN/system uses/NNS/uses a/DT/a fifo/NN/fifo replacement/NN/replacement algorithm/NN/algorithm for/IN/for resident/NN/resident pages/NNS/pages and/CC/and a/DT/a free-frame/JJ/free-frame pool/NN/pool of/IN/of recently/RB/recently used/VBN/used pages/NNP/pages. assume/NN/assume that/WDT/that the/DT/the free-frame/JJ/free-frame pool/NN/pool is/VBZ/is managed/VBN/managed using/VBG/using the/DT/the least/JJS/least recently/RB/recently used/VBD/used replacement/NN/replacement policy/NNP/policy. answer/NN/answer the/DT/the following/VBG/following questions/NNS/questions /:/: a/NNP/a. if/IN/if a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs and/CC/and if/IN/if the/DT/the page/NN/page does/VBZ/does not/RB/not exist/VB/exist in/IN/in the/DT/the free-frame/JJ/free-frame pool/NN/pool /,/, how/WRB/how is/VBZ/is free/JJ/free space/NN/space generated/VBN/generated for/IN/for the/DT/the newly/RB/newly requested/VBN/requested page/NN/page 414/CD/414 chapter/NN/chapter 9/CD/9 b/NNP/b. if/IN/if a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs and/CC/and if/IN/if the/DT/the page/NN/page exists/VBZ/exists in/IN/in the/DT/the free-frame/JJ/free-frame pool/NN/pool /,/, how/WRB/how is/VBZ/is the/DT/the resident/NN/resident page/NN/page set/NN/set and/CC/and the/DT/the free-france/NN/free-france pool/NN/pool managed/VBD/managed to/TO/to make/VB/make space/NN/space for/IN/for the/DT/the requested/VBN/requested page/NN/page c/NNP/c. what/WP/what does/VBZ/does the/DT/the system/NN/system degenerate/NN/degenerate to/TO/to if/IN/if the/DT/the number/NN/number of/IN/of resident/NN/resident pages/NNS/pages is/VBZ/is set/VBN/set to/TO/to one/CD/one d/NNP/d. what/WP/what does/VBZ/does the/DT/the system/NN/system degenerate/NN/degenerate to/TO/to if/IN/if the/DT/the number/NN/number of/IN/of pages/NNS/pages in/IN/in the/DT/the free-frame/JJ/free-frame pool/NN/pool is/VBZ/is zero/CD/zero 9.21/CD/9.21 the/DT/the slab-allocation/NN/slab-allocation algorithm/NN/algorithm uses/NNS/uses a/DT/a separate/JJ/separate cache/NN/cache for/IN/for each/DT/each different/JJ/different object/NN/object type/NNP/type. assuming/NN/assuming there/RB/there is/VBZ/is one/CD/one cache/NN/cache per/IN/per object/NN/object type/NN/type /,/, explain/NN/explain why/WRB/why this/DT/this scheme/NN/scheme does/VBZ/does n't/RB/n't scale/VB/scale well/RB/well with/IN/with multiple/JJ/multiple cpus/NNP/cpus. what/WP/what could/MD/could be/VB/be done/VBN/done to/TO/to address/NN/address this/DT/this scalability/NN/scalability issue/NN/issue 9.22/CD/9.22 assume/NN/assume that/WDT/that we/PRP/we have/VBP/have a/DT/a demand-paged/JJ/demand-paged memory/NNP/memory. the/DT/the page/NN/page table/NN/table is/VBZ/is held/VBN/held in/IN/in registers/NNP/registers. it/PRP/it takes/VBZ/takes 8/CD/8 milliseconds/NNS/milliseconds to/TO/to service/NN/service a/DT/a page/NN/page fault/NN/fault if/IN/if an/DT/an empty/NN/empty frame/NN/frame is/VBZ/is available/JJ/available or/CC/or if/IN/if the/DT/the replaced/VBN/replaced page/NN/page is/VBZ/is not/RB/not modified/VBN/modified and/CC/and 20/CD/20 milliseconds/NNS/milliseconds if/IN/if the/DT/the replaced/VBN/replaced page/NN/page is/VBZ/is modified/NNP/modified. memory-access/JJ/memory-access time/NN/time is/VBZ/is 100/CD/100 nanoseconds/NNP/nanoseconds. assume/NN/assume that/WDT/that the/DT/the page/NN/page to/TO/to be/VB/be replaced/VBN/replaced is/VBZ/is modified/VBN/modified 70/CD/70 percent/NN/percent of/IN/of the/DT/the time/NNP/time. what/WP/what is/VBZ/is the/DT/the maximum/NN/maximum acceptable/JJ/acceptable page-fault/NN/page-fault rate/NN/rate for/IN/for an/DT/an effective/JJ/effective access/NN/access time/NN/time of/IN/of no/DT/no more/RBR/more than/IN/than 200/CD/200 nanoseconds/NNS/nanoseconds 9.23/CD/9.23 segmentation/NN/segmentation is/VBZ/is similar/JJ/similar to/TO/to paging/NN/paging but/CC/but uses/VBZ/uses variable-sized/JJ/variable-sized pages/NNP/pages. define/NN/define two/CD/two segment-replacement/JJ/segment-replacement algorithms/NNS/algorithms based/VBN/based on/IN/on fifo/NN/fifo and/CC/and lru/NN/lru pagereplacement/NN/pagereplacement schemes/NNP/schemes. remember/NN/remember that/WDT/that since/IN/since segments/NNS/segments are/VBP/are not/RB/not the/DT/the same/JJ/same size/NN/size /,/, the/DT/the segment/NN/segment that/IN/that is/VBZ/is chosen/VBN/chosen to/TO/to be/VB/be replaced/VBN/replaced may/MD/may not/RB/not be/VB/be big/JJ/big enough/RB/enough to/TO/to leave/VB/leave enough/JJ/enough consecutive/JJ/consecutive locations/NNS/locations for/IN/for the/DT/the needed/VBN/needed segment/NNP/segment. consider/NN/consider strategies/NNS/strategies for/IN/for systems/NNS/systems where/WRB/where segments/NNS/segments cam/VBP/cam ot/NN/ot be/VB/be relocated/VBN/relocated and/CC/and strategies/NNS/strategies for/IN/for systems/NNS/systems where/WRB/where they/PRP/they can/NNP/can. 9.24/CD/9.24 which/WDT/which of/IN/of the/DT/the following/JJ/following programming/NN/programming techniques/NNS/techniques and/CC/and structures/NNS/structures are/VBP/are good/JJ/good for/IN/for a/DT/a demand-paged/JJ/demand-paged environment/NN/environment which/WDT/which are/VBP/are not/RB/not good/JJ/good explain/NN/explain your/PRP$/your answers/NNP/answers. a/NNP/a. stack/NN/stack b/NNP/b. hashed/VBD/hashed symbol/NN/symbol table/NN/table c/NNP/c. sequential/JJ/sequential search/NN/search d/NNP/d. binary/NN/binary search/NN/search e/NNP/e. pure/NN/pure code/NN/code f/NNP/f. vector/NN/vector operations/NNS/operations a/DT/a indirection/NN/indirection b/NN/b 9.25/CD/9.25 when/WRB/when a/DT/a page/NN/page fault/NN/fault occurs/NNS/occurs /,/, the/DT/the process/NN/process requesting/VBG/requesting the/DT/the page/NN/page must/MD/must block/VB/block while/IN/while waiting/VBG/waiting for/IN/for the/DT/the page/NN/page to/TO/to be/VB/be brought/VBN/brought from/IN/from disk/NN/disk into/IN/into physical/JJ/physical memory/NNP/memory. assume/NN/assume that/WDT/that there/EX/there exists/VBZ/exists a/DT/a process/NN/process with/IN/with five/CD/five user-level/JJ/user-level threads/NNS/threads and/CC/and that/IN/that the/DT/the mapping/NN/mapping of/IN/of user/NN/user threads/NNS/threads to/TO/to kernel/VB/kernel threads/NNS/threads is/VBZ/is many/JJ/many to/TO/to one/NNP/one. if/IN/if one/CD/one user/NN/user thread/NN/thread incurs/NNS/incurs a/DT/a page/NN/page fault/NN/fault while/IN/while accessing/VBG/accessing its/PRP$/its stack/NN/stack /,/, would/MD/would the/DT/the other/JJ/other user/NN/user user/NN/user threads/NNS/threads belonging/VBG/belonging to/TO/to the/DT/the same/JJ/same process/NN/process also/RB/also be/VB/be affected/VBN/affected by/IN/by the/DT/the page/NN/page fault-that/JJ/fault-that is/VBZ/is /,/, would/MD/would they/PRP/they also/RB/also have/VBP/have to/TO/to wait/VB/wait for/IN/for the/DT/the faulting/VBG/faulting page/NN/page to/TO/to be/VB/be brought/VBN/brought into/IN/into memory/NN/memory explain/NNP/explain. 415/CD/415 9.26/CD/9.26 consider/NN/consider a/DT/a system/NN/system that/WDT/that uses/VBZ/uses pure/NN/pure demand/NN/demand paging/NNP/paging. a/NNP/a. when/WRB/when a/DT/a process/NN/process first/RB/first starts/VBZ/starts execution/NN/execution /,/, how/WRB/how would/MD/would you/PRP/you characterize/VB/characterize the/DT/the page/NN/page fault/NN/fault rate/NN/rate b/NNP/b. once/RB/once the/DT/the working/VBG/working set/NN/set for/IN/for a/DT/a process/NN/process is/VBZ/is loaded/VBN/loaded into/IN/into memory/NN/memory /,/, how/WRB/how would/MD/would you/PRP/you characterize/VB/characterize the/DT/the page/NN/page fault/NN/fault rate/NN/rate c/NNP/c. assume/NN/assume that/WDT/that a/DT/a process/NN/process changes/NNS/changes its/PRP$/its locality/NN/locality and/CC/and the/DT/the size/NN/size of/IN/of the/DT/the new/JJ/new working/NN/working set/NN/set is/VBZ/is too/RB/too large/JJ/large to/TO/to be/VB/be stored/VBN/stored in/IN/in available/JJ/available free/JJ/free memory/NNP/memory. identify/NN/identify some/DT/some options/NNS/options system/NN/system designers/NNS/designers could/MD/could choose/VB/choose from/IN/from to/TO/to handle/VB/handle this/DT/this situation/NNP/situation. 9.27/CD/9.27 assume/NN/assume that/WDT/that a/DT/a program/NN/program has/VBZ/has just/RB/just referenced/VBN/referenced an/DT/an address/NN/address in/IN/in virtual/JJ/virtual memory/NNP/memory. describe/NN/describe a/DT/a scenario/NN/scenario in/IN/in which/WDT/which each/DT/each of/IN/of the/DT/the following/JJ/following can/MD/can occur/NNP/occur. /:/( if/IN/if no/DT/no such/JJ/such scenario/NN/scenario can/MD/can occur/VB/occur /,/, explain/VB/explain why/NNP/why. /NNP/) tlb/NN/tlb miss/NN/miss with/IN/with no/DT/no page/NN/page fault/NN/fault tlb/NN/tlb miss/NN/miss and/CC/and page/NN/page fault/NN/fault tlb/NN/tlb hit/VBD/hit and/CC/and no/DT/no page/NN/page fault/NN/fault tlb/NN/tlb hit/VBD/hit and/CC/and page/NN/page fault/NN/fault 9.28/CD/9.28 a/DT/a certain/JJ/certain computer/NN/computer provides/VBZ/provides its/PRP$/its users/NNS/users with/IN/with a/DT/a virtual/JJ/virtual memory/NN/memory space/NN/space of/IN/of 232/CD/232 bytes/NNP/bytes. the/DT/the computer/NN/computer has/VBZ/has 218/CD/218 bytes/NNS/bytes of/IN/of physical/JJ/physical memory/NNP/memory. the/DT/the virtual/JJ/virtual memory/NN/memory is/VBZ/is implemented/VBN/implemented by/IN/by paging/NN/paging /,/, and/CC/and the/DT/the page/NN/page size/NN/size is/VBZ/is 4,096/CD/4,096 bytes/NNP/bytes. a/DT/a user/NN/user process/NN/process generates/VBZ/generates the/DT/the virtual/JJ/virtual address/NN/address 11123456/CD/11123456. explain/NN/explain how/WRB/how the/DT/the system/NN/system establishes/VBZ/establishes the/DT/the corresponding/NN/corresponding physical/JJ/physical location/NNP/location. distinguish/JJ/distinguish between/IN/between software/NN/software and/CC/and hardware/NN/hardware operations/NNP/operations. 9.29/CD/9.29 when/WRB/when virtual/JJ/virtual memory/NN/memory is/VBZ/is implemented/VBN/implemented in/IN/in a/DT/a computing/NN/computing system/NN/system /,/, there/EX/there are/VBP/are certain/JJ/certain costs/NNS/costs associated/VBN/associated with/IN/with the/DT/the technique/NN/technique and/CC/and certain/JJ/certain benefits/NNP/benefits. list/NN/list the/DT/the costs/NNS/costs and/CC/and the/DT/the benefits/NNP/benefits. is/VBZ/is it/PRP/it possible/JJ/possible for/IN/for the/DT/the costs/NNS/costs to/TO/to exceed/VB/exceed the/DT/the benefits/NNS/benefits if/IN/if it/PRP/it is/VBZ/is /,/, what/WP/what measures/NNS/measures can/MD/can be/VB/be taken/VBN/taken to/TO/to ensure/VB/ensure that/IN/that this/DT/this does/VBZ/does not/RB/not happen/VB/happen 9.30/CD/9.30 give/JJ/give an/DT/an example/NN/example that/IN/that illustrates/NNS/illustrates the/DT/the problem/NN/problem with/IN/with restarting/NN/restarting the/DT/the move/NN/move character/NN/character instruction/NN/instruction /:/( mvc/NN/mvc /:/) on/IN/on the/DT/the ibm/NN/ibm 360/370/CD/360/370 when/WRB/when the/DT/the source/NN/source and/CC/and destination/NN/destination regions/NNS/regions are/VBP/are overlapping/NNP/overlapping. 9.31/CD/9.31 consider/NN/consider the/DT/the parameter/NN/parameter 6/CD/6. used/VBN/used to/TO/to define/VB/define the/DT/the working-set/JJ/working-set window/NN/window in/IN/in the/DT/the working-set/JJ/working-set model/NNP/model. what/WP/what is/VBZ/is the/DT/the effect/NN/effect of/IN/of setting/VBG/setting 6/CD/6. to/TO/to a/DT/a small/JJ/small value/NN/value on/IN/on the/DT/the page-fault/JJ/page-fault frequency/NN/frequency and/CC/and the/DT/the number/NN/number of/IN/of active/JJ/active /NN/( nonsuspended/VBD/nonsuspended /CD/) processes/NNS/processes currently/RB/currently executing/VBG/executing in/IN/in the/DT/the system/NN/system what/WP/what is/VBZ/is the/DT/the effect/NN/effect when/WRB/when 6/CD/6. is/VBZ/is set/VBN/set to/TO/to a/DT/a very/RB/very high/JJ/high value/NN/value 9.32/CD/9.32 is/VBZ/is it/PRP/it possible/JJ/possible for/IN/for a/DT/a process/NN/process to/TO/to have/VB/have two/CD/two working/VBG/working sets/NNS/sets /,/, one/CD/one representing/VBG/representing data/NNS/data and/CC/and another/DT/another representing/VBG/representing code/NN/code explain/NNP/explain. 9.33/CD/9.33 suppose/NN/suppose that/WDT/that your/PRP$/your replacement/NN/replacement policy/NN/policy /:/( in/IN/in a/DT/a paged/JJ/paged system/NN/system /:/) is/VBZ/is to/TO/to examine/VB/examine each/DT/each page/NN/page regularly/RB/regularly and/CC/and to/TO/to discard/VB/discard that/IN/that page/NN/page if/IN/if it/PRP/it has/VBZ/has not/RB/not been/VBN/been used/VBN/used since/IN/since the/DT/the last/JJ/last examination/NNP/examination. what/WP/what would/MD/would you/PRP/you gain/VB/gain and/CC/and what/WP/what would/MD/would you/PRP/you lose/VB/lose by/IN/by using/VBG/using this/DT/this policy/NN/policy rather/RB/rather than/IN/than lru/NN/lru or/CC/or second-chance/NN/second-chance replacement/NN/replacement 416/CD/416 chapter/NN/chapter 9/CD/9 9.34/CD/9.34 write/JJ/write a/DT/a program/NN/program that/WDT/that implements/VBZ/implements the/DT/the fifo/NN/fifo and/CC/and lru/NN/lru page-replacement/NN/page-replacement algorithms/NNS/algorithms presented/VBD/presented in/IN/in this/DT/this chapter/NNP/chapter. first/RB/first /,/, generate/RB/generate a/DT/a random/NN/random pagereference/NN/pagereference string/VBG/string where/WRB/where page/NN/page numbers/NNS/numbers range/VBP/range from/IN/from 0/-NONE-/0 to/TO/to 9/CD/9. apply/RB/apply the/DT/the random/NN/random page-reference/NN/page-reference string/VBG/string to/TO/to each/DT/each algorithm/NN/algorithm /,/, and/CC/and record/VB/record the/DT/the number/NN/number of/IN/of page/NN/page faults/NNS/faults incurred/VBN/incurred by/IN/by each/DT/each algorithm/NNP/algorithm. implement/NN/implement the/DT/the replacement/NN/replacement algorithms/NNS/algorithms so/RB/so that/IN/that the/DT/the number/NN/number of/IN/of page/NN/page frames/NNS/frames can/MD/can vary/VB/vary from/IN/from 1/CD/1 to/TO/to 7/CD/7. assume/NN/assume that/WDT/that demand/NN/demand paging/VBG/paging is/VBZ/is used/NNP/used. 9.35/CD/9.35 the/DT/the catalan/NN/catalan numbers/NNS/numbers are/VBP/are an/DT/an integer/NN/integer sequence/NN/sequence c11/NNP/c11 that/IN/that appear/JJ/appear in/IN/in treeenumeration/NN/treeenumeration problems/NNP/problems. the/DT/the first/JJ/first catalan/NN/catalan numbers/NNS/numbers for/IN/for n/NN/n =/:/= 1/CD/1 /,/, 2/CD/2 /,/, 3/CD/3 /,/, /:/... are/VBP/are 1/CD/1 /,/, 2/CD/2 /,/, 5/CD/5 /,/, 14/CD/14 /,/, 42/CD/42 /,/, 132/CD/132 /,/, /:/.... a/DT/a formula/NN/formula generating/VBG/generating c11/NNP/c11 is/VBZ/is 1/CD/1 /CD/( 2n/CD/2n /CD/) /CD/( 2n/CD/2n /CD/) !/./! ell/NN/ell =/:/= /:/( n/NN/n +/:/+ 1/CD/1 /CD/) /:/-- ;/:/; ;/:/; =/:/= /:/( n/NN/n +/:/+ 1/CD/1 /CD/) !/./! n/NN/n !/./! design/NN/design two/CD/two programs/NNS/programs that/WDT/that communicate/JJ/communicate with/IN/with shared/JJ/shared memory/NN/memory using/VBG/using the/DT/the win32/NNP/win32 api/NN/api as/IN/as outlined/VBN/outlined in/IN/in section/NN/section 9.7.2/CD/9.7.2. the/DT/the producer/NN/producer process/NN/process will/MD/will generate/VB/generate the/DT/the catalan/NN/catalan sequence/NN/sequence and/CC/and write/VB/write it/PRP/it to/TO/to a/DT/a shared/VBN/shared memory/NN/memory object/NNP/object. the/DT/the consumer/NN/consumer process/NN/process will/MD/will then/RB/then read/VB/read and/CC/and output/VB/output the/DT/the sequence/NN/sequence from/IN/from shared/VBN/shared memory/NNP/memory. in/IN/in this/DT/this instance/NN/instance /,/, the/DT/the producer/NN/producer process/NN/process will/MD/will be/VB/be passed/VBN/passed an/DT/an integer/NN/integer parameter/NN/parameter on/IN/on the/DT/the command/NN/command line/NN/line specifying/VBG/specifying how/WRB/how many/JJ/many catalan/NN/catalan numbers/NNS/numbers to/TO/to produce/VB/produce /:/( for/IN/for example/NN/example /,/, providing/NN/providing 5/CD/5 on/IN/on the/DT/the command/NN/command line/NN/line means/VBZ/means the/DT/the producer/NN/producer process/NN/process will/MD/will generate/VB/generate the/DT/the first/JJ/first five/CD/five catalan/NN/catalan numbers/NNS/numbers /:/) /./. demand/NN/demand paging/VBG/paging was/VBD/was first/JJ/first used/VBN/used iil/NN/iil the/DT/the atlas/NNS/atlas system/NN/system /,/, implemented/VBD/implemented on/IN/on the/DT/the manchester/NN/manchester university/NN/university muse/NN/muse computer/NN/computer around/IN/around 1960/CD/1960 /CD/( kilburn/NN/kilburn et/NN/et al/NNP/al. /NNP/[ 1961/CD/1961 /CD/] /CD/) /./. another/DT/another early/JJ/early demand-paging/JJ/demand-paging system/NN/system was/VBD/was multics/NNS/multics /,/, implemented/VBD/implemented on/IN/on the/DT/the ge/NN/ge 645/CD/645 system/NN/system /:/( organick/NN/organick /:/[ 1972/CD/1972 /CD/] /CD/) /./. belady/JJ/belady et/NN/et al/NNP/al. /NNP/[ 1969/CD/1969 /CD/] were/VBD/were the/DT/the first/JJ/first researchers/NNS/researchers to/TO/to observe/VB/observe that/IN/that the/DT/the fifo/NN/fifo replacement/NN/replacement strategy/NN/strategy may/MD/may produce/VB/produce the/DT/the anomaly/RB/anomaly that/IN/that bears/NNS/bears belady/RB/belady 's/VBZ/'s name/NNP/name. mattson/NN/mattson et/NN/et al/NNP/al. /NNP/[ 1970/CD/1970 /CD/] demonstrated/VBN/demonstrated that/IN/that stack/NN/stack algorithms/NNS/algorithms are/VBP/are not/RB/not subject/JJ/subject to/TO/to belady/JJ/belady 's/POS/'s anomaly/NNP/anomaly. the/DT/the optimal/JJ/optimal replacement/NN/replacement algorithm/NN/algorithm was/VBD/was presented/VBN/presented by/IN/by belady/RB/belady /:/[ 1966/CD/1966 /CD/] and/CC/and was/VBD/was proved/VBN/proved to/TO/to be/VB/be optimal/JJ/optimal by/IN/by mattson/NN/mattson et/NN/et al/NNP/al. /NNP/[ 1970/CD/1970 /CD/] /./. belady/JJ/belady '/''/' s/NNS/s optimal/JJ/optimal algorithm/NN/algorithm is/VBZ/is for/IN/for a/DT/a fixed/VBN/fixed allocation/NN/allocation ;/:/; prieve/NN/prieve and/CC/and fabry/NN/fabry /:/[ 1976/CD/1976 /CD/] presented/VBN/presented an/DT/an optimal/JJ/optimal algorithm/NN/algorithm for/IN/for situations/NNS/situations in/IN/in which/WDT/which the/DT/the allocation/NN/allocation can/MD/can vary/NNP/vary. the/DT/the enl/NN/enl lanced/VBD/lanced clock/NN/clock algorithm/NN/algorithm was/VBD/was discussed/VBN/discussed by/IN/by carr/NN/carr and/CC/and hennessy/NN/hennessy /:/[ 1981/CD/1981 /CD/] /./. the/DT/the working-set/JJ/working-set model/NN/model was/VBD/was developed/VBN/developed by/IN/by denning/NN/denning /:/[ 1968/CD/1968 /CD/] /./. discussions/NNS/discussions concerning/VBG/concerning the/DT/the working-set/JJ/working-set model/NN/model were/VBD/were presented/VBN/presented by/IN/by denning/NN/denning /:/[ 1980/CD/1980 /CD/] /./. the/DT/the scheme/NN/scheme for/IN/for monitoring/NN/monitoring the/DT/the page-fault/JJ/page-fault rate/NN/rate was/VBD/was developed/VBN/developed by/IN/by wulf/NN/wulf /:/[ 1969/CD/1969 /CD/] /,/, who/WP/who successfully/RB/successfully applied/VBD/applied this/DT/this technique/NN/technique to/TO/to the/DT/the burroughs/NNS/burroughs bssoo/VBP/bssoo computer/NN/computer system/NNP/system. wilson/NN/wilson et/NN/et al/NNP/al. /NNP/[ 1995/CD/1995 /CD/] presented/VBN/presented several/JJ/several algoritluns/NNS/algoritluns for/IN/for dynamic/JJ/dynamic memory/NN/memory allocation/NNP/allocation. jolmstone/NN/jolmstone and/CC/and wilson/NN/wilson /:/[ 1998/CD/1998 /CD/] described/VBN/described various/JJ/various memory-fragmentation/NN/memory-fragmentation 417/CD/417 issues/NNP/issues. buddy/NN/buddy system/NN/system memory/NN/memory allocators/NNS/allocators were/VBD/were described/VBN/described in/IN/in knowlton/NN/knowlton /:/[ 1965l/CD/1965l peterson/NN/peterson and/CC/and norman/NN/norman /:/[ 1977/CD/1977 /CD/] /,/, and/CC/and purdom/NN/purdom /,/, jr/NNP/jr. and/CC/and stigler/NN/stigler /:/[ 1970/CD/1970 /CD/] /./. bonwick/NN/bonwick /:/[ 1994/CD/1994 /CD/] discussed/VBN/discussed the/DT/the slab/NN/slab allocator/NN/allocator /,/, and/CC/and bonwick/VB/bonwick and/CC/and adams/NNS/adams /:/[ 2001/CD/2001 /CD/] extended/JJ/extended the/DT/the discussion/NN/discussion to/TO/to multiple/VB/multiple processors/NNP/processors. other/JJ/other memory-fitting/JJ/memory-fitting algorithms/NNS/algorithms can/MD/can be/VB/be found/VBN/found in/IN/in stephenson/NN/stephenson /:/[ 1983/CD/1983 /CD/] /,/, bays/NNS/bays /:/[ 1977/CD/1977 /CD/] /,/, and/CC/and brent/NN/brent /:/[ 1989/CD/1989 /CD/] /./. a/DT/a survey/NN/survey of/IN/of memory-allocation/NN/memory-allocation strategies/NNS/strategies can/MD/can be/VB/be found/VBN/found in/IN/in wilson/NN/wilson et/NN/et al/NNP/al. /NNP/[ 1995/CD/1995 /CD/] /./. solomon/NN/solomon and/CC/and russinovich/NN/russinovich /:/[ 2000/CD/2000 /CD/] and/CC/and russinovich/JJ/russinovich and/CC/and solomon/NN/solomon /:/[ 2005/CD/2005 /CD/] described/VBN/described how/WRB/how windows/NNS/windows implements/NNS/implements virtual/JJ/virtual memory/NNP/memory. mcdougall/NN/mcdougall and/CC/and mauro/NN/mauro /:/[ 2007/CD/2007 /CD/] discussed/VBN/discussed virtual/JJ/virtual memory/NN/memory in/IN/in solaris/NNP/solaris. virtual/JJ/virtual memory/NN/memory techniques/NNS/techniques in/IN/in linux/NN/linux and/CC/and bsd/VBD/bsd were/VBD/were described/VBN/described by/IN/by bovet/NN/bovet and/CC/and cesati/NN/cesati /:/[ 2002/CD/2002 /CD/] and/CC/and mckusick/NN/mckusick et/NN/et al/NNP/al. /NNP/[ 1996/CD/1996 /CD/] /,/, respectively/NNP/respectively. ganapathy/NN/ganapathy and/CC/and schimmel/NN/schimmel /:/[ 1998/CD/1998 /CD/] and/CC/and navarro/NN/navarro et/NN/et al/NNP/al. /NNP/[ 2002/CD/2002 /CD/] discussed/VBN/discussed operating/NN/operating system/NN/system support/NN/support for/IN/for multiple/NN/multiple page/NN/page sizes/NNP/sizes. ortiz/NN/ortiz /:/[ 2001/CD/2001 /CD/] described/VBN/described virtual/JJ/virtual memory/NN/memory used/VBN/used in/IN/in a/DT/a real-time/JJ/real-time embedded/VBN/embedded operating/NN/operating system/NNP/system. jacob/NN/jacob and/CC/and mudge/NN/mudge /:/[ 1998b/CD/1998b /CD/] compared/VBN/compared implementations/NNS/implementations of/IN/of virtual/JJ/virtual memory/NN/memory in/IN/in the/DT/the mips/NNS/mips /,/, powerpc/NN/powerpc /,/, and/CC/and pentium/NN/pentium architectures/NNP/architectures. a/DT/a companion/NN/companion article/NN/article /:/( jacob/NN/jacob and/CC/and mudge/NN/mudge /:/[ 1998a/CD/1998a /CD/] /CD/) described/VBN/described the/DT/the hardware/NN/hardware support/NN/support necessary/JJ/necessary for/IN/for implementation/NN/implementation of/IN/of virtual/JJ/virtual memory/NN/memory in/IN/in six/CD/six different/JJ/different architectures/NNS/architectures /,/, including/VBG/including the/DT/the ultrasparc/NNP/ultrasparc. part/NN/part five/CD/five since/IN/since main/JJ/main memory/NN/memory is/VBZ/is usually/RB/usually too/RB/too small/JJ/small to/TO/to accommodate/VB/accommodate all/DT/all the/DT/the data/NNS/data and/CC/and programs/NNS/programs permanently/RB/permanently /,/, the/DT/the computer/NN/computer system/NN/system must/MD/must provide/VB/provide secondary/JJ/secondary storage/NN/storage to/TO/to back/VB/back up/IN/up main/JJ/main memory/NNP/memory. modern/NN/modern computer/NN/computer systems/NNS/systems use/VBP/use disks/NNS/disks as/IN/as the/DT/the primary/JJ/primary on-line/NN/on-line storage/NN/storage medium/NN/medium for/IN/for information/NN/information /:/( both/DT/both programs/NNS/programs and/CC/and data/NNS/data /:/) /./. the/DT/the file/NN/file system/NN/system provides/VBZ/provides the/DT/the mechanism/NN/mechanism for/IN/for on-line/JJ/on-line storage/NN/storage of/IN/of and/CC/and access/NN/access to/TO/to both/DT/both data/NNS/data and/CC/and programs/NNS/programs residing/VBG/residing on/IN/on the/DT/the disks/NNP/disks. a/DT/a file/NN/file is/VBZ/is a/DT/a collection/NN/collection of/IN/of related/JJ/related information/NN/information defined/VBD/defined by/IN/by its/PRP$/its creator/NNP/creator. the/DT/the files/NNS/files are/VBP/are mapped/VBN/mapped by/IN/by the/DT/the operating/NN/operating system/NN/system onto/IN/onto physical/JJ/physical devices/NNP/devices. files/NNS/files are/VBP/are normally/RB/normally organized/VBN/organized into/IN/into directories/NNS/directories for/IN/for ease/NN/ease of/IN/of use/NNP/use. the/DT/the devices/NNS/devices that/WDT/that attach/DT/attach to/TO/to a/DT/a computer/NN/computer vary/NN/vary in/IN/in many/JJ/many aspects/NNP/aspects. some/DT/some devices/NNS/devices transfer/VBP/transfer a/DT/a character/NN/character or/CC/or a/DT/a block/NN/block of/IN/of characters/NNS/characters at/IN/at a/DT/a time/NNP/time. some/DT/some can/MD/can be/VB/be accessed/VBN/accessed only/RB/only sequentially/RB/sequentially /,/, others/NNS/others randomly/NNP/randomly. some/DT/some transfer/NN/transfer data/NNS/data synchronously/RB/synchronously /,/, others/NNS/others asynchronously/NNP/asynchronously. some/DT/some are/VBP/are dedicated/VBN/dedicated /,/, some/DT/some shared/NNP/shared. they/PRP/they can/MD/can be/VB/be read-only/RB/read-only or/CC/or read-write/NNP/read-write. they/PRP/they vary/VBP/vary greatly/RB/greatly in/IN/in speed/NNP/speed. in/IN/in many/JJ/many ways/NNS/ways /,/, they/PRP/they are/VBP/are also/RB/also the/DT/the slowest/JJS/slowest major/JJ/major component/NN/component of/IN/of the/DT/the computer/NNP/computer. because/IN/because of/IN/of all/DT/all this/DT/this device/NN/device variation/NN/variation /,/, the/DT/the operating/NN/operating system/NN/system needs/VBZ/needs to/TO/to provide/VB/provide a/DT/a wide/JJ/wide range/NN/range of/IN/of functionality/NN/functionality to/TO/to applications/NNS/applications /,/, to/TO/to allow/VB/allow them/PRP/them to/TO/to control/NN/control all/DT/all aspects/NNS/aspects of/IN/of the/DT/the devices/NNP/devices. one/CD/one key/JJ/key goal/NN/goal of/IN/of an/DT/an operating/NN/operating system/NN/system 's/POS/'s 1/0/CD/1/0 subsystem/NN/subsystem is/VBZ/is to/TO/to provide/VB/provide the/DT/the simplest/JJS/simplest interface/NN/interface possible/JJ/possible to/TO/to the/DT/the rest/NN/rest of/IN/of the/DT/the system/NNP/system. because/IN/because devices/NNS/devices are/VBP/are a/DT/a performance/NN/performance bottleneck/NN/bottleneck /,/, another/DT/another key/NN/key is/VBZ/is to/TO/to optimize/VB/optimize 1/0/CD/1/0 for/IN/for maximum/NN/maximum concurrency/NNP/concurrency. 
productivity/NN/productivity experts/NNS/experts say/VBP/say that/IN/that breakthroughs/NNS/breakthroughs come/VBP/come by/IN/by thinking/VBG/thinking nonlinearly/NNP/nonlinearly. in/IN/in this/DT/this chapter/NN/chapter /,/, we/PRP/we discuss/VBP/discuss one/CD/one of/IN/of the/DT/the most/RBS/most important/JJ/important nonlinear/NN/nonlinear data/NNS/data structures/NNS/structures in/IN/in computing/NN/computing trees/NNP/trees. tree/NN/tree structures/NNS/structures are/VBP/are indeed/RB/indeed a/DT/a breakthrough/JJ/breakthrough in/IN/in data/NNS/data organization/NN/organization /,/, for/IN/for they/PRP/they allow/VBP/allow us/PRP/us to/TO/to implement/VB/implement a/DT/a host/NN/host of/IN/of algorithms/NNS/algorithms much/RB/much faster/JJR/faster than/IN/than when/WRB/when using/VBG/using linear/NN/linear data/NNS/data structures/NNS/structures /,/, such/JJ/such as/IN/as array-based/JJ/array-based lists/NNS/lists or/CC/or linked/VBN/linked lists/NNP/lists. trees/NNS/trees also/RB/also provide/VB/provide a/DT/a natural/JJ/natural organization/NN/organization for/IN/for data/NNS/data /,/, and/CC/and consequently/RB/consequently have/VBP/have become/VBN/become ubiquitous/JJ/ubiquitous structures/NNS/structures in/IN/in file/NN/file systems/NNS/systems /,/, graphical/JJ/graphical user/NN/user interfaces/NNS/interfaces /,/, databases/NNS/databases /,/, web/NN/web sites/NNS/sites /,/, and/CC/and other/JJ/other computer/NN/computer systems/NNP/systems. it/PRP/it is/VBZ/is not/RB/not always/RB/always clear/JJ/clear what/WP/what productivity/NN/productivity experts/NNS/experts mean/VBP/mean by/IN/by nonlinear/JJ/nonlinear thinking/VBG/thinking /,/, but/CC/but when/WRB/when we/PRP/we say/VBP/say that/IN/that trees/NNS/trees are/VBP/are nonlinear/JJ/nonlinear /,/, we/PRP/we are/VBP/are referring/VBG/referring to/TO/to an/DT/an organizational/JJ/organizational relationship/NN/relationship that/WDT/that is/VBZ/is richer/RBR/richer than/IN/than the/DT/the simple/JJ/simple before/IN/before and/CC/and after/IN/after relationships/NNS/relationships between/IN/between objects/NNS/objects in/IN/in sequences/NNP/sequences. the/DT/the relationships/NNS/relationships in/IN/in a/DT/a tree/NN/tree are/VBP/are hierarchical/JJ/hierarchical /,/, with/IN/with some/DT/some objects/NNS/objects being/VBG/being above/IN/above and/CC/and some/DT/some below/IN/below others/NNP/others. actually/RB/actually /,/, the/DT/the main/JJ/main terminology/NN/terminology for/IN/for tree/NN/tree data/NNS/data structures/NNS/structures comes/VBZ/comes from/IN/from family/NN/family trees/NNS/trees /,/, with/IN/with the/DT/the terms/NNS/terms parent/NN/parent /,/, child/NN/child /,/, ancestor/NN/ancestor /,/, and/CC/and descendant/JJ/descendant being/VBG/being the/DT/the most/JJS/most common/JJ/common words/NNS/words used/VBN/used to/TO/to describe/VB/describe relationships/NNP/relationships. we/PRP/we show/VBP/show an/DT/an example/NN/example of/IN/of a/DT/a family/NN/family tree/NN/tree in/IN/in figure/NN/figure 8.1/CD/8.1. 8.1/CD/8.1. general/JJ/general trees/NNS/trees 8.1.1/CD/8.1.1 tree/NN/tree definitions/NNS/definitions and/CC/and properties/NNS/properties a/DT/a tree/NN/tree is/VBZ/is an/DT/an abstract/NN/abstract data/NNS/data type/NN/type that/IN/that stores/NNS/stores elements/NNS/elements hierarchically/NNP/hierarchically. with/IN/with the/DT/the exception/NN/exception of/IN/of the/DT/the top/JJ/top element/NN/element /,/, each/DT/each element/NN/element in/IN/in a/DT/a tree/NN/tree has/VBZ/has a/DT/a parent/NN/parent element/NN/element and/CC/and zero/CD/zero or/CC/or more/JJR/more children/NNS/children elements/NNP/elements. a/DT/a tree/NN/tree is/VBZ/is usually/RB/usually visualized/VBN/visualized by/IN/by placing/NN/placing elements/NNS/elements inside/VBP/inside ovals/NNS/ovals or/CC/or rectangles/NNS/rectangles /,/, and/CC/and by/IN/by drawing/NN/drawing the/DT/the connections/NNS/connections between/IN/between parents/NNS/parents and/CC/and children/NNS/children with/IN/with straight/JJ/straight lines/NNP/lines. /NNP/( see/VB/see figure/NN/figure 8.2/CD/8.2. /CD/) we/PRP/we typically/RB/typically call/VBP/call the/DT/the top/JJ/top element/NN/element the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree /,/, but/CC/but it/PRP/it is/VBZ/is drawn/VBN/drawn as/RB/as the/DT/the highest/JJS/highest element/NN/element /,/, with/IN/with the/DT/the other/JJ/other elements/NNS/elements being/VBG/being connected/VBN/connected below/IN/below /NNP/( just/RB/just the/DT/the opposite/JJ/opposite of/IN/of a/DT/a botanical/JJ/botanical tree/NN/tree /:/) /./. africa/NN/africa europe/NN/europe asia/NN/asia australia/NN/australia canada/NN/canada s/NNP/s. america/NN/america overseas/RB/overseas domestic/JJ/domestic international/JJ/international tv/NN/tv cd/NN/cd tuner/NN/tuner r&d/JJ/r&d sales/NNS/sales purchasing/VBG/purchasing manufacturing/NN/manufacturing electronics/NNS/electronics r/NN/r us/PRP/us figure/VBP/figure 8.2/CD/8.2 /:/: a/DT/a tree/NN/tree with/IN/with 17/CD/17 nodes/NNS/nodes representing/VBG/representing the/DT/the organization/NN/organization of/IN/of a/DT/a fictitious/JJ/fictitious corporation/NNP/corporation. the/DT/the root/NN/root stores/NNS/stores electronics/NNS/electronics r/VBP/r us/NNP/us. the/DT/the children/NNS/children of/IN/of the/DT/the root/NN/root store/NN/store r&d/JJ/r&d /,/, sales/NNS/sales /,/, purchasing/VBG/purchasing /,/, and/CC/and manufacturing/NNP/manufacturing. the/DT/the internal/JJ/internal nodes/NNS/nodes store/VBP/store sales/NNS/sales /,/, international/JJ/international /,/, overseas/JJ/overseas /,/, electronics/NNS/electronics r/VBP/r us/PRP/us /,/, and/CC/and manufacturing/NNP/manufacturing. formal/JJ/formal tree/NN/tree definition/NN/definition formally/RB/formally /,/, we/PRP/we define/VBP/define a/DT/a tree/NN/tree t/NN/t as/IN/as a/DT/a set/NN/set of/IN/of nodes/NNS/nodes storing/VBG/storing elements/NNS/elements such/JJ/such that/IN/that the/DT/the nodes/NNS/nodes have/VBP/have a/DT/a parent-child/JJ/parent-child relationship/NN/relationship that/WDT/that satisfies/VBZ/satisfies the/DT/the following/VBG/following properties/NNS/properties /:/: if/IN/if t/NN/t is/VBZ/is nonempty/JJ/nonempty /,/, it/PRP/it has/VBZ/has a/DT/a special/JJ/special node/NN/node /,/, called/VBN/called the/DT/the root/NN/root of/IN/of t/NN/t /,/, that/IN/that has/VBZ/has no/DT/no parent/NNP/parent. each/DT/each node/NN/node v/NN/v of/IN/of t/NN/t different/JJ/different from/IN/from the/DT/the root/NN/root has/VBZ/has a/DT/a unique/JJ/unique parent/NN/parent node/NN/node w/NN/w ;/:/; every/DT/every node/NN/node with/IN/with parent/NN/parent w/NN/w is/VBZ/is a/DT/a child/NN/child of/IN/of w/NNP/w. note/NN/note that/IN/that according/VBG/according to/TO/to our/PRP$/our definition/NN/definition /,/, a/DT/a tree/NN/tree can/MD/can be/VB/be empty/JJ/empty /,/, meaning/NN/meaning that/IN/that it/PRP/it does/VBZ/does not/RB/not have/VB/have any/DT/any nodes/NNP/nodes. this/DT/this convention/NN/convention also/RB/also allows/VBZ/allows us/PRP/us to/TO/to define/VB/define a/DT/a tree/NN/tree recursively/RB/recursively such/JJ/such that/IN/that a/DT/a tree/NN/tree t/NN/t is/VBZ/is either/DT/either empty/NN/empty or/CC/or consists/NNS/consists of/IN/of a/DT/a node/NN/node r/NN/r /,/, called/VBN/called the/DT/the root/NN/root of/IN/of t/NN/t /,/, and/CC/and a/DT/a /NN/( possibly/RB/possibly empty/JJ/empty /NN/) set/NN/set of/IN/of subtrees/NNS/subtrees whose/WP$/whose roots/NNS/roots are/VBP/are the/DT/the children/NNS/children of/IN/of r/NNP/r. 302/CD/302 chapter/NN/chapter 8/CD/8. trees/NNS/trees other/JJ/other node/NN/node relationships/NNS/relationships two/CD/two nodes/NNS/nodes that/WDT/that are/VBP/are children/NNS/children of/IN/of the/DT/the same/JJ/same parent/NN/parent are/VBP/are siblings/NNP/siblings. a/DT/a node/NN/node v/NN/v is/VBZ/is external/JJ/external if/IN/if v/NN/v has/VBZ/has no/DT/no children/NNP/children. a/DT/a node/NN/node v/NN/v is/VBZ/is internal/JJ/internal if/IN/if it/PRP/it has/VBZ/has one/CD/one or/CC/or more/JJR/more children/NNP/children. external/JJ/external nodes/NNS/nodes are/VBP/are also/RB/also known/VBN/known as/IN/as leaves/NNP/leaves. example/NN/example 8.1/CD/8.1 /:/: in/IN/in section/NN/section 4.1.4/CD/4.1.4 /,/, we/PRP/we discussed/VBD/discussed the/DT/the hierarchical/JJ/hierarchical relationship/NN/relationship between/IN/between files/NNS/files and/CC/and directories/NNS/directories in/IN/in a/DT/a computer/NN/computer s/VBZ/s file/JJ/file system/NN/system /,/, although/IN/although at/IN/at the/DT/the time/NN/time we/PRP/we did/VBD/did not/RB/not emphasize/VB/emphasize the/DT/the nomenclature/NN/nomenclature of/IN/of a/DT/a file/NN/file system/NN/system as/IN/as a/DT/a tree/NNP/tree. in/IN/in figure/NN/figure 8.3/CD/8.3 /,/, we/PRP/we revisit/VBP/revisit an/DT/an earlier/JJR/earlier example/NNP/example. we/PRP/we see/VBP/see that/IN/that the/DT/the internal/JJ/internal nodes/NNS/nodes of/IN/of the/DT/the tree/NN/tree are/VBP/are associated/VBN/associated with/IN/with directories/NNS/directories and/CC/and the/DT/the leaves/NNS/leaves are/VBP/are associated/VBN/associated with/IN/with regular/JJ/regular files/NNP/files. in/IN/in the/DT/the unix/NN/unix and/CC/and linux/NN/linux operating/VBG/operating systems/NNS/systems /,/, the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree is/VBZ/is appropriately/RB/appropriately called/VBN/called the/DT/the root/NN/root directory/NN/directory /,/, and/CC/and is/VBZ/is represented/VBN/represented by/IN/by the/DT/the symbol/NN/symbol //://. /user/rt/courses//JJ//user/rt/courses/ cs016//NN/cs016/ cs252//NN/cs252/ homeworks//NN/homeworks/ programs//NN/programs/ projects//NN/projects/ papers//NN/papers/ demos//NN/demos/ hw1/NNP/hw1 hw2/NNP/hw2 hw3/NNP/hw3 pr1/NNP/pr1 pr2/NNP/pr2 pr3/NNP/pr3 grades/VBZ/grades buylow/JJ/buylow sellhigh/NN/sellhigh market/NN/market grades/VBZ/grades figure/NN/figure 8.3/CD/8.3 /:/: tree/JJ/tree representing/NN/representing a/DT/a portion/NN/portion of/IN/of a/DT/a file/NN/file system/NNP/system. a/DT/a node/NN/node u/NN/u is/VBZ/is an/DT/an ancestor/NN/ancestor of/IN/of a/DT/a node/NN/node v/NN/v if/IN/if u/NN/u =/:/= v/NN/v or/CC/or u/VB/u is/VBZ/is an/DT/an ancestor/NN/ancestor of/IN/of the/DT/the parent/NN/parent of/IN/of v/NNP/v. conversely/RB/conversely /,/, we/PRP/we say/VBP/say that/IN/that a/DT/a node/NN/node v/NN/v is/VBZ/is a/DT/a descendant/JJ/descendant of/IN/of a/DT/a node/NN/node u/NN/u if/IN/if u/NN/u is/VBZ/is an/DT/an ancestor/NN/ancestor of/IN/of v/NNP/v. for/IN/for example/NN/example /,/, in/IN/in figure/NN/figure 8.3/CD/8.3 /,/, cs252//NNP/cs252/ is/VBZ/is an/DT/an ancestor/NN/ancestor of/IN/of papers//NNP/papers/ /,/, and/CC/and pr3/NNP/pr3 is/VBZ/is a/DT/a descendant/JJ/descendant of/IN/of cs016//NNP/cs016/. the/DT/the subtree/NN/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at a/DT/a node/NN/node v/NN/v is/VBZ/is the/DT/the tree/NN/tree consisting/VBG/consisting of/IN/of all/DT/all the/DT/the descendants/NNS/descendants of/IN/of v/NN/v in/IN/in t/NN/t /:/( including/VBG/including v/NN/v itself/PRP/itself /:/) /./. in/IN/in figure/NN/figure 8.3/CD/8.3 /,/, the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at cs016//JJ/cs016/ consists/NNS/consists of/IN/of the/DT/the nodes/NNS/nodes cs016//-NONE-/cs016/ /,/, grades/VBZ/grades /,/, homeworks//NNP/homeworks/ /,/, programs//NNP/programs/ /,/, hw1/NNP/hw1 /,/, hw2/NNP/hw2 /,/, hw3/NNP/hw3 /,/, pr1/NNP/pr1 /,/, pr2/NNP/pr2 /,/, and/CC/and pr3/NNP/pr3. edges/NNS/edges and/CC/and paths/NNS/paths in/IN/in trees/NNS/trees an/DT/an edge/NN/edge of/IN/of tree/NN/tree t/NN/t is/VBZ/is a/DT/a pair/NN/pair of/IN/of nodes/NNS/nodes /:/( u,v/JJ/u,v /NN/) such/JJ/such that/IN/that u/NN/u is/VBZ/is the/DT/the parent/NN/parent of/IN/of v/NN/v /,/, or/CC/or vice/NN/vice versa/NNP/versa. a/DT/a path/NN/path of/IN/of t/NN/t is/VBZ/is a/DT/a sequence/NN/sequence of/IN/of nodes/NNS/nodes such/JJ/such that/IN/that any/DT/any two/CD/two consecutive/JJ/consecutive nodes/NNS/nodes in/IN/in the/DT/the sequence/NN/sequence form/NN/form an/DT/an edge/NNP/edge. for/IN/for example/NN/example /,/, the/DT/the tree/NN/tree in/IN/in figure/NN/figure 8.3/CD/8.3 contains/NNS/contains the/DT/the path/NN/path /:/( cs252//JJ/cs252/ /,/, projects//JJ/projects/ /,/, demos//JJ/demos/ /,/, market/NN/market /:/) /./. 8.1/CD/8.1. general/JJ/general trees/NNS/trees 303/CD/303 example/NN/example 8.2/CD/8.2 /:/: the/DT/the inheritance/NN/inheritance relation/NN/relation between/IN/between classes/NNS/classes in/IN/in a/DT/a python/NN/python program/NN/program forms/NNS/forms a/DT/a tree/NN/tree when/WRB/when single/JJ/single inheritance/NN/inheritance is/VBZ/is used/NNP/used. for/IN/for example/NN/example /,/, in/IN/in section/NN/section 2.4/CD/2.4 we/PRP/we provided/VBD/provided a/DT/a summary/NN/summary of/IN/of the/DT/the hierarchy/JJ/hierarchy for/IN/for python/NN/python s/NNS/s exception/NN/exception types/NNS/types /,/, as/IN/as portrayed/VBN/portrayed in/IN/in figure/NN/figure 8.4/CD/8.4 /CD/( originally/RB/originally figure/NN/figure 2.5/CD/2.5 /CD/) /./. the/DT/the baseexception/NN/baseexception class/NN/class is/VBZ/is the/DT/the root/NN/root of/IN/of that/DT/that hierarchy/JJ/hierarchy /,/, while/IN/while all/DT/all user-defined/JJ/user-defined exception/NN/exception classes/NNS/classes should/MD/should conventionally/RB/conventionally be/VB/be declared/VBN/declared as/IN/as descendants/NNS/descendants of/IN/of the/DT/the more/RBR/more specific/JJ/specific exception/NN/exception class/NNP/class. /NNP/( see/VB/see /,/, for/IN/for example/NN/example /,/, the/DT/the empty/NN/empty class/NN/class we/PRP/we introduced/VBD/introduced in/IN/in code/NN/code fragment/NN/fragment 6.1/CD/6.1 of/IN/of chapter/NN/chapter 6/CD/6. /CD/) figure/NN/figure 8.4/CD/8.4 /:/: a/DT/a portion/NN/portion of/IN/of python/NN/python s/NNS/s hierarchy/VBP/hierarchy of/IN/of exception/NN/exception types/NNP/types. in/IN/in python/NN/python /,/, all/DT/all classes/NNS/classes are/VBP/are organized/VBN/organized into/IN/into a/DT/a single/JJ/single hierarchy/NN/hierarchy /,/, as/IN/as there/EX/there exists/NNS/exists a/DT/a built-in/JJ/built-in class/NN/class named/VBD/named object/NN/object as/IN/as the/DT/the ultimate/JJ/ultimate base/NN/base class/NNP/class. it/PRP/it is/VBZ/is a/DT/a direct/JJ/direct or/CC/or indirect/JJ/indirect base/NN/base class/NN/class of/IN/of all/DT/all other/JJ/other types/NNS/types in/IN/in python/NN/python /:/( even/RB/even if/IN/if not/RB/not declared/VBN/declared as/IN/as such/JJ/such when/WRB/when defining/VBG/defining a/DT/a new/JJ/new class/NN/class /:/) /./. therefore/RB/therefore /,/, the/DT/the hierarchy/NN/hierarchy pictured/VBD/pictured in/IN/in figure/NN/figure 8.4/CD/8.4 is/VBZ/is only/RB/only a/DT/a portion/NN/portion of/IN/of python/NN/python s/NNS/s complete/VBP/complete class/NN/class hierarchy/NNP/hierarchy. as/IN/as a/DT/a preview/NN/preview of/IN/of the/DT/the remainder/NN/remainder of/IN/of this/DT/this chapter/NN/chapter /,/, figure/NN/figure 8.5/CD/8.5 portrays/NNS/portrays our/PRP$/our own/JJ/own hierarchy/NN/hierarchy of/IN/of classes/NNS/classes for/IN/for representing/VBG/representing various/JJ/various forms/NNS/forms of/IN/of a/DT/a tree/NNP/tree. arraybinarytree/NN/arraybinarytree linkedbinarytree/NN/linkedbinarytree tree/NN/tree binarytree/NN/binarytree linkedtree/NN/linkedtree figure/NN/figure 8.5/CD/8.5 /:/: our/PRP$/our own/JJ/own inheritance/NN/inheritance hierarchy/NN/hierarchy for/IN/for modeling/NN/modeling various/JJ/various abstractions/NNS/abstractions and/CC/and implementations/NNS/implementations of/IN/of tree/NN/tree data/NNS/data structures/NNP/structures. in/IN/in the/DT/the remainder/NN/remainder of/IN/of this/DT/this chapter/NN/chapter /,/, we/PRP/we provide/VBP/provide implementations/NNS/implementations of/IN/of tree/NN/tree /,/, binarytree/JJ/binarytree /,/, and/CC/and linkedbinarytree/VB/linkedbinarytree classes/NNS/classes /,/, and/CC/and highlevel/NN/highlevel sketches/NNS/sketches for/IN/for how/WRB/how linkedtree/JJ/linkedtree and/CC/and arraybinarytree/JJ/arraybinarytree might/NN/might be/VB/be designed/NNP/designed. 304/CD/304 chapter/NN/chapter 8/CD/8. trees/NNS/trees ordered/VBN/ordered trees/NNS/trees a/DT/a tree/NN/tree is/VBZ/is ordered/VBN/ordered if/IN/if there/EX/there is/VBZ/is a/DT/a meaningful/JJ/meaningful linear/NN/linear order/NN/order among/IN/among the/DT/the children/NNS/children of/IN/of each/DT/each node/NN/node ;/:/; that/DT/that is/VBZ/is /,/, we/PRP/we purposefully/RB/purposefully identify/VBP/identify the/DT/the children/NNS/children of/IN/of a/DT/a node/NN/node as/IN/as being/VBG/being the/DT/the first/JJ/first /,/, second/JJ/second /,/, third/JJ/third /,/, and/CC/and so/RB/so on/NNP/on. such/JJ/such an/DT/an order/NN/order is/VBZ/is usually/RB/usually visualized/VBN/visualized by/IN/by arranging/NN/arranging siblings/NNS/siblings left/VBN/left to/TO/to right/RB/right /,/, according/VBG/according to/TO/to their/PRP$/their order/NNP/order. example/NN/example 8.3/CD/8.3 /:/: the/DT/the components/NNS/components of/IN/of a/DT/a structured/VBN/structured document/NN/document /,/, such/JJ/such as/IN/as a/DT/a book/NN/book /,/, are/VBP/are hierarchically/RB/hierarchically organized/VBN/organized as/IN/as a/DT/a tree/NN/tree whose/WP$/whose internal/JJ/internal nodes/NNS/nodes are/VBP/are parts/NNS/parts /,/, chapters/NNS/chapters /,/, and/CC/and sections/NNS/sections /,/, and/CC/and whose/WP$/whose leaves/NNS/leaves are/VBP/are paragraphs/NNS/paragraphs /,/, tables/NNS/tables /,/, figures/NNS/figures /,/, and/CC/and so/RB/so on/NNP/on. /NNP/( see/VB/see figure/NN/figure 8.6/CD/8.6. /CD/) the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree corresponds/NNS/corresponds to/TO/to the/DT/the book/NN/book itself/NNP/itself. we/PRP/we could/MD/could /,/, in/IN/in fact/NN/fact /,/, consider/NN/consider expanding/VBG/expanding the/DT/the tree/NN/tree further/RB/further to/TO/to show/VB/show paragraphs/NNS/paragraphs consisting/VBG/consisting of/IN/of sentences/NNS/sentences /,/, sentences/NNS/sentences consisting/VBG/consisting of/IN/of words/NNS/words /,/, and/CC/and words/NNS/words consisting/VBG/consisting of/IN/of characters/NNP/characters. such/JJ/such a/DT/a tree/NN/tree is/VBZ/is an/DT/an example/NN/example of/IN/of an/DT/an ordered/VBN/ordered tree/NN/tree /,/, because/IN/because there/EX/there is/VBZ/is a/DT/a well-defined/JJ/well-defined order/NN/order among/IN/among the/DT/the children/NNS/children of/IN/of each/DT/each node/NNP/node. figure/NN/figure 8.6/CD/8.6 /:/: an/DT/an ordered/VBN/ordered tree/NN/tree associated/VBN/associated with/IN/with a/DT/a book/NNP/book. let/NN/let s/VBZ/s look/NN/look back/RB/back at/IN/at the/DT/the other/JJ/other examples/NNS/examples of/IN/of trees/NNS/trees that/WDT/that we/PRP/we have/VBP/have described/VBN/described thus/RB/thus far/RB/far /,/, and/CC/and consider/NN/consider whether/IN/whether the/DT/the order/NN/order of/IN/of children/NNS/children is/VBZ/is significant/NNP/significant. a/DT/a family/NN/family tree/NN/tree that/WDT/that describes/VBZ/describes generational/JJ/generational relationships/NNS/relationships /,/, as/IN/as in/IN/in figure/NN/figure 8.1/CD/8.1 /,/, is/VBZ/is often/RB/often modeled/VBN/modeled as/IN/as an/DT/an ordered/VBN/ordered tree/NN/tree /,/, with/IN/with siblings/NNS/siblings ordered/VBN/ordered according/VBG/according to/TO/to their/PRP$/their birth/NNP/birth. in/IN/in contrast/NN/contrast /,/, an/DT/an organizational/JJ/organizational chart/NN/chart for/IN/for a/DT/a company/NN/company /,/, as/IN/as in/IN/in figure/NN/figure 8.2/CD/8.2 /,/, is/VBZ/is typically/RB/typically considered/VBN/considered an/DT/an unordered/VBN/unordered tree/NNP/tree. likewise/NN/likewise /,/, when/WRB/when using/VBG/using a/DT/a tree/NN/tree to/TO/to describe/VB/describe an/DT/an inheritance/NN/inheritance hierarchy/NN/hierarchy /,/, as/IN/as in/IN/in figure/NN/figure 8.4/CD/8.4 /,/, there/EX/there is/VBZ/is no/DT/no particular/JJ/particular significance/NN/significance to/TO/to the/DT/the order/NN/order among/IN/among the/DT/the subclasses/NNS/subclasses of/IN/of a/DT/a parent/NN/parent class/NNP/class. finally/RB/finally /,/, we/PRP/we consider/VBP/consider the/DT/the use/NN/use of/IN/of a/DT/a tree/NN/tree in/IN/in modeling/NN/modeling a/DT/a computer/NN/computer s/VBZ/s file/JJ/file system/NN/system /,/, as/IN/as in/IN/in figure/NN/figure 8.3/CD/8.3. although/IN/although an/DT/an operating/NN/operating system/NN/system often/RB/often displays/VBZ/displays entries/NNS/entries of/IN/of a/DT/a directory/NN/directory in/IN/in a/DT/a particular/JJ/particular order/NN/order /:/( e.g/NNP/e.g. /,/, alphabetical/JJ/alphabetical /,/, chronological/JJ/chronological /NN/) /,/, such/JJ/such an/DT/an order/NN/order is/VBZ/is not/RB/not typically/RB/typically inherent/JJ/inherent to/TO/to the/DT/the file/NN/file system/NN/system s/NNS/s representation/NNP/representation. 8.1/NNP/8.1. general/JJ/general trees/NNS/trees 305/CD/305 8.1.2/CD/8.1.2 the/DT/the tree/NN/tree abstract/NN/abstract data/NNS/data type/NN/type as/IN/as we/PRP/we did/VBD/did with/IN/with positional/JJ/positional lists/NNS/lists in/IN/in section/NN/section 7.4/CD/7.4 /,/, we/PRP/we define/VBP/define a/DT/a tree/NN/tree adt/NN/adt using/VBG/using the/DT/the concept/NN/concept of/IN/of a/DT/a position/NN/position as/IN/as an/DT/an abstraction/NN/abstraction for/IN/for a/DT/a node/NN/node of/IN/of a/DT/a tree/NNP/tree. an/DT/an element/NN/element is/VBZ/is stored/VBN/stored at/IN/at each/DT/each position/NN/position /,/, and/CC/and positions/NNS/positions satisfy/VBP/satisfy parent-child/JJ/parent-child relationships/NNS/relationships that/WDT/that define/NN/define the/DT/the tree/NN/tree structure/NNP/structure. a/DT/a position/NN/position object/NN/object for/IN/for a/DT/a tree/NN/tree supports/NNS/supports the/DT/the method/NN/method /:/: p.element/JJ/p.element /NN/( /:/) /:/: return/NN/return the/DT/the element/NN/element stored/VBD/stored at/IN/at position/NN/position p/NNP/p. the/DT/the tree/NN/tree adt/NN/adt then/RB/then supports/VBZ/supports the/DT/the following/VBG/following accessor/NN/accessor methods/NNS/methods /,/, allowing/VBG/allowing a/DT/a user/NN/user to/TO/to navigate/VB/navigate the/DT/the various/JJ/various positions/NNS/positions of/IN/of a/DT/a tree/NN/tree /:/: t.root/JJ/t.root /NN/( /:/) /:/: return/NN/return the/DT/the position/NN/position of/IN/of the/DT/the root/NN/root of/IN/of tree/NN/tree t/NN/t /,/, or/CC/or none/NN/none if/IN/if t/NN/t is/VBZ/is empty/NNP/empty. t.is/NNP/t.is root/NN/root /:/( p/NN/p /:/) /:/: return/NN/return true/NN/true if/IN/if position/NN/position p/NN/p is/VBZ/is the/DT/the root/NN/root of/IN/of tree/NN/tree t/NNP/t. t.parent/NNP/t.parent /NNP/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position of/IN/of the/DT/the parent/NN/parent of/IN/of position/NN/position p/NN/p /,/, or/CC/or none/NN/none if/IN/if p/NN/p is/VBZ/is the/DT/the root/NN/root of/IN/of t/NNP/t. t.num/NNP/t.num children/NNS/children /:/( p/NN/p /:/) /:/: return/NN/return the/DT/the number/NN/number of/IN/of children/NNS/children of/IN/of position/NN/position p/NNP/p. t.children/NNP/t.children /NNP/( p/NN/p /:/) /:/: generate/JJ/generate an/DT/an iteration/NN/iteration of/IN/of the/DT/the children/NNS/children of/IN/of position/NN/position p/NNP/p. t.is/NNP/t.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: return/NN/return true/NN/true if/IN/if position/NN/position p/NN/p does/VBZ/does not/RB/not have/VB/have any/DT/any children/NNP/children. len/NN/len /:/( t/NN/t /:/) /:/: return/NN/return the/DT/the number/NN/number of/IN/of positions/NNS/positions /:/( and/CC/and hence/NN/hence elements/NNS/elements /:/) that/IN/that are/VBP/are contained/VBN/contained in/IN/in tree/NN/tree t/NNP/t. t.is/NNP/t.is empty/NN/empty /:/( /:/) /:/: return/NN/return true/NN/true if/IN/if tree/NN/tree t/NN/t does/VBZ/does not/RB/not contain/VB/contain any/DT/any positions/NNP/positions. t.positions/NNS/t.positions /:/( /:/) /:/: generate/JJ/generate an/DT/an iteration/NN/iteration of/IN/of all/DT/all positions/NNS/positions of/IN/of tree/NN/tree t/NNP/t. iter/NN/iter /:/( t/NN/t /:/) /:/: generate/JJ/generate an/DT/an iteration/NN/iteration of/IN/of all/DT/all elements/NNS/elements stored/VBD/stored within/IN/within tree/NN/tree t/NNP/t. any/DT/any of/IN/of the/DT/the above/JJ/above methods/NNS/methods that/WDT/that accepts/VBZ/accepts a/DT/a position/NN/position as/IN/as an/DT/an argument/NN/argument should/MD/should generate/VB/generate a/DT/a valueerror/NN/valueerror if/IN/if that/DT/that position/NN/position is/VBZ/is invalid/JJ/invalid for/IN/for t/NNP/t. if/IN/if a/DT/a tree/NN/tree t/NN/t is/VBZ/is ordered/VBN/ordered /,/, then/RB/then t.children/JJ/t.children /NN/( p/NN/p /:/) reports/NNS/reports the/DT/the children/NNS/children of/IN/of p/NN/p in/IN/in the/DT/the natural/JJ/natural order/NNP/order. if/IN/if p/NN/p is/VBZ/is a/DT/a leaf/NN/leaf /,/, then/RB/then t.children/JJ/t.children /NN/( p/NN/p /:/) generates/NNS/generates an/DT/an empty/NN/empty iteration/NNP/iteration. in/IN/in similar/JJ/similar regard/NN/regard /,/, if/IN/if tree/NN/tree t/NN/t is/VBZ/is empty/JJ/empty /,/, then/RB/then both/DT/both t.positions/NNS/t.positions /VBP/( /:/) and/CC/and iter/NN/iter /:/( t/NN/t /:/) generate/NN/generate empty/NN/empty iterations/NNP/iterations. we/PRP/we will/MD/will discuss/VB/discuss general/JJ/general means/NNS/means for/IN/for iterating/VBG/iterating through/IN/through all/DT/all positions/NNS/positions of/IN/of a/DT/a tree/NN/tree in/IN/in sections/NNS/sections 8.4/CD/8.4. we/PRP/we do/VBP/do not/RB/not define/VB/define any/DT/any methods/NNS/methods for/IN/for creating/VBG/creating or/CC/or modifying/VBG/modifying trees/NNS/trees at/IN/at this/DT/this point/NNP/point. we/PRP/we prefer/VBP/prefer to/TO/to describe/VB/describe different/JJ/different tree/NN/tree update/NN/update methods/NNS/methods in/IN/in conjunction/NN/conjunction with/IN/with specific/JJ/specific implementations/NNS/implementations of/IN/of the/DT/the tree/NN/tree interface/NN/interface /,/, and/CC/and specific/JJ/specific applications/NNS/applications of/IN/of trees/NNP/trees. 306/CD/306 chapter/NN/chapter 8/CD/8. trees/NNS/trees a/DT/a tree/NN/tree abstract/NN/abstract base/NN/base class/NN/class in/IN/in python/NN/python in/IN/in discussing/NN/discussing the/DT/the object-oriented/JJ/object-oriented design/NN/design principle/NN/principle of/IN/of abstraction/NN/abstraction in/IN/in section/NN/section 2.1.2/CD/2.1.2 /,/, we/PRP/we noted/VBD/noted that/IN/that a/DT/a public/JJ/public interface/NN/interface for/IN/for an/DT/an abstract/NN/abstract data/NNS/data type/NN/type is/VBZ/is often/RB/often managed/VBN/managed in/IN/in python/NN/python via/IN/via duck/NN/duck typing/NNP/typing. for/IN/for example/NN/example /,/, we/PRP/we defined/VBD/defined the/DT/the notion/NN/notion of/IN/of the/DT/the public/NN/public interface/NN/interface for/IN/for a/DT/a queue/NN/queue adt/NN/adt in/IN/in section/NN/section 6.2/CD/6.2 /,/, and/CC/and have/VBP/have since/IN/since presented/VBN/presented several/JJ/several classes/NNS/classes that/WDT/that implement/NN/implement the/DT/the queue/NN/queue interface/NN/interface /:/( e.g/NNP/e.g. /,/, arrayqueue/NN/arrayqueue in/IN/in section/NN/section 6.2.2/CD/6.2.2 /,/, linkedqueue/JJ/linkedqueue in/IN/in section/NN/section 7.1.2/CD/7.1.2 /,/, circularqueue/JJ/circularqueue in/IN/in section/NN/section 7.2.2/CD/7.2.2 /CD/) /./. however/RB/however /,/, we/PRP/we never/RB/never gave/VBD/gave any/DT/any formal/JJ/formal definition/NN/definition of/IN/of the/DT/the queue/NN/queue adt/NN/adt in/IN/in python/NN/python ;/:/; all/DT/all of/IN/of the/DT/the concrete/JJ/concrete implementations/NNS/implementations were/VBD/were self-contained/JJ/self-contained classes/NNS/classes that/WDT/that just/RB/just happen/VBP/happen to/TO/to adhere/VB/adhere to/TO/to the/DT/the same/JJ/same public/JJ/public interface/NNP/interface. a/DT/a more/JJR/more formal/JJ/formal mechanism/NN/mechanism to/TO/to designate/VB/designate the/DT/the relationships/NNS/relationships between/IN/between different/JJ/different implementations/NNS/implementations of/IN/of the/DT/the same/JJ/same abstraction/NN/abstraction is/VBZ/is through/IN/through the/DT/the definition/NN/definition of/IN/of one/CD/one class/NN/class that/WDT/that serves/VBZ/serves as/RB/as an/DT/an abstract/NN/abstract base/NN/base class/NN/class /,/, via/IN/via inheritance/NN/inheritance /,/, for/IN/for one/CD/one or/CC/or more/JJR/more concrete/JJ/concrete classes/NNP/classes. /NNP/( see/VB/see section/NN/section 2.4.3/CD/2.4.3. /CD/) we/PRP/we choose/VBP/choose to/TO/to define/VB/define a/DT/a tree/NN/tree class/NN/class /,/, in/IN/in code/NN/code fragment/NN/fragment 8.1/CD/8.1 /,/, that/IN/that serves/NNS/serves as/IN/as an/DT/an abstract/NN/abstract base/NN/base class/NN/class corresponding/VBG/corresponding to/TO/to the/DT/the tree/NN/tree adt/NNP/adt. our/PRP$/our reason/NN/reason for/IN/for doing/VBG/doing so/RB/so is/VBZ/is that/IN/that there/EX/there is/VBZ/is quite/RB/quite a/DT/a bit/NN/bit of/IN/of useful/JJ/useful code/NN/code that/WDT/that we/PRP/we can/MD/can provide/VB/provide /,/, even/RB/even at/IN/at this/DT/this level/NN/level of/IN/of abstraction/NN/abstraction /,/, allowing/VBG/allowing greater/JJR/greater code/NN/code reuse/NN/reuse in/IN/in the/DT/the concrete/JJ/concrete tree/NN/tree implementations/NNS/implementations we/PRP/we later/JJ/later define/NNP/define. the/DT/the tree/NN/tree class/NN/class provides/VBZ/provides a/DT/a definition/NN/definition of/IN/of a/DT/a nested/VBN/nested position/NN/position class/NN/class /:/( which/WDT/which is/VBZ/is also/RB/also abstract/NN/abstract /:/) /,/, and/CC/and declarations/NNS/declarations of/IN/of many/JJ/many of/IN/of the/DT/the accessor/NN/accessor methods/NNS/methods included/VBD/included in/IN/in the/DT/the tree/NN/tree adt/NNP/adt. however/RB/however /,/, our/PRP$/our tree/NN/tree class/NN/class does/VBZ/does not/RB/not define/VB/define any/DT/any internal/JJ/internal representation/NN/representation for/IN/for storing/NN/storing a/DT/a tree/NN/tree /,/, and/CC/and five/CD/five of/IN/of the/DT/the methods/NNS/methods given/VBN/given in/IN/in that/DT/that code/NN/code fragment/NN/fragment remain/NN/remain abstract/NN/abstract /:/( root/NN/root /,/, parent/NN/parent /,/, num/NN/num children/NNS/children /,/, children/NNS/children /,/, and/CC/and len/NN/len /:/) ;/:/; each/DT/each of/IN/of these/DT/these methods/NNS/methods raises/VBZ/raises a/DT/a notimplementederror/NNP/notimplementederror. /NNP/( a/DT/a more/JJR/more formal/JJ/formal approach/NN/approach for/IN/for defining/NN/defining abstract/NN/abstract base/NN/base classes/NNS/classes and/CC/and abstract/NN/abstract methods/NNS/methods /,/, using/VBG/using python/NN/python s/NNS/s abc/VBP/abc module/NN/module /,/, is/VBZ/is described/VBN/described in/IN/in section/NN/section 2.4.3/CD/2.4.3. /CD/) the/DT/the subclasses/NNS/subclasses are/VBP/are responsible/JJ/responsible for/IN/for overriding/VBG/overriding abstract/NN/abstract methods/NNS/methods /,/, such/JJ/such as/IN/as children/NNS/children /,/, to/TO/to provide/VB/provide a/DT/a working/NN/working implementation/NN/implementation for/IN/for each/DT/each behavior/NN/behavior /,/, based/VBN/based on/IN/on their/PRP$/their chosen/NN/chosen internal/JJ/internal representation/NNP/representation. although/IN/although the/DT/the tree/NN/tree class/NN/class is/VBZ/is an/DT/an abstract/NN/abstract base/NN/base class/NN/class /,/, it/PRP/it includes/VBZ/includes several/JJ/several concrete/JJ/concrete methods/NNS/methods with/IN/with implementations/NNS/implementations that/IN/that rely/RB/rely on/IN/on calls/NNS/calls to/TO/to the/DT/the abstract/NN/abstract methods/NNS/methods of/IN/of the/DT/the class/NNP/class. in/IN/in defining/NN/defining the/DT/the tree/NN/tree adt/NN/adt in/IN/in the/DT/the previous/JJ/previous section/NN/section /,/, we/PRP/we declare/VBP/declare ten/VBN/ten accessor/NN/accessor methods/NNP/methods. five/CD/five of/IN/of those/DT/those are/VBP/are the/DT/the ones/NNS/ones we/PRP/we left/VBP/left as/IN/as abstract/NN/abstract /,/, in/IN/in code/NN/code fragment/NN/fragment 8.1/CD/8.1. the/DT/the other/JJ/other five/CD/five can/MD/can be/VB/be implemented/VBN/implemented based/VBN/based on/IN/on the/DT/the former/NNP/former. code/NN/code fragment/NN/fragment 8.2/CD/8.2 provides/NNS/provides concrete/JJ/concrete implementations/NNS/implementations for/IN/for methods/NNS/methods is/VBZ/is root/VBN/root /,/, is/VBZ/is leaf/NN/leaf /,/, and/CC/and is/VBZ/is empty/NNP/empty. in/IN/in section/NN/section 8.4/CD/8.4 /,/, we/PRP/we will/MD/will explore/VB/explore general/JJ/general algorithms/NNS/algorithms for/IN/for traversing/VBG/traversing a/DT/a tree/NN/tree that/WDT/that can/MD/can be/VB/be used/VBN/used to/TO/to provide/VB/provide concrete/JJ/concrete implementations/NNS/implementations of/IN/of the/DT/the positions/NNS/positions and/CC/and iter/NN/iter methods/NNS/methods within/IN/within the/DT/the tree/NN/tree class/NNP/class. the/DT/the beauty/NN/beauty of/IN/of this/DT/this design/NN/design is/VBZ/is that/IN/that the/DT/the concrete/JJ/concrete methods/NNS/methods defined/VBN/defined within/IN/within the/DT/the tree/NN/tree abstract/NN/abstract base/NN/base class/NN/class will/MD/will be/VB/be inherited/VBN/inherited by/IN/by all/DT/all subclasses/NNP/subclasses. this/DT/this promotes/VBZ/promotes greater/JJR/greater code/NN/code reuse/NN/reuse /,/, as/IN/as there/EX/there will/MD/will be/VB/be no/RB/no need/VBN/need for/IN/for those/DT/those subclasses/NNS/subclasses to/TO/to reimplement/VB/reimplement such/JJ/such behaviors/NNP/behaviors. we/PRP/we note/VBP/note that/IN/that /,/, with/IN/with the/DT/the tree/NN/tree class/NN/class being/VBG/being abstract/NN/abstract /,/, there/EX/there is/VBZ/is no/DT/no reason/NN/reason to/TO/to create/VB/create a/DT/a direct/JJ/direct instance/NN/instance of/IN/of it/PRP/it /,/, nor/CC/nor would/MD/would such/VB/such an/DT/an instance/NN/instance be/VB/be useful/NNP/useful. the/DT/the class/NN/class exists/VBZ/exists to/TO/to serve/VB/serve as/IN/as a/DT/a base/NN/base for/IN/for inheritance/NN/inheritance /,/, and/CC/and users/NNS/users will/MD/will create/VB/create instances/NNS/instances of/IN/of concrete/JJ/concrete subclasses/NNP/subclasses. /./. 8.1.3/CD/8.1.3 computing/VBG/computing depth/NN/depth and/CC/and height/NN/height let/VB/let p/NN/p be/VB/be the/DT/the position/NN/position of/IN/of a/DT/a node/NN/node of/IN/of a/DT/a tree/NN/tree t/NNP/t. the/DT/the depth/NN/depth of/IN/of p/NN/p is/VBZ/is the/DT/the number/NN/number of/IN/of ancestors/NNS/ancestors of/IN/of p/NN/p /,/, excluding/VBG/excluding p/NN/p itself/NNP/itself. for/IN/for example/NN/example /,/, in/IN/in the/DT/the tree/NN/tree of/IN/of figure/NN/figure 8.2/CD/8.2 /,/, the/DT/the node/NN/node storing/VBG/storing international/JJ/international has/NNS/has depth/VBP/depth 2/CD/2. note/NN/note that/IN/that this/DT/this definition/NN/definition implies/VBZ/implies that/IN/that the/DT/the depth/NN/depth of/IN/of the/DT/the root/NN/root of/IN/of t/NN/t is/VBZ/is 0/CD/0. the/DT/the depth/NN/depth of/IN/of p/NN/p can/MD/can also/RB/also be/VB/be recursively/RB/recursively defined/VBN/defined as/IN/as follows/NNS/follows /:/: if/IN/if p/NN/p is/VBZ/is the/DT/the root/NN/root /,/, then/RB/then the/DT/the depth/NN/depth of/IN/of p/NN/p is/VBZ/is 0/CD/0. otherwise/NN/otherwise /,/, the/DT/the depth/NN/depth of/IN/of p/NN/p is/VBZ/is one/CD/one plus/NN/plus the/DT/the depth/NN/depth of/IN/of the/DT/the parent/NN/parent of/IN/of p/NNP/p. based/VBN/based on/IN/on this/DT/this definition/NN/definition /,/, we/PRP/we present/VBP/present a/DT/a simple/JJ/simple /,/, recursive/JJ/recursive algorithm/NN/algorithm /,/, depth/NN/depth /,/, in/IN/in code/NN/code fragment/NN/fragment 8.3/CD/8.3 /,/, for/IN/for computing/NN/computing the/DT/the depth/NN/depth of/IN/of a/DT/a position/NN/position p/NN/p in/IN/in tree/NN/tree t/NNP/t. this/DT/this method/NN/method calls/VBZ/calls itself/PRP/itself recursively/RB/recursively on/IN/on the/DT/the parent/NN/parent of/IN/of p/NN/p /,/, and/CC/and adds/VBZ/adds 1/CD/1 to/TO/to the/DT/the value/NN/value returned/NNP/returned. 52/CD/52 def/NN/def depth/NN/depth /:/( self/NN/self /,/, p/NN/p /:/) /:/: 53/CD/53 return/NN/return the/DT/the number/NN/number of/IN/of levels/NNS/levels separating/VBG/separating position/NN/position p/NN/p from/IN/from the/DT/the root/NNP/root. 54/CD/54 if/IN/if self.is/NNP/self.is root/NN/root /:/( p/NN/p /:/) /:/: 55/CD/55 return/NN/return 0/-NONE-/0 56/CD/56 else/NN/else /:/: 57/CD/57 return/NN/return 1/CD/1 +/CD/+ self.depth/JJ/self.depth /NN/( self.parent/JJ/self.parent /NN/( p/NN/p /:/) /:/) code/NN/code fragment/NN/fragment 8.3/CD/8.3 /:/: method/NN/method depth/NN/depth of/IN/of the/DT/the tree/NN/tree class/NNP/class. the/DT/the running/VBG/running time/NN/time of/IN/of t.depth/JJ/t.depth /NN/( p/NN/p /:/) for/IN/for position/NN/position p/NN/p is/VBZ/is o/RB/o /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) /,/, where/WRB/where dp/NN/dp denotes/VBZ/denotes the/DT/the depth/NN/depth of/IN/of p/NN/p in/IN/in the/DT/the tree/NN/tree t/NN/t /,/, because/IN/because the/DT/the algorithm/NN/algorithm performs/NNS/performs a/DT/a constant-time/JJ/constant-time recursive/JJ/recursive step/NN/step for/IN/for each/DT/each ancestor/NN/ancestor of/IN/of p/NNP/p. thus/RB/thus /,/, algorithm/NN/algorithm t.depth/JJ/t.depth /NN/( p/NN/p /:/) runs/NNS/runs in/IN/in o/NN/o /:/( n/NN/n /:/) worstcase/NN/worstcase time/NN/time /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the total/JJ/total number/NN/number of/IN/of positions/NNS/positions of/IN/of t/NN/t /,/, because/IN/because a/DT/a position/NN/position of/IN/of t/NN/t may/MD/may have/VB/have depth/NN/depth n/NN/n 1/CD/1 if/IN/if all/DT/all nodes/NNS/nodes form/NN/form a/DT/a single/JJ/single branch/NNP/branch. although/IN/although such/JJ/such a/DT/a running/NN/running time/NN/time is/VBZ/is a/DT/a function/NN/function of/IN/of the/DT/the input/NN/input size/NN/size /,/, it/PRP/it is/VBZ/is more/RBR/more informative/JJ/informative to/TO/to characterize/VB/characterize the/DT/the running/NN/running time/NN/time in/IN/in terms/NNS/terms of/IN/of the/DT/the parameter/NN/parameter dp/NN/dp /,/, as/IN/as this/DT/this parameter/NN/parameter may/MD/may be/VB/be much/RB/much smaller/JJR/smaller than/IN/than n/NNP/n. 8.1/CD/8.1. general/JJ/general trees/NNS/trees 309/CD/309 height/NN/height the/DT/the height/NN/height of/IN/of a/DT/a position/NN/position p/NN/p in/IN/in a/DT/a tree/NN/tree t/NN/t is/VBZ/is also/RB/also defined/VBN/defined recursively/RB/recursively /:/: if/IN/if p/NN/p is/VBZ/is a/DT/a leaf/NN/leaf /,/, then/RB/then the/DT/the height/NN/height of/IN/of p/NN/p is/VBZ/is 0/CD/0. otherwise/NN/otherwise /,/, the/DT/the height/NN/height of/IN/of p/NN/p is/VBZ/is one/CD/one more/RBR/more than/IN/than the/DT/the maximum/NN/maximum of/IN/of the/DT/the heights/NNS/heights of/IN/of p/NN/p s/NNS/s children/NNP/children. the/DT/the height/NN/height of/IN/of a/DT/a nonempty/NN/nonempty tree/NN/tree t/NN/t is/VBZ/is the/DT/the height/NN/height of/IN/of the/DT/the root/NN/root of/IN/of t/NNP/t. for/IN/for example/NN/example /,/, the/DT/the tree/NN/tree of/IN/of figure/NN/figure 8.2/CD/8.2 has/VBZ/has height/VBN/height 4/CD/4. in/IN/in addition/NN/addition /,/, height/VBD/height can/MD/can also/RB/also be/VB/be viewed/VBN/viewed as/IN/as follows/NNP/follows. proposition/NN/proposition 8.4/CD/8.4 /:/: the/DT/the height/NN/height of/IN/of a/DT/a nonempty/NN/nonempty tree/NN/tree t/NN/t is/VBZ/is equal/JJ/equal to/TO/to the/DT/the maximum/NN/maximum of/IN/of the/DT/the depths/NNS/depths of/IN/of its/PRP$/its leaf/NN/leaf positions/NNP/positions. we/PRP/we leave/VBP/leave the/DT/the justification/NN/justification of/IN/of this/DT/this fact/NN/fact to/TO/to an/DT/an exercise/NN/exercise /:/( r-8.3/-NONE-/r-8.3 /:/) /./. we/PRP/we present/VBD/present an/DT/an algorithm/NN/algorithm /,/, height1/NNP/height1 /,/, implemented/VBD/implemented in/IN/in code/NN/code fragment/NN/fragment 8.4/CD/8.4 as/IN/as a/DT/a nonpublic/JJ/nonpublic method/NN/method height1/NNP/height1 of/IN/of the/DT/the tree/NN/tree class/NNP/class. it/PRP/it computes/VBZ/computes the/DT/the height/NN/height of/IN/of a/DT/a nonempty/NN/nonempty tree/NN/tree t/NN/t based/VBN/based on/IN/on proposition/NN/proposition 8.4/CD/8.4 and/CC/and the/DT/the algorithm/NN/algorithm depth/NN/depth from/IN/from code/NN/code fragment/NN/fragment 8.3/CD/8.3. unfortunately/RB/unfortunately /,/, algorithm/NN/algorithm height1/NNP/height1 is/VBZ/is not/RB/not very/RB/very efficient/NNP/efficient. we/PRP/we have/VBP/have not/RB/not yet/RB/yet defined/VBN/defined the/DT/the positions/NNS/positions /:/( /:/) method/NN/method ;/:/; we/PRP/we will/MD/will see/VB/see that/IN/that it/PRP/it can/MD/can be/VB/be implemented/VBN/implemented to/TO/to run/VB/run in/IN/in o/NN/o /:/( n/NN/n /:/) time/NN/time /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of positions/NNS/positions of/IN/of t/NNP/t. because/IN/because height1/NNP/height1 calls/VBZ/calls algorithm/NN/algorithm depth/NN/depth /:/( p/NN/p /:/) on/IN/on each/DT/each leaf/NN/leaf of/IN/of t/NN/t /,/, its/PRP$/its running/NN/running time/NN/time is/VBZ/is o/RB/o /:/( n/NN/n +/:/+ p/NN/p l/NN/l /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) /CD/) /,/, where/WRB/where l/NN/l is/VBZ/is the/DT/the set/NN/set of/IN/of leaf/NN/leaf positions/NNS/positions of/IN/of t/NNP/t. in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, the/DT/the sum/NN/sum p/NN/p l/NN/l /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) is/VBZ/is proportional/JJ/proportional to/TO/to n2/NNP/n2. /NNP/( see/VB/see exercise/NN/exercise c-8.33/NNP/c-8.33. /NNP/) thus/RB/thus /,/, algorithm/NN/algorithm height1/NNP/height1 runs/VBZ/runs in/IN/in o/NN/o /:/( n2/NNP/n2 /:/) worst-case/JJ/worst-case time/NNP/time. we/PRP/we can/MD/can compute/VB/compute the/DT/the height/NN/height of/IN/of a/DT/a tree/NN/tree more/RBR/more efficiently/RB/efficiently /,/, in/IN/in o/NN/o /:/( n/NN/n /:/) worst-case/JJ/worst-case time/NN/time /,/, by/IN/by relying/NN/relying instead/RB/instead on/IN/on the/DT/the original/JJ/original recursive/JJ/recursive definition/NNP/definition. to/TO/to do/VB/do this/DT/this /,/, we/PRP/we will/MD/will parameterize/VB/parameterize a/DT/a function/NN/function based/VBN/based on/IN/on a/DT/a position/NN/position within/IN/within the/DT/the tree/NN/tree /,/, and/CC/and calculate/VB/calculate the/DT/the height/NN/height of/IN/of the/DT/the subtree/JJ/subtree rooted/VBN/rooted at/IN/at that/DT/that position/NNP/position. 310/CD/310 chapter/NN/chapter 8/CD/8. trees/NNS/trees it/PRP/it is/VBZ/is important/JJ/important to/TO/to understand/VB/understand why/WRB/why algorithm/NN/algorithm height2/NNP/height2 is/VBZ/is more/JJR/more efficient/JJ/efficient than/IN/than height1/NNP/height1. the/DT/the algorithm/NN/algorithm is/VBZ/is recursive/JJ/recursive /,/, and/CC/and it/PRP/it progresses/VBZ/progresses in/IN/in a/DT/a top-down/JJ/top-down fashion/NNP/fashion. if/IN/if the/DT/the method/NN/method is/VBZ/is initially/RB/initially called/VBN/called on/IN/on the/DT/the root/NN/root of/IN/of t/NN/t /,/, it/PRP/it will/MD/will eventually/RB/eventually be/VB/be called/VBN/called once/RB/once for/IN/for each/DT/each position/NN/position of/IN/of t/NNP/t. this/DT/this is/VBZ/is because/IN/because the/DT/the root/NN/root eventually/RB/eventually invokes/VBZ/invokes the/DT/the recursion/NN/recursion on/IN/on each/DT/each of/IN/of its/PRP$/its children/NNS/children /,/, which/WDT/which in/IN/in turn/NN/turn invokes/NNS/invokes the/DT/the recursion/NN/recursion on/IN/on each/DT/each of/IN/of their/PRP$/their children/NNS/children /,/, and/CC/and so/RB/so on/NNP/on. we/PRP/we can/MD/can determine/VB/determine the/DT/the running/NN/running time/NN/time of/IN/of the/DT/the height2/NNP/height2 algorithm/NN/algorithm by/IN/by summing/NN/summing /,/, over/IN/over all/DT/all the/DT/the positions/NNS/positions /,/, the/DT/the amount/NN/amount of/IN/of time/NN/time spent/NN/spent on/IN/on the/DT/the nonrecursive/JJ/nonrecursive part/NN/part of/IN/of each/DT/each call/NNP/call. /NNP/( review/NN/review section/NN/section 4.2/CD/4.2 for/IN/for analyses/NNS/analyses of/IN/of recursive/JJ/recursive processes/NNP/processes. /NNP/) in/IN/in our/PRP$/our implementation/NN/implementation /,/, there/EX/there is/VBZ/is a/DT/a constant/JJ/constant amount/NN/amount of/IN/of work/NN/work per/IN/per position/NN/position /,/, plus/CC/plus the/DT/the overhead/JJ/overhead of/IN/of computing/NN/computing the/DT/the maximum/NN/maximum over/IN/over the/DT/the iteration/NN/iteration of/IN/of children/NNP/children. although/IN/although we/PRP/we do/VBP/do not/RB/not yet/RB/yet have/VB/have a/DT/a concrete/JJ/concrete implementation/NN/implementation of/IN/of children/NNS/children /:/( p/NN/p /:/) /,/, we/PRP/we assume/VBP/assume that/IN/that such/JJ/such an/DT/an iteration/NN/iteration is/VBZ/is generated/VBN/generated in/IN/in o/NN/o /:/( cp/NN/cp +/:/+ 1/CD/1 /CD/) time/NN/time /,/, where/WRB/where cp/NN/cp denotes/VBZ/denotes the/DT/the number/NN/number of/IN/of children/NNS/children of/IN/of p/NNP/p. algorithm/NN/algorithm height2/NNP/height2 spends/NNS/spends o/VBP/o /:/( cp/NN/cp +/:/+ 1/CD/1 /CD/) time/NN/time at/IN/at each/DT/each position/NN/position p/NN/p to/TO/to compute/VB/compute the/DT/the maximum/NN/maximum /,/, and/CC/and its/PRP$/its overall/JJ/overall running/VBG/running time/NN/time is/VBZ/is o/RB/o /:/( p/NN/p /:/( cp/NN/cp +/:/+ 1/CD/1 /CD/) /CD/) =/CD/= o/NN/o /:/( n/NN/n +/:/+ p/NN/p cp/NN/cp /:/) /./. in/IN/in order/NN/order to/TO/to complete/VB/complete the/DT/the analysis/NN/analysis /,/, we/PRP/we make/VBP/make use/VBP/use of/IN/of the/DT/the following/JJ/following property/NNP/property. proposition/NN/proposition 8.5/CD/8.5 /:/: let/JJ/let t/NN/t be/VB/be a/DT/a tree/NN/tree with/IN/with n/NN/n positions/NNS/positions /,/, and/CC/and let/VB/let cp/NN/cp denote/NN/denote the/DT/the number/NN/number of/IN/of children/NNS/children of/IN/of a/DT/a position/NN/position p/NN/p of/IN/of t/NNP/t. then/RB/then /,/, summing/VBG/summing over/IN/over the/DT/the positions/NNS/positions of/IN/of t/NN/t /,/, p/NN/p cp/NN/cp =/:/= n/NN/n 1/CD/1. justification/NN/justification /:/: each/DT/each position/NN/position of/IN/of t/NN/t /,/, with/IN/with the/DT/the exception/NN/exception of/IN/of the/DT/the root/NN/root /,/, is/VBZ/is a/DT/a child/NN/child of/IN/of another/DT/another position/NN/position /,/, and/CC/and thus/RB/thus contributes/VBZ/contributes one/CD/one unit/NN/unit to/TO/to the/DT/the above/NN/above sum/NNP/sum. by/IN/by proposition/NN/proposition 8.5/CD/8.5 /,/, the/DT/the running/NN/running time/NN/time of/IN/of algorithm/NN/algorithm height2/NNP/height2 /,/, when/WRB/when called/VBN/called on/IN/on the/DT/the root/NN/root of/IN/of t/NN/t /,/, is/VBZ/is o/RB/o /:/( n/NN/n /:/) /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of positions/NNS/positions of/IN/of t/NNP/t. revisiting/NN/revisiting the/DT/the public/NN/public interface/NN/interface for/IN/for our/PRP$/our tree/NN/tree class/NN/class /,/, the/DT/the ability/NN/ability to/TO/to compute/VB/compute heights/NNS/heights of/IN/of subtrees/NNS/subtrees is/VBZ/is beneficial/JJ/beneficial /,/, but/CC/but a/DT/a user/NN/user might/MD/might expect/VB/expect to/TO/to be/VB/be able/JJ/able to/TO/to compute/VB/compute the/DT/the height/NN/height of/IN/of the/DT/the entire/JJ/entire tree/NN/tree without/IN/without explicitly/RB/explicitly designating/VBG/designating the/DT/the tree/NN/tree root/NNP/root. we/PRP/we can/MD/can wrap/VB/wrap the/DT/the nonpublic/JJ/nonpublic height2/NNP/height2 in/IN/in our/PRP$/our implementation/NN/implementation with/IN/with a/DT/a public/JJ/public height/NN/height method/NN/method that/WDT/that provides/VBZ/provides a/DT/a default/NN/default interpretation/NN/interpretation when/WRB/when invoked/VBN/invoked on/IN/on tree/NN/tree t/NN/t with/IN/with syntax/NN/syntax t.height/JJ/t.height /NN/( /:/) /./. such/JJ/such an/DT/an implementation/NN/implementation is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.6/CD/8.6. 8.2/CD/8.2. binary/JJ/binary trees/NNS/trees 8.2/CD/8.2 binary/JJ/binary trees/NNS/trees a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is an/DT/an ordered/VBN/ordered tree/NN/tree with/IN/with the/DT/the following/VBG/following properties/NNS/properties /:/: 1/CD/1. every/DT/every node/NN/node has/VBZ/has at/IN/at most/JJS/most two/CD/two children/NNP/children. 2/CD/2. each/DT/each child/NN/child node/NN/node is/VBZ/is labeled/VBN/labeled as/RB/as being/VBG/being either/DT/either a/DT/a left/NN/left child/NN/child or/CC/or a/DT/a right/NN/right child/NNP/child. 3/NNP/3. a/DT/a left/NN/left child/NN/child precedes/VBZ/precedes a/DT/a right/NN/right child/NN/child in/IN/in the/DT/the order/NN/order of/IN/of children/NNS/children of/IN/of a/DT/a node/NNP/node. the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at a/DT/a left/NN/left or/CC/or right/RB/right child/JJ/child of/IN/of an/DT/an internal/JJ/internal node/NN/node v/NN/v is/VBZ/is called/VBN/called a/DT/a left/NN/left subtree/NN/subtree or/CC/or right/RB/right subtree/JJ/subtree /,/, respectively/RB/respectively /,/, of/IN/of v/NNP/v. a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is proper/JJ/proper if/IN/if each/DT/each node/NN/node has/VBZ/has either/DT/either zero/NN/zero or/CC/or two/CD/two children/NNP/children. some/DT/some people/NNS/people also/RB/also refer/VBP/refer to/TO/to such/JJ/such trees/NNS/trees as/IN/as being/VBG/being full/JJ/full binary/JJ/binary trees/NNP/trees. thus/RB/thus /,/, in/IN/in a/DT/a proper/NN/proper binary/NN/binary tree/NN/tree /,/, every/DT/every internal/JJ/internal node/NN/node has/VBZ/has exactly/RB/exactly two/CD/two children/NNP/children. a/DT/a binary/JJ/binary tree/NN/tree that/WDT/that is/VBZ/is not/RB/not proper/JJ/proper is/VBZ/is improper/NNP/improper. example/NN/example 8.6/CD/8.6 /:/: an/DT/an important/JJ/important class/NN/class of/IN/of binary/JJ/binary trees/NNS/trees arises/NNS/arises in/IN/in contexts/NNS/contexts where/WRB/where we/PRP/we wish/VBP/wish to/TO/to represent/VB/represent a/DT/a number/NN/number of/IN/of different/JJ/different outcomes/NNS/outcomes that/WDT/that can/MD/can result/VB/result from/IN/from answering/VBG/answering a/DT/a series/NN/series of/IN/of yes-or-no/JJ/yes-or-no questions/NNP/questions. each/DT/each internal/JJ/internal node/NN/node is/VBZ/is associated/VBN/associated with/IN/with a/DT/a question/NNP/question. starting/NN/starting at/IN/at the/DT/the root/NN/root /,/, we/PRP/we go/VBP/go to/TO/to the/DT/the left/NN/left or/CC/or right/RB/right child/JJ/child of/IN/of the/DT/the current/JJ/current node/NN/node /,/, depending/VBG/depending on/IN/on whether/IN/whether the/DT/the answer/NN/answer to/TO/to the/DT/the question/NN/question is/VBZ/is yes/NNS/yes or/CC/or no/NNP/no. with/IN/with each/DT/each decision/NN/decision /,/, we/PRP/we follow/VBP/follow an/DT/an edge/NN/edge from/IN/from a/DT/a parent/NN/parent to/TO/to a/DT/a child/NN/child /,/, eventually/RB/eventually tracing/VBG/tracing a/DT/a path/NN/path in/IN/in the/DT/the tree/NN/tree from/IN/from the/DT/the root/NN/root to/TO/to a/DT/a leaf/NNP/leaf. such/JJ/such binary/JJ/binary trees/NNS/trees are/VBP/are known/VBN/known as/IN/as decision/NN/decision trees/NNS/trees /,/, because/IN/because a/DT/a leaf/NN/leaf position/NN/position p/NN/p in/IN/in such/JJ/such a/DT/a tree/NN/tree represents/VBZ/represents a/DT/a decision/NN/decision of/IN/of what/WP/what to/TO/to do/VB/do if/IN/if the/DT/the questions/NNS/questions associated/VBN/associated with/IN/with p/NN/p s/NNS/s ancestors/NNS/ancestors are/VBP/are answered/VBN/answered in/IN/in a/DT/a way/NN/way that/WDT/that leads/VBZ/leads to/TO/to p/NNP/p. a/DT/a decision/NN/decision tree/NN/tree is/VBZ/is a/DT/a proper/NN/proper binary/NN/binary tree/NNP/tree. figure/NN/figure 8.7/CD/8.7 illustrates/NNS/illustrates a/DT/a decision/NN/decision tree/NN/tree that/WDT/that provides/VBZ/provides recommendations/NNS/recommendations to/TO/to a/DT/a prospective/JJ/prospective investor/NNP/investor. chapter/NN/chapter 8/CD/8. trees/NNS/trees example/NN/example 8.7/CD/8.7 /:/: an/DT/an arithmetic/JJ/arithmetic expression/NN/expression can/MD/can be/VB/be represented/VBN/represented by/IN/by a/DT/a binary/JJ/binary treewhose/NN/treewhose leaves/VBZ/leaves are/VBP/are associated/VBN/associated with/IN/with variables/NNS/variables or/CC/or constants/NNS/constants /,/, and/CC/and whose/WP$/whose internal/JJ/internal nodes/NNS/nodes are/VBP/are associated/VBN/associated with/IN/with one/CD/one of/IN/of the/DT/the operators/NNS/operators +/:/+ /,/, /,/, /,/, and/CC/and //NNP//. /NNP/( see/VB/see figure/NN/figure 8.8/CD/8.8. /CD/) each/DT/each node/NN/node in/IN/in such/JJ/such a/DT/a tree/NN/tree has/VBZ/has a/DT/a value/NN/value associated/VBN/associated with/IN/with it/NNP/it. if/IN/if a/DT/a node/NN/node is/VBZ/is leaf/NN/leaf /,/, then/RB/then its/PRP$/its value/NN/value is/VBZ/is that/IN/that of/IN/of its/PRP$/its variable/JJ/variable or/CC/or constant/NNP/constant. if/IN/if a/DT/a node/NN/node is/VBZ/is internal/JJ/internal /,/, then/RB/then its/PRP$/its value/NN/value is/VBZ/is defined/VBN/defined by/IN/by applying/NN/applying its/PRP$/its operation/NN/operation to/TO/to the/DT/the values/NNS/values of/IN/of its/PRP$/its children/NNP/children. an/DT/an arithmetic/JJ/arithmetic expression/NN/expression tree/NN/tree is/VBZ/is a/DT/a proper/NN/proper binary/NN/binary tree/NN/tree /,/, since/IN/since each/DT/each operator/NN/operator +/:/+ /,/, /,/, /,/, and/CC/and //:// takes/NNS/takes exactly/RB/exactly two/CD/two operands/NNP/operands. of/IN/of course/NN/course /,/, if/IN/if we/PRP/we were/VBD/were to/TO/to allow/VB/allow unary/JJ/unary operators/NNS/operators /,/, like/IN/like negation/NN/negation /:/( /:/) /,/, as/IN/as in/IN/in x/NN/x /,/, then/RB/then we/PRP/we could/MD/could have/VB/have an/DT/an improper/JJ/improper binary/NN/binary tree/NNP/tree. figure/NN/figure 8.8/CD/8.8 /:/: a/DT/a binary/JJ/binary tree/NN/tree representing/VBG/representing an/DT/an arithmetic/JJ/arithmetic expression/NNP/expression. this/DT/this tree/NN/tree represents/VBZ/represents the/DT/the expression/NN/expression /:/( /:/( /:/( /:/( 3/CD/3 +/CD/+ 1/CD/1 /CD/) 3/CD/3 /CD/) //CD// /CD/( /CD/( 9/CD/9 5/CD/5 /CD/) +/CD/+ 2/CD/2 /CD/) /CD/) /CD/( /CD/( 3/CD/3 /CD/( 7/CD/7 4/CD/4 /CD/) /CD/) +/CD/+ 6/CD/6 /CD/) /CD/) /./. the/DT/the value/NN/value associated/VBN/associated with/IN/with the/DT/the internal/JJ/internal node/NN/node labeled/VBD/labeled //CD// is/VBZ/is 2/CD/2. a/DT/a recursive/JJ/recursive binary/NN/binary tree/NN/tree definition/NN/definition incidentally/RB/incidentally /,/, we/PRP/we can/MD/can also/RB/also define/VB/define a/DT/a binary/JJ/binary tree/NN/tree in/IN/in a/DT/a recursive/JJ/recursive way/NN/way such/JJ/such that/IN/that a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is either/DT/either empty/NN/empty or/CC/or consists/NNS/consists of/IN/of /:/: a/DT/a node/NN/node r/NN/r /,/, called/VBN/called the/DT/the root/NN/root of/IN/of t/NN/t /,/, that/IN/that stores/NNS/stores an/DT/an element/NN/element a/DT/a binary/JJ/binary tree/NN/tree /:/( possibly/RB/possibly empty/JJ/empty /NN/) /,/, called/VBN/called the/DT/the left/NN/left subtree/NN/subtree of/IN/of t/NN/t a/DT/a binary/JJ/binary tree/NN/tree /:/( possibly/RB/possibly empty/JJ/empty /NN/) /,/, called/VBN/called the/DT/the right/NN/right subtree/NN/subtree of/IN/of t/NN/t 8.2/CD/8.2. binary/JJ/binary trees/NNS/trees 313/CD/313 8.2.1/CD/8.2.1 the/DT/the binary/JJ/binary tree/NN/tree abstract/NN/abstract data/NNS/data type/NN/type as/IN/as an/DT/an abstract/NN/abstract data/NNS/data type/NN/type /,/, a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is a/DT/a specialization/NN/specialization of/IN/of a/DT/a tree/NN/tree that/WDT/that supports/VBZ/supports three/CD/three additional/JJ/additional accessor/NN/accessor methods/NNS/methods /:/: t.left/JJ/t.left /NN/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position that/IN/that represents/NNS/represents the/DT/the left/NN/left child/NN/child of/IN/of p/NN/p /,/, or/CC/or none/NN/none if/IN/if p/NN/p has/VBZ/has no/DT/no left/NN/left child/NNP/child. t.right/JJ/t.right /NN/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position that/IN/that represents/NNS/represents the/DT/the right/NN/right child/NN/child of/IN/of p/NN/p /,/, or/CC/or none/NN/none if/IN/if p/NN/p has/VBZ/has no/DT/no right/NN/right child/NNP/child. t.sibling/NNP/t.sibling /NNP/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position that/IN/that represents/NNS/represents the/DT/the sibling/VBG/sibling of/IN/of p/NN/p /,/, or/CC/or none/NN/none if/IN/if p/NN/p has/VBZ/has no/DT/no sibling/NNP/sibling. just/RB/just as/IN/as in/IN/in section/NN/section 8.1.2/CD/8.1.2 for/IN/for the/DT/the tree/NN/tree adt/NN/adt /,/, we/PRP/we do/VBP/do not/RB/not define/VB/define specialized/VBN/specialized update/NN/update methods/NNS/methods for/IN/for binary/JJ/binary trees/NNS/trees here/NNP/here. instead/RB/instead /,/, we/PRP/we will/MD/will consider/VB/consider some/DT/some possible/JJ/possible update/NN/update methods/NNS/methods when/WRB/when we/PRP/we describe/VBP/describe specific/JJ/specific implementations/NNS/implementations and/CC/and applications/NNS/applications of/IN/of binary/JJ/binary trees/NNP/trees. the/DT/the binarytree/NN/binarytree abstract/NN/abstract base/NN/base class/NN/class in/IN/in python/NN/python just/RB/just as/IN/as tree/JJ/tree was/VBD/was defined/VBN/defined as/IN/as an/DT/an abstract/NN/abstract base/NN/base class/NN/class in/IN/in section/NN/section 8.1.2/CD/8.1.2 /,/, we/PRP/we define/VBP/define a/DT/a new/JJ/new binarytree/NN/binarytree class/NN/class associated/VBN/associated with/IN/with the/DT/the binary/JJ/binary tree/NN/tree adt/NNP/adt. we/PRP/we rely/RB/rely on/IN/on inheritance/NN/inheritance to/TO/to define/VB/define the/DT/the binarytree/NN/binarytree class/NN/class based/VBN/based upon/IN/upon the/DT/the existing/VBG/existing tree/NN/tree class/NNP/class. however/RB/however /,/, our/PRP$/our binarytree/NN/binarytree class/NN/class remains/VBZ/remains abstract/NN/abstract /,/, as/IN/as we/PRP/we still/RB/still do/VBP/do not/RB/not provide/VB/provide complete/JJ/complete specifications/NNS/specifications for/IN/for how/WRB/how such/JJ/such a/DT/a structure/NN/structure will/MD/will be/VB/be represented/VBN/represented internally/RB/internally /,/, nor/CC/nor implementations/NNS/implementations for/IN/for some/DT/some necessary/JJ/necessary behaviors/NNP/behaviors. our/PRP$/our python/NN/python implementation/NN/implementation of/IN/of the/DT/the binarytree/JJ/binarytree class/NN/class is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.7/CD/8.7. by/IN/by using/NN/using inheritance/NN/inheritance /,/, a/DT/a binary/JJ/binary tree/NN/tree supports/NNS/supports all/DT/all the/DT/the functionality/NN/functionality that/IN/that was/VBD/was defined/VBN/defined for/IN/for general/JJ/general trees/NNS/trees /:/( e.g/NNP/e.g. /,/, parent/NN/parent /,/, is/VBZ/is leaf/NN/leaf /,/, root/NN/root /:/) /./. our/PRP$/our new/JJ/new class/NN/class also/RB/also inherits/VBZ/inherits the/DT/the nested/VBN/nested position/NN/position class/NN/class that/IN/that was/VBD/was originally/RB/originally defined/VBN/defined within/IN/within the/DT/the tree/NN/tree class/NN/class definition/NNP/definition. in/IN/in addition/NN/addition /,/, the/DT/the new/JJ/new class/NN/class provides/VBZ/provides declarations/NNS/declarations for/IN/for new/JJ/new abstract/NN/abstract methods/NNS/methods left/VBN/left and/CC/and right/RB/right that/IN/that should/MD/should be/VB/be supported/VBN/supported by/IN/by concrete/JJ/concrete subclasses/NNS/subclasses of/IN/of binarytree/NNP/binarytree. our/PRP$/our new/JJ/new class/NN/class also/RB/also provides/VBZ/provides two/CD/two concrete/JJ/concrete implementations/NNS/implementations of/IN/of methods/NNP/methods. the/DT/the new/JJ/new sibling/NN/sibling method/NN/method is/VBZ/is derived/VBN/derived from/IN/from the/DT/the combination/NN/combination of/IN/of left/NN/left /,/, right/RB/right /,/, and/CC/and parent/NNP/parent. typically/RB/typically /,/, we/PRP/we identify/VBP/identify the/DT/the sibling/VBG/sibling of/IN/of a/DT/a position/NN/position p/NN/p as/IN/as the/DT/the other/JJ/other child/NN/child of/IN/of p/NN/p s/NNS/s parent/NNP/parent. however/RB/however /,/, if/IN/if p/NN/p is/VBZ/is the/DT/the root/NN/root /,/, it/PRP/it has/VBZ/has no/DT/no parent/NN/parent /,/, and/CC/and thus/RB/thus no/DT/no sibling/NNP/sibling. also/RB/also /,/, p/NN/p may/MD/may be/VB/be the/DT/the only/JJ/only child/NN/child of/IN/of its/PRP$/its parent/NN/parent /,/, and/CC/and thus/RB/thus does/VBZ/does not/RB/not have/VB/have a/DT/a sibling/NNP/sibling. finally/RB/finally /,/, code/NN/code fragment/NN/fragment 8.7/CD/8.7 provides/NNS/provides a/DT/a concrete/JJ/concrete implementation/NN/implementation of/IN/of the/DT/the children/NNS/children method/VBD/method ;/:/; this/DT/this method/NN/method is/VBZ/is abstract/NN/abstract in/IN/in the/DT/the tree/NN/tree class/NNP/class. although/IN/although we/PRP/we have/VBP/have still/RB/still not/RB/not specified/VBN/specified how/WRB/how the/DT/the children/NNS/children of/IN/of a/DT/a node/NN/node will/MD/will be/VB/be stored/VBN/stored /,/, we/PRP/we derive/VBP/derive a/DT/a generator/NN/generator for/IN/for the/DT/the ordered/VBN/ordered children/NNS/children based/VBN/based upon/IN/upon the/DT/the implied/JJ/implied behavior/NN/behavior of/IN/of abstract/NN/abstract methods/NNS/methods left/VBN/left and/CC/and right/NNP/right. 314/CD/314 chapter/NN/chapter 8/CD/8. trees/NNS/trees 8.2/CD/8.2. binary/JJ/binary trees/NNS/trees 315/CD/315 8.2.2/CD/8.2.2 properties/NNS/properties of/IN/of binary/JJ/binary trees/NNS/trees binary/JJ/binary trees/NNS/trees have/VBP/have several/JJ/several interesting/JJ/interesting properties/NNS/properties dealing/VBG/dealing with/IN/with relationships/NNS/relationships between/IN/between their/PRP$/their heights/NNS/heights and/CC/and number/NN/number of/IN/of nodes/NNP/nodes. we/PRP/we denote/VBP/denote the/DT/the set/NN/set of/IN/of all/DT/all nodes/NNS/nodes of/IN/of a/DT/a tree/NN/tree t/NN/t at/IN/at the/DT/the same/JJ/same depth/NN/depth d/NN/d as/IN/as level/NN/level d/NN/d of/IN/of t/NNP/t. in/IN/in a/DT/a binary/JJ/binary tree/NN/tree /,/, level/NN/level 0/-NONE-/0 has/VBZ/has at/IN/at most/JJS/most one/CD/one node/NN/node /:/( the/DT/the root/NN/root /:/) /,/, level/NN/level 1/CD/1 has/VBZ/has at/IN/at most/JJS/most two/CD/two nodes/NNS/nodes /:/( the/DT/the children/NNS/children of/IN/of the/DT/the root/NN/root /:/) /,/, level/NN/level 2/CD/2 has/VBZ/has at/IN/at most/JJS/most four/CD/four nodes/NNS/nodes /,/, and/CC/and so/RB/so on/NNP/on. /NNP/( see/VB/see figure/NN/figure 8.9/CD/8.9. /CD/) in/IN/in general/JJ/general /,/, level/NN/level d/NN/d has/VBZ/has at/IN/at most/JJS/most 2d/JJ/2d nodes/NNP/nodes. figure/NN/figure 8.9/CD/8.9 /:/: maximum/NN/maximum number/NN/number of/IN/of nodes/NNS/nodes in/IN/in the/DT/the levels/NNS/levels of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. we/PRP/we can/MD/can see/VB/see that/IN/that the/DT/the maximum/NN/maximum number/NN/number of/IN/of nodes/NNS/nodes on/IN/on the/DT/the levels/NNS/levels of/IN/of a/DT/a binary/JJ/binary tree/NN/tree grows/VBZ/grows exponentially/RB/exponentially as/IN/as we/PRP/we go/VBP/go down/RB/down the/DT/the tree/NNP/tree. from/IN/from this/DT/this simple/NN/simple observation/NN/observation /,/, we/PRP/we can/MD/can derive/VB/derive the/DT/the following/VBG/following properties/NNS/properties relating/VBG/relating the/DT/the height/NN/height of/IN/of a/DT/a binary/JJ/binary tree/NN/tree t/NN/t with/IN/with its/PRP$/its number/NN/number of/IN/of nodes/NNP/nodes. a/DT/a detailed/JJ/detailed justification/NN/justification of/IN/of these/DT/these properties/NNS/properties is/VBZ/is left/VBN/left as/RB/as exercise/VB/exercise r-8.8/NNP/r-8.8. proposition/NN/proposition 8.8/CD/8.8 /:/: let/JJ/let t/NN/t be/VB/be a/DT/a nonempty/NN/nonempty binary/NN/binary tree/NN/tree /,/, and/CC/and let/VB/let n/NN/n /,/, ne/NN/ne /,/, ni/NN/ni and/CC/and h/NN/h denote/NN/denote the/DT/the number/NN/number of/IN/of nodes/NNS/nodes /,/, number/NN/number of/IN/of external/JJ/external nodes/NNS/nodes /,/, number/NN/number of/IN/of internal/JJ/internal nodes/NNS/nodes /,/, and/CC/and height/VBD/height of/IN/of t/NN/t /,/, respectively/NNP/respectively. 316/CD/316 chapter/NN/chapter 8/CD/8. trees/NNS/trees relating/VBG/relating internal/JJ/internal nodes/NNS/nodes to/TO/to external/JJ/external nodes/NNS/nodes in/IN/in a/DT/a proper/NN/proper binary/NN/binary tree/NN/tree in/IN/in addition/NN/addition to/TO/to the/DT/the earlier/JJR/earlier binary/JJ/binary tree/NN/tree properties/NNS/properties /,/, the/DT/the following/VBG/following relationship/NN/relationship exists/NNS/exists between/IN/between the/DT/the number/NN/number of/IN/of internal/JJ/internal nodes/NNS/nodes and/CC/and external/JJ/external nodes/NNS/nodes in/IN/in a/DT/a proper/NN/proper binary/NN/binary tree/NNP/tree. proposition/NN/proposition 8.9/CD/8.9 /:/: in/IN/in a/DT/a nonempty/NN/nonempty proper/NN/proper binary/NN/binary tree/NN/tree t/NN/t /,/, with/IN/with ne/NN/ne external/JJ/external nodes/NNS/nodes and/CC/and ni/NN/ni internal/JJ/internal nodes/NNS/nodes /,/, we/PRP/we have/VBP/have ne/VBN/ne =/-NONE-/= ni/NN/ni +/:/+ 1/CD/1. justification/NN/justification /:/: we/PRP/we justify/VBP/justify this/DT/this proposition/NN/proposition by/IN/by removing/NN/removing nodes/NNS/nodes from/IN/from t/NN/t and/CC/and dividing/VBG/dividing them/PRP/them up/RP/up into/IN/into two/CD/two piles/NNS/piles /,/, an/DT/an internal-node/JJ/internal-node pile/NN/pile and/CC/and an/DT/an external-node/JJ/external-node pile/NN/pile /,/, until/IN/until t/NN/t becomes/VBZ/becomes empty/NNP/empty. the/DT/the piles/NNS/piles are/VBP/are initially/RB/initially empty/NNP/empty. by/IN/by the/DT/the end/NN/end /,/, we/PRP/we will/MD/will show/VB/show that/IN/that the/DT/the external-node/JJ/external-node pile/NN/pile has/VBZ/has one/CD/one more/JJR/more node/NN/node than/IN/than the/DT/the internal-node/JJ/internal-node pile/NNP/pile. we/PRP/we consider/VBP/consider two/CD/two cases/NNS/cases /:/: case/NN/case 1/CD/1 /:/: if/IN/if t/NN/t has/VBZ/has only/RB/only one/CD/one node/NN/node v/NN/v /,/, we/PRP/we remove/VBP/remove v/NN/v and/CC/and place/NN/place it/PRP/it on/IN/on the/DT/the external-node/JJ/external-node pile/NNP/pile. thus/RB/thus /,/, the/DT/the external-node/JJ/external-node pile/NN/pile has/VBZ/has one/CD/one node/NN/node and/CC/and the/DT/the internal-node/JJ/internal-node pile/NN/pile is/VBZ/is empty/NNP/empty. case/NN/case 2/CD/2 /:/: otherwise/RB/otherwise /:/( t/NN/t has/VBZ/has more/JJR/more than/IN/than one/CD/one node/NN/node /:/) /,/, we/PRP/we remove/VBP/remove from/IN/from t/NN/t an/DT/an /NN/( arbitrary/NN/arbitrary /:/) external/JJ/external node/NN/node w/NN/w and/CC/and its/PRP$/its parent/NN/parent v/NN/v /,/, which/WDT/which is/VBZ/is an/DT/an internal/JJ/internal node/NNP/node. we/PRP/we place/VBP/place w/NN/w on/IN/on the/DT/the external-node/JJ/external-node pile/NN/pile and/CC/and v/NN/v on/IN/on the/DT/the internal-node/JJ/internal-node pile/NNP/pile. if/IN/if v/NN/v has/VBZ/has a/DT/a parent/NN/parent u/NN/u /,/, then/RB/then we/PRP/we reconnect/VBP/reconnect u/PRP/u with/IN/with the/DT/the former/JJ/former sibling/NN/sibling z/NN/z of/IN/of w/NN/w /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 8.10/CD/8.10. this/DT/this operation/NN/operation /,/, removes/VBZ/removes one/CD/one internal/JJ/internal node/NN/node and/CC/and one/CD/one external/JJ/external node/NN/node /,/, and/CC/and leaves/VBZ/leaves the/DT/the tree/NN/tree being/VBG/being a/DT/a proper/NN/proper binary/NN/binary tree/NNP/tree. repeating/NN/repeating this/DT/this operation/NN/operation /,/, we/PRP/we eventually/RB/eventually are/VBP/are left/VBN/left with/IN/with a/DT/a final/JJ/final tree/NN/tree consisting/VBG/consisting of/IN/of a/DT/a single/JJ/single node/NNP/node. note/NN/note that/IN/that the/DT/the same/JJ/same number/NN/number of/IN/of external/JJ/external and/CC/and internal/JJ/internal nodes/NNS/nodes have/VBP/have been/VBN/been removed/VBN/removed and/CC/and placed/VBN/placed on/IN/on their/PRP$/their respective/JJ/respective piles/NNS/piles by/IN/by the/DT/the sequence/NN/sequence of/IN/of operations/NNS/operations leading/VBG/leading to/TO/to this/DT/this final/JJ/final tree/NNP/tree. now/RB/now /,/, we/PRP/we remove/VBP/remove the/DT/the node/NN/node of/IN/of the/DT/the final/JJ/final tree/NN/tree and/CC/and we/PRP/we place/VBP/place it/PRP/it on/IN/on the/DT/the external-node/JJ/external-node pile/NNP/pile. thus/RB/thus /,/, the/DT/the the/DT/the external-node/JJ/external-node pile/NN/pile has/VBZ/has one/CD/one more/JJR/more node/NN/node than/IN/than the/DT/the internal-node/JJ/internal-node pile/NNP/pile. figure/NN/figure 8.10/CD/8.10 /:/: operation/NN/operation that/IN/that removes/NNS/removes an/DT/an external/JJ/external node/NN/node and/CC/and its/PRP$/its parent/NN/parent node/NN/node /,/, used/VBN/used in/IN/in the/DT/the justification/NN/justification of/IN/of proposition/NN/proposition 8.9/CD/8.9. note/NN/note that/IN/that the/DT/the above/NN/above relationship/NN/relationship does/VBZ/does not/RB/not hold/VB/hold /,/, in/IN/in general/JJ/general /,/, for/IN/for improper/NN/improper binary/NN/binary trees/NNS/trees and/CC/and nonbinary/JJ/nonbinary trees/NNS/trees /,/, although/IN/although there/EX/there are/VBP/are other/JJ/other interesting/JJ/interesting relationships/NNS/relationships that/WDT/that do/VBP/do hold/NNP/hold. /NNP/( see/VB/see exercises/NNS/exercises c-8.32/-NONE-/c-8.32 through/IN/through c-8.34/NNP/c-8.34. /NNP/) 8.3/NNP/8.3. implementing/NN/implementing trees/NNS/trees 317/CD/317 8.3/CD/8.3 implementing/VBG/implementing trees/NNS/trees the/DT/the tree/NN/tree and/CC/and binarytree/VB/binarytree classes/NNS/classes that/WDT/that we/PRP/we have/VBP/have defined/VBN/defined thus/RB/thus far/RB/far in/IN/in this/DT/this chapter/NN/chapter are/VBP/are both/DT/both formally/RB/formally abstract/NN/abstract base/NN/base classes/NNP/classes. although/IN/although they/PRP/they provide/VBP/provide a/DT/a great/JJ/great deal/NN/deal of/IN/of support/NN/support /,/, neither/DT/neither of/IN/of them/PRP/them can/MD/can be/VB/be directly/RB/directly instantiated/NNP/instantiated. we/PRP/we have/VBP/have not/RB/not yet/RB/yet defined/VBN/defined key/JJ/key implementation/NN/implementation details/NNS/details for/IN/for how/WRB/how a/DT/a tree/NN/tree will/MD/will be/VB/be represented/VBN/represented internally/RB/internally /,/, and/CC/and how/WRB/how we/PRP/we can/MD/can effectively/RB/effectively navigate/VB/navigate between/IN/between parents/NNS/parents and/CC/and children/NNP/children. specifically/RB/specifically /,/, a/DT/a concrete/JJ/concrete implementation/NN/implementation of/IN/of a/DT/a tree/NN/tree must/MD/must provide/VB/provide methods/NNS/methods root/NN/root /,/, parent/NN/parent /,/, num/NN/num children/NNS/children /,/, children/NNS/children /,/, len/NN/len /,/, and/CC/and in/IN/in the/DT/the case/NN/case of/IN/of binarytree/NN/binarytree /,/, the/DT/the additional/JJ/additional accessors/NNS/accessors left/VBN/left and/CC/and right/NNP/right. there/RB/there are/VBP/are several/JJ/several choices/NNS/choices for/IN/for the/DT/the internal/JJ/internal representation/NN/representation of/IN/of trees/NNP/trees. we/PRP/we describe/VBP/describe the/DT/the most/RBS/most common/JJ/common representations/NNS/representations in/IN/in this/DT/this section/NNP/section. we/PRP/we begin/VBP/begin with/IN/with the/DT/the case/NN/case of/IN/of a/DT/a binary/JJ/binary tree/NN/tree /,/, since/IN/since its/PRP$/its shape/NN/shape is/VBZ/is more/RBR/more narrowly/RB/narrowly defined/NNP/defined. 8.3.1/CD/8.3.1 linked/VBD/linked structure/NN/structure for/IN/for binary/JJ/binary trees/NNS/trees a/DT/a natural/JJ/natural way/NN/way to/TO/to realize/VB/realize a/DT/a binary/JJ/binary tree/NN/tree t/NN/t is/VBZ/is to/TO/to use/VB/use a/DT/a linked/VBN/linked structure/NN/structure /,/, with/IN/with a/DT/a node/NN/node /:/( see/NN/see figure/NN/figure 8.11a/CD/8.11a /CD/) that/WDT/that maintains/VBZ/maintains references/NNS/references to/TO/to the/DT/the element/NN/element stored/VBD/stored at/IN/at a/DT/a position/NN/position p/NN/p and/CC/and to/TO/to the/DT/the nodes/NNS/nodes associated/VBN/associated with/IN/with the/DT/the children/NNS/children and/CC/and parent/NN/parent of/IN/of p/NNP/p. if/IN/if p/NN/p is/VBZ/is the/DT/the root/NN/root of/IN/of t/NN/t /,/, then/RB/then the/DT/the parent/NN/parent field/NN/field of/IN/of p/NN/p is/VBZ/is none/NNP/none. likewise/NN/likewise /,/, if/IN/if p/NN/p does/VBZ/does not/RB/not have/VB/have a/DT/a left/VBN/left child/NN/child /:/( respectively/RB/respectively /,/, right/RB/right child/VB/child /:/) /,/, the/DT/the associated/VBN/associated field/NN/field is/VBZ/is none/NNP/none. the/DT/the tree/NN/tree itself/PRP/itself maintains/VBZ/maintains an/DT/an instance/NN/instance variable/JJ/variable storing/NN/storing a/DT/a reference/NN/reference to/TO/to the/DT/the root/NN/root node/NN/node /:/( if/IN/if any/DT/any /NN/) /,/, and/CC/and a/DT/a variable/JJ/variable /,/, called/VBN/called size/NN/size /,/, that/IN/that represents/NNS/represents the/DT/the overall/JJ/overall number/NN/number of/IN/of nodes/NNS/nodes of/IN/of t/NNP/t. we/PRP/we show/VBP/show such/JJ/such a/DT/a linked/VBN/linked structure/NN/structure representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree in/IN/in figure/NN/figure 8.11b/CD/8.11b. figure/NN/figure 8.11/CD/8.11 /:/: a/DT/a linked/VBN/linked structure/NN/structure for/IN/for representing/VBG/representing /:/: /:/( a/DT/a /NN/) a/DT/a single/JJ/single node/NN/node ;/:/; /:/( b/NN/b /:/) a/DT/a binary/JJ/binary tree/NNP/tree. 318/CD/318 chapter/NN/chapter 8/CD/8. trees/NNS/trees python/IN/python implementation/NN/implementation of/IN/of a/DT/a linked/VBN/linked binary/JJ/binary tree/NN/tree structure/NN/structure in/IN/in this/DT/this section/NN/section /,/, we/PRP/we define/VBP/define a/DT/a concrete/JJ/concrete linkedbinarytree/NN/linkedbinarytree class/NN/class that/WDT/that implements/VBZ/implements the/DT/the binary/JJ/binary tree/NN/tree adt/NN/adt by/IN/by subclassing/NN/subclassing the/DT/the binarytree/NN/binarytree class/NNP/class. our/PRP$/our general/JJ/general approach/NN/approach is/VBZ/is very/RB/very similar/JJ/similar to/TO/to what/WP/what we/PRP/we used/VBD/used when/WRB/when developing/VBG/developing the/DT/the positionallist/NN/positionallist in/IN/in section/NN/section 7.4/CD/7.4 /:/: we/PRP/we define/VBP/define a/DT/a simple/JJ/simple /,/, nonpublic/JJ/nonpublic node/NN/node class/NN/class to/TO/to represent/VB/represent a/DT/a node/NN/node /,/, and/CC/and a/DT/a public/JJ/public position/NN/position class/NN/class that/IN/that wraps/NNS/wraps a/DT/a node/NNP/node. we/PRP/we provide/VBP/provide a/DT/a validate/NN/validate utility/NN/utility for/IN/for robustly/RB/robustly checking/VBG/checking the/DT/the validity/NN/validity of/IN/of a/DT/a given/VBN/given position/NN/position instance/NN/instance when/WRB/when unwrapping/VBG/unwrapping it/PRP/it /,/, and/CC/and a/DT/a make/NN/make position/NN/position utility/NN/utility for/IN/for wrapping/NN/wrapping a/DT/a node/NN/node as/IN/as a/DT/a position/NN/position to/TO/to return/VB/return to/TO/to a/DT/a caller/NNP/caller. those/DT/those definitions/NNS/definitions are/VBP/are provided/VBN/provided in/IN/in code/NN/code fragment/NN/fragment 8.8/CD/8.8. as/IN/as a/DT/a formality/NN/formality /,/, the/DT/the new/JJ/new position/NN/position class/NN/class is/VBZ/is declared/VBN/declared to/TO/to inherit/VB/inherit immediately/RB/immediately from/IN/from binarytree.position/NNP/binarytree.position. technically/RB/technically /,/, the/DT/the binarytree/NN/binarytree class/NN/class definition/NN/definition /:/( see/NN/see code/NN/code fragment/NN/fragment 8.7/CD/8.7 /CD/) does/VBZ/does not/RB/not formally/RB/formally declare/VB/declare such/JJ/such a/DT/a nested/JJ/nested class/NN/class ;/:/; it/PRP/it trivially/RB/trivially inherits/VBZ/inherits it/PRP/it from/IN/from tree.position/NNP/tree.position. a/DT/a minor/NN/minor benefit/NN/benefit from/IN/from this/DT/this design/NN/design is/VBZ/is that/IN/that our/PRP$/our position/NN/position class/NN/class inherits/NNS/inherits the/DT/the ne/NN/ne special/JJ/special method/NN/method so/IN/so that/IN/that syntax/NN/syntax p/NN/p !/./! =/:/= q/NN/q is/VBZ/is derived/VBN/derived appropriately/RB/appropriately relative/JJ/relative to/TO/to eq/VB/eq /./. our/PRP$/our class/NN/class definition/NN/definition continues/VBZ/continues /,/, in/IN/in code/NN/code fragment/NN/fragment 8.9/CD/8.9 /,/, with/IN/with a/DT/a constructor/NN/constructor and/CC/and with/IN/with concrete/JJ/concrete implementations/NNS/implementations for/IN/for the/DT/the methods/NNS/methods that/WDT/that remain/NN/remain abstract/NN/abstract in/IN/in the/DT/the tree/NN/tree and/CC/and binarytree/VB/binarytree classes/NNP/classes. the/DT/the constructor/NN/constructor creates/VBZ/creates an/DT/an empty/NN/empty tree/NN/tree by/IN/by initializing/NN/initializing root/NN/root to/TO/to none/NN/none and/CC/and size/NN/size to/TO/to zero/NNP/zero. these/DT/these accessor/NN/accessor methods/NNS/methods are/VBP/are implemented/VBN/implemented with/IN/with careful/JJ/careful use/NN/use of/IN/of the/DT/the validate/NN/validate and/CC/and make/VB/make position/NN/position utilities/NNS/utilities to/TO/to safeguard/VB/safeguard against/IN/against boundary/JJ/boundary cases/NNP/cases. operations/NNS/operations for/IN/for updating/VBG/updating a/DT/a linked/JJ/linked binary/NN/binary tree/NN/tree thus/RB/thus far/JJ/far /,/, we/PRP/we have/VBP/have provided/VBN/provided functionality/NN/functionality for/IN/for examining/NN/examining an/DT/an existing/VBG/existing binary/JJ/binary tree/NNP/tree. however/RB/however /,/, the/DT/the constructor/NN/constructor for/IN/for our/PRP$/our linkedbinarytree/JJ/linkedbinarytree class/NN/class results/NNS/results in/IN/in an/DT/an empty/NN/empty tree/NN/tree and/CC/and we/PRP/we have/VBP/have not/RB/not provided/VBN/provided any/DT/any means/NNS/means for/IN/for changing/VBG/changing the/DT/the structure/NN/structure or/CC/or content/NN/content of/IN/of a/DT/a tree/NNP/tree. we/PRP/we chose/VBD/chose not/RB/not to/TO/to declare/VB/declare update/JJ/update methods/NNS/methods as/IN/as part/NN/part of/IN/of the/DT/the tree/NN/tree or/CC/or binarytree/VB/binarytree abstract/NN/abstract base/NN/base classes/NNS/classes for/IN/for several/JJ/several reasons/NNP/reasons. first/JJ/first /,/, although/IN/although the/DT/the principle/NN/principle of/IN/of encapsulation/NN/encapsulation suggests/VBZ/suggests that/IN/that the/DT/the outward/NN/outward behaviors/NNS/behaviors of/IN/of a/DT/a class/NN/class need/NN/need not/RB/not depend/VB/depend on/IN/on the/DT/the internal/JJ/internal representation/NN/representation /,/, the/DT/the efficiency/NN/efficiency of/IN/of the/DT/the operations/NNS/operations depends/VBZ/depends greatly/RB/greatly upon/IN/upon the/DT/the representation/NNP/representation. we/PRP/we prefer/VBP/prefer to/TO/to have/VB/have each/DT/each concrete/JJ/concrete implementation/NN/implementation of/IN/of a/DT/a tree/NN/tree class/NN/class offer/NN/offer the/DT/the most/JJS/most suitable/JJ/suitable options/NNS/options for/IN/for updating/VBG/updating a/DT/a tree/NNP/tree. the/DT/the second/JJ/second reason/NN/reason we/PRP/we do/VBP/do not/RB/not provide/VB/provide update/JJ/update methods/NNS/methods in/IN/in the/DT/the base/NN/base class/NN/class is/VBZ/is that/IN/that we/PRP/we may/MD/may not/RB/not want/VB/want such/JJ/such update/JJ/update methods/NNS/methods to/TO/to be/VB/be part/NN/part of/IN/of a/DT/a public/JJ/public interface/NNP/interface. there/RB/there are/VBP/are many/JJ/many applications/NNS/applications of/IN/of trees/NNS/trees /,/, and/CC/and some/DT/some forms/NNS/forms of/IN/of update/JJ/update operations/NNS/operations that/WDT/that are/VBP/are suitable/JJ/suitable for/IN/for one/CD/one application/NN/application may/MD/may be/VB/be unacceptable/JJ/unacceptable in/IN/in another/NNP/another. however/RB/however /,/, if/IN/if we/PRP/we place/VBP/place an/DT/an update/NN/update method/NN/method in/IN/in a/DT/a base/NN/base class/NN/class /,/, any/DT/any class/NN/class that/IN/that inherits/NNS/inherits from/IN/from that/DT/that base/NN/base will/MD/will inherit/VB/inherit the/DT/the update/NN/update method/NNP/method. consider/NN/consider /,/, for/IN/for example/NN/example /,/, the/DT/the possibility/NN/possibility of/IN/of a/DT/a method/NN/method t.replace/NN/t.replace /:/( p/NN/p /,/, e/NN/e /:/) that/IN/that replaces/NNS/replaces the/DT/the element/NN/element stored/VBD/stored at/IN/at position/NN/position p/NN/p with/IN/with another/DT/another element/NN/element e/NNP/e. such/JJ/such a/DT/a general/JJ/general method/NN/method may/MD/may be/VB/be unacceptable/JJ/unacceptable in/IN/in the/DT/the context/NN/context of/IN/of an/DT/an arithmetic/JJ/arithmetic expression/NN/expression tree/NN/tree /:/( see/NN/see example/NN/example 8.7/CD/8.7 on/IN/on page/NN/page 312/CD/312 /,/, and/CC/and a/DT/a later/JJ/later case/NN/case study/NN/study in/IN/in section/NN/section 8.5/CD/8.5 /CD/) /,/, because/IN/because we/PRP/we may/MD/may want/VB/want to/TO/to enforce/VB/enforce that/IN/that internal/JJ/internal nodes/NNS/nodes store/VBP/store only/RB/only operators/NNS/operators as/IN/as elements/NNP/elements. 8.3/CD/8.3. implementing/VBG/implementing trees/NNS/trees 319/CD/319 for/IN/for linked/VBN/linked binary/JJ/binary trees/NNS/trees /,/, a/DT/a reasonable/JJ/reasonable set/NN/set of/IN/of update/NN/update methods/NNS/methods to/TO/to support/VB/support for/IN/for general/JJ/general usage/NN/usage are/VBP/are the/DT/the following/VBG/following /:/: t.add/JJ/t.add root/NN/root /:/( e/NN/e /:/) /:/: create/JJ/create a/DT/a root/NN/root for/IN/for an/DT/an empty/NN/empty tree/NN/tree /,/, storing/VBG/storing e/NN/e as/IN/as the/DT/the element/NN/element /,/, and/CC/and return/NN/return the/DT/the position/NN/position of/IN/of that/DT/that root/NN/root ;/:/; an/DT/an error/NN/error occurs/VBZ/occurs if/IN/if the/DT/the tree/NN/tree is/VBZ/is not/RB/not empty/NNP/empty. t.add/NNP/t.add left/VBD/left /NNP/( p/NN/p /,/, e/NN/e /:/) /:/: create/JJ/create a/DT/a new/JJ/new node/NN/node storing/VBG/storing element/NN/element e/NN/e /,/, link/NN/link the/DT/the node/NN/node as/IN/as the/DT/the left/NN/left child/NN/child of/IN/of position/NN/position p/NN/p /,/, and/CC/and return/NN/return the/DT/the resulting/VBG/resulting position/NN/position ;/:/; an/DT/an error/NN/error occurs/VBZ/occurs if/IN/if p/NN/p already/RB/already has/VBZ/has a/DT/a left/VBN/left child/NNP/child. t.add/NNP/t.add right/NN/right /:/( p/NN/p /,/, e/NN/e /:/) /:/: create/JJ/create a/DT/a new/JJ/new node/NN/node storing/VBG/storing element/NN/element e/NN/e /,/, link/NN/link the/DT/the node/NN/node as/IN/as the/DT/the right/NN/right child/NN/child of/IN/of position/NN/position p/NN/p /,/, and/CC/and return/NN/return the/DT/the resulting/VBG/resulting position/NN/position ;/:/; an/DT/an error/NN/error occurs/VBZ/occurs if/IN/if p/NN/p already/RB/already has/VBZ/has a/DT/a right/NN/right child/NNP/child. t.replace/NN/t.replace /:/( p/NN/p /,/, e/NN/e /:/) /:/: replace/NN/replace the/DT/the element/NN/element stored/VBD/stored at/IN/at position/NN/position p/NN/p with/IN/with element/NN/element e/NN/e /,/, and/CC/and return/NN/return the/DT/the previously/RB/previously stored/VBD/stored element/NNP/element. t.delete/JJ/t.delete /NN/( p/NN/p /:/) /:/: remove/IN/remove the/DT/the node/NN/node at/IN/at position/NN/position p/NN/p /,/, replacing/VBG/replacing it/PRP/it with/IN/with its/PRP$/its child/NN/child /,/, if/IN/if any/DT/any /,/, and/CC/and return/NN/return the/DT/the element/NN/element that/IN/that had/VBD/had been/VBN/been stored/VBN/stored at/IN/at p/NN/p ;/:/; an/DT/an error/NN/error occurs/VBZ/occurs if/IN/if p/NN/p has/VBZ/has two/CD/two children/NNP/children. t.attach/JJ/t.attach /NN/( p/NN/p /,/, t1/NNP/t1 /,/, t2/NNP/t2 /NNP/) /:/: attach/DT/attach the/DT/the internal/JJ/internal structure/NN/structure of/IN/of trees/NNS/trees t1/NNP/t1 and/CC/and t2/NNP/t2 /,/, respectively/RB/respectively /,/, as/IN/as the/DT/the left/NN/left and/CC/and right/RB/right subtrees/VBZ/subtrees of/IN/of leaf/NN/leaf position/NN/position p/NN/p of/IN/of t/NN/t /,/, and/CC/and reset/VB/reset t1/NNP/t1 and/CC/and t2/NNP/t2 to/TO/to empty/NN/empty trees/NNS/trees ;/:/; an/DT/an error/NN/error condition/NN/condition occurs/NNS/occurs if/IN/if p/NN/p is/VBZ/is not/RB/not a/DT/a leaf/NNP/leaf. we/PRP/we have/VBP/have specifically/RB/specifically chosen/VBN/chosen this/DT/this collection/NN/collection of/IN/of operations/NNS/operations because/IN/because each/DT/each can/MD/can be/VB/be implemented/VBN/implemented in/IN/in o/NN/o /:/( 1/CD/1 /CD/) worst-case/JJ/worst-case time/NN/time with/IN/with our/PRP$/our linked/VBN/linked representation/NNP/representation. the/DT/the most/RBS/most complex/JJ/complex of/IN/of these/DT/these are/VBP/are delete/JJ/delete and/CC/and attach/DT/attach /,/, due/JJ/due to/TO/to the/DT/the case/NN/case analyses/VBZ/analyses involving/VBG/involving the/DT/the various/JJ/various parent-child/NN/parent-child relationships/NNS/relationships and/CC/and boundary/JJ/boundary conditions/NNS/conditions /,/, yet/RB/yet there/EX/there remains/VBZ/remains only/RB/only a/DT/a constant/JJ/constant number/NN/number of/IN/of operations/NNS/operations to/TO/to perform/NNP/perform. /NNP/( the/DT/the implementation/NN/implementation of/IN/of both/DT/both methods/NNS/methods could/MD/could be/VB/be greatly/RB/greatly simplified/VBN/simplified if/IN/if we/PRP/we used/VBD/used a/DT/a tree/NN/tree representation/NN/representation with/IN/with a/DT/a sentinel/NN/sentinel node/NN/node /,/, akin/NN/akin to/TO/to our/PRP$/our treatment/NN/treatment of/IN/of positional/JJ/positional lists/NNS/lists ;/:/; see/VB/see exercise/NN/exercise c-8.40/-NONE-/c-8.40 /./) /./. to/TO/to avoid/VB/avoid the/DT/the problem/NN/problem of/IN/of undesirable/JJ/undesirable update/NN/update methods/NNS/methods being/VBG/being inherited/VBN/inherited by/IN/by subclasses/NNS/subclasses of/IN/of linkedbinarytree/JJ/linkedbinarytree /,/, we/PRP/we have/VBP/have chosen/VBN/chosen an/DT/an implementation/NN/implementation in/IN/in which/WDT/which none/NN/none of/IN/of the/DT/the above/JJ/above methods/NNS/methods are/VBP/are publicly/RB/publicly supported/NNP/supported. instead/RB/instead /,/, we/PRP/we provide/VBP/provide nonpublic/JJ/nonpublic versions/NNS/versions of/IN/of each/DT/each /,/, for/IN/for example/NN/example /,/, providing/NN/providing the/DT/the underscored/VBN/underscored delete/JJ/delete in/IN/in lieu/NN/lieu of/IN/of a/DT/a public/JJ/public delete/NNP/delete. our/PRP$/our implementations/NNS/implementations of/IN/of these/DT/these six/CD/six update/NN/update methods/NNS/methods are/VBP/are provided/VBN/provided in/IN/in code/NN/code fragments/NNS/fragments 8.10/CD/8.10 and/CC/and 8.11/CD/8.11. in/IN/in particular/JJ/particular applications/NNS/applications /,/, subclasses/NNS/subclasses of/IN/of linkedbinarytree/JJ/linkedbinarytree can/NN/can invoke/NN/invoke the/DT/the nonpublic/JJ/nonpublic methods/NNS/methods internally/RB/internally /,/, while/IN/while preserving/NN/preserving a/DT/a public/JJ/public interface/NN/interface that/IN/that is/VBZ/is appropriate/JJ/appropriate for/IN/for the/DT/the application/NNP/application. a/DT/a subclass/NN/subclass may/MD/may also/RB/also choose/VB/choose to/TO/to wrap/VB/wrap one/CD/one or/CC/or more/JJR/more of/IN/of the/DT/the nonpublic/JJ/nonpublic update/NN/update methods/NNS/methods with/IN/with a/DT/a public/JJ/public method/NN/method to/TO/to expose/VB/expose it/PRP/it to/TO/to the/DT/the user/NNP/user. we/PRP/we leave/VBP/leave as/IN/as an/DT/an exercise/NN/exercise /:/( r-8.15/-NONE-/r-8.15 /:/) /,/, the/DT/the task/NN/task of/IN/of defining/VBG/defining a/DT/a mutablelinkedbinarytree/JJ/mutablelinkedbinarytree subclass/NN/subclass that/WDT/that provides/VBZ/provides public/JJ/public methods/NNS/methods wrapping/VBG/wrapping each/DT/each of/IN/of these/DT/these six/CD/six update/NN/update methods/NNP/methods. 8.3/CD/8.3. implementing/VBG/implementing trees/NNS/trees 321/CD/321 chapter/NN/chapter 8/CD/8. trees/NNS/trees performance/NN/performance of/IN/of the/DT/the linked/VBN/linked binary/JJ/binary tree/NN/tree implementation/NN/implementation to/TO/to summarize/VB/summarize the/DT/the efficiencies/NNS/efficiencies of/IN/of the/DT/the linked/VBN/linked structure/NN/structure representation/NN/representation /,/, we/PRP/we analyze/VBP/analyze the/DT/the running/VBG/running times/NNS/times of/IN/of the/DT/the linkedbinarytree/JJ/linkedbinarytree methods/NNS/methods /,/, including/VBG/including derived/VBN/derived methods/NNS/methods that/IN/that are/VBP/are inherited/VBN/inherited from/IN/from the/DT/the tree/NN/tree and/CC/and binarytree/VB/binarytree classes/NNS/classes /:/: the/DT/the len/NN/len method/NN/method /,/, implemented/VBD/implemented in/IN/in linkedbinarytree/NN/linkedbinarytree /,/, uses/VBZ/uses an/DT/an instance/NN/instance variable/JJ/variable storing/NN/storing the/DT/the number/NN/number of/IN/of nodes/NNS/nodes of/IN/of t/NN/t and/CC/and takes/VBZ/takes o/NN/o /:/( 1/CD/1 /CD/) time/NNP/time. method/NN/method is/VBZ/is empty/JJ/empty /,/, inherited/VBN/inherited from/IN/from tree/NN/tree /,/, relies/NNS/relies on/IN/on a/DT/a single/JJ/single call/NN/call to/TO/to len/VB/len and/CC/and thus/RB/thus takes/VBZ/takes o/NN/o /:/( 1/CD/1 /CD/) time/NNP/time. the/DT/the accessor/NN/accessor methods/NNS/methods root/NN/root /,/, left/VBN/left /,/, right/RB/right /,/, parent/NN/parent /,/, and/CC/and num/NN/num children/NNS/children are/VBP/are implemented/VBN/implemented directly/RB/directly in/IN/in linkedbinarytree/JJ/linkedbinarytree and/CC/and take/VB/take o/NN/o /:/( 1/CD/1 /CD/) time/NNP/time. the/DT/the sibling/NN/sibling and/CC/and children/NNS/children methods/NNS/methods are/VBP/are derived/VBN/derived in/IN/in binarytree/JJ/binarytree based/VBN/based on/IN/on a/DT/a constant/JJ/constant number/NN/number of/IN/of calls/NNS/calls to/TO/to these/DT/these other/JJ/other accessors/NNS/accessors /,/, so/RB/so they/PRP/they run/VBP/run in/IN/in o/NN/o /:/( 1/CD/1 /CD/) time/NN/time as/IN/as well/NNP/well. the/DT/the is/VBZ/is root/NN/root and/CC/and is/VBZ/is leaf/NN/leaf methods/NNS/methods /,/, from/IN/from the/DT/the tree/NN/tree class/NN/class /,/, both/DT/both run/NN/run in/IN/in o/NN/o /:/( 1/CD/1 /CD/) time/NN/time /,/, as/IN/as is/VBZ/is root/VBN/root calls/NNS/calls root/NN/root and/CC/and then/RB/then relies/VBZ/relies on/IN/on equivalence/NN/equivalence testing/NN/testing of/IN/of positions/NNS/positions /,/, while/IN/while is/VBZ/is leaf/NN/leaf calls/VBZ/calls left/VBN/left and/CC/and right/RB/right and/CC/and verifies/NNS/verifies that/WDT/that none/NN/none is/VBZ/is returned/VBN/returned by/IN/by both/NNP/both. methods/NNS/methods depth/VBP/depth and/CC/and height/NN/height were/VBD/were each/DT/each analyzed/VBN/analyzed in/IN/in section/NN/section 8.1.3/CD/8.1.3. the/DT/the depth/NN/depth method/NN/method at/IN/at position/NN/position p/NN/p runs/VBZ/runs in/IN/in o/NN/o /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) time/NN/time where/WRB/where dp/NN/dp is/VBZ/is its/PRP$/its depth/NN/depth ;/:/; the/DT/the height/NN/height method/NN/method on/IN/on the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree runs/VBZ/runs in/IN/in o/NN/o /:/( n/NN/n /:/) time/NNP/time. the/DT/the various/JJ/various update/NN/update methods/NNS/methods add/VBP/add root/NN/root /,/, add/JJ/add left/NN/left /,/, add/JJ/add right/NN/right /,/, replace/NN/replace /,/, delete/JJ/delete /,/, and/CC/and attach/DT/attach /NN/( that/IN/that is/VBZ/is /,/, their/PRP$/their nonpublic/JJ/nonpublic implementations/NNS/implementations /:/) each/DT/each run/NN/run in/IN/in o/NN/o /:/( 1/CD/1 /CD/) time/NN/time /,/, as/IN/as they/PRP/they involve/VBP/involve relinking/VBG/relinking only/RB/only a/DT/a constant/JJ/constant number/NN/number of/IN/of nodes/NNS/nodes per/IN/per operation/NNP/operation. table/NN/table 8.1/CD/8.1 summarizes/NNS/summarizes the/DT/the performance/NN/performance of/IN/of the/DT/the linked/VBN/linked structure/NN/structure implementation/NN/implementation of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. operation/NN/operation running/VBG/running time/NN/time len/NN/len /,/, is/VBZ/is empty/JJ/empty o/NN/o /:/( 1/CD/1 /CD/) root/NN/root /,/, parent/NN/parent /,/, left/VBN/left /,/, right/RB/right /,/, sibling/VBG/sibling /,/, children/NNS/children /,/, num/NN/num children/NNS/children o/VBP/o /:/( 1/CD/1 /CD/) is/VBZ/is root/NN/root /,/, is/VBZ/is leaf/NN/leaf o/NN/o /:/( 1/CD/1 /CD/) depth/NN/depth /:/( p/NN/p /:/) o/NN/o /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) height/NN/height o/NN/o /:/( n/NN/n /:/) add/NN/add root/NN/root /,/, add/JJ/add left/NN/left /,/, add/JJ/add right/NN/right /,/, replace/NN/replace /,/, delete/JJ/delete /,/, attach/DT/attach o/NN/o /:/( 1/CD/1 /CD/) table/JJ/table 8.1/CD/8.1 /:/: running/VBG/running times/NNS/times for/IN/for the/DT/the methods/NNS/methods of/IN/of an/DT/an n-node/JJ/n-node binary/NN/binary tree/NN/tree implemented/VBD/implemented with/IN/with a/DT/a linked/VBN/linked structure/NNP/structure. the/DT/the space/NN/space usage/NN/usage is/VBZ/is o/RB/o /:/( n/NN/n /:/) /./. 8.3/CD/8.3. implementing/VBG/implementing trees/NNS/trees 325/CD/325 8.3.2/CD/8.3.2 array-based/JJ/array-based representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree an/DT/an alternative/NN/alternative representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree t/NN/t is/VBZ/is based/VBN/based on/IN/on a/DT/a way/NN/way of/IN/of numbering/VBG/numbering the/DT/the positions/NNS/positions of/IN/of t/NNP/t. for/IN/for every/DT/every position/NN/position p/NN/p of/IN/of t/NN/t /,/, let/VB/let f/NN/f /:/( p/NN/p /:/) be/VB/be the/DT/the integer/NN/integer defined/VBD/defined as/IN/as follows/NNP/follows. if/IN/if p/NN/p is/VBZ/is the/DT/the root/NN/root of/IN/of t/NN/t /,/, then/RB/then f/NN/f /:/( p/NN/p /:/) =/:/= 0/CD/0. if/IN/if p/NN/p is/VBZ/is the/DT/the left/VBN/left child/NN/child of/IN/of position/NN/position q/NN/q /,/, then/RB/then f/NN/f /:/( p/NN/p /:/) =/:/= 2/CD/2 f/NN/f /:/( q/NN/q /:/) +/:/+ 1/CD/1. if/IN/if p/NN/p is/VBZ/is the/DT/the right/NN/right child/NN/child of/IN/of position/NN/position q/NN/q /,/, then/RB/then f/NN/f /:/( p/NN/p /:/) =/:/= 2/CD/2 f/NN/f /:/( q/NN/q /:/) +/:/+ 2/CD/2. the/DT/the numbering/NN/numbering function/NN/function f/NN/f is/VBZ/is known/VBN/known as/IN/as a/DT/a level/NN/level numbering/VBG/numbering of/IN/of the/DT/the positions/NNS/positions in/IN/in a/DT/a binary/JJ/binary tree/NN/tree t/NN/t /,/, for/IN/for it/PRP/it numbers/VBZ/numbers the/DT/the positions/NNS/positions on/IN/on each/DT/each level/NN/level of/IN/of t/NN/t in/IN/in increasing/VBG/increasing order/NN/order from/IN/from left/VBN/left to/TO/to right/NNP/right. /NNP/( see/VB/see figure/NN/figure 8.12/CD/8.12. /CD/) note/NN/note well/RB/well that/IN/that the/DT/the level/NN/level numbering/VBG/numbering is/VBZ/is based/VBN/based on/IN/on potential/JJ/potential positions/NNS/positions within/IN/within the/DT/the tree/NN/tree /,/, not/RB/not actual/JJ/actual positions/NNS/positions of/IN/of a/DT/a given/VBN/given tree/NN/tree /,/, so/RB/so they/PRP/they are/VBP/are not/RB/not necessarily/RB/necessarily consecutive/NNP/consecutive. for/IN/for example/NN/example /,/, in/IN/in figure/NN/figure 8.12/CD/8.12 /CD/( b/NN/b /:/) /,/, there/EX/there are/VBP/are no/DT/no nodes/NNS/nodes with/IN/with level/NN/level numbering/VBG/numbering 13/CD/13 or/CC/or 14/CD/14 /,/, because/IN/because the/DT/the node/NN/node with/IN/with level/NN/level numbering/VBG/numbering 6/CD/6 has/VBZ/has no/DT/no children/NNP/children. 326/CD/326 chapter/NN/chapter 8/CD/8. trees/NNS/trees the/DT/the level/NN/level numbering/VBG/numbering function/NN/function f/NN/f suggests/VBZ/suggests a/DT/a representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree t/NN/t by/IN/by means/NNS/means of/IN/of an/DT/an array-based/JJ/array-based structure/NN/structure a/DT/a /NN/( such/JJ/such as/IN/as a/DT/a python/NN/python list/NN/list /:/) /,/, with/IN/with the/DT/the element/NN/element at/IN/at position/NN/position p/NN/p of/IN/of t/NN/t stored/VBD/stored at/IN/at index/NN/index f/NN/f /:/( p/NN/p /:/) of/IN/of the/DT/the array/NNP/array. we/PRP/we show/VBP/show an/DT/an example/NN/example of/IN/of an/DT/an array-based/JJ/array-based representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree in/IN/in figure/NN/figure 8.13/CD/8.13. figure/NN/figure 8.13/CD/8.13 /:/: representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree by/IN/by means/NNS/means of/IN/of an/DT/an array/NNP/array. one/CD/one advantage/NN/advantage of/IN/of an/DT/an array-based/JJ/array-based representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is that/IN/that a/DT/a position/NN/position p/NN/p can/MD/can be/VB/be represented/VBN/represented by/IN/by the/DT/the single/JJ/single integer/NN/integer f/NN/f /:/( p/NN/p /:/) /,/, and/CC/and that/IN/that position-based/JJ/position-based methods/NNS/methods such/JJ/such as/IN/as root/NN/root /,/, parent/NN/parent /,/, left/VBN/left /,/, and/CC/and right/RB/right can/MD/can be/VB/be implemented/VBN/implemented using/VBG/using simple/NN/simple arithmetic/JJ/arithmetic operations/NNS/operations on/IN/on the/DT/the number/NN/number f/NN/f /:/( p/NN/p /:/) /./. based/VBN/based on/IN/on our/PRP$/our formula/NN/formula for/IN/for the/DT/the level/NN/level numbering/VBG/numbering /,/, the/DT/the left/NN/left child/NN/child of/IN/of p/NN/p has/VBZ/has index/NN/index 2/CD/2 f/NN/f /:/( p/NN/p /:/) +/:/+ 1/CD/1 /,/, the/DT/the right/NN/right child/NN/child of/IN/of p/NN/p has/VBZ/has index/NN/index 2/CD/2 f/NN/f /:/( p/NN/p /:/) +/:/+ 2/CD/2 /,/, and/CC/and the/DT/the parent/NN/parent of/IN/of p/NN/p has/VBZ/has index/NN/index _/NNP/_ /NNP/( f/NN/f /:/( p/NN/p /:/) 1/CD/1 /CD/) /2_/NNP//2_. we/PRP/we leave/VBP/leave the/DT/the details/NNS/details of/IN/of a/DT/a complete/JJ/complete implementation/NN/implementation as/IN/as an/DT/an exercise/NN/exercise /:/( r-8.18/-NONE-/r-8.18 /:/) /./. the/DT/the space/NN/space usage/NN/usage of/IN/of an/DT/an array-based/JJ/array-based representation/NN/representation depends/NNS/depends greatly/RB/greatly on/IN/on the/DT/the shape/NN/shape of/IN/of the/DT/the tree/NNP/tree. let/NN/let n/NN/n be/VB/be the/DT/the number/NN/number of/IN/of nodes/NNS/nodes of/IN/of t/NN/t /,/, and/CC/and let/VB/let fm/NN/fm be/VB/be the/DT/the maximum/NN/maximum value/NN/value of/IN/of f/NN/f /:/( p/NN/p /:/) over/IN/over all/DT/all the/DT/the nodes/NNS/nodes of/IN/of t/NNP/t. the/DT/the array/NN/array a/DT/a requires/VBZ/requires length/NN/length n/NN/n =/:/= 1/CD/1 +/CD/+ fm/NN/fm /,/, since/IN/since elements/NNS/elements range/VBP/range from/IN/from a/DT/a /CD/[ 0/-NONE-/0 /:/] to/TO/to a/DT/a /NN/[ fm/NN/fm /:/] /./. note/NN/note that/IN/that a/DT/a may/MD/may have/VB/have a/DT/a number/NN/number of/IN/of empty/JJ/empty cells/NNS/cells that/WDT/that do/VBP/do not/RB/not refer/VB/refer to/TO/to existing/VBG/existing nodes/NNS/nodes of/IN/of t/NNP/t. in/IN/in fact/NN/fact /,/, in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, n/NN/n =/:/= 2n/CD/2n 1/CD/1 /,/, the/DT/the justification/NN/justification of/IN/of which/WDT/which is/VBZ/is left/VBN/left as/RB/as an/DT/an exercise/NN/exercise /:/( r-8.16/-NONE-/r-8.16 /:/) /./. in/IN/in section/NN/section 9.3/CD/9.3 /,/, we/PRP/we will/MD/will see/VB/see a/DT/a class/NN/class of/IN/of binary/JJ/binary trees/NNS/trees /,/, called/VBN/called heaps/NNS/heaps for/IN/for which/WDT/which n/NN/n =/:/= n/NNP/n. thus/RB/thus /,/, in/IN/in spite/NN/spite of/IN/of the/DT/the worst-case/JJ/worst-case space/NN/space usage/NN/usage /,/, there/EX/there are/VBP/are applications/NNS/applications for/IN/for which/WDT/which the/DT/the array/NN/array representation/NN/representation of/IN/of a/DT/a binary/JJ/binary tree/NN/tree is/VBZ/is space/NN/space efficient/NNP/efficient. still/RB/still /,/, for/IN/for general/JJ/general binary/NN/binary trees/NNS/trees /,/, the/DT/the exponential/JJ/exponential worst-case/NN/worst-case space/NN/space requirement/NN/requirement of/IN/of this/DT/this representation/NN/representation is/VBZ/is prohibitive/NNP/prohibitive. another/DT/another drawback/NN/drawback of/IN/of an/DT/an array/NN/array representation/NN/representation is/VBZ/is that/IN/that some/DT/some update/JJ/update operations/NNS/operations for/IN/for trees/NNS/trees can/MD/can not/RB/not be/VB/be efficiently/RB/efficiently supported/NNP/supported. for/IN/for example/NN/example /,/, deleting/NN/deleting a/DT/a node/NN/node and/CC/and promoting/VBG/promoting its/PRP$/its child/NN/child takes/VBZ/takes o/NN/o /:/( n/NN/n /:/) time/NN/time because/IN/because it/PRP/it is/VBZ/is not/RB/not just/RB/just the/DT/the child/NN/child that/IN/that moves/NNS/moves locations/NNS/locations within/IN/within the/DT/the array/NN/array /,/, but/CC/but all/DT/all descendants/NNS/descendants of/IN/of that/DT/that child/NNP/child. 8.3/NNP/8.3. implementing/NN/implementing trees/NNS/trees 327/CD/327 8.3.3/CD/8.3.3 linked/VBN/linked structure/NN/structure for/IN/for general/JJ/general trees/NNS/trees when/WRB/when representing/VBG/representing a/DT/a binary/JJ/binary tree/NN/tree with/IN/with a/DT/a linked/VBN/linked structure/NN/structure /,/, each/DT/each node/NN/node explicitly/RB/explicitly maintains/VBZ/maintains fields/NNS/fields left/VBN/left and/CC/and right/RB/right as/IN/as references/NNS/references to/TO/to individual/JJ/individual children/NNP/children. for/IN/for a/DT/a general/JJ/general tree/NN/tree /,/, there/EX/there is/VBZ/is no/DT/no a/DT/a priori/NN/priori limit/NN/limit on/IN/on the/DT/the number/NN/number of/IN/of children/NNS/children that/WDT/that a/DT/a node/NN/node may/MD/may have/NNP/have. a/DT/a natural/JJ/natural way/NN/way to/TO/to realize/VB/realize a/DT/a general/JJ/general tree/NN/tree t/NN/t as/IN/as a/DT/a linked/VBN/linked structure/NN/structure is/VBZ/is to/TO/to have/VB/have each/DT/each node/NN/node store/NN/store a/DT/a single/JJ/single container/NN/container of/IN/of references/NNS/references to/TO/to its/PRP$/its children/NNP/children. for/IN/for example/NN/example /,/, a/DT/a children/NN/children field/NN/field of/IN/of a/DT/a node/NN/node can/MD/can be/VB/be a/DT/a python/NN/python list/NN/list of/IN/of references/NNS/references to/TO/to the/DT/the children/NNS/children of/IN/of the/DT/the node/NN/node /:/( if/IN/if any/DT/any /NN/) /./. such/JJ/such a/DT/a linked/VBN/linked representation/NN/representation .figure/NN/.figure 8.14/CD/8.14 /:/: the/DT/the linked/VBN/linked structure/NN/structure for/IN/for a/DT/a general/JJ/general tree/NN/tree /:/: /:/( a/DT/a /NN/) the/DT/the structure/NN/structure of/IN/of a/DT/a node/NN/node ;/:/; /:/( b/NN/b /:/) a/DT/a larger/JJR/larger portion/NN/portion of/IN/of the/DT/the data/NNS/data structure/VBP/structure associated/VBN/associated with/IN/with a/DT/a node/NN/node and/CC/and its/PRP$/its children/NNP/children. table/JJ/table 8.2/CD/8.2 summarizes/NNS/summarizes the/DT/the performance/NN/performance of/IN/of the/DT/the implementation/NN/implementation of/IN/of a/DT/a general/JJ/general tree/NN/tree using/VBG/using a/DT/a linked/JJ/linked structure/NNP/structure. the/DT/the analysis/NN/analysis is/VBZ/is left/VBN/left as/RB/as an/DT/an exercise/NN/exercise /:/( r-8.14/-NONE-/r-8.14 /:/) /,/, but/CC/but we/PRP/we note/VBP/note that/IN/that /,/, by/IN/by using/NN/using a/DT/a collection/NN/collection to/TO/to store/VB/store the/DT/the children/NNS/children of/IN/of each/DT/each position/NN/position p/NN/p /,/, we/PRP/we can/MD/can implement/VB/implement children/NNS/children /:/( p/NN/p /:/) by/IN/by simply/RB/simply iterating/VBG/iterating that/IN/that collection/NNP/collection. operation/NN/operation running/VBG/running time/NN/time len/NN/len /,/, is/VBZ/is empty/JJ/empty o/NN/o /:/( 1/CD/1 /CD/) root/NN/root /,/, parent/NN/parent /,/, is/VBZ/is root/VBN/root /,/, is/VBZ/is leaf/NN/leaf o/NN/o /:/( 1/CD/1 /CD/) children/NNS/children /:/( p/NN/p /:/) o/NN/o /:/( cp/NN/cp +/:/+ 1/CD/1 /CD/) depth/NN/depth /:/( p/NN/p /:/) o/NN/o /:/( dp/NN/dp +/:/+ 1/CD/1 /CD/) height/NN/height o/NN/o /:/( n/NN/n /:/) table/JJ/table 8.2/CD/8.2 /:/: running/VBG/running times/NNS/times of/IN/of the/DT/the accessor/NN/accessor methods/NNS/methods of/IN/of an/DT/an n-node/JJ/n-node general/JJ/general tree/NN/tree implemented/VBD/implemented with/IN/with a/DT/a linked/VBN/linked structure/NNP/structure. we/PRP/we let/VBP/let cp/NN/cp denote/NN/denote the/DT/the number/NN/number of/IN/of children/NNS/children of/IN/of a/DT/a position/NN/position p/NNP/p. the/DT/the space/NN/space usage/NN/usage is/VBZ/is o/RB/o /:/( n/NN/n /:/) /./. 328/CD/328 chapter/NN/chapter 8/CD/8. trees/NNS/trees 8.4/CD/8.4 tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms a/DT/a traversal/NN/traversal of/IN/of a/DT/a tree/NN/tree t/NN/t is/VBZ/is a/DT/a systematic/JJ/systematic way/NN/way of/IN/of accessing/VBG/accessing /,/, or/CC/or visiting/VBG/visiting /,/, all/DT/all the/DT/the positions/NNS/positions of/IN/of t/NNP/t. the/DT/the specific/JJ/specific action/NN/action associated/VBN/associated with/IN/with the/DT/the visit/NN/visit of/IN/of a/DT/a position/NN/position p/NN/p depends/NNS/depends on/IN/on the/DT/the application/NN/application of/IN/of this/DT/this traversal/NN/traversal /,/, and/CC/and could/MD/could involve/VB/involve anything/NN/anything from/IN/from incrementing/VBG/incrementing a/DT/a counter/NN/counter to/TO/to performing/VBG/performing some/DT/some complex/JJ/complex computation/NN/computation for/IN/for p/NNP/p. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we describe/VBP/describe several/JJ/several common/JJ/common traversal/NN/traversal schemes/NNS/schemes for/IN/for trees/NNS/trees /,/, implement/NN/implement them/PRP/them in/IN/in the/DT/the context/NN/context of/IN/of our/PRP$/our various/JJ/various tree/NN/tree classes/NNS/classes /,/, and/CC/and discuss/NN/discuss several/JJ/several common/JJ/common applications/NNS/applications of/IN/of tree/NN/tree traversals/NNP/traversals. 8.4.1/CD/8.4.1 preorder/NN/preorder and/CC/and postorder/NN/postorder traversals/NNS/traversals of/IN/of general/JJ/general trees/NNS/trees in/IN/in a/DT/a preorder/NN/preorder traversal/NN/traversal of/IN/of a/DT/a tree/NN/tree t/NN/t /,/, the/DT/the root/NN/root of/IN/of t/NN/t is/VBZ/is visited/VBN/visited first/RB/first and/CC/and then/RB/then the/DT/the subtrees/NNS/subtrees rooted/VBD/rooted at/IN/at its/PRP$/its children/NNS/children are/VBP/are traversed/VBN/traversed recursively/NNP/recursively. if/IN/if the/DT/the tree/NN/tree is/VBZ/is ordered/VBN/ordered /,/, then/RB/then the/DT/the subtrees/NNS/subtrees are/VBP/are traversed/VBN/traversed according/VBG/according to/TO/to the/DT/the order/NN/order of/IN/of the/DT/the children/NNP/children. the/DT/the pseudo-code/JJ/pseudo-code for/IN/for the/DT/the preorder/NN/preorder traversal/NN/traversal of/IN/of the/DT/the subtree/JJ/subtree rooted/VBN/rooted at/IN/at a/DT/a position/NN/position p/NN/p is/VBZ/is shown/VBN/shown in/IN/in code/NN/code fragment/NN/fragment 8.12/CD/8.12. algorithm/NN/algorithm preorder/NN/preorder /:/( t/NN/t /,/, p/NN/p /:/) /:/: perform/NN/perform the/DT/the visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p for/IN/for each/DT/each child/NN/child c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) do/VBP/do preorder/JJR/preorder /:/( t/NN/t /,/, c/NN/c /:/) /:/{ recursively/RB/recursively traverse/VBP/traverse the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at c/NN/c /:/} code/NN/code fragment/NN/fragment 8.12/CD/8.12 /:/: algorithm/NN/algorithm preorder/NN/preorder for/IN/for performing/VBG/performing the/DT/the preorder/NN/preorder traversal/NN/traversal of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a tree/NN/tree t/NNP/t. figure/NN/figure 8.15/CD/8.15 portrays/NNS/portrays the/DT/the order/NN/order in/IN/in which/WDT/which positions/NNS/positions of/IN/of a/DT/a sample/NN/sample tree/NN/tree are/VBP/are visited/VBN/visited during/IN/during an/DT/an application/NN/application of/IN/of the/DT/the preorder/NN/preorder traversal/NN/traversal algorithm/NNP/algorithm. paper/NN/paper title/NN/title abstract/NN/abstract 1/CD/1 2/CD/2 3/CD/3 references/NNS/references 1.1/CD/1.1 1.2/CD/1.2 2.1/CD/2.1 2.2/CD/2.2 2.3/CD/2.3 3.1/CD/3.1 3.2/CD/3.2 figure/NN/figure 8.15/CD/8.15 /:/: preorder/NN/preorder traversal/NN/traversal of/IN/of an/DT/an ordered/VBN/ordered tree/NN/tree /,/, where/WRB/where the/DT/the children/NNS/children of/IN/of each/DT/each position/NN/position are/VBP/are ordered/VBN/ordered from/IN/from left/VBN/left to/TO/to right/NNP/right. 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms postorder/NN/postorder traversal/NN/traversal another/DT/another important/JJ/important tree/NN/tree traversal/NN/traversal algorithm/NN/algorithm is/VBZ/is the/DT/the postorder/NN/postorder traversal/NNP/traversal. in/IN/in some/DT/some sense/NN/sense /,/, this/DT/this algorithm/NN/algorithm can/MD/can be/VB/be viewed/VBN/viewed as/IN/as the/DT/the opposite/JJ/opposite of/IN/of the/DT/the preorder/NN/preorder traversal/NN/traversal /,/, because/IN/because it/PRP/it recursively/RB/recursively traverses/VBZ/traverses the/DT/the subtrees/NNS/subtrees rooted/VBD/rooted at/IN/at the/DT/the children/NNS/children of/IN/of the/DT/the root/NN/root first/RB/first /,/, and/CC/and then/RB/then visits/VBZ/visits the/DT/the root/NN/root /:/( hence/NN/hence /,/, the/DT/the name/NN/name postorder/NN/postorder /:/) /./. pseudo-code/JJ/pseudo-code for/IN/for the/DT/the postorder/NN/postorder traversal/NN/traversal is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.13/CD/8.13 /,/, and/CC/and an/DT/an example/NN/example of/IN/of a/DT/a postorder/NN/postorder traversal/NN/traversal is/VBZ/is portrayed/VBN/portrayed in/IN/in figure/NN/figure 8.16/CD/8.16. algorithm/NN/algorithm postorder/NN/postorder /:/( t/NN/t /,/, p/NN/p /:/) /:/: for/IN/for each/DT/each child/NN/child c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) do/VBP/do postorder/JJR/postorder /:/( t/NN/t /,/, c/NN/c /:/) /:/{ recursively/RB/recursively traverse/VBP/traverse the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at c/NN/c /:/} perform/NN/perform the/DT/the visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p code/NN/code fragment/NN/fragment 8.13/CD/8.13 /:/: algorithm/NN/algorithm postorder/NN/postorder for/IN/for performing/VBG/performing the/DT/the postorder/NN/postorder traversal/NN/traversal of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a tree/NN/tree t/NNP/t. paper/NN/paper title/NN/title abstract/NN/abstract 1/CD/1 2/CD/2 3/CD/3 references/NNS/references 1.1/CD/1.1 1.2/CD/1.2 2.1/CD/2.1 2.2/CD/2.2 2.3/CD/2.3 3.1/CD/3.1 3.2/CD/3.2 figure/NN/figure 8.16/CD/8.16 /:/: postorder/NN/postorder traversal/NN/traversal of/IN/of the/DT/the ordered/VBN/ordered tree/NN/tree of/IN/of figure/NN/figure 8.15/CD/8.15. running-time/JJ/running-time analysis/NN/analysis both/DT/both preorder/NN/preorder and/CC/and postorder/NN/postorder traversal/NN/traversal algorithms/NNS/algorithms are/VBP/are efficient/JJ/efficient ways/NNS/ways to/TO/to access/NN/access all/DT/all the/DT/the positions/NNS/positions of/IN/of a/DT/a tree/NNP/tree. the/DT/the analysis/NN/analysis of/IN/of either/DT/either of/IN/of these/DT/these traversal/NN/traversal algorithms/NNS/algorithms is/VBZ/is similar/JJ/similar to/TO/to that/DT/that of/IN/of algorithm/NN/algorithm height2/NNP/height2 /,/, given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.5/CD/8.5 of/IN/of section/NN/section 8.1.3/CD/8.1.3. at/IN/at each/DT/each position/NN/position p/NN/p /,/, the/DT/the nonrecursive/JJ/nonrecursive part/NN/part of/IN/of the/DT/the traversal/NN/traversal algorithm/NN/algorithm requires/VBZ/requires time/NN/time o/NN/o /:/( cp/NN/cp +/:/+ 1/CD/1 /CD/) /,/, where/WRB/where cp/NN/cp is/VBZ/is the/DT/the number/NN/number of/IN/of children/NNS/children of/IN/of p/NN/p /,/, under/IN/under the/DT/the assumption/NN/assumption that/IN/that the/DT/the visit/NN/visit itself/PRP/itself takes/VBZ/takes o/RB/o /:/( 1/CD/1 /CD/) time/NNP/time. by/IN/by proposition/NN/proposition 8.5/CD/8.5 /,/, the/DT/the overall/JJ/overall running/NN/running time/NN/time for/IN/for the/DT/the traversal/NN/traversal of/IN/of tree/NN/tree t/NN/t is/VBZ/is o/RB/o /:/( n/NN/n /:/) /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of positions/NNS/positions in/IN/in the/DT/the tree/NNP/tree. this/DT/this running/NN/running time/NN/time is/VBZ/is asymptotically/RB/asymptotically optimal/JJ/optimal since/IN/since the/DT/the traversal/NN/traversal must/MD/must visit/VB/visit all/DT/all the/DT/the n/NN/n positions/NNS/positions of/IN/of the/DT/the tree/NNP/tree. 330/CD/330 chapter/NN/chapter 8/CD/8. trees/NNS/trees 8.4.2/CD/8.4.2 breadth-first/JJ/breadth-first tree/NN/tree traversal/NN/traversal although/IN/although the/DT/the preorder/NN/preorder and/CC/and postorder/NN/postorder traversals/NNS/traversals are/VBP/are common/JJ/common ways/NNS/ways of/IN/of visiting/VBG/visiting the/DT/the positions/NNS/positions of/IN/of a/DT/a tree/NN/tree /,/, another/DT/another common/JJ/common approach/NN/approach is/VBZ/is to/TO/to traverse/VB/traverse a/DT/a tree/NN/tree so/IN/so that/IN/that we/PRP/we visit/VBP/visit all/DT/all the/DT/the positions/NNS/positions at/IN/at depth/NN/depth d/NN/d before/IN/before we/PRP/we visit/VBP/visit the/DT/the positions/NNS/positions at/IN/at depth/NN/depth d/NN/d +/:/+ 1/CD/1. such/JJ/such an/DT/an algorithm/NN/algorithm is/VBZ/is known/VBN/known as/IN/as a/DT/a breadth-first/JJ/breadth-first traversal/NNP/traversal. a/DT/a breadth-first/JJ/breadth-first traversal/NN/traversal is/VBZ/is a/DT/a common/JJ/common approach/NN/approach used/VBN/used in/IN/in software/NN/software for/IN/for playing/NN/playing games/NNP/games. a/DT/a game/NN/game tree/NN/tree represents/VBZ/represents the/DT/the possible/JJ/possible choices/NNS/choices of/IN/of moves/NNS/moves that/WDT/that might/MD/might be/VB/be made/VBN/made by/IN/by a/DT/a player/NN/player /:/( or/CC/or computer/NN/computer /:/) during/IN/during a/DT/a game/NN/game /,/, with/IN/with the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree being/VBG/being the/DT/the initial/JJ/initial configuration/NN/configuration for/IN/for the/DT/the game/NNP/game. for/IN/for example/NN/example /,/, figure/NN/figure 8.17/CD/8.17 displays/NNS/displays a/DT/a partial/JJ/partial game/NN/game tree/NN/tree for/IN/for tic-tac-toe/NNP/tic-tac-toe. figure/NN/figure 8.17/CD/8.17 /:/: partial/JJ/partial game/NN/game tree/NN/tree for/IN/for tic-tac-toe/JJ/tic-tac-toe /,/, with/IN/with annotations/NNS/annotations displaying/VBG/displaying the/DT/the order/NN/order in/IN/in which/WDT/which positions/NNS/positions are/VBP/are visited/VBN/visited in/IN/in a/DT/a breadth-first/JJ/breadth-first traversal/NNP/traversal. a/DT/a breadth-first/JJ/breadth-first traversal/NN/traversal of/IN/of such/JJ/such a/DT/a game/NN/game tree/NN/tree is/VBZ/is often/RB/often performed/VBN/performed because/IN/because a/DT/a computer/NN/computer may/MD/may be/VB/be unable/JJ/unable to/TO/to explore/VB/explore a/DT/a complete/JJ/complete game/NN/game tree/NN/tree in/IN/in a/DT/a limited/JJ/limited amount/NN/amount of/IN/of time/NNP/time. so/RB/so the/DT/the computer/NN/computer will/MD/will consider/VB/consider all/DT/all moves/NNS/moves /,/, then/RB/then responses/VBZ/responses to/TO/to those/DT/those moves/NNS/moves /,/, going/VBG/going as/IN/as deep/NN/deep as/IN/as computational/JJ/computational time/NN/time allows/NNP/allows. pseudo-code/NNP/pseudo-code for/IN/for a/DT/a breadth-first/JJ/breadth-first traversal/NN/traversal is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.14/CD/8.14. the/DT/the process/NN/process is/VBZ/is not/RB/not recursive/JJ/recursive /,/, since/IN/since we/PRP/we are/VBP/are not/RB/not traversing/VBG/traversing entire/JJ/entire subtrees/NNS/subtrees at/IN/at once/NNP/once. we/PRP/we use/VBP/use a/DT/a queue/NN/queue to/TO/to produce/VB/produce a/DT/a fifo/NN/fifo /:/( i.e/NNP/i.e. /,/, first-in/NNP/first-in first-out/NNP/first-out /NNP/) semantics/NNS/semantics for/IN/for the/DT/the order/NN/order in/IN/in which/WDT/which we/PRP/we visit/VBP/visit nodes/NNP/nodes. the/DT/the overall/JJ/overall running/NN/running time/NN/time is/VBZ/is o/RB/o /:/( n/NN/n /:/) /,/, due/JJ/due to/TO/to the/DT/the n/NN/n calls/VBZ/calls to/TO/to enqueue/VB/enqueue and/CC/and n/VB/n calls/NNS/calls to/TO/to dequeue/NNP/dequeue. algorithm/NN/algorithm breadthfirst/NN/breadthfirst /:/( t/NN/t /:/) /:/: initialize/NN/initialize queue/NN/queue q/NN/q to/TO/to contain/VB/contain t.root/JJ/t.root /NN/( /:/) while/IN/while q/NN/q not/RB/not empty/JJ/empty do/VBP/do p/NN/p =/:/= q.dequeue/JJ/q.dequeue /NN/( /:/) /:/{ p/NN/p is/VBZ/is the/DT/the oldest/JJS/oldest entry/NN/entry in/IN/in the/DT/the queue/NN/queue /:/} perform/NN/perform the/DT/the visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p for/IN/for each/DT/each child/NN/child c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) do/VBP/do q.enqueue/JJ/q.enqueue /NN/( c/NN/c /:/) /:/{ add/NN/add p/NN/p s/NNS/s children/NNS/children to/TO/to the/DT/the end/NN/end of/IN/of the/DT/the queue/NN/queue for/IN/for later/JJ/later visits/NNS/visits /:/} code/NN/code fragment/NN/fragment 8.14/CD/8.14 /:/: algorithm/NN/algorithm for/IN/for performing/VBG/performing a/DT/a breadth-first/JJ/breadth-first traversal/NN/traversal of/IN/of a/DT/a tree/NNP/tree. 8.4/NNP/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 331/CD/331 8.4.3/CD/8.4.3 inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary tree/NN/tree the/DT/the standard/JJ/standard preorder/NN/preorder /,/, postorder/NN/postorder /,/, and/CC/and breadth-first/JJ/breadth-first traversals/NNS/traversals that/WDT/that were/VBD/were introduced/VBN/introduced for/IN/for general/JJ/general trees/NNS/trees /,/, can/MD/can be/VB/be directly/RB/directly applied/VBN/applied to/TO/to binary/JJ/binary trees/NNP/trees. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we introduce/VBP/introduce another/DT/another common/JJ/common traversal/NN/traversal algorithm/NN/algorithm specifically/RB/specifically for/IN/for a/DT/a binary/JJ/binary tree/NNP/tree. during/IN/during an/DT/an inorder/NN/inorder traversal/NN/traversal /,/, we/PRP/we visit/VBP/visit a/DT/a position/NN/position between/IN/between the/DT/the recursive/JJ/recursive traversals/NNS/traversals of/IN/of its/PRP$/its left/VBN/left and/CC/and right/RB/right subtrees/NNP/subtrees. the/DT/the inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary tree/NN/tree t/NN/t can/MD/can be/VB/be informally/RB/informally viewed/VBN/viewed as/IN/as visiting/NN/visiting the/DT/the nodes/NNS/nodes of/IN/of t/NN/t from/IN/from left/VBN/left to/TO/to right/NNP/right. indeed/RB/indeed /,/, for/IN/for every/DT/every position/NN/position p/NN/p /,/, the/DT/the inorder/NN/inorder traversal/NN/traversal visits/NNS/visits p/VBP/p after/IN/after all/DT/all the/DT/the positions/NNS/positions in/IN/in the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NN/p and/CC/and before/IN/before all/DT/all the/DT/the positions/NNS/positions in/IN/in the/DT/the right/NN/right subtree/NN/subtree of/IN/of p/NNP/p. pseudo-code/NNP/pseudo-code for/IN/for the/DT/the inorder/NN/inorder traversal/NN/traversal algorithm/NN/algorithm is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.15/CD/8.15 /,/, and/CC/and an/DT/an example/NN/example of/IN/of an/DT/an inorder/NN/inorder traversal/NN/traversal is/VBZ/is portrayed/VBN/portrayed in/IN/in figure/NN/figure 8.18/CD/8.18. algorithm/NN/algorithm inorder/NN/inorder /:/( p/NN/p /:/) /:/: if/IN/if p/NN/p has/VBZ/has a/DT/a left/VBN/left child/NN/child lc/NN/lc then/RB/then inorder/JJR/inorder /NN/( lc/NN/lc /:/) /:/{ recursively/RB/recursively traverse/VBP/traverse the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NN/p /:/} perform/NN/perform the/DT/the visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p if/IN/if p/NN/p has/VBZ/has a/DT/a right/NN/right child/NN/child rc/NN/rc then/RB/then inorder/JJR/inorder /NN/( rc/NN/rc /:/) /:/{ recursively/RB/recursively traverse/VBP/traverse the/DT/the right/NN/right subtree/NN/subtree of/IN/of p/NN/p /:/} code/NN/code fragment/NN/fragment 8.15/CD/8.15 /:/: algorithm/NN/algorithm inorder/NN/inorder for/IN/for performing/VBG/performing an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. 3/CD/3 1/CD/1 9/CD/9 5/CD/5 7/CD/7 4/CD/4 3/CD/3 2/CD/2 3/CD/3 6/CD/6 figure/NN/figure 8.18/CD/8.18 /:/: inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. the/DT/the inorder/NN/inorder traversal/NN/traversal algorithm/NN/algorithm has/VBZ/has several/JJ/several important/JJ/important applications/NNP/applications. when/WRB/when using/VBG/using a/DT/a binary/JJ/binary tree/NN/tree to/TO/to represent/VB/represent an/DT/an arithmetic/JJ/arithmetic expression/NN/expression /,/, as/IN/as in/IN/in figure/NN/figure 8.18/CD/8.18 /,/, the/DT/the inorder/NN/inorder traversal/NN/traversal visits/NNS/visits positions/NNS/positions in/IN/in a/DT/a consistent/NN/consistent order/NN/order with/IN/with the/DT/the standard/JJ/standard representation/NN/representation of/IN/of the/DT/the expression/NN/expression /,/, as/IN/as in/IN/in 3/CD/3 +/CD/+ 1/CD/1 3/9/CD/3/9 5/CD/5 +/CD/+ 2/CD/2. /./. /./. /:/( albeit/NN/albeit without/IN/without parentheses/NNS/parentheses /:/) /./. 332/CD/332 chapter/NN/chapter 8/CD/8. trees/NNS/trees binary/JJ/binary search/NN/search trees/NNS/trees an/DT/an important/JJ/important application/NN/application of/IN/of the/DT/the inorder/NN/inorder traversal/NN/traversal algorithm/NN/algorithm arises/NNS/arises when/WRB/when we/PRP/we store/VBP/store an/DT/an ordered/VBN/ordered sequence/NN/sequence of/IN/of elements/NNS/elements in/IN/in a/DT/a binary/JJ/binary tree/NN/tree /,/, defining/VBG/defining a/DT/a structure/NN/structure we/PRP/we call/VBP/call a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. let/NN/let s/VBZ/s be/VB/be a/DT/a set/NN/set whose/WP$/whose unique/NN/unique elements/NNS/elements have/VBP/have an/DT/an order/NN/order relation/NNP/relation. for/IN/for example/NN/example /,/, s/VBZ/s could/MD/could be/VB/be a/DT/a set/NN/set of/IN/of integers/NNP/integers. a/DT/a binary/JJ/binary search/NN/search tree/NN/tree for/IN/for s/NNS/s is/VBZ/is a/DT/a binary/JJ/binary tree/NN/tree t/NN/t such/JJ/such that/IN/that /,/, for/IN/for each/DT/each position/NN/position p/NN/p of/IN/of t/NN/t /:/: position/NN/position p/NN/p stores/NNS/stores an/DT/an element/NN/element of/IN/of s/NNS/s /,/, denoted/VBD/denoted as/IN/as e/NN/e /:/( p/NN/p /:/) /./. elements/NNS/elements stored/VBD/stored in/IN/in the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NN/p /:/( if/IN/if any/DT/any /NN/) are/VBP/are less/RBR/less than/IN/than e/NN/e /:/( p/NN/p /:/) /./. elements/NNS/elements stored/VBD/stored in/IN/in the/DT/the right/NN/right subtree/NN/subtree of/IN/of p/NN/p /:/( if/IN/if any/DT/any /NN/) are/VBP/are greater/JJR/greater than/IN/than e/NN/e /:/( p/NN/p /:/) /./. an/DT/an example/NN/example of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 8.19/CD/8.19. the/DT/the above/JJ/above properties/NNS/properties assure/VBP/assure that/IN/that an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t visits/NNS/visits the/DT/the elements/NNS/elements in/IN/in nondecreasing/VBG/nondecreasing order/NNP/order. 36/CD/36 25/CD/25 31/CD/31 42/CD/42 12/CD/12 62/CD/62 75/CD/75 58/CD/58 90/CD/90 figure/NN/figure 8.19/CD/8.19 /:/: a/DT/a binary/JJ/binary search/NN/search tree/NN/tree storing/VBG/storing integers/NNP/integers. the/DT/the solid/JJ/solid path/NN/path is/VBZ/is traversed/VBN/traversed when/WRB/when searching/VBG/searching /:/( successfully/RB/successfully /:/) for/IN/for 36/CD/36. the/DT/the dashed/JJ/dashed path/NN/path is/VBZ/is traversed/VBN/traversed when/WRB/when searching/VBG/searching /:/( unsuccessfully/RB/unsuccessfully /:/) for/IN/for 70/CD/70. we/PRP/we can/MD/can use/VB/use a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t for/IN/for set/NN/set s/NNS/s to/TO/to find/VB/find whether/IN/whether a/DT/a given/VBN/given search/NN/search value/NN/value v/NN/v is/VBZ/is in/IN/in s/NNS/s /,/, by/IN/by traversing/NN/traversing a/DT/a path/NN/path down/IN/down the/DT/the tree/NN/tree t/NN/t /,/, starting/VBG/starting at/IN/at the/DT/the root/NNP/root. at/IN/at each/DT/each internal/JJ/internal position/NN/position p/NN/p encountered/VBD/encountered /,/, we/PRP/we compare/VBP/compare our/PRP$/our search/NN/search value/NN/value v/NN/v with/IN/with the/DT/the element/NN/element e/NN/e /:/( p/NN/p /:/) stored/VBD/stored at/IN/at p/NNP/p. if/IN/if v/NN/v </:/< e/NN/e /:/( p/NN/p /:/) /,/, then/RB/then the/DT/the search/NN/search continues/VBZ/continues in/IN/in the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NNP/p. if/IN/if v/NN/v =/:/= e/NN/e /:/( p/NN/p /:/) /,/, then/RB/then the/DT/the search/NN/search terminates/VBZ/terminates successfully/NNP/successfully. if/IN/if v/NN/v >/:/> e/NN/e /:/( p/NN/p /:/) /,/, then/RB/then the/DT/the search/NN/search continues/VBZ/continues in/IN/in the/DT/the right/NN/right subtree/NN/subtree of/IN/of p/NNP/p. finally/RB/finally /,/, if/IN/if we/PRP/we reach/VBP/reach an/DT/an empty/NN/empty subtree/NN/subtree /,/, the/DT/the search/NN/search terminates/VBZ/terminates unsuccessfully/NNP/unsuccessfully. in/IN/in other/JJ/other words/NNS/words /,/, a/DT/a binary/JJ/binary search/NN/search tree/NN/tree can/MD/can be/VB/be viewed/VBN/viewed as/IN/as a/DT/a binary/JJ/binary decision/NN/decision tree/NN/tree /:/( recall/NN/recall example/NN/example 8.6/CD/8.6 /CD/) /,/, where/WRB/where the/DT/the question/NN/question asked/VBD/asked at/IN/at each/DT/each internal/JJ/internal node/NN/node is/VBZ/is whether/IN/whether the/DT/the element/NN/element at/IN/at that/DT/that node/NN/node is/VBZ/is less/JJR/less than/IN/than /,/, equal/JJ/equal to/TO/to /,/, or/CC/or larger/JJR/larger than/IN/than the/DT/the element/NN/element being/VBG/being searched/VBN/searched for/NNP/for. we/PRP/we illustrate/VBP/illustrate several/JJ/several examples/NNS/examples of/IN/of the/DT/the search/NN/search operation/NN/operation in/IN/in figure/NN/figure 8.19/CD/8.19. note/NN/note that/IN/that the/DT/the running/VBG/running time/NN/time of/IN/of searching/VBG/searching in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t is/VBZ/is proportional/JJ/proportional to/TO/to the/DT/the height/NN/height of/IN/of t/NNP/t. recall/NN/recall from/IN/from proposition/NN/proposition 8.8/CD/8.8 that/WDT/that the/DT/the height/NN/height of/IN/of a/DT/a binary/JJ/binary tree/NN/tree with/IN/with n/NN/n nodes/NNS/nodes can/MD/can be/VB/be as/RB/as small/JJ/small as/IN/as log/JJ/log /NN/( n/NN/n +/:/+ 1/CD/1 /CD/) 1/CD/1 or/CC/or as/IN/as large/JJ/large as/IN/as n/NN/n 1/CD/1. thus/RB/thus /,/, binary/JJ/binary search/NN/search trees/NNS/trees are/VBP/are most/JJS/most efficient/JJ/efficient when/WRB/when they/PRP/they have/VBP/have small/JJ/small height/NNP/height. chapter/NN/chapter 11/CD/11 is/VBZ/is devoted/VBN/devoted to/TO/to the/DT/the study/NN/study of/IN/of search/NN/search trees/NNP/trees. 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 333/CD/333 8.4.4/CD/8.4.4 implementing/VBG/implementing tree/NN/tree traversals/NNS/traversals in/IN/in python/NN/python when/WRB/when first/JJ/first defining/NN/defining the/DT/the tree/NN/tree adt/NN/adt in/IN/in section/NN/section 8.1.2/CD/8.1.2 /,/, we/PRP/we stated/VBD/stated that/IN/that tree/NN/tree t/NN/t should/MD/should include/VB/include support/NN/support for/IN/for the/DT/the following/VBG/following methods/NNS/methods /:/: t.positions/NNS/t.positions /VBP/( /:/) /:/: generate/JJ/generate an/DT/an iteration/NN/iteration of/IN/of all/DT/all positions/NNS/positions of/IN/of tree/NN/tree t/NNP/t. iter/NN/iter /:/( t/NN/t /:/) /:/: generate/JJ/generate an/DT/an iteration/NN/iteration of/IN/of all/DT/all elements/NNS/elements stored/VBD/stored within/IN/within tree/NN/tree t/NNP/t. at/IN/at that/DT/that time/NN/time /,/, we/PRP/we did/VBD/did not/RB/not make/VB/make any/DT/any assumption/NN/assumption about/IN/about the/DT/the order/NN/order in/IN/in which/WDT/which these/DT/these iterations/NNS/iterations report/NN/report their/PRP$/their results/NNP/results. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we demonstrate/VBP/demonstrate how/WRB/how any/DT/any of/IN/of the/DT/the tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms we/PRP/we have/VBP/have introduced/VBN/introduced could/MD/could be/VB/be used/VBN/used to/TO/to produce/VB/produce these/DT/these iterations/NNP/iterations. to/TO/to begin/VB/begin /,/, we/PRP/we note/VBP/note that/IN/that it/PRP/it is/VBZ/is easy/JJ/easy to/TO/to produce/VB/produce an/DT/an iteration/NN/iteration of/IN/of all/DT/all elements/NNS/elements of/IN/of a/DT/a tree/NN/tree /,/, if/IN/if we/PRP/we rely/RB/rely on/IN/on a/DT/a presumed/VBN/presumed iteration/NN/iteration of/IN/of all/DT/all positions/NNP/positions. therefore/NN/therefore /,/, support/NN/support for/IN/for the/DT/the iter/NN/iter /:/( t/NN/t /:/) syntax/NN/syntax can/MD/can be/VB/be formally/RB/formally provided/VBN/provided by/IN/by a/DT/a concrete/JJ/concrete implementation/NN/implementation of/IN/of the/DT/the special/JJ/special method/NN/method iter/NN/iter within/IN/within the/DT/the abstract/NN/abstract base/NN/base class/NN/class tree/NNP/tree. we/PRP/we rely/RB/rely on/IN/on python/NN/python s/NNS/s generator/NN/generator syntax/NN/syntax as/IN/as the/DT/the mechanism/NN/mechanism for/IN/for producing/VBG/producing iterations/NNP/iterations. /NNP/( see/VB/see section/NN/section 1.8/CD/1.8. /CD/) our/PRP$/our implementation/NN/implementation of/IN/of tree/NNP/tree. iter/NN/iter is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.16/CD/8.16. 75/CD/75 def/NN/def iter/NN/iter /:/( self/NN/self /:/) /:/: 76/CD/76 generate/NN/generate an/DT/an iteration/NN/iteration of/IN/of the/DT/the tree/NN/tree s/VBZ/s elements/NNP/elements. 77/CD/77 for/IN/for p/NN/p in/IN/in self.positions/NNS/self.positions /:/( /:/) /:/: #/#/# use/NN/use same/NN/same order/NN/order as/IN/as positions/NNS/positions /:/( /:/) 78/CD/78 yield/NN/yield p.element/JJ/p.element /NN/( /:/) #/#/# but/CC/but yield/NN/yield each/DT/each element/NN/element code/NN/code fragment/NN/fragment 8.16/CD/8.16 /:/: iterating/VBG/iterating all/DT/all elements/NNS/elements of/IN/of a/DT/a tree/NN/tree instance/NN/instance /,/, based/VBN/based upon/IN/upon an/DT/an iteration/NN/iteration of/IN/of the/DT/the positions/NNS/positions of/IN/of the/DT/the tree/NNP/tree. this/DT/this code/NN/code should/MD/should be/VB/be included/VBN/included in/IN/in the/DT/the body/NN/body of/IN/of the/DT/the tree/NN/tree class/NNP/class. to/TO/to implement/VB/implement the/DT/the positions/NNS/positions method/VBD/method /,/, we/PRP/we have/VBP/have a/DT/a choice/NN/choice of/IN/of tree/NN/tree traversal/NN/traversal algorithms/NNP/algorithms. given/NN/given that/WDT/that there/EX/there are/VBP/are advantages/NNS/advantages to/TO/to each/DT/each of/IN/of those/DT/those traversal/NN/traversal orders/NNS/orders /,/, we/PRP/we will/MD/will provide/VB/provide independent/JJ/independent implementations/NNS/implementations of/IN/of each/DT/each strategy/NN/strategy that/IN/that can/MD/can be/VB/be called/VBN/called directly/RB/directly by/IN/by a/DT/a user/NN/user of/IN/of our/PRP$/our class/NNP/class. we/PRP/we can/MD/can then/RB/then trivially/RB/trivially adapt/VBD/adapt one/CD/one of/IN/of those/DT/those as/IN/as a/DT/a default/NN/default order/NN/order for/IN/for the/DT/the positions/NNS/positions method/VBD/method of/IN/of the/DT/the tree/NN/tree adt/NNP/adt. preorder/NN/preorder traversal/NN/traversal we/PRP/we begin/VBP/begin by/IN/by considering/VBG/considering the/DT/the preorder/NN/preorder traversal/NN/traversal algorithm/NNP/algorithm. we/PRP/we will/MD/will support/VB/support a/DT/a public/JJ/public method/NN/method with/IN/with calling/VBG/calling signature/NN/signature t.preorder/NN/t.preorder /:/( /:/) for/IN/for tree/NN/tree t/NN/t /,/, which/WDT/which generates/VBZ/generates a/DT/a preorder/NN/preorder iteration/NN/iteration of/IN/of all/DT/all positions/NNS/positions within/IN/within the/DT/the tree/NNP/tree. however/RB/however /,/, the/DT/the recursive/JJ/recursive algorithm/NN/algorithm for/IN/for generating/NN/generating a/DT/a preorder/NN/preorder traversal/NN/traversal /,/, as/IN/as originally/RB/originally described/VBN/described in/IN/in code/NN/code fragment/NN/fragment 8.12/CD/8.12 /,/, must/MD/must be/VB/be parameterized/VBN/parameterized by/IN/by a/DT/a specific/JJ/specific position/NN/position within/IN/within the/DT/the tree/NN/tree that/IN/that serves/NNS/serves as/IN/as the/DT/the root/NN/root of/IN/of a/DT/a subtree/JJ/subtree to/TO/to traverse/NNP/traverse. a/DT/a standard/JJ/standard solution/NN/solution for/IN/for such/JJ/such a/DT/a circumstance/NN/circumstance is/VBZ/is to/TO/to define/VB/define a/DT/a nonpublic/JJ/nonpublic utility/NN/utility method/NN/method with/IN/with the/DT/the desired/VBN/desired recursive/JJ/recursive parameterization/NN/parameterization /,/, and/CC/and then/RB/then to/TO/to have/VB/have the/DT/the public/NN/public method/NN/method preorder/NN/preorder invoke/NN/invoke the/DT/the nonpublic/JJ/nonpublic method/NN/method upon/IN/upon the/DT/the root/NN/root of/IN/of the/DT/the tree/NNP/tree. our/PRP$/our implementation/NN/implementation of/IN/of such/JJ/such a/DT/a design/NN/design is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.17/CD/8.17. 334/CD/334 chapter/NN/chapter 8/CD/8. trees/NNS/trees 79/CD/79 def/NN/def preorder/NN/preorder /:/( self/NN/self /:/) /:/: 80/CD/80 generate/NN/generate a/DT/a preorder/NN/preorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in the/DT/the tree/NNP/tree. 81/CD/81 if/IN/if not/RB/not self.is/JJ/self.is empty/NN/empty /:/( /:/) /:/: 82/CD/82 for/IN/for p/NN/p in/IN/in self/NNP/self. subtree/NN/subtree preorder/NN/preorder /:/( self.root/JJ/self.root /NN/( /:/) /:/) /:/: #/#/# start/NN/start recursion/NN/recursion 83/CD/83 yield/NN/yield p/NN/p 84/CD/84 85/CD/85 def/NN/def subtree/NN/subtree preorder/NN/preorder /:/( self/NN/self /,/, p/NN/p /:/) /:/: 86/CD/86 generate/NN/generate a/DT/a preorder/NN/preorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in subtree/JJ/subtree rooted/VBN/rooted at/IN/at p/NNP/p. 87/CD/87 yield/NN/yield p/NN/p #/#/# visit/NN/visit p/NN/p before/IN/before its/PRP$/its subtrees/NNS/subtrees 88/CD/88 for/IN/for c/NN/c in/IN/in self.children/JJ/self.children /NN/( p/NN/p /:/) /:/: #/#/# for/IN/for each/DT/each child/NN/child c/NN/c 89/CD/89 for/IN/for other/JJ/other in/IN/in self/NNP/self. subtree/NN/subtree preorder/NN/preorder /:/( c/NN/c /:/) /:/: #/#/# do/VBP/do preorder/NN/preorder of/IN/of c/NN/c s/NNS/s subtree/VBP/subtree 90/CD/90 yield/NN/yield other/JJ/other #/#/# yielding/NN/yielding each/DT/each to/TO/to our/PRP$/our caller/NN/caller code/NN/code fragment/NN/fragment 8.17/CD/8.17 /:/: support/NN/support for/IN/for performing/VBG/performing a/DT/a preorder/NN/preorder traversal/NN/traversal of/IN/of a/DT/a tree/NNP/tree. this/DT/this code/NN/code should/MD/should be/VB/be included/VBN/included in/IN/in the/DT/the body/NN/body of/IN/of the/DT/the tree/NN/tree class/NNP/class. formally/RB/formally /,/, both/DT/both preorder/NN/preorder and/CC/and the/DT/the utility/NN/utility subtree/NN/subtree preorder/NN/preorder are/VBP/are generators/NNP/generators. rather/RB/rather than/IN/than perform/NN/perform a/DT/a visit/NN/visit action/NN/action from/IN/from within/IN/within this/DT/this code/NN/code /,/, we/PRP/we yield/VBD/yield each/DT/each position/NN/position to/TO/to the/DT/the caller/NN/caller and/CC/and let/VB/let the/DT/the caller/NN/caller decide/NN/decide what/WP/what action/NN/action to/TO/to perform/VB/perform at/IN/at that/DT/that position/NNP/position. the/DT/the subtree/NN/subtree preorder/NN/preorder method/NN/method is/VBZ/is the/DT/the recursive/JJ/recursive one/NNP/one. however/RB/however /,/, because/IN/because we/PRP/we are/VBP/are relying/VBG/relying on/IN/on generators/NNS/generators rather/RB/rather than/IN/than traditional/JJ/traditional functions/NNS/functions /,/, the/DT/the recursion/NN/recursion has/VBZ/has a/DT/a slightly/RB/slightly different/JJ/different form/NNP/form. in/IN/in order/NN/order to/TO/to yield/VB/yield all/DT/all positions/NNS/positions within/IN/within the/DT/the subtree/NN/subtree of/IN/of child/NN/child c/NN/c /,/, we/PRP/we loop/VBP/loop over/IN/over the/DT/the positions/NNS/positions yielded/VBD/yielded by/IN/by the/DT/the recursive/JJ/recursive call/NN/call self/NNP/self. subtree/NN/subtree preorder/NN/preorder /:/( c/NN/c /:/) /,/, and/CC/and reyield/VBD/reyield each/DT/each position/NN/position in/IN/in the/DT/the outer/NN/outer context/NNP/context. note/NN/note that/IN/that if/IN/if p/NN/p is/VBZ/is a/DT/a leaf/NN/leaf /,/, the/DT/the for/IN/for loop/NN/loop over/IN/over self.children/JJ/self.children /NN/( p/NN/p /:/) is/VBZ/is trivial/JJ/trivial /NN/( this/DT/this is/VBZ/is the/DT/the base/NN/base case/NN/case for/IN/for our/PRP$/our recursion/NN/recursion /:/) /./. we/PRP/we rely/RB/rely on/IN/on a/DT/a similar/JJ/similar technique/NN/technique in/IN/in the/DT/the public/NN/public preorder/NN/preorder method/NN/method to/TO/to re-yield/JJ/re-yield all/DT/all positions/NNS/positions that/WDT/that are/VBP/are generated/VBN/generated by/IN/by the/DT/the recursive/JJ/recursive process/NN/process starting/VBG/starting at/IN/at the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree ;/:/; if/IN/if the/DT/the tree/NN/tree is/VBZ/is empty/JJ/empty /,/, nothing/NN/nothing is/VBZ/is yielded/NNP/yielded. at/IN/at this/DT/this point/NN/point /,/, we/PRP/we have/VBP/have provided/VBN/provided full/JJ/full support/NN/support for/IN/for the/DT/the preorder/NN/preorder generator/NNP/generator. a/DT/a user/NN/user of/IN/of the/DT/the class/NN/class can/MD/can therefore/VB/therefore write/JJ/write code/NN/code such/JJ/such as/IN/as for/IN/for p/NN/p in/IN/in t.preorder/JJ/t.preorder /NN/( /:/) /:/: #/#/# visit/NN/visit position/NN/position p/NN/p the/DT/the official/NN/official tree/NN/tree adt/NN/adt requires/VBZ/requires that/IN/that all/DT/all trees/NNS/trees support/NN/support a/DT/a positions/NNS/positions method/NN/method as/IN/as well/NNP/well. to/TO/to use/VB/use a/DT/a preorder/NN/preorder traversal/NN/traversal as/IN/as the/DT/the default/NN/default order/NN/order of/IN/of iteration/NN/iteration /,/, we/PRP/we include/VBP/include the/DT/the definition/NN/definition shown/NN/shown in/IN/in code/NN/code fragment/NN/fragment 8.18/CD/8.18 within/IN/within our/PRP$/our tree/NN/tree class/NNP/class. rather/RB/rather than/IN/than loop/NN/loop over/IN/over the/DT/the results/NNS/results returned/VBD/returned by/IN/by the/DT/the preorder/NN/preorder call/NN/call /,/, we/PRP/we return/VBP/return the/DT/the entire/JJ/entire iteration/NN/iteration as/IN/as an/DT/an object/NNP/object. 91/CD/91 def/NN/def positions/NNS/positions /:/( self/PRP/self /VBP/) /:/: 92/CD/92 generate/NN/generate an/DT/an iteration/NN/iteration of/IN/of the/DT/the tree/NN/tree s/VBZ/s positions/NNP/positions. 93/CD/93 return/NN/return self.preorder/NN/self.preorder /:/( /:/) #/#/# return/NN/return entire/NN/entire preorder/NN/preorder iteration/NN/iteration code/NN/code fragment/NN/fragment 8.18/CD/8.18 /:/: an/DT/an implementation/NN/implementation of/IN/of the/DT/the positions/NNS/positions method/VBD/method for/IN/for the/DT/the tree/NN/tree class/NN/class that/WDT/that relies/VBZ/relies on/IN/on a/DT/a preorder/NN/preorder traversal/NN/traversal to/TO/to generate/VB/generate the/DT/the results/NNP/results. 8.4/NNP/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 335/CD/335 postorder/NN/postorder traversal/NN/traversal we/PRP/we can/MD/can implement/VB/implement a/DT/a postorder/NN/postorder traversal/NN/traversal using/VBG/using very/RB/very similar/JJ/similar technique/NN/technique as/IN/as with/IN/with a/DT/a preorder/NN/preorder traversal/NNP/traversal. the/DT/the only/JJ/only difference/NN/difference is/VBZ/is that/IN/that within/IN/within the/DT/the recursive/JJ/recursive utility/NN/utility for/IN/for a/DT/a postorder/NN/postorder we/PRP/we wait/VBP/wait to/TO/to yield/VB/yield position/NN/position p/NN/p until/IN/until after/IN/after we/PRP/we have/VBP/have recursively/RB/recursively yield/VBN/yield the/DT/the positions/NNS/positions in/IN/in its/PRP$/its subtrees/NNP/subtrees. an/DT/an implementation/NN/implementation is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.19/CD/8.19. 94/CD/94 def/NN/def postorder/NN/postorder /:/( self/NN/self /:/) /:/: 95/CD/95 generate/NN/generate a/DT/a postorder/NN/postorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in the/DT/the tree/NNP/tree. 96/CD/96 if/IN/if not/RB/not self.is/JJ/self.is empty/NN/empty /:/( /:/) /:/: 97/CD/97 for/IN/for p/NN/p in/IN/in self/NNP/self. subtree/NN/subtree postorder/NN/postorder /:/( self.root/JJ/self.root /NN/( /:/) /:/) /:/: #/#/# start/NN/start recursion/NN/recursion 98/CD/98 yield/NN/yield p/NN/p 99/CD/99 100/CD/100 def/NN/def subtree/NN/subtree postorder/NN/postorder /:/( self/NN/self /,/, p/NN/p /:/) /:/: 101/CD/101 generate/NN/generate a/DT/a postorder/NN/postorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in subtree/JJ/subtree rooted/VBN/rooted at/IN/at p/NNP/p. 102/CD/102 for/IN/for c/NN/c in/IN/in self.children/JJ/self.children /NN/( p/NN/p /:/) /:/: #/#/# for/IN/for each/DT/each child/NN/child c/NN/c 103/CD/103 for/IN/for other/JJ/other in/IN/in self/NNP/self. subtree/NN/subtree postorder/NN/postorder /:/( c/NN/c /:/) /:/: #/#/# do/VBP/do postorder/NN/postorder of/IN/of c/NN/c s/NNS/s subtree/VBP/subtree 104/CD/104 yield/NN/yield other/JJ/other #/#/# yielding/NN/yielding each/DT/each to/TO/to our/PRP$/our caller/NN/caller 105/CD/105 yield/NN/yield p/NN/p #/#/# visit/NN/visit p/NN/p after/IN/after its/PRP$/its subtrees/NNS/subtrees code/VBP/code fragment/NN/fragment 8.19/CD/8.19 /:/: support/NN/support for/IN/for performing/VBG/performing a/DT/a postorder/NN/postorder traversal/NN/traversal of/IN/of a/DT/a tree/NNP/tree. this/DT/this code/NN/code should/MD/should be/VB/be included/VBN/included in/IN/in the/DT/the body/NN/body of/IN/of the/DT/the tree/NN/tree class/NNP/class. breadth-first/NNP/breadth-first traversal/NN/traversal in/IN/in code/NN/code fragment/NN/fragment 8.20/CD/8.20 /,/, we/PRP/we provide/VBP/provide an/DT/an implementation/NN/implementation of/IN/of the/DT/the breadth-first/JJ/breadth-first traversal/NN/traversal algorithm/NN/algorithm in/IN/in the/DT/the context/NN/context of/IN/of our/PRP$/our tree/NN/tree class/NNP/class. recall/NN/recall that/WDT/that the/DT/the breadth-first/JJ/breadth-first traversal/NN/traversal algorithm/NN/algorithm is/VBZ/is not/RB/not recursive/JJ/recursive ;/:/; it/PRP/it relies/VBZ/relies on/IN/on a/DT/a queue/NN/queue of/IN/of positions/NNS/positions to/TO/to manage/VB/manage the/DT/the traversal/NN/traversal process/NNP/process. our/PRP$/our implementation/NN/implementation uses/NNS/uses the/DT/the linkedqueue/NN/linkedqueue class/NN/class from/IN/from section/NN/section 7.1.2/CD/7.1.2 /,/, although/IN/although any/DT/any implementation/NN/implementation of/IN/of the/DT/the queue/NN/queue adt/NN/adt would/MD/would suffice/NNP/suffice. inorder/NN/inorder traversal/NN/traversal for/IN/for binary/JJ/binary trees/NNS/trees the/DT/the preorder/NN/preorder /,/, postorder/NN/postorder /,/, and/CC/and breadth-first/JJ/breadth-first traversal/NN/traversal algorithms/NNS/algorithms are/VBP/are applicable/JJ/applicable to/TO/to all/DT/all trees/NNS/trees /,/, and/CC/and so/RB/so we/PRP/we include/VBP/include their/PRP$/their implementations/NNS/implementations within/IN/within the/DT/the tree/NN/tree abstract/NN/abstract base/NN/base class/NNP/class. those/DT/those methods/NNS/methods are/VBP/are inherited/VBN/inherited by/IN/by the/DT/the abstract/NN/abstract binarytree/NN/binarytree class/NN/class /,/, the/DT/the concrete/JJ/concrete linkedbinarytree/NN/linkedbinarytree class/NN/class /,/, and/CC/and any/DT/any other/JJ/other dependent/NN/dependent tree/NN/tree classes/NNS/classes we/PRP/we might/MD/might develop/NNP/develop. the/DT/the inorder/NN/inorder traversal/NN/traversal algorithm/NN/algorithm /,/, because/IN/because it/PRP/it explicitly/RB/explicitly relies/VBZ/relies on/IN/on the/DT/the notion/NN/notion of/IN/of a/DT/a left/NN/left and/CC/and right/RB/right child/VB/child of/IN/of a/DT/a node/NN/node /,/, only/RB/only applies/VBZ/applies to/TO/to binary/JJ/binary trees/NNP/trees. we/PRP/we therefore/VBP/therefore include/VBP/include its/PRP$/its definition/NN/definition within/IN/within the/DT/the body/NN/body of/IN/of the/DT/the binarytree/JJ/binarytree class/NNP/class. we/PRP/we use/VBP/use a/DT/a similar/JJ/similar technique/NN/technique to/TO/to implement/VB/implement an/DT/an inorder/NN/inorder traversal/NN/traversal /:/( code/NN/code fragment/NN/fragment 8.21/CD/8.21 /CD/) as/IN/as we/PRP/we did/VBD/did with/IN/with preorder/NN/preorder and/CC/and postorder/NN/postorder traversals/NNP/traversals. 336/CD/336 chapter/NN/chapter 8/CD/8. trees/NNS/trees 106/CD/106 def/NN/def breadthfirst/NN/breadthfirst /:/( self/NN/self /:/) /:/: 107/CD/107 generate/NN/generate a/DT/a breadth-first/JJ/breadth-first iteration/NN/iteration of/IN/of the/DT/the positions/NNS/positions of/IN/of the/DT/the tree/NNP/tree. 108/CD/108 if/IN/if not/RB/not self.is/JJ/self.is empty/NN/empty /:/( /:/) /:/: 109/CD/109 fringe/NN/fringe =/:/= linkedqueue/NN/linkedqueue /:/( /:/) #/#/# known/VBN/known positions/NNS/positions not/RB/not yet/RB/yet yielded/VBN/yielded 110/CD/110 fringe.enqueue/JJ/fringe.enqueue /NN/( self.root/NN/self.root /:/( /:/) /:/) #/#/# starting/VBG/starting with/IN/with the/DT/the root/NN/root 111/CD/111 while/IN/while not/RB/not fringe.is/JJ/fringe.is empty/NN/empty /:/( /:/) /:/: 112/CD/112 p/NN/p =/:/= fringe.dequeue/JJ/fringe.dequeue /NN/( /:/) #/#/# remove/NN/remove from/IN/from front/NN/front of/IN/of the/DT/the queue/NN/queue 113/CD/113 yield/NN/yield p/NN/p #/#/# report/NN/report this/DT/this position/NN/position 114/CD/114 for/IN/for c/NN/c in/IN/in self.children/JJ/self.children /NN/( p/NN/p /:/) /:/: 115/CD/115 fringe.enqueue/JJ/fringe.enqueue /NN/( c/NN/c /:/) #/#/# add/NN/add children/NNS/children to/TO/to back/VB/back of/IN/of queue/NN/queue code/NN/code fragment/NN/fragment 8.20/CD/8.20 /:/: an/DT/an implementation/NN/implementation of/IN/of a/DT/a breadth-first/JJ/breadth-first traversal/NN/traversal of/IN/of a/DT/a tree/NNP/tree. this/DT/this code/NN/code should/MD/should be/VB/be included/VBN/included in/IN/in the/DT/the body/NN/body of/IN/of the/DT/the tree/NN/tree class/NNP/class. 37/CD/37 def/NN/def inorder/NN/inorder /:/( self/NN/self /:/) /:/: 38/CD/38 generate/NN/generate an/DT/an inorder/NN/inorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in the/DT/the tree/NNP/tree. 39/CD/39 if/IN/if not/RB/not self.is/JJ/self.is empty/NN/empty /:/( /:/) /:/: 40/CD/40 for/IN/for p/NN/p in/IN/in self/NNP/self. subtree/NN/subtree inorder/NN/inorder /:/( self.root/JJ/self.root /NN/( /:/) /:/) /:/: 41/CD/41 yield/NN/yield p/NN/p 42/CD/42 43/CD/43 def/NN/def subtree/NN/subtree inorder/NN/inorder /:/( self/NN/self /,/, p/NN/p /:/) /:/: 44/CD/44 generate/NN/generate an/DT/an inorder/NN/inorder iteration/NN/iteration of/IN/of positions/NNS/positions in/IN/in subtree/JJ/subtree rooted/VBN/rooted at/IN/at p/NNP/p. 45/CD/45 if/IN/if self.left/JJ/self.left /NN/( p/NN/p /:/) is/VBZ/is not/RB/not none/NN/none /:/: #/#/# if/IN/if left/VBN/left child/NN/child exists/NNS/exists /,/, traverse/VBP/traverse its/PRP$/its subtree/JJ/subtree 46/CD/46 for/IN/for other/JJ/other in/IN/in self/NNP/self. subtree/NN/subtree inorder/NN/inorder /:/( self.left/JJ/self.left /NN/( p/NN/p /:/) /:/) /:/: 47/CD/47 yield/NN/yield other/JJ/other 48/CD/48 yield/NN/yield p/NN/p #/#/# visit/NN/visit p/NN/p between/IN/between its/PRP$/its subtrees/NNS/subtrees 49/CD/49 if/IN/if self.right/JJ/self.right /NN/( p/NN/p /:/) is/VBZ/is not/RB/not none/NN/none /:/: #/#/# if/IN/if right/RB/right child/VBN/child exists/NNS/exists /,/, traverse/VBP/traverse its/PRP$/its subtree/JJ/subtree 50/CD/50 for/IN/for other/JJ/other in/IN/in self/NNP/self. subtree/NN/subtree inorder/NN/inorder /:/( self.right/JJ/self.right /NN/( p/NN/p /:/) /:/) /:/: 51/CD/51 yield/NN/yield other/JJ/other code/NN/code fragment/NN/fragment 8.21/CD/8.21 /:/: support/NN/support for/IN/for performing/VBG/performing an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. this/DT/this code/NN/code should/MD/should be/VB/be included/VBN/included in/IN/in the/DT/the binarytree/NN/binarytree class/NN/class /:/( given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.7/CD/8.7 /CD/) /./. for/IN/for many/JJ/many applications/NNS/applications of/IN/of binary/JJ/binary trees/NNS/trees /,/, an/DT/an inorder/NN/inorder traversal/NN/traversal provides/VBZ/provides a/DT/a natural/JJ/natural iteration/NNP/iteration. we/PRP/we could/MD/could make/VB/make it/PRP/it the/DT/the default/NN/default for/IN/for the/DT/the binarytree/NN/binarytree class/NN/class by/IN/by overriding/NN/overriding the/DT/the positions/NNS/positions method/VBD/method that/IN/that was/VBD/was inherited/VBN/inherited from/IN/from the/DT/the tree/NN/tree class/NN/class /:/( see/NN/see code/NN/code fragment/NN/fragment 8.22/CD/8.22 /CD/) /./. 52/CD/52 #/#/# override/JJ/override inherited/VBN/inherited version/NN/version to/TO/to make/VB/make inorder/NN/inorder the/DT/the default/NN/default 53/CD/53 def/NN/def positions/NNS/positions /:/( self/PRP/self /VBP/) /:/: 54/CD/54 generate/NN/generate an/DT/an iteration/NN/iteration of/IN/of the/DT/the tree/NN/tree s/VBZ/s positions/NNP/positions. 55/CD/55 return/NN/return self.inorder/NN/self.inorder /:/( /:/) #/#/# make/NN/make inorder/NN/inorder the/DT/the default/NN/default code/NN/code fragment/NN/fragment 8.22/CD/8.22 /:/: defining/VBG/defining the/DT/the binarytree.position/NN/binarytree.position method/NN/method so/RB/so that/IN/that positions/NNS/positions are/VBP/are reported/VBN/reported using/VBG/using inorder/NN/inorder traversal/NNP/traversal. 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 337/CD/337 8.4.5/CD/8.4.5 applications/NNS/applications of/IN/of tree/NN/tree traversals/NNS/traversals in/IN/in this/DT/this section/NN/section /,/, we/PRP/we demonstrate/VBP/demonstrate several/JJ/several representative/JJ/representative applications/NNS/applications of/IN/of tree/NN/tree traversals/NNS/traversals /,/, including/VBG/including some/DT/some customizations/NNS/customizations of/IN/of the/DT/the standard/JJ/standard traversal/NN/traversal algorithms/NNP/algorithms. table/NN/table of/IN/of contents/NNS/contents when/WRB/when using/VBG/using a/DT/a tree/NN/tree to/TO/to represent/VB/represent the/DT/the hierarchical/JJ/hierarchical structure/NN/structure of/IN/of a/DT/a document/NN/document /,/, a/DT/a preorder/NN/preorder traversal/NN/traversal of/IN/of the/DT/the tree/NN/tree can/MD/can naturally/RB/naturally be/VB/be used/VBN/used to/TO/to produce/VB/produce a/DT/a table/JJ/table of/IN/of contents/NNS/contents for/IN/for the/DT/the document/NNP/document. for/IN/for example/NN/example /,/, the/DT/the table/NN/table of/IN/of contents/NNS/contents associated/VBN/associated with/IN/with the/DT/the tree/NN/tree from/IN/from figure/NN/figure 8.15/CD/8.15 is/VBZ/is displayed/VBN/displayed in/IN/in figure/NN/figure 8.20/CD/8.20. part/NN/part /:/( a/DT/a /NN/) of/IN/of that/DT/that figure/NN/figure gives/VBZ/gives a/DT/a simple/JJ/simple presentation/NN/presentation with/IN/with one/CD/one element/NN/element per/IN/per line/NN/line ;/:/; part/NN/part /:/( b/NN/b /:/) shows/VBZ/shows a/DT/a more/RBR/more attractive/JJ/attractive presentation/NN/presentation produced/VBN/produced by/IN/by indenting/NN/indenting each/DT/each element/NN/element based/VBN/based on/IN/on its/PRP$/its depth/NN/depth within/IN/within the/DT/the tree/NNP/tree. a/DT/a similar/JJ/similar presentation/NN/presentation could/MD/could be/VB/be used/VBN/used to/TO/to display/VB/display the/DT/the contents/NNS/contents of/IN/of a/DT/a computer/NN/computer s/VBZ/s file/JJ/file system/NN/system /,/, based/VBN/based on/IN/on its/PRP$/its tree/NN/tree representation/NN/representation /:/( as/IN/as in/IN/in figure/NN/figure 8.3/CD/8.3 /CD/) /./. paper/NN/paper paper/NN/paper title/NN/title title/NN/title abstract/NN/abstract abstract/NN/abstract 1/CD/1 1/CD/1 1.1/CD/1.1 1.1/CD/1.1 1.2/CD/1.2 1.2/CD/1.2 2/CD/2 2/CD/2 2.1/CD/2.1 2.1/CD/2.1 /:/... /:/... /:/( a/DT/a /NN/) /:/( b/NN/b /:/) figure/NN/figure 8.20/CD/8.20 /:/: table/JJ/table of/IN/of contents/NNS/contents for/IN/for a/DT/a document/NN/document represented/VBN/represented by/IN/by the/DT/the tree/NN/tree in/IN/in figure/NN/figure 8.15/CD/8.15 /:/: /:/( a/DT/a /NN/) without/IN/without indentation/NN/indentation ;/:/; /:/( b/NN/b /:/) with/IN/with indentation/NN/indentation based/VBN/based on/IN/on depth/NN/depth within/IN/within the/DT/the tree/NNP/tree. the/DT/the unindented/VBN/unindented version/NN/version of/IN/of the/DT/the table/NN/table of/IN/of contents/NNS/contents /,/, given/VBN/given a/DT/a tree/NN/tree t/NN/t /,/, can/MD/can be/VB/be produced/VBN/produced with/IN/with the/DT/the following/VBG/following code/NN/code /:/: for/IN/for p/NN/p in/IN/in t.preorder/JJ/t.preorder /NN/( /:/) /:/: print/NN/print /:/( p.element/JJ/p.element /NN/( /:/) /:/) to/TO/to produce/VB/produce the/DT/the presentation/NN/presentation of/IN/of figure/NN/figure 8.20/CD/8.20 /CD/( b/NN/b /:/) /,/, we/PRP/we indent/VBP/indent each/DT/each element/NN/element with/IN/with a/DT/a number/NN/number of/IN/of spaces/NNS/spaces equal/JJ/equal to/TO/to twice/NN/twice the/DT/the element/NN/element s/VBZ/s depth/NN/depth in/IN/in the/DT/the tree/NN/tree /:/( hence/NN/hence /,/, the/DT/the root/NN/root element/NN/element was/VBD/was unindented/VBN/unindented /-NONE-/) /./. although/IN/although we/PRP/we could/MD/could replace/VB/replace the/DT/the body/NN/body of/IN/of the/DT/the above/JJ/above loop/NN/loop with/IN/with the/DT/the statement/NN/statement print/NN/print /:/( 2/CD/2 t.depth/JJ/t.depth /NN/( p/NN/p /:/) +/:/+ str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) /:/) /,/, such/JJ/such an/DT/an approach/NN/approach is/VBZ/is unnecessarily/RB/unnecessarily inefficient/NNP/inefficient. although/IN/although the/DT/the work/NN/work to/TO/to produce/VB/produce the/DT/the preorder/NN/preorder traversal/NN/traversal runs/VBZ/runs in/IN/in o/NN/o /:/( n/NN/n /:/) time/NN/time /,/, based/VBN/based on/IN/on the/DT/the analysis/NN/analysis of/IN/of section/NN/section 8.4.1/CD/8.4.1 /,/, the/DT/the calls/NNS/calls to/TO/to depth/VB/depth incur/NN/incur a/DT/a hidden/NN/hidden cost/NNP/cost. making/VBG/making a/DT/a call/NN/call to/TO/to depth/VB/depth from/IN/from every/DT/every position/NN/position of/IN/of the/DT/the tree/NN/tree results/NNS/results in/IN/in o/NN/o /:/( n2/NNP/n2 /:/) worst-case/JJ/worst-case time/NN/time /,/, as/IN/as noted/VBN/noted when/WRB/when analyzing/VBG/analyzing the/DT/the algorithm/NN/algorithm height1/NNP/height1 in/IN/in section/NN/section 8.1.3/CD/8.1.3. 338/CD/338 chapter/NN/chapter 8/CD/8. trees/NNS/trees a/DT/a preferred/VBN/preferred approach/NN/approach to/TO/to producing/VBG/producing an/DT/an indented/JJ/indented table/NN/table of/IN/of contents/NNS/contents is/VBZ/is to/TO/to redesign/VB/redesign a/DT/a top-down/JJ/top-down recursion/NN/recursion that/WDT/that includes/VBZ/includes the/DT/the current/JJ/current depth/NN/depth as/IN/as an/DT/an additional/JJ/additional parameter/NNP/parameter. such/JJ/such an/DT/an implementation/NN/implementation is/VBZ/is provided/VBN/provided in/IN/in code/NN/code fragment/NN/fragment 8.23/CD/8.23. this/DT/this implementation/NN/implementation runs/VBZ/runs in/IN/in worst-case/JJ/worst-case o/NN/o /:/( n/NN/n /:/) time/NN/time /:/( except/IN/except /,/, technically/RB/technically /,/, the/DT/the time/NN/time it/PRP/it takes/VBZ/takes to/TO/to print/VB/print strings/NNS/strings of/IN/of increasing/VBG/increasing lengths/NNS/lengths /:/) /./. 1/CD/1 def/NN/def preorder/NN/preorder indent/NN/indent /:/( t/NN/t /,/, p/NN/p /,/, d/VBD/d /:/) /:/: 2/CD/2 print/NN/print preorder/NN/preorder representation/NN/representation of/IN/of subtree/JJ/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at p/NN/p at/IN/at depth/NN/depth d/NNP/d. 3/CD/3 print/NN/print /:/( 2/CD/2 d/NN/d +/:/+ str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) /:/) #/#/# use/NN/use depth/NN/depth for/IN/for indentation/NN/indentation 4/CD/4 for/IN/for c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) /:/: 5/CD/5 preorder/NN/preorder indent/NN/indent /:/( t/NN/t /,/, c/NN/c /,/, d/VBD/d +/:/+ 1/CD/1 /CD/) #/#/# child/NN/child depth/NN/depth is/VBZ/is d/VBN/d +/-NONE-/+ 1/CD/1 code/NN/code fragment/NN/fragment 8.23/CD/8.23 /:/: efficient/JJ/efficient recursion/NN/recursion for/IN/for printing/NN/printing indented/VBD/indented version/NN/version of/IN/of a/DT/a preorder/NN/preorder traversal/NNP/traversal. on/IN/on a/DT/a complete/JJ/complete tree/NN/tree t/NN/t /,/, the/DT/the recursion/NN/recursion should/MD/should be/VB/be started/VBN/started with/IN/with form/NN/form preorder/NN/preorder indent/NN/indent /:/( t/NN/t /,/, t.root/JJ/t.root /NN/( /:/) /,/, 0/-NONE-/0 /:/) /./. in/IN/in the/DT/the example/NN/example of/IN/of figure/NN/figure 8.20/CD/8.20 /,/, we/PRP/we were/VBD/were fortunate/JJ/fortunate in/IN/in that/DT/that the/DT/the numbering/NN/numbering was/VBD/was embedded/VBN/embedded within/IN/within the/DT/the elements/NNS/elements of/IN/of the/DT/the tree/NNP/tree. more/RBR/more generally/RB/generally /,/, we/PRP/we might/MD/might be/VB/be interested/JJ/interested in/IN/in using/NN/using a/DT/a preorder/NN/preorder traversal/NN/traversal to/TO/to display/VB/display the/DT/the structure/NN/structure of/IN/of a/DT/a tree/NN/tree /,/, with/IN/with indentation/NN/indentation and/CC/and also/RB/also explicit/VBD/explicit numbering/VBG/numbering that/IN/that was/VBD/was not/RB/not present/JJ/present in/IN/in the/DT/the tree/NNP/tree. for/IN/for example/NN/example /,/, we/PRP/we might/MD/might display/VB/display the/DT/the tree/NN/tree from/IN/from figure/NN/figure 8.2/CD/8.2 beginning/NN/beginning as/IN/as /:/: electronics/NNS/electronics r/VBP/r us/PRP/us 1/CD/1 r&d/JJ/r&d 2/CD/2 sales/NNS/sales 2.1/CD/2.1 domestic/JJ/domestic 2.2/CD/2.2 international/JJ/international 2.2.1/CD/2.2.1 canada/NN/canada 2.2.2/CD/2.2.2 s/NNP/s. america/NN/america this/DT/this is/VBZ/is more/RBR/more challenging/VBG/challenging /,/, because/IN/because the/DT/the numbers/NNS/numbers used/VBN/used as/IN/as labels/NNS/labels are/VBP/are implicit/JJ/implicit in/IN/in the/DT/the structure/NN/structure of/IN/of the/DT/the tree/NNP/tree. a/DT/a label/NN/label depends/VBZ/depends on/IN/on the/DT/the index/NN/index of/IN/of each/DT/each position/NN/position /,/, relative/JJ/relative to/TO/to its/PRP$/its siblings/NNS/siblings /,/, along/IN/along the/DT/the path/NN/path from/IN/from the/DT/the root/NN/root to/TO/to the/DT/the current/JJ/current position/NNP/position. to/TO/to accomplish/VB/accomplish the/DT/the task/NN/task /,/, we/PRP/we add/VBP/add a/DT/a representation/NN/representation of/IN/of that/DT/that path/NN/path as/IN/as an/DT/an additional/JJ/additional parameter/NN/parameter to/TO/to the/DT/the recursive/JJ/recursive signature/NNP/signature. specifically/RB/specifically /,/, we/PRP/we use/VBP/use a/DT/a list/NN/list of/IN/of zero-indexed/JJ/zero-indexed numbers/NNS/numbers /,/, one/CD/one for/IN/for each/DT/each position/NN/position along/IN/along the/DT/the downward/NN/downward path/NN/path /,/, other/JJ/other than/IN/than the/DT/the root/NNP/root. /NNP/( we/PRP/we convert/VBP/convert those/DT/those numbers/NNS/numbers to/TO/to oneindexed/VBN/oneindexed form/NN/form when/WRB/when printing/NNP/printing. /NNP/) at/IN/at the/DT/the implementation/NN/implementation level/NN/level /,/, we/PRP/we wish/VBP/wish to/TO/to avoid/VB/avoid the/DT/the inefficiency/NN/inefficiency of/IN/of duplicating/VBG/duplicating such/JJ/such lists/NNS/lists when/WRB/when sending/VBG/sending a/DT/a new/JJ/new parameter/NN/parameter from/IN/from one/CD/one level/NN/level of/IN/of the/DT/the recursion/NN/recursion to/TO/to the/DT/the next/NNP/next. a/DT/a standard/JJ/standard solution/NN/solution is/VBZ/is to/TO/to share/VB/share the/DT/the same/JJ/same list/NN/list instance/NN/instance throughout/IN/throughout the/DT/the recursion/NNP/recursion. at/IN/at one/CD/one level/NN/level of/IN/of the/DT/the recursion/NN/recursion /,/, a/DT/a new/JJ/new entry/NN/entry is/VBZ/is temporarily/RB/temporarily added/VBN/added to/TO/to the/DT/the end/NN/end of/IN/of the/DT/the list/NN/list before/IN/before making/VBG/making further/JJ/further recursive/JJ/recursive calls/NNP/calls. in/IN/in order/NN/order to/TO/to leave/VB/leave no/DT/no trace/NN/trace /,/, that/IN/that same/JJ/same block/NN/block of/IN/of code/NN/code must/MD/must remove/VB/remove the/DT/the extraneous/JJ/extraneous entry/NN/entry from/IN/from the/DT/the list/NN/list before/IN/before completing/VBG/completing its/PRP$/its task/NNP/task. an/DT/an implementation/NN/implementation based/VBN/based on/IN/on this/DT/this approach/NN/approach is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.24/CD/8.24. 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 339/CD/339 1/CD/1 def/NN/def preorder/NN/preorder label/NN/label /:/( t/NN/t /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 2/CD/2 print/NN/print labeled/VBD/labeled representation/NN/representation of/IN/of subtree/JJ/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at p/NN/p at/IN/at depth/NN/depth d/NNP/d. 3/CD/3 label/NN/label =/:/= /./. .join/JJ/.join /NN/( str/NN/str /:/( j/NN/j +/:/+ 1/CD/1 /CD/) for/IN/for j/NN/j in/IN/in path/NN/path /:/) #/#/# displayed/VBN/displayed labels/NNS/labels are/VBP/are one-indexed/JJ/one-indexed 4/CD/4 print/NN/print /:/( 2/CD/2 d/NN/d +/:/+ label/NN/label /,/, p.element/JJ/p.element /NN/( /:/) /:/) 5/CD/5 path.append/NN/path.append /:/( 0/-NONE-/0 /:/) #/#/# path/NN/path entries/NNS/entries are/VBP/are zero-indexed/JJ/zero-indexed 6/CD/6 for/IN/for c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) /:/: 7/CD/7 preorder/NN/preorder label/NN/label /:/( t/NN/t /,/, c/NN/c /,/, d/VBD/d +/:/+ 1/CD/1 /,/, path/NN/path /:/) #/#/# child/NN/child depth/NN/depth is/VBZ/is d/VBN/d +/-NONE-/+ 1/CD/1 8/CD/8 path/NN/path /NN/[ 1/CD/1 /CD/] +/CD/+ =/CD/= 1/CD/1 9/CD/9 path.pop/JJ/path.pop /NN/( /:/) code/NN/code fragment/NN/fragment 8.24/CD/8.24 /:/: efficient/JJ/efficient recursion/NN/recursion for/IN/for printing/NN/printing an/DT/an indented/JJ/indented and/CC/and labeled/VBD/labeled presentation/NN/presentation of/IN/of a/DT/a preorder/NN/preorder traversal/NNP/traversal. parenthetic/JJ/parenthetic representations/NNS/representations of/IN/of a/DT/a tree/NN/tree it/PRP/it is/VBZ/is not/RB/not possible/JJ/possible to/TO/to reconstruct/VB/reconstruct a/DT/a general/JJ/general tree/NN/tree /,/, given/VBN/given only/RB/only the/DT/the preorder/NN/preorder sequence/NN/sequence of/IN/of elements/NNS/elements /,/, as/IN/as in/IN/in figure/NN/figure 8.20/CD/8.20 /CD/( a/DT/a /NN/) /./. some/DT/some additional/JJ/additional context/NN/context is/VBZ/is necessary/JJ/necessary for/IN/for the/DT/the structure/NN/structure of/IN/of the/DT/the tree/NN/tree to/TO/to be/VB/be well/RB/well defined/NNP/defined. the/DT/the use/NN/use of/IN/of indentation/NN/indentation or/CC/or numbered/VBN/numbered labels/NNS/labels provides/VBZ/provides such/JJ/such context/NN/context /,/, with/IN/with a/DT/a very/RB/very human-friendly/JJ/human-friendly presentation/NNP/presentation. however/RB/however /,/, there/EX/there are/VBP/are more/JJR/more concise/NN/concise string/VBG/string representations/NNS/representations of/IN/of trees/NNS/trees that/WDT/that are/VBP/are computer-friendly/NNP/computer-friendly. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we explore/VBP/explore one/CD/one such/JJ/such representation/NNP/representation. the/DT/the parenthetic/JJ/parenthetic string/NN/string representation/NN/representation p/NN/p /:/( t/NN/t /:/) of/IN/of tree/NN/tree t/NN/t is/VBZ/is recursively/RB/recursively defined/VBN/defined as/IN/as follows/NNP/follows. if/IN/if t/NN/t consists/NNS/consists of/IN/of a/DT/a single/JJ/single position/NN/position p/NN/p /,/, then/RB/then p/VB/p /:/( t/NN/t /:/) =/:/= str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) /./. otherwise/NN/otherwise /,/, it/PRP/it is/VBZ/is defined/VBN/defined recursively/RB/recursively as/IN/as /,/, p/NN/p /:/( t/NN/t /:/) =/:/= str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) +/:/+ /:/( +/:/+ p/NN/p /:/( t1/NNP/t1 /:/) +/:/+ /,/, +/:/+ +/:/+ /,/, +/:/+ p/NN/p /:/( tk/NN/tk /:/) +/:/+ /:/) where/WRB/where p/NN/p is/VBZ/is the/DT/the root/NN/root of/IN/of t/NN/t and/CC/and t1,t2/-NONE-/t1,t2 /,/, /./. /./. /./. ,tk/NN/,tk are/VBP/are the/DT/the subtrees/NNS/subtrees rooted/VBD/rooted at/IN/at the/DT/the children/NNS/children of/IN/of p/NN/p /,/, which/WDT/which are/VBP/are given/VBN/given in/IN/in order/NN/order if/IN/if t/NN/t is/VBZ/is an/DT/an ordered/VBN/ordered tree/NNP/tree. we/PRP/we are/VBP/are using/VBG/using +/:/+ here/RB/here to/TO/to denote/VB/denote string/NN/string concatenation/NNP/concatenation. as/IN/as an/DT/an example/NN/example /,/, the/DT/the parenthetic/JJ/parenthetic representation/NN/representation of/IN/of the/DT/the tree/NN/tree of/IN/of figure/NN/figure 8.2/CD/8.2 would/MD/would appear/VB/appear as/IN/as follows/NNS/follows /:/( line/NN/line breaks/NNS/breaks are/VBP/are cosmetic/JJ/cosmetic /NN/) /:/: electronics/NNS/electronics r/VBP/r us/PRP/us /:/( r&d/JJ/r&d /,/, sales/NNS/sales /:/( domestic/JJ/domestic /,/, international/JJ/international /NN/( canada/NN/canada /,/, s/NNP/s. america/NN/america /,/, overseas/JJ/overseas /NN/( africa/NN/africa /,/, europe/NN/europe /,/, asia/NN/asia /,/, australia/NN/australia /:/) /:/) /:/) /,/, purchasing/VBG/purchasing /,/, manufacturing/NN/manufacturing /:/( tv/NN/tv /,/, cd/NN/cd /,/, tuner/NN/tuner /:/) /:/) although/IN/although the/DT/the parenthetic/JJ/parenthetic representation/NN/representation is/VBZ/is essentially/RB/essentially a/DT/a preorder/NN/preorder traversal/NN/traversal /,/, we/PRP/we can/MD/can not/RB/not easily/RB/easily produce/VB/produce the/DT/the additional/JJ/additional punctuation/NN/punctuation using/VBG/using the/DT/the formal/JJ/formal implementation/NN/implementation of/IN/of preorder/NN/preorder /,/, as/IN/as given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.17/CD/8.17. the/DT/the opening/VBG/opening parenthesis/NN/parenthesis must/MD/must be/VB/be produced/VBN/produced just/RB/just before/IN/before the/DT/the loop/NN/loop over/IN/over a/DT/a position/NN/position s/VBZ/s children/NNS/children and/CC/and the/DT/the closing/JJ/closing parenthesis/NN/parenthesis must/MD/must be/VB/be produced/VBN/produced just/RB/just after/IN/after that/DT/that loop/NNP/loop. furthermore/NN/furthermore /,/, the/DT/the separating/NN/separating commas/VBZ/commas must/MD/must be/VB/be produced/NNP/produced. the/DT/the python/NN/python function/NN/function parenthesize/NN/parenthesize /,/, shown/NN/shown in/IN/in code/NN/code fragment/NN/fragment 8.25/CD/8.25 /,/, is/VBZ/is a/DT/a custom/NN/custom traversal/NN/traversal that/WDT/that prints/VBZ/prints such/JJ/such a/DT/a parenthetic/JJ/parenthetic string/NN/string representation/NN/representation of/IN/of a/DT/a tree/NN/tree t/NNP/t. 340/CD/340 chapter/NN/chapter 8/CD/8. trees/NNS/trees 1/CD/1 def/NN/def parenthesize/NN/parenthesize /:/( t/NN/t /,/, p/NN/p /:/) /:/: 2/CD/2 print/NN/print parenthesized/VBD/parenthesized representation/NN/representation of/IN/of subtree/JJ/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at p/NNP/p. 3/CD/3 print/NN/print /:/( p.element/JJ/p.element /NN/( /:/) /,/, end/NN/end =/:/= /:/) #/#/# use/NN/use of/IN/of end/NN/end avoids/NNS/avoids trailing/VBG/trailing newline/NN/newline 4/CD/4 if/IN/if not/RB/not t.is/JJ/t.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: 5/CD/5 first/JJ/first time/NN/time =/:/= true/JJ/true 6/CD/6 for/IN/for c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) /:/: 7/CD/7 sep/NN/sep =/:/= /:/( if/IN/if first/JJ/first time/NN/time else/RB/else /,/, #/#/# determine/NN/determine proper/NN/proper separator/NN/separator 8/CD/8 print/NN/print /NN/( sep/NN/sep /,/, end/NN/end =/:/= /:/) 9/CD/9 first/JJ/first time/NN/time =/:/= false/NN/false #/#/# any/DT/any future/NN/future passes/VBZ/passes will/MD/will not/RB/not be/VB/be the/DT/the first/JJ/first 10/CD/10 parenthesize/NN/parenthesize /:/( t/NN/t /,/, c/NN/c /:/) #/#/# recur/NN/recur on/IN/on child/NN/child 11/CD/11 print/NN/print /:/( /:/) /,/, end/NN/end =/:/= /:/) #/#/# include/NN/include closing/NN/closing parenthesis/NN/parenthesis code/NN/code fragment/NN/fragment 8.25/CD/8.25 /:/: function/NN/function that/IN/that prints/NNS/prints parenthetic/JJ/parenthetic string/NN/string representation/NN/representation of/IN/of a/DT/a tree/NNP/tree. computing/NN/computing disk/NN/disk space/NN/space in/IN/in example/NN/example 8.1/CD/8.1 /,/, we/PRP/we considered/VBD/considered the/DT/the use/NN/use of/IN/of a/DT/a tree/NN/tree as/IN/as a/DT/a model/NN/model for/IN/for a/DT/a file-system/JJ/file-system structure/NN/structure /,/, with/IN/with internal/JJ/internal positions/NNS/positions representing/VBG/representing directories/NNS/directories and/CC/and leaves/NNS/leaves representing/VBG/representing files/NNP/files. in/IN/in fact/NN/fact /,/, when/WRB/when introducing/VBG/introducing the/DT/the use/NN/use of/IN/of recursion/NN/recursion back/RB/back in/IN/in chapter/NN/chapter 4/CD/4 /,/, we/PRP/we specifically/RB/specifically examined/VBD/examined the/DT/the topic/JJ/topic of/IN/of file/NN/file systems/NNS/systems /:/( see/VB/see section/NN/section 4.1.4/CD/4.1.4 /CD/) /./. although/IN/although we/PRP/we did/VBD/did not/RB/not explicitly/RB/explicitly model/VB/model it/PRP/it as/IN/as a/DT/a tree/NN/tree at/IN/at that/DT/that time/NN/time /,/, we/PRP/we gave/VBD/gave an/DT/an implementation/NN/implementation of/IN/of an/DT/an algorithm/NN/algorithm for/IN/for computing/NN/computing the/DT/the disk/NN/disk usage/NN/usage /:/( code/NN/code fragment/NN/fragment 4.5/CD/4.5 /CD/) /./. the/DT/the recursive/JJ/recursive computation/NN/computation of/IN/of disk/NN/disk space/NN/space is/VBZ/is emblematic/JJ/emblematic of/IN/of a/DT/a postorder/NN/postorder traversal/NN/traversal /,/, as/IN/as we/PRP/we can/MD/can not/RB/not effectively/RB/effectively compute/VB/compute the/DT/the total/JJ/total space/NN/space used/VBN/used by/IN/by a/DT/a directory/NN/directory until/IN/until after/IN/after we/PRP/we know/VBP/know the/DT/the space/NN/space that/IN/that is/VBZ/is used/VBN/used by/IN/by its/PRP$/its children/NNS/children directories/NNP/directories. unfortunately/RB/unfortunately /,/, the/DT/the formal/JJ/formal implementation/NN/implementation of/IN/of postorder/NN/postorder /,/, as/IN/as given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.19/CD/8.19 does/VBZ/does not/RB/not suffice/VB/suffice for/IN/for this/DT/this purpose/NNP/purpose. as/IN/as it/PRP/it visits/VBZ/visits the/DT/the position/NN/position of/IN/of a/DT/a directory/NN/directory /,/, there/EX/there is/VBZ/is no/DT/no easy/JJ/easy way/NN/way to/TO/to discern/VB/discern which/WDT/which of/IN/of the/DT/the previous/JJ/previous positions/NNS/positions represent/VBP/represent children/NNS/children of/IN/of that/DT/that directory/NN/directory /,/, nor/CC/nor how/WRB/how much/JJ/much recursive/JJ/recursive disk/NN/disk space/NN/space was/VBD/was allocated/NNP/allocated. we/PRP/we would/MD/would like/VB/like to/TO/to have/VB/have a/DT/a mechanism/NN/mechanism for/IN/for children/NNS/children to/TO/to return/VB/return information/NN/information to/TO/to the/DT/the parent/NN/parent as/IN/as part/NN/part of/IN/of the/DT/the traversal/NN/traversal process/NNP/process. a/DT/a custom/NN/custom solution/NN/solution to/TO/to the/DT/the disk/NN/disk space/NN/space problem/NN/problem /,/, with/IN/with each/DT/each level/NN/level of/IN/of recursion/NN/recursion providing/VBG/providing a/DT/a return/NN/return value/NN/value to/TO/to the/DT/the /NN/( parent/NN/parent /:/) caller/NN/caller /,/, is/VBZ/is provided/VBN/provided in/IN/in code/NN/code fragment/NN/fragment 8.26/CD/8.26. 1/CD/1 def/NN/def disk/NN/disk space/NN/space /:/( t/NN/t /,/, p/NN/p /:/) /:/: 2/CD/2 return/NN/return total/NN/total disk/NN/disk space/NN/space for/IN/for subtree/NN/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at p/NNP/p. 3/CD/3 subtotal/JJ/subtotal =/NN/= p.element/JJ/p.element /NN/( /:/) .space/NN/.space /:/( /:/) #/#/# space/NN/space used/VBN/used at/IN/at position/NN/position p/NN/p 4/CD/4 for/IN/for c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) /:/: 5/CD/5 subtotal/JJ/subtotal +/NN/+ =/:/= disk/NN/disk space/NN/space /:/( t/NN/t /,/, c/NN/c /:/) #/#/# add/NN/add child/NN/child s/NNS/s space/NN/space to/TO/to subtotal/JJ/subtotal 6/CD/6 return/NN/return subtotal/NN/subtotal code/NN/code fragment/NN/fragment 8.26/CD/8.26 /:/: recursive/JJ/recursive computation/NN/computation of/IN/of disk/NN/disk space/NN/space for/IN/for a/DT/a tree/NNP/tree. we/PRP/we assume/VBP/assume that/IN/that a/DT/a space/NN/space /:/( /:/) method/NN/method of/IN/of each/DT/each tree/NN/tree element/NN/element reports/NNS/reports the/DT/the local/JJ/local space/NN/space used/VBN/used at/IN/at that/DT/that position/NNP/position. 8.4/NNP/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 341/CD/341 8.4.6/CD/8.4.6 euler/NN/euler tours/NNS/tours and/CC/and the/DT/the template/NN/template method/NN/method pattern/NN/pattern _/NNP/_ the/DT/the various/JJ/various applications/NNS/applications described/VBN/described in/IN/in section/NN/section 8.4.5/CD/8.4.5 demonstrate/NN/demonstrate the/DT/the great/JJ/great power/NN/power of/IN/of recursive/JJ/recursive tree/NN/tree traversals/NNP/traversals. unfortunately/RB/unfortunately /,/, they/PRP/they also/RB/also show/VBP/show that/IN/that the/DT/the specific/JJ/specific implementations/NNS/implementations of/IN/of the/DT/the preorder/NN/preorder and/CC/and postorder/NN/postorder methods/NNS/methods of/IN/of our/PRP$/our tree/NN/tree class/NN/class /,/, or/CC/or the/DT/the inorder/NN/inorder method/NN/method of/IN/of the/DT/the binarytree/JJ/binarytree class/NN/class /,/, are/VBP/are not/RB/not general/JJ/general enough/RB/enough to/TO/to capture/VB/capture the/DT/the range/NN/range of/IN/of computations/NNS/computations we/PRP/we desire/NNP/desire. in/IN/in some/DT/some cases/NNS/cases /,/, we/PRP/we need/VBP/need more/JJR/more of/IN/of a/DT/a blending/NN/blending of/IN/of the/DT/the approaches/NNS/approaches /,/, with/IN/with initial/JJ/initial work/NN/work performed/VBN/performed before/IN/before recurring/NN/recurring on/IN/on subtrees/NNS/subtrees /,/, additional/JJ/additional work/NN/work performed/VBN/performed after/IN/after those/DT/those recursions/NNS/recursions /,/, and/CC/and in/IN/in the/DT/the case/NN/case of/IN/of a/DT/a binary/JJ/binary tree/NN/tree /,/, work/NN/work performed/VBD/performed between/IN/between the/DT/the two/CD/two possible/JJ/possible recursions/NNP/recursions. furthermore/NN/furthermore /,/, in/IN/in some/DT/some contexts/NNS/contexts it/PRP/it was/VBD/was important/JJ/important to/TO/to know/VB/know the/DT/the depth/NN/depth of/IN/of a/DT/a position/NN/position /,/, or/CC/or the/DT/the complete/JJ/complete path/NN/path from/IN/from the/DT/the root/NN/root to/TO/to that/DT/that position/NN/position /,/, or/CC/or to/TO/to return/VB/return information/NN/information from/IN/from one/CD/one level/NN/level of/IN/of the/DT/the recursion/NN/recursion to/TO/to another/NNP/another. for/IN/for each/DT/each of/IN/of the/DT/the previous/JJ/previous applications/NNS/applications /,/, we/PRP/we were/VBD/were able/JJ/able to/TO/to develop/VB/develop a/DT/a custom/NN/custom implementation/NN/implementation to/TO/to properly/RB/properly adapt/VB/adapt the/DT/the recursive/JJ/recursive ideas/NNS/ideas /,/, but/CC/but the/DT/the great/JJ/great principles/NNS/principles of/IN/of object-oriented/JJ/object-oriented programming/NN/programming introduced/VBD/introduced in/IN/in section/NN/section 2.1.1/CD/2.1.1 include/NN/include adaptability/NN/adaptability and/CC/and reusability/NNP/reusability. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we develop/VB/develop a/DT/a more/RBR/more general/JJ/general framework/NN/framework for/IN/for implementing/NN/implementing tree/NN/tree traversals/NNS/traversals based/VBN/based on/IN/on a/DT/a concept/NN/concept known/VBN/known as/IN/as an/DT/an euler/NN/euler tour/NN/tour traversal/NNP/traversal. the/DT/the euler/NN/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a general/JJ/general tree/NN/tree t/NN/t can/MD/can be/VB/be informally/RB/informally defined/VBN/defined as/IN/as a/DT/a walk/NN/walk around/RP/around t/NN/t /,/, where/WRB/where we/PRP/we start/VBP/start by/IN/by going/VBG/going from/IN/from the/DT/the root/NN/root toward/IN/toward its/PRP$/its leftmost/NN/leftmost child/NN/child /,/, viewing/VBG/viewing the/DT/the edges/NNS/edges of/IN/of t/NN/t as/IN/as being/VBG/being walls/NNS/walls that/WDT/that we/PRP/we always/RB/always keep/VB/keep to/TO/to our/PRP$/our left/NNP/left. /NNP/( see/VB/see figure/NN/figure 8.21/CD/8.21. /CD/) 3/CD/3 1/CD/1 9/CD/9 5/CD/5 7/CD/7 4/CD/4 3/CD/3 2/CD/2 3/CD/3 6/CD/6 figure/NN/figure 8.21/CD/8.21 /:/: euler/JJR/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a tree/NNP/tree. the/DT/the complexity/NN/complexity of/IN/of the/DT/the walk/NN/walk is/VBZ/is o/RB/o /:/( n/NN/n /:/) /,/, because/IN/because it/PRP/it progresses/VBZ/progresses exactly/RB/exactly two/CD/two times/NNS/times along/IN/along each/DT/each of/IN/of the/DT/the n/NN/n 1/CD/1 edges/NNS/edges of/IN/of the/DT/the tree/NN/tree once/RB/once going/VBG/going downward/RB/downward along/IN/along the/DT/the edge/NN/edge /,/, and/CC/and later/JJ/later going/NN/going upward/NN/upward along/IN/along the/DT/the edge/NNP/edge. to/TO/to unify/VB/unify the/DT/the concept/NN/concept of/IN/of preorder/NN/preorder and/CC/and postorder/NN/postorder traversals/NNS/traversals /,/, we/PRP/we can/MD/can think/VB/think of/IN/of there/EX/there being/VBG/being two/CD/two notable/JJ/notable visits/NNS/visits to/TO/to each/DT/each position/NN/position p/NN/p /:/: a/DT/a pre/NN/pre visit/NN/visit occurs/NNS/occurs when/WRB/when first/JJ/first reaching/NN/reaching the/DT/the position/NN/position /,/, that/IN/that is/VBZ/is /,/, when/WRB/when the/DT/the walk/NN/walk passes/VBZ/passes immediately/RB/immediately left/VBN/left of/IN/of the/DT/the node/NN/node in/IN/in our/PRP$/our visualization/NNP/visualization. a/DT/a post/NN/post visit/NN/visit occurs/NNS/occurs when/WRB/when the/DT/the walk/NN/walk later/JJ/later proceeds/NNS/proceeds upward/VBP/upward from/IN/from that/DT/that position/NN/position /,/, that/IN/that is/VBZ/is /,/, when/WRB/when the/DT/the walk/NN/walk passes/VBZ/passes to/TO/to the/DT/the right/NN/right of/IN/of the/DT/the node/NN/node in/IN/in our/PRP$/our visualization/NNP/visualization. 342/CD/342 chapter/NN/chapter 8/CD/8. trees/NNS/trees the/DT/the process/NN/process of/IN/of an/DT/an euler/NN/euler tour/NN/tour can/MD/can easily/RB/easily be/VB/be viewed/VBN/viewed recursively/-NONE-/recursively. in/IN/in between/IN/between the/DT/the pre/NN/pre visit/NN/visit and/CC/and post/NN/post visit/NN/visit of/IN/of a/DT/a given/VBN/given position/NN/position will/MD/will be/VB/be a/DT/a recursive/JJ/recursive tour/NN/tour of/IN/of each/DT/each of/IN/of its/PRP$/its subtrees/NNP/subtrees. looking/VBG/looking at/IN/at figure/NN/figure 8.21/CD/8.21 as/IN/as an/DT/an example/NN/example /,/, there/EX/there is/VBZ/is a/DT/a contiguous/JJ/contiguous portion/NN/portion of/IN/of the/DT/the entire/JJ/entire tour/NN/tour that/WDT/that is/VBZ/is itself/PRP/itself an/DT/an euler/NN/euler tour/NN/tour of/IN/of the/DT/the subtree/JJ/subtree of/IN/of the/DT/the node/NN/node with/IN/with element/NN/element //:// /./. that/IN/that tour/PRP$/tour contains/NNS/contains two/CD/two contiguous/JJ/contiguous subtours/NNS/subtours /,/, one/CD/one traversing/VBG/traversing that/IN/that position/NN/position s/NNS/s left/VBN/left subtree/JJ/subtree and/CC/and another/DT/another traversing/NN/traversing the/DT/the right/NN/right subtree/NNP/subtree. the/DT/the pseudo-code/JJ/pseudo-code for/IN/for an/DT/an euler/NN/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at a/DT/a position/NN/position p/NN/p is/VBZ/is shown/VBN/shown in/IN/in code/NN/code fragment/NN/fragment 8.27/CD/8.27. algorithm/NN/algorithm eulertour/NN/eulertour /:/( t/NN/t /,/, p/NN/p /:/) /:/: perform/NN/perform the/DT/the pre/NN/pre visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p for/IN/for each/DT/each child/NN/child c/NN/c in/IN/in t.children/JJ/t.children /NN/( p/NN/p /:/) do/VBP/do eulertour/PRP$/eulertour /NNP/( t/NN/t /,/, c/NN/c /:/) /:/{ recursively/RB/recursively tour/PRP$/tour the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at c/NN/c /:/} perform/NN/perform the/DT/the post/NN/post visit/NN/visit action/NN/action for/IN/for position/NN/position p/NN/p code/NN/code fragment/NN/fragment 8.27/CD/8.27 /:/: algorithm/NN/algorithm eulertour/PRP$/eulertour for/IN/for performing/VBG/performing an/DT/an euler/NN/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a tree/NNP/tree. the/DT/the template/NN/template method/NN/method pattern/NN/pattern to/TO/to provide/VB/provide a/DT/a framework/NN/framework that/WDT/that is/VBZ/is reusable/JJ/reusable and/CC/and adaptable/JJ/adaptable /,/, we/PRP/we rely/RB/rely on/IN/on an/DT/an interesting/JJ/interesting object-oriented/JJ/object-oriented software/NN/software design/NN/design pattern/NN/pattern /,/, the/DT/the template/NN/template method/NN/method pattern/NNP/pattern. the/DT/the template/NN/template method/NN/method pattern/NN/pattern describes/VBZ/describes a/DT/a generic/JJ/generic computation/NN/computation mechanism/NN/mechanism that/WDT/that can/MD/can be/VB/be specialized/VBN/specialized for/IN/for a/DT/a particular/JJ/particular application/NN/application by/IN/by redefining/NN/redefining certain/JJ/certain steps/NNP/steps. to/TO/to allow/VB/allow customization/NN/customization /,/, the/DT/the primary/JJ/primary algorithm/NN/algorithm calls/VBZ/calls auxiliary/JJ/auxiliary functions/NNS/functions known/VBN/known as/IN/as hooks/NNS/hooks at/IN/at designated/VBN/designated steps/NNS/steps of/IN/of the/DT/the process/NNP/process. in/IN/in the/DT/the context/NN/context of/IN/of an/DT/an euler/NN/euler tour/NN/tour traversal/NN/traversal /,/, we/PRP/we define/VBP/define two/CD/two separate/JJ/separate hooks/NNS/hooks /,/, a/DT/a previsit/NN/previsit hook/NN/hook that/WDT/that is/VBZ/is called/VBN/called before/IN/before the/DT/the subtrees/NNS/subtrees are/VBP/are traversed/VBN/traversed /,/, and/CC/and a/DT/a postvisit/NN/postvisit hook/NN/hook that/WDT/that is/VBZ/is called/VBN/called after/IN/after the/DT/the completion/NN/completion of/IN/of the/DT/the subtree/JJ/subtree traversals/NNP/traversals. our/PRP$/our implementation/NN/implementation will/MD/will take/VB/take the/DT/the form/NN/form of/IN/of an/DT/an eulertour/NN/eulertour class/NN/class that/WDT/that manages/VBZ/manages the/DT/the process/NN/process /,/, and/CC/and defines/NNS/defines trivial/JJ/trivial definitions/NNS/definitions for/IN/for the/DT/the hooks/NNS/hooks that/WDT/that do/VBP/do nothing/NNP/nothing. the/DT/the traversal/NN/traversal can/MD/can be/VB/be customized/VBN/customized by/IN/by defining/NN/defining a/DT/a subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour and/CC/and overriding/VBG/overriding one/CD/one or/CC/or both/DT/both hooks/NNS/hooks to/TO/to provide/VB/provide specialized/VBN/specialized behavior/NNP/behavior. python/NN/python implementation/NN/implementation our/PRP$/our implementation/NN/implementation of/IN/of an/DT/an eulertour/NN/eulertour class/NN/class is/VBZ/is provided/VBN/provided in/IN/in code/NN/code fragment/NN/fragment 8.28/CD/8.28. the/DT/the primary/JJ/primary recursive/JJ/recursive process/NN/process is/VBZ/is defined/VBN/defined in/IN/in the/DT/the nonpublic/JJ/nonpublic tour/NN/tour method/NNP/method. a/DT/a tour/NN/tour instance/NN/instance is/VBZ/is created/VBN/created by/IN/by sending/NN/sending a/DT/a reference/NN/reference to/TO/to a/DT/a specific/JJ/specific tree/NN/tree to/TO/to the/DT/the constructor/NN/constructor /,/, and/CC/and then/RB/then by/IN/by calling/NN/calling the/DT/the public/NN/public execute/NN/execute method/NN/method /,/, which/WDT/which beings/NNS/beings the/DT/the tour/NN/tour and/CC/and returns/NNS/returns a/DT/a final/JJ/final result/NN/result of/IN/of the/DT/the computation/NNP/computation. 8.4/NNP/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 343/CD/343 1/CD/1 class/NN/class eulertour/NN/eulertour /:/: 2/CD/2 abstract/NN/abstract base/NN/base class/NN/class for/IN/for performing/VBG/performing euler/JJR/euler tour/NN/tour of/IN/of a/DT/a tree/NNP/tree. 3/CD/3 4/CD/4 hook/NN/hook previsit/NN/previsit and/CC/and hook/NN/hook postvisit/NN/postvisit may/MD/may be/VB/be overridden/VBN/overridden by/IN/by subclasses/NNP/subclasses. 5/CD/5 6/CD/6 def/NN/def init/NN/init /:/( self/NN/self /,/, tree/NN/tree /:/) /:/: 7/CD/7 prepare/NN/prepare an/DT/an euler/NN/euler tour/NN/tour template/NN/template for/IN/for given/VBN/given tree/NNP/tree. 8/CD/8 self/NNP/self. tree/NN/tree =/:/= tree/NN/tree 9/CD/9 10/CD/10 def/NN/def tree/NN/tree /:/( self/NN/self /:/) /:/: 11/CD/11 return/NN/return reference/NN/reference to/TO/to the/DT/the tree/NN/tree being/VBG/being traversed/NNP/traversed. 12/CD/12 return/NN/return self/NNP/self. tree/NN/tree 13/CD/13 14/CD/14 def/NN/def execute/NN/execute /:/( self/NN/self /:/) /:/: 15/CD/15 perform/NN/perform the/DT/the tour/NN/tour and/CC/and return/NN/return any/DT/any result/NN/result from/IN/from post/NN/post visit/NN/visit of/IN/of root/NNP/root. 16/CD/16 if/IN/if len/NN/len /:/( self/NNP/self. tree/NN/tree /:/) >/:/> 0/-NONE-/0 /:/: 17/CD/17 return/NN/return self/NNP/self. tour/NN/tour /:/( self/NNP/self. tree.root/NN/tree.root /:/( /:/) /,/, 0/-NONE-/0 /,/, /NNP/[ /NNP/] /NNP/) #/#/# start/NN/start the/DT/the recursion/NN/recursion 18/CD/18 19/CD/19 def/NN/def tour/NN/tour /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 20/CD/20 perform/NN/perform tour/NN/tour of/IN/of subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NNP/p. 21/CD/21 22/CD/22 p/NN/p position/NN/position of/IN/of current/NN/current node/NN/node being/VBG/being visited/VBN/visited 23/CD/23 d/NN/d depth/NN/depth of/IN/of p/NN/p in/IN/in the/DT/the tree/NN/tree 24/CD/24 path/NN/path list/NN/list of/IN/of indices/NNS/indices of/IN/of children/NNS/children on/IN/on path/NN/path from/IN/from root/NN/root to/TO/to p/VB/p 25/CD/25 26/CD/26 self/NNP/self. hook/NN/hook previsit/NN/previsit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) #/#/# pre/NN/pre visit/NN/visit p/NN/p 27/CD/27 results/NNS/results =/:/= /:/[ /:/] 28/CD/28 path.append/JJ/path.append /NN/( 0/-NONE-/0 /./) #/#/# add/NN/add new/JJ/new index/NN/index to/TO/to end/VB/end of/IN/of path/NN/path before/IN/before recursion/NN/recursion 29/CD/29 for/IN/for c/NN/c in/IN/in self/NNP/self. tree.children/NNP/tree.children /NNP/( p/NN/p /:/) /:/: 30/CD/30 results.append/JJ/results.append /NN/( self/NNP/self. tour/NN/tour /:/( c/NN/c /,/, d/VBD/d +/:/+ 1/CD/1 /,/, path/NN/path /:/) /:/) #/#/# recur/NN/recur on/IN/on child/NN/child s/NNS/s subtree/VBP/subtree 31/CD/31 path/NN/path /:/[ 1/CD/1 /CD/] +/CD/+ =/CD/= 1/CD/1 #/#/# increment/NN/increment index/NN/index 32/CD/32 path.pop/JJ/path.pop /NN/( /:/) #/#/# remove/NN/remove extraneous/JJ/extraneous index/NN/index from/IN/from end/NN/end of/IN/of path/NN/path 33/CD/33 answer/NN/answer =/:/= self/NNP/self. hook/NN/hook postvisit/NN/postvisit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) #/#/# post/NN/post visit/NN/visit p/NN/p 34/CD/34 return/NN/return answer/NN/answer 35/CD/35 36/CD/36 def/NN/def hook/NN/hook previsit/NN/previsit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: #/#/# can/MD/can be/VB/be overridden/VBN/overridden 37/CD/37 pass/NN/pass 38/CD/38 39/CD/39 def/NN/def hook/NN/hook postvisit/NN/postvisit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) /:/: #/#/# can/MD/can be/VB/be overridden/VBN/overridden 40/CD/40 pass/NN/pass code/NN/code fragment/NN/fragment 8.28/CD/8.28 /:/: an/DT/an eulertour/NN/eulertour base/NN/base class/NN/class providing/VBG/providing a/DT/a framework/NN/framework for/IN/for performing/VBG/performing euler/JJR/euler tour/NN/tour traversals/NNS/traversals of/IN/of a/DT/a tree/NNP/tree. 344/CD/344 chapter/NN/chapter 8/CD/8. trees/NNS/trees based/VBN/based on/IN/on our/PRP$/our experience/NN/experience of/IN/of customizing/VBG/customizing traversals/NNS/traversals for/IN/for sample/NN/sample applications/NNS/applications section/NN/section 8.4.5/CD/8.4.5 /,/, we/PRP/we build/VBP/build support/NN/support into/IN/into the/DT/the primary/JJ/primary eulertour/NN/eulertour for/IN/for maintaining/VBG/maintaining the/DT/the recursive/JJ/recursive depth/NN/depth and/CC/and the/DT/the representation/NN/representation of/IN/of the/DT/the recursive/JJ/recursive path/NN/path through/IN/through a/DT/a tree/NN/tree /,/, using/VBG/using the/DT/the approach/NN/approach that/WDT/that we/PRP/we introduced/VBD/introduced in/IN/in code/NN/code fragment/NN/fragment 8.24/CD/8.24. we/PRP/we also/RB/also provide/VBP/provide a/DT/a mechanism/NN/mechanism for/IN/for one/CD/one recursive/JJ/recursive level/NN/level to/TO/to return/VB/return a/DT/a value/NN/value to/TO/to another/DT/another when/WRB/when post-processing/NNP/post-processing. formally/RB/formally /,/, our/PRP$/our framework/NN/framework relies/NNS/relies on/IN/on the/DT/the following/JJ/following two/CD/two hooks/NNS/hooks that/WDT/that can/MD/can be/VB/be specialized/VBN/specialized /:/: method/NN/method hook/NN/hook previsit/NN/previsit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) this/DT/this function/NN/function is/VBZ/is called/VBN/called once/RB/once for/IN/for each/DT/each position/NN/position /,/, immediately/RB/immediately before/IN/before its/PRP$/its subtrees/NNS/subtrees /:/( if/IN/if any/DT/any /NN/) are/VBP/are traversed/NNP/traversed. parameter/NN/parameter p/NN/p is/VBZ/is a/DT/a position/NN/position in/IN/in the/DT/the tree/NN/tree /,/, d/VBD/d is/VBZ/is the/DT/the depth/NN/depth of/IN/of that/DT/that position/NN/position /,/, and/CC/and path/NN/path is/VBZ/is a/DT/a list/NN/list of/IN/of indices/NNS/indices /,/, using/VBG/using the/DT/the convention/NN/convention described/VBD/described in/IN/in the/DT/the discussion/NN/discussion of/IN/of code/NN/code fragment/NN/fragment 8.24/CD/8.24. no/DT/no return/NN/return value/NN/value is/VBZ/is expected/VBN/expected from/IN/from this/DT/this function/NNP/function. method/NN/method hook/NN/hook postvisit/NN/postvisit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) this/DT/this function/NN/function is/VBZ/is called/VBN/called once/RB/once for/IN/for each/DT/each position/NN/position /,/, immediately/RB/immediately after/IN/after its/PRP$/its subtrees/NNS/subtrees /:/( if/IN/if any/DT/any /NN/) are/VBP/are traversed/NNP/traversed. the/DT/the first/JJ/first three/CD/three parameters/NNS/parameters use/VBP/use the/DT/the same/JJ/same convention/NN/convention as/IN/as did/VBD/did hook/NN/hook previsit/NNP/previsit. the/DT/the final/JJ/final parameter/NN/parameter is/VBZ/is a/DT/a list/NN/list of/IN/of objects/NNS/objects that/WDT/that were/VBD/were provided/VBN/provided as/IN/as return/NN/return values/NNS/values from/IN/from the/DT/the post/NN/post visits/VBZ/visits of/IN/of the/DT/the respective/JJ/respective subtrees/NNS/subtrees of/IN/of p/NNP/p. any/DT/any value/NN/value returned/VBD/returned by/IN/by this/DT/this call/NN/call will/MD/will be/VB/be available/JJ/available to/TO/to the/DT/the parent/NN/parent of/IN/of p/NN/p during/IN/during its/PRP$/its postvisit/NNP/postvisit. for/IN/for more/JJR/more complex/JJ/complex tasks/NNS/tasks /,/, subclasses/NNS/subclasses of/IN/of eulertour/PRP$/eulertour may/MD/may also/RB/also choose/VB/choose to/TO/to initialize/VB/initialize and/CC/and maintain/VB/maintain additional/JJ/additional state/NN/state in/IN/in the/DT/the form/NN/form of/IN/of instance/NN/instance variables/NNS/variables that/WDT/that can/MD/can be/VB/be accessed/VBN/accessed within/IN/within the/DT/the bodies/NNS/bodies of/IN/of the/DT/the hooks/NNP/hooks. using/VBG/using the/DT/the euler/NN/euler tour/NN/tour framework/NN/framework to/TO/to demonstrate/VB/demonstrate the/DT/the flexibility/NN/flexibility of/IN/of our/PRP$/our euler/NN/euler tour/NN/tour framework/NN/framework /,/, we/PRP/we revisit/VBP/revisit the/DT/the sample/NN/sample applications/NNS/applications from/IN/from section/NN/section 8.4.5/CD/8.4.5. as/IN/as a/DT/a simple/JJ/simple example/NN/example /,/, an/DT/an indented/JJ/indented preorder/NN/preorder traversal/NN/traversal /,/, akin/NN/akin to/TO/to that/DT/that originally/RB/originally produced/VBN/produced by/IN/by code/NN/code fragment/NN/fragment 8.23/CD/8.23 /,/, can/MD/can be/VB/be generated/VBN/generated with/IN/with the/DT/the simple/JJ/simple subclass/NN/subclass given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.29/CD/8.29. 1/CD/1 class/NN/class preorderprintindentedtour/NN/preorderprintindentedtour /:/( eulertour/PRP$/eulertour /NN/) /:/: 2/CD/2 def/NN/def hook/NN/hook previsit/NN/previsit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 3/LS/3 print/NN/print /:/( 2/CD/2 d/NN/d +/:/+ str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) /:/) code/NN/code fragment/NN/fragment 8.29/CD/8.29 /:/: a/DT/a subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour that/IN/that produces/NNS/produces an/DT/an indented/JJ/indented preorder/NN/preorder list/NN/list of/IN/of a/DT/a tree/NN/tree s/VBZ/s elements/NNP/elements. such/JJ/such a/DT/a tour/NN/tour would/MD/would be/VB/be started/VBN/started by/IN/by creating/NN/creating an/DT/an instance/NN/instance of/IN/of the/DT/the subclass/NN/subclass for/IN/for a/DT/a given/VBN/given tree/NN/tree t/NN/t /,/, and/CC/and invoking/VBG/invoking its/PRP$/its execute/NN/execute method/NNP/method. this/DT/this could/MD/could be/VB/be expressed/VBN/expressed as/IN/as follows/NNS/follows /:/: tour/PRP$/tour =/NN/= preorderprintindentedtour/NN/preorderprintindentedtour /:/( t/NN/t /:/) tour.execute/JJ/tour.execute /NN/( /:/) 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 345/CD/345 a/DT/a labeled/JJ/labeled version/NN/version of/IN/of an/DT/an indented/VBN/indented /,/, preorder/NN/preorder presentation/NN/presentation /,/, akin/NN/akin to/TO/to code/VB/code fragment/NN/fragment 8.24/CD/8.24 /,/, could/MD/could be/VB/be generated/VBN/generated by/IN/by the/DT/the new/JJ/new subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour shown/NN/shown in/IN/in code/NN/code fragment/NN/fragment 8.30/CD/8.30. 1/CD/1 class/NN/class preorderprintindentedlabeledtour/NN/preorderprintindentedlabeledtour /:/( eulertour/PRP$/eulertour /NN/) /:/: 2/CD/2 def/NN/def hook/NN/hook previsit/NN/previsit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 3/LS/3 label/NN/label =/:/= /./. .join/JJ/.join /NN/( str/NN/str /:/( j/NN/j +/:/+ 1/CD/1 /CD/) for/IN/for j/NN/j in/IN/in path/NN/path /:/) #/#/# labels/NNS/labels are/VBP/are one-indexed/JJ/one-indexed 4/CD/4 print/NN/print /:/( 2/CD/2 d/NN/d +/:/+ label/NN/label /,/, p.element/JJ/p.element /NN/( /:/) /:/) code/NN/code fragment/NN/fragment 8.30/CD/8.30 /:/: a/DT/a subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour that/IN/that produces/NNS/produces a/DT/a labeled/JJ/labeled and/CC/and indented/VBD/indented /,/, preorder/NN/preorder list/NN/list of/IN/of a/DT/a tree/NN/tree s/VBZ/s elements/NNP/elements. to/TO/to produce/VB/produce the/DT/the parenthetic/JJ/parenthetic string/NN/string representation/NN/representation /,/, originally/RB/originally achieved/VBD/achieved with/IN/with code/NN/code fragment/NN/fragment 8.25/CD/8.25 /,/, we/PRP/we define/VBP/define a/DT/a subclass/NN/subclass that/WDT/that overrides/VBZ/overrides both/DT/both the/DT/the previsit/NN/previsit and/CC/and postvisit/NN/postvisit hooks/NNP/hooks. our/PRP$/our new/JJ/new implementation/NN/implementation is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.31/CD/8.31. 1/CD/1 class/NN/class parenthesizetour/NN/parenthesizetour /:/( eulertour/PRP$/eulertour /NN/) /:/: 2/CD/2 def/NN/def hook/NN/hook previsit/NN/previsit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 3/LS/3 if/IN/if path/NN/path and/CC/and path/NN/path /:/[ 1/CD/1 /CD/] >/CD/> 0/-NONE-/0 /:/: #/#/# p/NN/p follows/VBZ/follows a/DT/a sibling/NN/sibling 4/CD/4 print/NN/print /:/( /,/, /,/, end/NN/end =/:/= /:/) #/#/# so/RB/so preface/NN/preface with/IN/with comma/NN/comma 5/CD/5 print/NN/print /:/( p.element/JJ/p.element /NN/( /:/) /,/, end/NN/end =/:/= /:/) #/#/# then/RB/then print/VBP/print element/NN/element 6/CD/6 if/IN/if not/RB/not self.tree/JJ/self.tree /NN/( /:/) .is/NN/.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: #/#/# if/IN/if p/NN/p has/VBZ/has children/VBN/children 7/CD/7 print/NN/print /:/( /:/( /,/, end/NN/end =/:/= /:/) #/#/# print/NN/print opening/VBG/opening parenthesis/NN/parenthesis 8/CD/8 9/CD/9 def/NN/def hook/NN/hook postvisit/NN/postvisit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) /:/: 10/CD/10 if/IN/if not/RB/not self.tree/JJ/self.tree /NN/( /:/) .is/NN/.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: #/#/# if/IN/if p/NN/p has/VBZ/has children/VBN/children 11/CD/11 print/NN/print /:/( /:/) /,/, end/NN/end =/:/= /:/) #/#/# print/NN/print closing/NN/closing parenthesis/NN/parenthesis code/NN/code fragment/NN/fragment 8.31/CD/8.31 /:/: a/DT/a subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour that/IN/that prints/NNS/prints a/DT/a parenthetic/JJ/parenthetic string/NN/string representation/NN/representation of/IN/of a/DT/a tree/NNP/tree. notice/NN/notice that/WDT/that in/IN/in this/DT/this implementation/NN/implementation /,/, we/PRP/we need/VBP/need to/TO/to invoke/VB/invoke a/DT/a method/NN/method on/IN/on the/DT/the tree/NN/tree instance/NN/instance that/WDT/that is/VBZ/is being/VBG/being traversed/VBN/traversed from/IN/from within/IN/within the/DT/the hooks/NNP/hooks. the/DT/the public/NN/public tree/NN/tree /:/( /:/) method/NN/method of/IN/of the/DT/the eulertour/NN/eulertour class/NN/class serves/NNS/serves as/IN/as an/DT/an accessor/NN/accessor for/IN/for that/DT/that tree/NNP/tree. finally/RB/finally /,/, the/DT/the task/NN/task of/IN/of computing/NN/computing disk/NN/disk space/NN/space /,/, as/IN/as originally/RB/originally implemented/VBN/implemented in/IN/in code/NN/code fragment/NN/fragment 8.26/CD/8.26 /,/, can/MD/can be/VB/be performed/VBN/performed quite/RB/quite easily/RB/easily with/IN/with the/DT/the eulertour/NN/eulertour subclass/NN/subclass shown/NN/shown in/IN/in code/NN/code fragment/NN/fragment 8.32/CD/8.32. the/DT/the postvisit/NN/postvisit result/NN/result of/IN/of the/DT/the root/NN/root will/MD/will be/VB/be returned/VBN/returned by/IN/by the/DT/the call/NN/call to/TO/to execute/VB/execute /:/( /:/) /./. 1/CD/1 class/NN/class diskspacetour/NN/diskspacetour /:/( eulertour/PRP$/eulertour /NN/) /:/: 2/CD/2 def/NN/def hook/NN/hook postvisit/NN/postvisit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) /:/: 3/LS/3 #/#/# we/PRP/we simply/RB/simply add/VBP/add space/NN/space associated/VBN/associated with/IN/with p/NN/p to/TO/to that/DT/that of/IN/of its/PRP$/its subtrees/NNS/subtrees 4/CD/4 return/NN/return p.element/JJ/p.element /NN/( /:/) .space/NN/.space /:/( /:/) +/:/+ sum/NN/sum /:/( results/NNS/results /VBP/) code/NN/code fragment/NN/fragment 8.32/CD/8.32 /:/: a/DT/a subclass/NN/subclass of/IN/of eulertour/PRP$/eulertour that/IN/that computes/NNS/computes disk/VBP/disk space/NN/space for/IN/for a/DT/a tree/NNP/tree. 346/CD/346 chapter/NN/chapter 8/CD/8. trees/NNS/trees the/DT/the euler/NN/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary tree/NN/tree in/IN/in section/NN/section 8.4.6/CD/8.4.6 /,/, we/PRP/we introduced/VBD/introduced the/DT/the concept/NN/concept of/IN/of an/DT/an euler/NN/euler tour/NN/tour traversal/NN/traversal of/IN/of a/DT/a general/JJ/general graph/NN/graph /,/, using/VBG/using the/DT/the template/NN/template method/NN/method pattern/NN/pattern in/IN/in designing/NN/designing the/DT/the eulertour/NN/eulertour class/NNP/class. that/IN/that class/NN/class provided/VBD/provided methods/NNS/methods hook/VBP/hook previsit/NN/previsit and/CC/and hook/NN/hook postvisit/NN/postvisit that/WDT/that could/MD/could be/VB/be overridden/VBN/overridden to/TO/to customize/VB/customize a/DT/a tour/NNP/tour. in/IN/in code/NN/code fragment/NN/fragment 8.33/CD/8.33 we/PRP/we provide/VBP/provide a/DT/a binaryeulertour/NN/binaryeulertour specialization/NN/specialization that/WDT/that includes/VBZ/includes an/DT/an additional/JJ/additional hook/NN/hook invisit/NN/invisit that/WDT/that is/VBZ/is called/VBN/called once/RB/once for/IN/for each/DT/each position/NN/position after/IN/after its/PRP$/its left/VBN/left subtree/JJ/subtree is/VBZ/is traversed/VBN/traversed /,/, but/CC/but before/IN/before its/PRP$/its right/NN/right subtree/NN/subtree is/VBZ/is traversed/NNP/traversed. our/PRP$/our implementation/NN/implementation of/IN/of binaryeulertour/PRP$/binaryeulertour replaces/NNS/replaces the/DT/the original/JJ/original tour/NN/tour utility/NN/utility to/TO/to specialize/VB/specialize to/TO/to the/DT/the case/NN/case in/IN/in which/WDT/which a/DT/a node/NN/node has/VBZ/has at/IN/at most/JJS/most two/CD/two children/NNP/children. if/IN/if a/DT/a node/NN/node has/VBZ/has only/RB/only one/CD/one child/NN/child /,/, a/DT/a tour/NN/tour differentiates/VBZ/differentiates between/IN/between whether/IN/whether that/DT/that is/VBZ/is a/DT/a left/VBN/left child/NN/child or/CC/or a/DT/a right/NN/right child/NN/child /,/, with/IN/with the/DT/the in/IN/in visit/NN/visit taking/VBG/taking place/NN/place after/IN/after the/DT/the visit/NN/visit of/IN/of a/DT/a sole/JJ/sole left/NN/left child/NN/child /,/, but/CC/but before/IN/before the/DT/the visit/NN/visit of/IN/of a/DT/a sole/JJ/sole right/NN/right child/NNP/child. in/IN/in the/DT/the case/NN/case of/IN/of a/DT/a leaf/NN/leaf /,/, the/DT/the three/CD/three hooks/NNS/hooks are/VBP/are called/VBN/called in/IN/in succession/NNP/succession. 1/CD/1 class/NN/class binaryeulertour/NN/binaryeulertour /:/( eulertour/PRP$/eulertour /NN/) /:/: 2/CD/2 abstract/NN/abstract base/NN/base class/NN/class for/IN/for performing/VBG/performing euler/JJR/euler tour/NN/tour of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. 3/CD/3 4/CD/4 this/DT/this version/NN/version includes/VBZ/includes an/DT/an additional/JJ/additional hook/NN/hook invisit/NN/invisit that/WDT/that is/VBZ/is called/VBN/called after/IN/after the/DT/the tour/NN/tour 5/CD/5 of/IN/of the/DT/the left/NN/left subtree/NN/subtree /:/( if/IN/if any/DT/any /NN/) /,/, yet/CC/yet before/IN/before the/DT/the tour/NN/tour of/IN/of the/DT/the right/NN/right subtree/NN/subtree /:/( if/IN/if any/DT/any /NN/) /./. 6/CD/6 7/CD/7 note/NN/note /:/: right/NN/right child/NN/child is/VBZ/is always/RB/always assigned/VBN/assigned index/NN/index 1/CD/1 in/IN/in path/NN/path /,/, even/RB/even if/IN/if no/DT/no left/NN/left sibling/NNP/sibling. 8/CD/8 9/CD/9 def/NN/def tour/NN/tour /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 10/CD/10 results/NNS/results =/:/= /:/[ none/NN/none /,/, none/NN/none /:/] #/#/# will/MD/will update/VB/update with/IN/with results/NNS/results of/IN/of recursions/NNS/recursions 11/CD/11 self/NNP/self. hook/NN/hook previsit/NN/previsit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) #/#/# pre/NN/pre visit/NN/visit for/IN/for p/NN/p 12/CD/12 if/IN/if self/NNP/self. tree.left/NNP/tree.left /NNP/( p/NN/p /:/) is/VBZ/is not/RB/not none/NN/none /:/: #/#/# consider/NN/consider left/VBD/left child/NN/child 13/CD/13 path.append/JJ/path.append /NN/( 0/-NONE-/0 /./) 14/CD/14 results/NNS/results /:/[ 0/-NONE-/0 /:/] =/:/= self/NNP/self. tour/PRP$/tour /NNP/( self/NNP/self. tree.left/NNP/tree.left /NNP/( p/NN/p /:/) /,/, d/VBD/d +/:/+ 1/CD/1 /,/, path/NN/path /:/) 15/CD/15 path.pop/JJ/path.pop /NN/( /:/) 16/CD/16 self/NNP/self. hook/NN/hook invisit/NN/invisit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) #/#/# in/IN/in visit/NN/visit for/IN/for p/NN/p 17/CD/17 if/IN/if self/NNP/self. tree.right/JJ/tree.right /NN/( p/NN/p /:/) is/VBZ/is not/RB/not none/NN/none /:/: #/#/# consider/NN/consider right/RB/right child/NN/child 18/CD/18 path.append/JJ/path.append /NN/( 1/CD/1 /CD/) 19/CD/19 results/NNS/results /:/[ 1/CD/1 /CD/] =/CD/= self/NNP/self. tour/PRP$/tour /NNP/( self/NNP/self. tree.right/NNP/tree.right /NNP/( p/NN/p /:/) /,/, d/VBD/d +/:/+ 1/CD/1 /,/, path/NN/path /:/) 20/CD/20 path.pop/JJ/path.pop /NN/( /:/) 21/CD/21 answer/NN/answer =/:/= self/NNP/self. hook/NN/hook postvisit/NN/postvisit /:/( p/NN/p /,/, d/VBD/d /,/, path/NN/path /,/, results/NNS/results /:/) #/#/# post/NN/post visit/NN/visit p/NN/p 22/CD/22 return/NN/return answer/NN/answer 23/CD/23 24/CD/24 def/NN/def hook/NN/hook invisit/NN/invisit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: pass/NN/pass #/#/# can/MD/can be/VB/be overridden/VBN/overridden code/NN/code fragment/NN/fragment 8.33/CD/8.33 /:/: a/DT/a binaryeulertour/NN/binaryeulertour base/NN/base class/NN/class providing/VBG/providing a/DT/a specialized/JJ/specialized tour/NN/tour for/IN/for binary/JJ/binary trees/NNP/trees. the/DT/the original/JJ/original eulertour/NN/eulertour base/NN/base class/NN/class was/VBD/was given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.28/CD/8.28. 8.4/CD/8.4. tree/NN/tree traversal/NN/traversal algorithms/NNS/algorithms 347/CD/347 3/CD/3 2/CD/2 1/CD/1 0/-NONE-/0 0/-NONE-/0 1/CD/1 2/CD/2 3/CD/3 4/CD/4 5/CD/5 6/CD/6 7/CD/7 8/CD/8 9/CD/9 10/CD/10 11/CD/11 12/CD/12 4/CD/4 figure/NN/figure 8.22/CD/8.22 /:/: an/DT/an inorder/NN/inorder drawing/VBG/drawing of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. to/TO/to demonstrate/VB/demonstrate use/NN/use of/IN/of the/DT/the binaryeulertour/NN/binaryeulertour framework/NN/framework /,/, we/PRP/we develop/VB/develop a/DT/a subclass/NN/subclass that/WDT/that computes/VBZ/computes a/DT/a graphical/JJ/graphical layout/NN/layout of/IN/of a/DT/a binary/JJ/binary tree/NN/tree /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 8.22/CD/8.22. the/DT/the geometry/NN/geometry is/VBZ/is determined/VBN/determined by/IN/by an/DT/an algorithm/NN/algorithm that/IN/that assigns/NNS/assigns x/-NONE-/x- and/CC/and y-coordinates/NNS/y-coordinates to/TO/to each/DT/each position/NN/position p/NN/p of/IN/of a/DT/a binary/JJ/binary tree/NN/tree t/NN/t using/VBG/using the/DT/the following/VBG/following two/CD/two rules/NNS/rules /:/: x/NN/x /:/( p/NN/p /:/) is/VBZ/is the/DT/the number/NN/number of/IN/of positions/NNS/positions visited/VBN/visited before/IN/before p/NN/p in/IN/in an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of t/NNP/t. y/NN/y /:/( p/NN/p /:/) is/VBZ/is the/DT/the depth/NN/depth of/IN/of p/NN/p in/IN/in t/NNP/t. in/IN/in this/DT/this application/NN/application /,/, we/PRP/we take/VBP/take the/DT/the convention/NN/convention common/JJ/common in/IN/in computer/NN/computer graphics/NNS/graphics that/WDT/that xcoordinates/VBZ/xcoordinates increase/NN/increase left/VBN/left to/TO/to right/RB/right and/CC/and y-coordinates/NNS/y-coordinates increase/VB/increase top/JJ/top to/TO/to bottom/NNP/bottom. so/RB/so the/DT/the origin/NN/origin is/VBZ/is in/IN/in the/DT/the upper/JJ/upper left/NN/left corner/NN/corner of/IN/of the/DT/the computer/NN/computer screen/NNP/screen. code/NN/code fragment/NN/fragment 8.34/CD/8.34 provides/NNS/provides an/DT/an implementation/NN/implementation of/IN/of a/DT/a binarylayout/NN/binarylayout subclass/NN/subclass that/WDT/that implements/VBZ/implements the/DT/the above/NN/above algorithm/NN/algorithm for/IN/for assigning/NN/assigning /:/( x,y/JJ/x,y /NN/) coordinates/NNS/coordinates to/TO/to the/DT/the element/NN/element stored/VBD/stored at/IN/at each/DT/each position/NN/position of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. we/PRP/we adapt/VBD/adapt the/DT/the binaryeulertour/NN/binaryeulertour framework/NN/framework by/IN/by introducing/NN/introducing additional/JJ/additional state/NN/state in/IN/in the/DT/the form/NN/form of/IN/of a/DT/a count/NN/count instance/NN/instance variable/JJ/variable that/IN/that represents/NNS/represents the/DT/the number/NN/number of/IN/of in/IN/in visits/NNS/visits that/WDT/that we/PRP/we have/VBP/have performed/NNP/performed. the/DT/the x-coordinate/JJ/x-coordinate for/IN/for each/DT/each position/NN/position is/VBZ/is set/VBN/set according/VBG/according to/TO/to that/DT/that counter/NNP/counter. 1/CD/1 class/NN/class binarylayout/IN/binarylayout /CD/( binaryeulertour/PRP$/binaryeulertour /NN/) /:/: 2/CD/2 class/NN/class for/IN/for computing/NN/computing /:/( x,y/JJ/x,y /NN/) coordinates/NNS/coordinates for/IN/for each/DT/each node/NN/node of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. 3/CD/3 def/NN/def init/NN/init /:/( self/NN/self /,/, tree/NN/tree /:/) /:/: 4/CD/4 super/NN/super /:/( /:/) /./. init/NN/init /:/( tree/NN/tree /:/) #/#/# must/MD/must call/VB/call the/DT/the parent/NN/parent constructor/NN/constructor 5/CD/5 self/NNP/self. count/NN/count =/:/= 0/-NONE-/0 #/#/# initialize/NN/initialize count/NN/count of/IN/of processed/VBN/processed nodes/NNS/nodes 6/CD/6 7/CD/7 def/NN/def hook/NN/hook invisit/NN/invisit /:/( self/NN/self /,/, p/NN/p /,/, d/VBD/d /,/, path/NN/path /:/) /:/: 8/CD/8 p.element/JJ/p.element /NN/( /:/) .setx/JJ/.setx /NN/( self/NNP/self. count/NN/count /:/) #/#/# x-coordinate/JJ/x-coordinate serialized/JJ/serialized by/IN/by count/NN/count 9/CD/9 p.element/JJ/p.element /NN/( /:/) .sety/NN/.sety /:/( d/NN/d /:/) #/#/# y-coordinate/JJ/y-coordinate is/VBZ/is depth/JJ/depth 10/CD/10 self/NNP/self. count/NN/count +/:/+ =/:/= 1/CD/1 #/#/# advance/NN/advance count/NN/count of/IN/of processed/VBN/processed nodes/NNS/nodes code/VBP/code fragment/NN/fragment 8.34/CD/8.34 /:/: a/DT/a binarylayout/NN/binarylayout class/NN/class that/WDT/that computes/VBZ/computes coordinates/VBZ/coordinates at/IN/at which/WDT/which to/TO/to draw/VB/draw positions/NNS/positions of/IN/of a/DT/a binary/JJ/binary tree/NNP/tree. we/PRP/we assume/VBP/assume that/IN/that the/DT/the element/NN/element type/NN/type for/IN/for the/DT/the original/JJ/original tree/NN/tree supports/NNS/supports setx/VBP/setx and/CC/and sety/NN/sety methods/NNP/methods. 348/CD/348 chapter/NN/chapter 8/CD/8. trees/NNS/trees 8.5/CD/8.5 case/NN/case study/NN/study /:/: an/DT/an expression/NN/expression tree/NN/tree in/IN/in example/NN/example 8.7/CD/8.7 /,/, we/PRP/we introduced/VBD/introduced the/DT/the use/NN/use of/IN/of a/DT/a binary/JJ/binary tree/NN/tree to/TO/to represent/VB/represent the/DT/the structure/NN/structure of/IN/of an/DT/an arithmetic/JJ/arithmetic expression/NNP/expression. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we define/VBP/define a/DT/a new/JJ/new expressiontree/NN/expressiontree class/NN/class that/WDT/that provides/VBZ/provides support/NN/support for/IN/for constructing/NN/constructing such/JJ/such trees/NNS/trees /,/, and/CC/and for/IN/for displaying/NN/displaying and/CC/and evaluating/VBG/evaluating the/DT/the arithmetic/JJ/arithmetic expression/NN/expression that/WDT/that such/JJ/such a/DT/a tree/NN/tree represents/NNP/represents. our/PRP$/our expressiontree/NN/expressiontree class/NN/class is/VBZ/is defined/VBN/defined as/RB/as a/DT/a subclass/NN/subclass of/IN/of linkedbinarytree/JJ/linkedbinarytree /,/, and/CC/and we/PRP/we rely/RB/rely on/IN/on the/DT/the nonpublic/JJ/nonpublic mutators/NNS/mutators to/TO/to construct/VB/construct such/JJ/such trees/NNP/trees. each/DT/each internal/JJ/internal node/NN/node must/MD/must store/VB/store a/DT/a string/NN/string that/WDT/that defines/VBZ/defines a/DT/a binary/JJ/binary operator/NN/operator /:/( e.g/NNP/e.g. /,/, +/NNP/+ /NNP/) /,/, and/CC/and each/DT/each leaf/NN/leaf must/MD/must store/VB/store a/DT/a numeric/JJ/numeric value/NN/value /:/( or/CC/or a/DT/a string/NN/string representing/VBG/representing a/DT/a numeric/JJ/numeric value/NN/value /:/) /./. our/PRP$/our eventual/JJ/eventual goal/NN/goal is/VBZ/is to/TO/to build/VB/build arbitrarily/RB/arbitrarily complex/JJ/complex expression/NN/expression trees/NNS/trees for/IN/for compound/NN/compound arithmetic/JJ/arithmetic expressions/NNS/expressions such/JJ/such as/IN/as /NNP/( /NNP/( /NNP/( 3/CD/3 +/CD/+ 1/CD/1 /CD/) 4/CD/4 /CD/) //CD// /CD/( /CD/( 9/CD/9 5/CD/5 /CD/) +/CD/+ 2/CD/2 /CD/) /CD/) /./. however/RB/however /,/, it/PRP/it suffices/VBZ/suffices for/IN/for the/DT/the expressiontree/NN/expressiontree class/NN/class to/TO/to support/VB/support two/CD/two basic/JJ/basic forms/NNS/forms of/IN/of initialization/NN/initialization /:/: expressiontree/JJ/expressiontree /NN/( value/NN/value /:/) /:/: create/JJ/create a/DT/a tree/NN/tree storing/VBG/storing the/DT/the given/VBN/given value/NN/value at/IN/at the/DT/the root/NNP/root. expressiontree/NN/expressiontree /:/( op,e1,e2/-NONE-/op,e1,e2 /:/) /:/: create/JJ/create a/DT/a tree/NN/tree storing/VBG/storing string/NN/string op/NN/op at/IN/at the/DT/the root/NN/root /:/( e.g/NNP/e.g. /,/, +/NNP/+ /NNP/) /,/, and/CC/and with/IN/with the/DT/the structures/NNS/structures of/IN/of existing/VBG/existing expressiontree/JJ/expressiontree instances/NNS/instances e1/NNP/e1 and/CC/and e2/NNP/e2 as/IN/as the/DT/the left/NN/left and/CC/and right/RB/right subtrees/VBZ/subtrees of/IN/of the/DT/the root/NN/root /,/, respectively/NNP/respectively. such/JJ/such a/DT/a constructor/NN/constructor for/IN/for the/DT/the expressiontree/NN/expressiontree class/NN/class is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.35/CD/8.35. the/DT/the class/NN/class formally/RB/formally inherits/VBZ/inherits from/IN/from linkedbinarytree/JJ/linkedbinarytree /,/, so/RB/so it/PRP/it has/VBZ/has access/NN/access to/TO/to all/DT/all the/DT/the nonpublic/JJ/nonpublic update/NN/update methods/NNS/methods that/WDT/that were/VBD/were defined/VBN/defined in/IN/in section/NN/section 8.3.1/CD/8.3.1. we/PRP/we use/VBP/use add/VBN/add root/NN/root to/TO/to create/VB/create an/DT/an initial/JJ/initial root/NN/root of/IN/of the/DT/the tree/NN/tree storing/VBG/storing the/DT/the token/NN/token provided/VBD/provided as/IN/as the/DT/the first/JJ/first parameter/NNP/parameter. then/RB/then we/PRP/we perform/VBP/perform run-time/JJ/run-time checking/NN/checking of/IN/of the/DT/the parameters/NNS/parameters to/TO/to determine/VB/determine whether/IN/whether the/DT/the caller/NN/caller invoked/VBD/invoked the/DT/the one-parameter/JJ/one-parameter version/NN/version of/IN/of the/DT/the constructor/NN/constructor /:/( in/IN/in which/WDT/which case/NN/case /,/, we/PRP/we are/VBP/are done/VBN/done /-NONE-/) /,/, or/CC/or the/DT/the three-parameter/JJ/three-parameter form/NNP/form. in/IN/in that/DT/that case/NN/case /,/, we/PRP/we use/VBP/use the/DT/the inherited/VBN/inherited attach/NN/attach method/NN/method to/TO/to incorporate/VB/incorporate the/DT/the structure/NN/structure of/IN/of the/DT/the existing/VBG/existing trees/NNS/trees as/IN/as subtrees/NNS/subtrees of/IN/of the/DT/the root/NNP/root. composing/NN/composing a/DT/a parenthesized/JJ/parenthesized string/NN/string representation/NN/representation a/DT/a string/NN/string representation/NN/representation of/IN/of an/DT/an existing/VBG/existing expression/NN/expression tree/NN/tree instance/NN/instance /,/, for/IN/for example/NN/example /,/, as/IN/as /NNP/( /NNP/( /NNP/( 3/CD/3 +/CD/+ 1/CD/1 /CD/) x4/NNP/x4 /NNP/) //NNP// /NNP/( /NNP/( 9-5/CD/9-5 /CD/) +/CD/+ 2/CD/2 /CD/) /CD/) /,/, can/MD/can be/VB/be produced/VBN/produced by/IN/by displaying/NN/displaying tree/NN/tree elements/NNS/elements using/VBG/using an/DT/an inorder/NN/inorder traversal/NN/traversal /,/, but/CC/but with/IN/with opening/VBG/opening and/CC/and closing/JJ/closing parentheses/NNS/parentheses inserted/VBN/inserted with/IN/with a/DT/a preorder/NN/preorder and/CC/and postorder/NN/postorder step/VB/step /,/, respectively/NNP/respectively. in/IN/in the/DT/the context/NN/context of/IN/of an/DT/an expressiontree/JJ/expressiontree class/NN/class /,/, we/PRP/we support/VBP/support a/DT/a special/JJ/special str/NN/str method/NN/method /:/( see/NN/see section/NN/section 2.3.2/CD/2.3.2 /CD/) that/WDT/that returns/NNS/returns the/DT/the appropriate/JJ/appropriate string/NNP/string. because/IN/because it/PRP/it is/VBZ/is more/RBR/more efficient/JJ/efficient to/TO/to first/JJ/first build/NN/build a/DT/a sequence/NN/sequence of/IN/of individual/JJ/individual strings/NNS/strings to/TO/to be/VB/be joined/VBN/joined together/RP/together /:/( see/VB/see discussion/NN/discussion of/IN/of composing/VBG/composing strings/NNS/strings in/IN/in section/NN/section 5.4.2/CD/5.4.2 /CD/) /,/, the/DT/the implementation/NN/implementation of/IN/of str/NN/str relies/NNS/relies on/IN/on a/DT/a nonpublic/JJ/nonpublic /,/, recursive/JJ/recursive method/NN/method named/VBD/named parenthesize/NN/parenthesize recur/NN/recur that/WDT/that appends/VBZ/appends a/DT/a series/NN/series of/IN/of strings/NNS/strings to/TO/to a/DT/a list/NNP/list. these/DT/these methods/NNS/methods are/VBP/are included/VBN/included in/IN/in code/NN/code 8.35/CD/8.35. 8.5/CD/8.5. case/NN/case study/NN/study /:/: an/DT/an expression/NN/expression tree/NN/tree 349/CD/349 1/CD/1 class/NN/class expressiontree/NN/expressiontree /:/( linkedbinarytree/NN/linkedbinarytree /:/) /:/: 2/CD/2 an/DT/an arithmetic/JJ/arithmetic expression/NN/expression tree/NNP/tree. 3/CD/3 4/CD/4 def/NN/def init/NN/init /:/( self/NN/self /,/, token/VBN/token /,/, left/VBN/left =/-NONE-/= none/NN/none /,/, right/RB/right =/:/= none/NN/none /:/) /:/: 5/CD/5 create/NN/create an/DT/an expression/NN/expression tree/NNP/tree. 6/CD/6 7/CD/7 in/IN/in a/DT/a single/JJ/single parameter/NN/parameter form/NN/form /,/, token/VBN/token should/MD/should be/VB/be a/DT/a leaf/NN/leaf value/NN/value /:/( e.g/NNP/e.g. /,/, 42/CD/42 /:/) /,/, 8/CD/8 and/CC/and the/DT/the expression/NN/expression tree/NN/tree will/MD/will have/VB/have that/DT/that value/NN/value at/IN/at an/DT/an isolated/VBN/isolated node/NNP/node. 9/CD/9 10/CD/10 in/IN/in a/DT/a three-parameter/JJ/three-parameter version/NN/version /,/, token/VBN/token should/MD/should be/VB/be an/DT/an operator/NN/operator /,/, 11/CD/11 and/CC/and left/VBN/left and/CC/and right/RB/right should/MD/should be/VB/be existing/VBG/existing expressiontree/JJ/expressiontree instances/NNS/instances 12/CD/12 that/WDT/that become/NN/become the/DT/the operands/NNS/operands for/IN/for the/DT/the binary/JJ/binary operator/NNP/operator. 13/CD/13 14/CD/14 super/NN/super /:/( /:/) /./. init/NN/init /:/( /:/) #/#/# linkedbinarytree/JJ/linkedbinarytree initialization/NN/initialization 15/CD/15 if/IN/if not/RB/not isinstance/NN/isinstance /:/( token/NN/token /,/, str/NN/str /:/) /:/: 16/CD/16 raise/NN/raise typeerror/NN/typeerror /:/( token/NN/token must/MD/must be/VB/be a/DT/a string/NN/string /:/) 17/CD/17 self/NNP/self. add/NN/add root/NN/root /:/( token/NN/token /:/) #/#/# use/NN/use inherited/VBD/inherited /,/, nonpublic/JJ/nonpublic method/NN/method 18/CD/18 if/IN/if left/VBN/left is/VBZ/is not/RB/not none/NN/none /:/: #/#/# presumably/RB/presumably three-parameter/JJ/three-parameter form/NN/form 19/CD/19 if/IN/if token/JJ/token not/RB/not in/IN/in +/NNP/+ /:/- */-NONE-/* x//-NONE-/x/ /:/: 20/CD/20 raise/NN/raise valueerror/NN/valueerror /:/( token/NN/token must/MD/must be/VB/be valid/VBN/valid operator/NN/operator /:/) 21/CD/21 self/NNP/self. attach/NN/attach /:/( self.root/JJ/self.root /NN/( /:/) /,/, left/VBN/left /,/, right/RB/right /:/) #/#/# use/NN/use inherited/VBD/inherited /,/, nonpublic/JJ/nonpublic method/NN/method 22/CD/22 23/CD/23 def/NN/def str/NN/str /:/( self/NN/self /:/) /:/: 24/CD/24 return/NN/return string/VBG/string representation/NN/representation of/IN/of the/DT/the expression/NNP/expression. 25/CD/25 pieces/NNS/pieces =/:/= /:/[ /:/] #/#/# sequence/NN/sequence of/IN/of piecewise/NN/piecewise strings/NNS/strings to/TO/to compose/VB/compose 26/CD/26 self/NNP/self. parenthesize/NN/parenthesize recur/NN/recur /:/( self.root/JJ/self.root /NN/( /:/) /,/, pieces/NNS/pieces /:/) 27/CD/27 return/NN/return .join/JJ/.join /NN/( pieces/NNS/pieces /:/) 28/CD/28 29/CD/29 def/NN/def parenthesize/NN/parenthesize recur/NN/recur /:/( self/NN/self /,/, p/NN/p /,/, result/NN/result /:/) /:/: 30/CD/30 append/NN/append piecewise/NN/piecewise representation/NN/representation of/IN/of p/NN/p s/NNS/s subtree/VBP/subtree to/TO/to resulting/VBG/resulting list/NNP/list. 31/CD/31 if/IN/if self.is/NNP/self.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: 32/CD/32 result.append/JJ/result.append /NN/( str/NN/str /:/( p.element/JJ/p.element /NN/( /:/) /:/) /:/) #/#/# leaf/NN/leaf value/NN/value as/IN/as a/DT/a string/NN/string 33/CD/33 else/NN/else /:/: 34/CD/34 result.append/JJ/result.append /NN/( /:/( /:/) #/#/# opening/VBG/opening parenthesis/NN/parenthesis 35/CD/35 self/NNP/self. parenthesize/NN/parenthesize recur/NN/recur /:/( self.left/JJ/self.left /NN/( p/NN/p /:/) /,/, result/NN/result /:/) #/#/# left/VBN/left subtree/NN/subtree 36/CD/36 result.append/JJ/result.append /NN/( p.element/JJ/p.element /NN/( /:/) /:/) #/#/# operator/NN/operator 37/CD/37 self/NNP/self. parenthesize/NN/parenthesize recur/NN/recur /:/( self.right/JJ/self.right /NN/( p/NN/p /:/) /,/, result/NN/result /:/) #/#/# right/RB/right subtree/JJ/subtree 38/CD/38 result.append/JJ/result.append /NN/( /:/) /:/) #/#/# closing/JJ/closing parenthesis/NN/parenthesis code/NN/code fragment/NN/fragment 8.35/CD/8.35 /:/: the/DT/the beginning/NN/beginning of/IN/of an/DT/an expressiontree/JJ/expressiontree class/NNP/class. 350/CD/350 chapter/NN/chapter 8/CD/8. trees/NNS/trees expression/NN/expression tree/NN/tree evaluation/NN/evaluation the/DT/the numeric/JJ/numeric evaluation/NN/evaluation of/IN/of an/DT/an expression/NN/expression tree/NN/tree can/MD/can be/VB/be accomplished/VBN/accomplished with/IN/with a/DT/a simple/JJ/simple application/NN/application of/IN/of a/DT/a postorder/NN/postorder traversal/NNP/traversal. if/IN/if we/PRP/we know/VBP/know the/DT/the values/NNS/values represented/VBD/represented by/IN/by the/DT/the two/CD/two subtrees/NNS/subtrees of/IN/of an/DT/an internal/JJ/internal position/NN/position /,/, we/PRP/we can/MD/can calculate/VB/calculate the/DT/the result/NN/result of/IN/of the/DT/the computation/NN/computation that/IN/that position/NN/position designates/NNP/designates. pseudo-code/NNP/pseudo-code for/IN/for the/DT/the recursive/JJ/recursive evaluation/NN/evaluation of/IN/of the/DT/the value/NN/value represented/VBD/represented by/IN/by a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.36/CD/8.36. algorithm/NN/algorithm evaluate/NN/evaluate recur/NN/recur /:/( p/NN/p /:/) /:/: if/IN/if p/NN/p is/VBZ/is a/DT/a leaf/NN/leaf then/RB/then return/NN/return the/DT/the value/NN/value stored/VBD/stored at/IN/at p/NN/p else/RB/else let/VB/let be/VB/be the/DT/the operator/NN/operator stored/VBD/stored at/IN/at p/NN/p x/NN/x =/:/= evaluate/NN/evaluate recur/NN/recur /:/( left/VBN/left /-NONE-/( p/NN/p /:/) /:/) y/NN/y =/:/= evaluate/NN/evaluate recur/NN/recur /:/( right/NN/right /:/( p/NN/p /:/) /:/) return/NN/return x/NN/x y/NN/y code/NN/code fragment/NN/fragment 8.36/CD/8.36 /:/: algorithm/NN/algorithm evaluate/NN/evaluate recur/NN/recur for/IN/for evaluating/NN/evaluating the/DT/the expression/NN/expression represented/VBD/represented by/IN/by a/DT/a subtree/JJ/subtree of/IN/of an/DT/an arithmetic/JJ/arithmetic expression/NN/expression tree/NN/tree rooted/VBD/rooted at/IN/at position/NN/position p/NNP/p. to/TO/to implement/VB/implement this/DT/this algorithm/NN/algorithm in/IN/in the/DT/the context/NN/context of/IN/of a/DT/a python/NN/python expressiontree/NN/expressiontree class/NN/class /,/, we/PRP/we provide/VBP/provide a/DT/a public/JJ/public evaluate/NN/evaluate method/NN/method that/WDT/that is/VBZ/is invoked/VBN/invoked on/IN/on instance/NN/instance t/NN/t as/IN/as t.evaluate/JJ/t.evaluate /NN/( /:/) /./. code/NN/code fragment/NN/fragment 8.37/CD/8.37 provides/NNS/provides such/JJ/such an/DT/an implementation/NN/implementation /,/, relying/VBG/relying on/IN/on a/DT/a nonpublic/JJ/nonpublic evaluate/NN/evaluate recur/NN/recur method/NN/method that/WDT/that computes/VBZ/computes the/DT/the value/NN/value of/IN/of a/DT/a designated/VBN/designated subtree/NNP/subtree. 39/CD/39 def/NN/def evaluate/NN/evaluate /:/( self/NN/self /:/) /:/: 40/CD/40 return/NN/return the/DT/the numeric/JJ/numeric result/NN/result of/IN/of the/DT/the expression/NNP/expression. 41/CD/41 return/NN/return self/NNP/self. evaluate/NN/evaluate recur/NN/recur /:/( self.root/JJ/self.root /NN/( /:/) /:/) 42/CD/42 43/CD/43 def/NN/def evaluate/NN/evaluate recur/NN/recur /:/( self/NN/self /,/, p/NN/p /:/) /:/: 44/CD/44 return/NN/return the/DT/the numeric/JJ/numeric result/NN/result of/IN/of subtree/NN/subtree rooted/VBN/rooted at/IN/at p/NNP/p. 45/CD/45 if/IN/if self.is/NNP/self.is leaf/NN/leaf /:/( p/NN/p /:/) /:/: 46/CD/46 return/NN/return float/NN/float /:/( p.element/JJ/p.element /NN/( /:/) /:/) #/#/# we/PRP/we assume/VBP/assume element/NN/element is/VBZ/is numeric/JJ/numeric 47/CD/47 else/NN/else /:/: 48/CD/48 op/NN/op =/:/= p.element/JJ/p.element /NN/( /:/) 49/CD/49 left/NN/left val/NN/val =/:/= self/NNP/self. evaluate/NN/evaluate recur/NN/recur /:/( self.left/JJ/self.left /NN/( p/NN/p /:/) /:/) 50/CD/50 right/NN/right val/NN/val =/:/= self/NNP/self. evaluate/NN/evaluate recur/NN/recur /:/( self.right/JJ/self.right /NN/( p/NN/p /:/) /:/) 51/CD/51 if/IN/if op/NN/op =/:/= =/:/= +/:/+ /:/: return/NN/return left/VBD/left val/NN/val +/:/+ right/NN/right val/NN/val 52/CD/52 elif/NN/elif op/NN/op =/:/= =/:/= /:/- /:/: return/NN/return left/VBD/left val/NN/val right/RB/right val/JJ/val 53/CD/53 elif/NN/elif op/NN/op =/:/= =/:/= //:// /:/: return/NN/return left/VBD/left val/NN/val //:// right/NN/right val/NN/val 54/CD/54 else/NN/else /:/: return/NN/return left/VBD/left val/NN/val right/RB/right val/JJ/val #/#/# treat/NN/treat x/NN/x or/CC/or as/IN/as multiplication/NN/multiplication code/NN/code fragment/NN/fragment 8.37/CD/8.37 /:/: support/NN/support for/IN/for evaluating/NN/evaluating an/DT/an expressiontree/NN/expressiontree instance/NNP/instance. 8.5/CD/8.5. case/NN/case study/NN/study /:/: an/DT/an expression/NN/expression tree/NN/tree 351/CD/351 building/NN/building an/DT/an expression/NN/expression tree/NN/tree the/DT/the constructor/NN/constructor for/IN/for the/DT/the expressiontree/NN/expressiontree class/NN/class /,/, from/IN/from code/NN/code fragment/NN/fragment 8.35/CD/8.35 /,/, provides/VBZ/provides basic/JJ/basic functionality/NN/functionality for/IN/for combining/NN/combining existing/VBG/existing trees/NNS/trees to/TO/to build/VB/build larger/JJR/larger expression/NN/expression trees/NNP/trees. however/RB/however /,/, the/DT/the question/NN/question still/RB/still remains/VBZ/remains how/WRB/how to/TO/to construct/VB/construct a/DT/a tree/NN/tree that/WDT/that represents/VBZ/represents an/DT/an expression/NN/expression for/IN/for a/DT/a given/VBN/given string/VBG/string /,/, such/JJ/such as/IN/as /NNP/( /NNP/( /NNP/( 3/CD/3 +/CD/+ 1/CD/1 /CD/) x4/NNP/x4 /NNP/) //NNP// /NNP/( /NNP/( 9-5/CD/9-5 /CD/) +/CD/+ 2/CD/2 /CD/) /CD/) /./. to/TO/to automate/VB/automate this/DT/this process/NN/process /,/, we/PRP/we rely/RB/rely on/IN/on a/DT/a bottom-up/JJ/bottom-up construction/NN/construction algorithm/NN/algorithm /,/, assuming/VBG/assuming that/IN/that a/DT/a string/NN/string can/MD/can first/RB/first be/VB/be tokenized/VBN/tokenized so/RB/so that/IN/that multidigit/NN/multidigit numbers/NNS/numbers are/VBP/are treated/VBN/treated atomically/RB/atomically /:/( see/VB/see exercise/NN/exercise r-8.30/-NONE-/r-8.30 /./) /,/, and/CC/and that/IN/that the/DT/the expression/NN/expression is/VBZ/is fully/RB/fully parenthesized/NNP/parenthesized. the/DT/the algorithm/NN/algorithm uses/VBZ/uses a/DT/a stack/NN/stack s/VBZ/s while/IN/while scanning/VBG/scanning tokens/NNS/tokens of/IN/of the/DT/the input/NN/input expression/NN/expression e/NN/e to/TO/to find/VB/find values/NNS/values /,/, operators/NNS/operators /,/, and/CC/and right/RB/right parentheses/NNP/parentheses. /:/( left/VBN/left parentheses/NNS/parentheses are/VBP/are ignored/NNP/ignored. /NNP/) when/WRB/when we/PRP/we see/VBP/see an/DT/an operator/NN/operator /,/, we/PRP/we push/VBP/push that/IN/that string/VBG/string on/IN/on the/DT/the stack/NNP/stack. when/WRB/when we/PRP/we see/VBP/see a/DT/a literal/JJ/literal value/NN/value v/NN/v /,/, we/PRP/we create/VBP/create a/DT/a single-node/JJ/single-node expression/NN/expression tree/NN/tree t/NN/t storing/VBG/storing v/NN/v /,/, and/CC/and push/VB/push t/NN/t on/IN/on the/DT/the stack/NNP/stack. when/WRB/when we/PRP/we see/VBP/see a/DT/a right/NN/right parenthesis/NN/parenthesis /,/, /:/) /,/, we/PRP/we pop/VBP/pop the/DT/the top/JJ/top three/CD/three items/NNS/items from/IN/from the/DT/the stack/NN/stack s/VBZ/s /,/, which/WDT/which represent/NN/represent a/DT/a subexpression/NN/subexpression /:/( e1/NNP/e1 e2/NNP/e2 /NNP/) /./. we/PRP/we then/RB/then construct/VB/construct a/DT/a tree/NN/tree t/NN/t using/VBG/using trees/NNS/trees for/IN/for e1/NNP/e1 and/CC/and e2/NNP/e2 as/IN/as subtrees/NNS/subtrees of/IN/of the/DT/the root/NN/root storing/VBG/storing /,/, and/CC/and push/VB/push the/DT/the resulting/VBG/resulting tree/NN/tree t/NN/t back/RB/back on/IN/on the/DT/the stack/NNP/stack. we/PRP/we repeat/VBP/repeat this/DT/this until/IN/until the/DT/the expression/NN/expression e/NN/e has/VBZ/has been/VBN/been processed/VBN/processed /,/, at/IN/at which/WDT/which time/NN/time the/DT/the top/JJ/top element/NN/element on/IN/on the/DT/the stack/NN/stack is/VBZ/is the/DT/the expression/NN/expression tree/NN/tree for/IN/for e/NNP/e. the/DT/the total/JJ/total running/NN/running time/NN/time is/VBZ/is o/RB/o /:/( n/NN/n /:/) /./. an/DT/an implementation/NN/implementation of/IN/of this/DT/this algorithm/NN/algorithm is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.38/CD/8.38 in/IN/in the/DT/the form/NN/form of/IN/of a/DT/a stand-alone/JJ/stand-alone function/NN/function named/VBD/named build/NN/build expression/NN/expression tree/NN/tree /,/, which/WDT/which produces/NNS/produces and/CC/and returns/NNS/returns an/DT/an appropriate/JJ/appropriate expressiontree/NN/expressiontree instance/NN/instance /,/, assuming/VBG/assuming the/DT/the input/NN/input has/VBZ/has been/VBN/been tokenized/NNP/tokenized. 1/CD/1 def/NN/def build/NN/build expression/NN/expression tree/NN/tree /:/( tokens/NNS/tokens /VBP/) /:/: 2/CD/2 returns/NNS/returns an/DT/an expressiontree/JJ/expressiontree based/VBN/based upon/IN/upon by/IN/by a/DT/a tokenized/JJ/tokenized expression/NNP/expression. 3/CD/3 s/NNS/s =/:/= /:/[ /:/] #/#/# we/PRP/we use/VBP/use python/NN/python list/NN/list as/IN/as stack/NN/stack 4/CD/4 for/IN/for t/NN/t in/IN/in tokens/NNS/tokens /:/: 5/CD/5 if/IN/if t/NN/t in/IN/in +/NNP/+ -x/NNP/-x */-NONE-/* //:// /:/: #/#/# t/NN/t is/VBZ/is an/DT/an operator/NN/operator symbol/NN/symbol 6/CD/6 s.append/NN/s.append /:/( t/NN/t /:/) #/#/# push/NN/push the/DT/the operator/NN/operator symbol/NN/symbol in/IN/in chapter/NN/chapter 8/CD/8 we/PRP/we introduced/VBD/introduced the/DT/the tree/NN/tree data/NNS/data structure/NN/structure and/CC/and demonstrated/VBD/demonstrated a/DT/a variety/NN/variety of/IN/of applications/NNP/applications. one/CD/one important/JJ/important use/NN/use is/VBZ/is as/IN/as a/DT/a search/NN/search tree/NN/tree /:/( as/IN/as described/VBN/described on/IN/on page/NN/page 332/CD/332 /CD/) /./. in/IN/in this/DT/this chapter/NN/chapter /,/, we/PRP/we use/VBP/use a/DT/a search/NN/search tree/NN/tree structure/NN/structure to/TO/to efficiently/RB/efficiently implement/JJ/implement a/DT/a sorted/JJ/sorted map/NNP/map. the/DT/the three/CD/three most/JJS/most fundamental/JJ/fundamental methods/NNS/methods of/IN/of a/DT/a map/NN/map m/NN/m /:/( see/NN/see section/NN/section 10.1.1/CD/10.1.1 /CD/) are/VBP/are /:/: m/NN/m /:/[ k/NN/k /:/] /:/: return/NN/return the/DT/the value/NN/value v/NN/v associated/VBN/associated with/IN/with key/JJ/key k/NN/k in/IN/in map/NN/map m/NN/m /,/, if/IN/if one/CD/one exists/NNS/exists ;/:/; otherwise/NN/otherwise raise/VBP/raise a/DT/a keyerror/NN/keyerror ;/:/; implemented/VBN/implemented with/IN/with getitem/NN/getitem method/NNP/method. m/NN/m /:/[ k/NN/k /:/] =/:/= v/NN/v /:/: associate/NN/associate value/NN/value v/NN/v with/IN/with key/JJ/key k/NN/k in/IN/in map/NN/map m/NN/m /,/, replacing/VBG/replacing the/DT/the existing/VBG/existing value/NN/value if/IN/if the/DT/the map/NN/map already/RB/already contains/VBZ/contains an/DT/an item/NN/item with/IN/with key/JJ/key equal/JJ/equal to/TO/to k/VB/k ;/:/; implemented/VBN/implemented with/IN/with setitem/NN/setitem method/NNP/method. del/NN/del m/NN/m /:/[ k/NN/k /:/] /:/: remove/IN/remove from/IN/from map/NN/map m/NN/m the/DT/the item/NN/item with/IN/with key/JJ/key equal/JJ/equal to/TO/to k/VB/k ;/:/; if/IN/if m/NN/m has/VBZ/has no/DT/no such/JJ/such item/NN/item /,/, then/RB/then raise/VB/raise a/DT/a keyerror/NN/keyerror ;/:/; implemented/VBN/implemented with/IN/with delitem/NN/delitem method/NNP/method. the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt includes/VBZ/includes additional/JJ/additional functionality/NN/functionality /:/( see/NN/see section/NN/section 10.3/CD/10.3 /CD/) /,/, guaranteeing/VBG/guaranteeing that/IN/that an/DT/an iteration/NN/iteration reports/VBZ/reports keys/NNS/keys in/IN/in sorted/JJ/sorted order/NN/order /,/, and/CC/and supporting/VBG/supporting additional/JJ/additional searches/NNS/searches such/JJ/such as/IN/as find/NN/find gt/NN/gt /:/( k/NN/k /:/) and/CC/and find/VB/find range/NN/range /:/( start/NN/start /,/, stop/VB/stop /:/) /./. binary/JJ/binary trees/NNS/trees are/VBP/are an/DT/an excellent/NN/excellent data/NNS/data structure/NN/structure for/IN/for storing/NN/storing items/NNS/items of/IN/of a/DT/a map/NN/map /,/, assuming/VBG/assuming we/PRP/we have/VBP/have an/DT/an order/NN/order relation/NN/relation defined/VBD/defined on/IN/on the/DT/the keys/NNP/keys. in/IN/in this/DT/this context/NN/context /,/, a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is a/DT/a binary/JJ/binary tree/NN/tree t/NN/t with/IN/with each/DT/each position/NN/position p/NN/p storing/VBG/storing a/DT/a key-value/JJ/key-value pair/NN/pair /:/( k,v/NN/k,v /:/) such/JJ/such that/IN/that /:/: keys/NNS/keys stored/VBD/stored in/IN/in the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NN/p are/VBP/are less/RBR/less than/IN/than k/NNP/k. keys/NNS/keys stored/VBD/stored in/IN/in the/DT/the right/NN/right subtree/NN/subtree of/IN/of p/NN/p are/VBP/are greater/JJR/greater than/IN/than k/NNP/k. an/DT/an example/NN/example of/IN/of such/JJ/such a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is given/VBN/given in/IN/in figure/NN/figure 11.1/CD/11.1. as/IN/as a/DT/a matter/NN/matter of/IN/of convenience/NN/convenience /,/, we/PRP/we will/MD/will not/RB/not diagram/VB/diagram the/DT/the values/NNS/values associated/VBN/associated with/IN/with keys/NNS/keys in/IN/in this/DT/this chapter/NN/chapter /,/, since/IN/since those/DT/those values/NNS/values do/VBP/do not/RB/not affect/VB/affect the/DT/the placement/NN/placement of/IN/of items/NNS/items within/IN/within a/DT/a search/NN/search tree/NNP/tree. figure/NN/figure 11.1/CD/11.1 /:/: a/DT/a binary/JJ/binary search/NN/search tree/NN/tree with/IN/with integer/JJR/integer keys/NNP/keys. we/PRP/we omit/VBP/omit the/DT/the display/NN/display of/IN/of associated/VBN/associated values/NNS/values in/IN/in this/DT/this chapter/NN/chapter /,/, since/IN/since they/PRP/they are/VBP/are not/RB/not relevant/JJ/relevant to/TO/to the/DT/the order/NN/order of/IN/of items/NNS/items within/IN/within a/DT/a search/NN/search tree/NNP/tree. /./. binary/JJ/binary search/NN/search trees/NNS/trees navigating/VBG/navigating a/DT/a binary/JJ/binary search/NN/search tree/NN/tree we/PRP/we begin/VBP/begin by/IN/by demonstrating/VBG/demonstrating that/IN/that a/DT/a binary/JJ/binary search/NN/search tree/NN/tree hierarchically/RB/hierarchically represents/VBZ/represents the/DT/the sorted/VBN/sorted order/NN/order of/IN/of its/PRP$/its keys/NNP/keys. in/IN/in particular/JJ/particular /,/, the/DT/the structural/JJ/structural property/NN/property regarding/VBG/regarding the/DT/the placement/NN/placement of/IN/of keys/NNS/keys within/IN/within a/DT/a binary/JJ/binary search/NN/search tree/NN/tree assures/NNS/assures the/DT/the following/VBG/following important/JJ/important consequence/NN/consequence regarding/VBG/regarding an/DT/an inorder/NN/inorder traversal/NN/traversal /:/( section/NN/section 8.4.3/CD/8.4.3 /CD/) of/IN/of the/DT/the tree/NNP/tree. proposition/NN/proposition 11.1/CD/11.1 /:/: an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree visits/NNS/visits positions/NNS/positions in/IN/in increasing/VBG/increasing order/NN/order of/IN/of their/PRP$/their keys/NNP/keys. justification/NN/justification /:/: we/PRP/we prove/VBP/prove this/DT/this by/IN/by induction/NN/induction on/IN/on the/DT/the size/NN/size of/IN/of a/DT/a subtree/NNP/subtree. if/IN/if a/DT/a subtree/NN/subtree has/VBZ/has at/IN/at most/JJS/most one/CD/one item/NN/item /,/, its/PRP$/its keys/NNS/keys are/VBP/are trivially/RB/trivially visited/VBN/visited in/IN/in order/NNP/order. more/RBR/more generally/RB/generally /,/, an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of a/DT/a /NN/( sub/NN/sub /:/) tree/NN/tree consists/NNS/consists of/IN/of a/DT/a recursive/JJ/recursive traversal/NN/traversal of/IN/of the/DT/the /NNP/( possibly/RB/possibly empty/JJ/empty /NN/) left/NN/left subtree/NN/subtree /,/, followed/VBN/followed by/IN/by a/DT/a visit/NN/visit of/IN/of the/DT/the root/NN/root /,/, and/CC/and then/RB/then a/DT/a recursive/JJ/recursive traversal/NN/traversal of/IN/of the/DT/the /NNP/( possibly/RB/possibly empty/JJ/empty /NN/) right/RB/right subtree/NNP/subtree. by/IN/by induction/NN/induction /,/, a/DT/a recursive/JJ/recursive inorder/NN/inorder traversal/NN/traversal of/IN/of the/DT/the left/NN/left subtree/NN/subtree will/MD/will produce/VB/produce an/DT/an iteration/NN/iteration of/IN/of the/DT/the keys/NNS/keys in/IN/in that/DT/that subtree/NN/subtree in/IN/in increasing/VBG/increasing order/NNP/order. furthermore/NN/furthermore /,/, by/IN/by the/DT/the binary/JJ/binary search/NN/search tree/NN/tree property/NN/property /,/, all/DT/all keys/NNS/keys in/IN/in the/DT/the left/NN/left subtree/NN/subtree have/VBP/have keys/NNS/keys strictly/RB/strictly smaller/JJR/smaller than/IN/than that/DT/that of/IN/of the/DT/the root/NNP/root. therefore/NN/therefore /,/, visiting/VBG/visiting the/DT/the root/NN/root just/RB/just after/IN/after that/DT/that subtree/NN/subtree extends/NNS/extends the/DT/the increasing/VBG/increasing order/NN/order of/IN/of keys/NNP/keys. finally/RB/finally /,/, by/IN/by the/DT/the search/NN/search tree/NN/tree property/NN/property /,/, all/DT/all keys/NNS/keys in/IN/in the/DT/the right/NN/right subtree/NN/subtree are/VBP/are strictly/RB/strictly greater/JJR/greater than/IN/than the/DT/the root/NN/root /,/, and/CC/and by/IN/by induction/NN/induction /,/, an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of that/DT/that subtree/JJ/subtree will/MD/will visit/VB/visit those/DT/those keys/NNS/keys in/IN/in increasing/VBG/increasing order/NNP/order. since/IN/since an/DT/an inorder/NN/inorder traversal/NN/traversal can/MD/can be/VB/be executed/VBN/executed in/IN/in linear/JJ/linear time/NN/time /,/, a/DT/a consequence/NN/consequence of/IN/of this/DT/this proposition/NN/proposition is/VBZ/is that/IN/that we/PRP/we can/MD/can produce/VB/produce a/DT/a sorted/VBN/sorted iteration/NN/iteration of/IN/of the/DT/the keys/NNS/keys of/IN/of a/DT/a map/NN/map in/IN/in linear/NN/linear time/NN/time /,/, when/WRB/when represented/VBN/represented as/IN/as a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. although/IN/although an/DT/an inorder/NN/inorder traversal/NN/traversal is/VBZ/is typically/RB/typically expressed/VBN/expressed using/VBG/using a/DT/a top-down/JJ/top-down recursion/NN/recursion /,/, we/PRP/we can/MD/can provide/VB/provide nonrecursive/JJ/nonrecursive descriptions/NNS/descriptions of/IN/of operations/NNS/operations that/WDT/that allow/IN/allow more/JJR/more finegrained/VBN/finegrained navigation/NN/navigation among/IN/among the/DT/the positions/NNS/positions of/IN/of a/DT/a binary/JJ/binary search/NN/search relative/JJ/relative to/TO/to the/DT/the order/NN/order of/IN/of their/PRP$/their keys/NNP/keys. our/PRP$/our generic/JJ/generic binary/NN/binary tree/NN/tree adt/NN/adt from/IN/from chapter/NN/chapter 8/CD/8 is/VBZ/is defined/VBN/defined as/RB/as a/DT/a positional/JJ/positional structure/NN/structure /,/, allowing/VBG/allowing direct/JJ/direct navigation/NN/navigation using/VBG/using methods/NNS/methods such/JJ/such as/IN/as parent/NN/parent /:/( p/NN/p /:/) /,/, left/VBN/left /-NONE-/( p/NN/p /:/) /,/, and/CC/and right/RB/right /:/( p/NN/p /:/) /./. with/IN/with a/DT/a binary/JJ/binary search/NN/search tree/NN/tree /,/, we/PRP/we can/MD/can provide/VB/provide additional/JJ/additional navigation/NN/navigation based/VBN/based on/IN/on the/DT/the natural/JJ/natural order/NN/order of/IN/of the/DT/the keys/NNS/keys stored/VBD/stored in/IN/in the/DT/the tree/NNP/tree. in/IN/in particular/JJ/particular /,/, we/PRP/we can/MD/can support/VB/support the/DT/the following/VBG/following methods/NNS/methods /,/, akin/NN/akin to/TO/to those/DT/those provided/VBN/provided by/IN/by a/DT/a positionallist/NN/positionallist /:/( section/NN/section 7.4.1/CD/7.4.1 /CD/) /./. first/JJ/first /NN/( /:/) /:/: return/NN/return the/DT/the position/NN/position containing/VBG/containing the/DT/the least/JJS/least key/JJ/key /,/, or/CC/or none/NN/none if/IN/if the/DT/the tree/NN/tree is/VBZ/is empty/NNP/empty. last/JJ/last /NN/( /:/) /:/: return/NN/return the/DT/the position/NN/position containing/VBG/containing the/DT/the greatest/JJS/greatest key/JJ/key /,/, or/CC/or none/NN/none if/IN/if empty/JJ/empty tree/NNP/tree. before/IN/before /NNP/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position containing/VBG/containing the/DT/the greatest/JJS/greatest key/JJ/key that/IN/that is/VBZ/is less/JJR/less than/IN/than that/DT/that of/IN/of position/NN/position p/NN/p /:/( i.e/NNP/i.e. /,/, the/DT/the position/NN/position that/IN/that would/MD/would be/VB/be visited/VBN/visited immediately/RB/immediately before/IN/before p/NN/p in/IN/in an/DT/an inorder/NN/inorder traversal/NN/traversal /:/) /,/, or/CC/or none/NN/none if/IN/if p/NN/p is/VBZ/is the/DT/the first/JJ/first position/NNP/position. after/IN/after /NNP/( p/NN/p /:/) /:/: return/NN/return the/DT/the position/NN/position containing/VBG/containing the/DT/the least/JJS/least key/JJ/key that/IN/that is/VBZ/is greater/JJR/greater than/IN/than that/DT/that of/IN/of position/NN/position p/NN/p /:/( i.e/NNP/i.e. /,/, the/DT/the position/NN/position that/IN/that would/MD/would be/VB/be visited/VBN/visited immediately/RB/immediately after/IN/after p/NN/p in/IN/in an/DT/an inorder/NN/inorder traversal/NN/traversal /:/) /,/, or/CC/or none/NN/none if/IN/if p/NN/p is/VBZ/is the/DT/the last/JJ/last position/NNP/position. chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees the/DT/the first/JJ/first position/NN/position of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree can/MD/can be/VB/be located/VBN/located by/IN/by starting/NN/starting a/DT/a walk/NN/walk at/IN/at the/DT/the root/NN/root and/CC/and continuing/VBG/continuing to/TO/to the/DT/the left/NN/left child/NN/child /,/, as/IN/as long/RB/long as/IN/as a/DT/a left/NN/left child/NN/child exists/NNP/exists. by/IN/by symmetry/NN/symmetry /,/, the/DT/the last/JJ/last position/NN/position is/VBZ/is reached/VBN/reached by/IN/by repeated/VBN/repeated steps/NNS/steps rightward/IN/rightward starting/VBG/starting at/IN/at the/DT/the root/NNP/root. the/DT/the successor/NN/successor of/IN/of a/DT/a position/NN/position /,/, after/IN/after /NNP/( p/NN/p /:/) /,/, is/VBZ/is determined/VBN/determined by/IN/by the/DT/the following/JJ/following algorithm/NNP/algorithm. algorithm/NN/algorithm after/IN/after /CD/( p/NN/p /:/) /:/: if/IN/if right/JJ/right /NN/( p/NN/p /:/) is/VBZ/is not/RB/not none/NN/none then/RB/then /./{ successor/NN/successor is/VBZ/is leftmost/VBN/leftmost position/NN/position in/IN/in p/NN/p s/NNS/s right/RB/right subtree/VBP/subtree /:/} code/NN/code fragment/NN/fragment 11.1/CD/11.1 /:/: computing/VBG/computing the/DT/the successor/NN/successor of/IN/of a/DT/a position/NN/position in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. the/DT/the rationale/NN/rationale for/IN/for this/DT/this process/NN/process is/VBZ/is based/VBN/based purely/RB/purely on/IN/on the/DT/the workings/NNS/workings of/IN/of an/DT/an inorder/NN/inorder traversal/NN/traversal /,/, given/VBN/given the/DT/the correspondence/NN/correspondence of/IN/of proposition/NN/proposition 11.1/CD/11.1. if/IN/if p/NN/p has/VBZ/has a/DT/a right/NN/right subtree/NN/subtree /,/, that/IN/that right/NN/right subtree/NN/subtree is/VBZ/is recursively/RB/recursively traversed/VBN/traversed immediately/RB/immediately after/IN/after p/NN/p is/VBZ/is visited/VBN/visited /,/, and/CC/and so/RB/so the/DT/the first/JJ/first position/NN/position to/TO/to be/VB/be visited/VBN/visited after/IN/after p/NN/p is/VBZ/is the/DT/the leftmost/NN/leftmost position/NN/position within/IN/within the/DT/the right/NN/right subtree/NNP/subtree. if/IN/if p/NN/p does/VBZ/does not/RB/not have/VB/have a/DT/a right/NN/right subtree/NN/subtree /,/, then/RB/then the/DT/the flow/NN/flow of/IN/of control/NN/control of/IN/of an/DT/an inorder/NN/inorder traversal/NN/traversal returns/NNS/returns to/TO/to p/VB/p s/NNS/s parent/NNP/parent. if/IN/if p/NN/p were/VBD/were in/IN/in the/DT/the right/NN/right subtree/NN/subtree of/IN/of that/DT/that parent/NN/parent /,/, then/RB/then the/DT/the parent/NN/parent s/VBZ/s subtree/JJ/subtree traversal/NN/traversal is/VBZ/is complete/JJ/complete and/CC/and the/DT/the flow/NN/flow of/IN/of control/NN/control progresses/NNS/progresses to/TO/to its/PRP$/its parent/NN/parent and/CC/and so/RB/so on/NNP/on. once/RB/once an/DT/an ancestor/NN/ancestor is/VBZ/is reached/VBN/reached in/IN/in which/WDT/which the/DT/the recursion/NN/recursion is/VBZ/is returning/VBG/returning from/IN/from its/PRP$/its left/VBN/left subtree/JJ/subtree /,/, then/RB/then that/IN/that ancestor/NN/ancestor becomes/VBZ/becomes the/DT/the next/JJ/next position/NN/position visited/VBD/visited by/IN/by the/DT/the inorder/NN/inorder traversal/NN/traversal /,/, and/CC/and thus/RB/thus is/VBZ/is the/DT/the successor/NN/successor of/IN/of p/NNP/p. notice/NN/notice that/WDT/that the/DT/the only/JJ/only case/NN/case in/IN/in which/WDT/which no/DT/no such/JJ/such ancestor/NN/ancestor is/VBZ/is found/VBN/found is/VBZ/is when/WRB/when p/NN/p was/VBD/was the/DT/the rightmost/NN/rightmost /:/( last/JJ/last /NN/) position/NN/position of/IN/of the/DT/the full/JJ/full tree/NN/tree /,/, in/IN/in which/WDT/which case/NN/case there/RB/there is/VBZ/is no/DT/no successor/NNP/successor. a/DT/a symmetric/JJ/symmetric algorithm/NN/algorithm can/MD/can be/VB/be defined/VBN/defined to/TO/to determine/VB/determine the/DT/the predecessor/NN/predecessor of/IN/of a/DT/a position/NN/position /,/, before/IN/before /NNP/( p/NN/p /:/) /./. at/IN/at this/DT/this point/NN/point /,/, we/PRP/we note/VBP/note that/IN/that the/DT/the running/VBG/running time/NN/time of/IN/of single/JJ/single call/NN/call to/TO/to after/IN/after /CD/( p/NN/p /:/) or/CC/or before/IN/before /CD/( p/NN/p /:/) is/VBZ/is bounded/VBN/bounded by/IN/by the/DT/the height/NN/height h/NN/h of/IN/of the/DT/the full/JJ/full tree/NN/tree /,/, because/IN/because it/PRP/it is/VBZ/is found/VBN/found after/IN/after either/DT/either a/DT/a single/JJ/single downward/NN/downward walk/NN/walk or/CC/or a/DT/a single/JJ/single upward/NN/upward walk/NNP/walk. while/IN/while the/DT/the worst-case/NN/worst-case running/VBG/running time/NN/time is/VBZ/is o/RB/o /:/( h/NN/h /:/) /,/, we/PRP/we note/VBP/note that/IN/that either/DT/either of/IN/of these/DT/these methods/NNS/methods run/VBP/run in/IN/in o/NN/o /:/( 1/CD/1 /CD/) amortized/VBN/amortized time/NN/time /,/, in/IN/in that/DT/that series/NN/series of/IN/of n/NN/n calls/NNS/calls to/TO/to after/IN/after /CD/( p/NN/p /:/) starting/VBG/starting at/IN/at the/DT/the first/JJ/first position/NN/position will/MD/will execute/VB/execute in/IN/in a/DT/a total/NN/total of/IN/of o/NN/o /:/( n/NN/n /:/) time/NNP/time. we/PRP/we leave/VBP/leave a/DT/a formal/JJ/formal justification/NN/justification of/IN/of this/DT/this fact/NN/fact to/TO/to exercise/VB/exercise c-11.34/-NONE-/c-11.34 /,/, but/CC/but intuitively/RB/intuitively the/DT/the upward/NN/upward and/CC/and downward/NN/downward paths/NNS/paths mimic/JJ/mimic steps/NNS/steps of/IN/of the/DT/the inorder/NN/inorder traversal/NN/traversal /:/( a/DT/a related/JJ/related argument/NN/argument was/VBD/was made/VBN/made in/IN/in the/DT/the justification/NN/justification of/IN/of proposition/NN/proposition 9.3/CD/9.3 /CD/) /./. 11.1/CD/11.1. binary/JJ/binary search/NN/search trees/NNS/trees 463/CD/463 11.1.2/CD/11.1.2 searches/NNS/searches the/DT/the most/JJS/most important/JJ/important consequence/NN/consequence of/IN/of the/DT/the structural/JJ/structural property/NN/property of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is its/PRP$/its namesake/NN/namesake search/NN/search algorithm/NNP/algorithm. we/PRP/we can/MD/can attempt/VB/attempt to/TO/to locate/VB/locate a/DT/a particular/JJ/particular key/JJ/key in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NN/tree by/IN/by viewing/NN/viewing it/PRP/it as/IN/as a/DT/a decision/NN/decision tree/NN/tree /:/( recall/NN/recall figure/NN/figure 8.7/CD/8.7 /CD/) /./. in/IN/in this/DT/this case/NN/case /,/, the/DT/the question/NN/question asked/VBD/asked at/IN/at each/DT/each position/NN/position p/NN/p is/VBZ/is whether/IN/whether the/DT/the desired/VBN/desired key/JJ/key k/NN/k is/VBZ/is less/JJR/less than/IN/than /,/, equal/JJ/equal to/TO/to /,/, or/CC/or greater/JJR/greater than/IN/than the/DT/the key/JJ/key stored/VBN/stored at/IN/at position/NN/position p/NN/p /,/, which/WDT/which we/PRP/we denote/VBP/denote as/IN/as p.key/JJ/p.key /NN/( /:/) /./. if/IN/if the/DT/the answer/NN/answer is/VBZ/is less/JJR/less than/IN/than /,/, then/RB/then the/DT/the search/NN/search continues/VBZ/continues in/IN/in the/DT/the left/NN/left subtree/NNP/subtree. if/IN/if the/DT/the answer/NN/answer is/VBZ/is equal/JJ/equal /,/, then/RB/then the/DT/the search/NN/search terminates/VBZ/terminates successfully/NNP/successfully. if/IN/if the/DT/the answer/NN/answer is/VBZ/is greater/JJR/greater than/IN/than /,/, then/RB/then the/DT/the search/NN/search continues/VBZ/continues in/IN/in the/DT/the right/NN/right subtree/NNP/subtree. finally/RB/finally /,/, if/IN/if we/PRP/we reach/VBP/reach an/DT/an empty/NN/empty subtree/NN/subtree /,/, then/RB/then the/DT/the search/NN/search terminates/VBZ/terminates unsuccessfully/NNP/unsuccessfully. /NNP/( see/VB/see figure/NN/figure 11.2/CD/11.2. /CD/) figure/NN/figure 11.2/CD/11.2 /:/: /:/( a/DT/a /NN/) a/DT/a successful/JJ/successful search/NN/search for/IN/for key/JJ/key 65/CD/65 in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NN/tree ;/:/; /:/( b/NN/b /:/) an/DT/an unsuccessful/JJ/unsuccessful search/NN/search for/IN/for key/JJ/key 68/CD/68 that/WDT/that terminates/VBZ/terminates because/IN/because there/EX/there is/VBZ/is no/DT/no subtree/NN/subtree to/TO/to the/DT/the left/NN/left of/IN/of the/DT/the key/JJ/key 76/CD/76. we/PRP/we describe/VBP/describe this/DT/this approach/NN/approach in/IN/in code/NN/code fragment/NN/fragment 11.2/CD/11.2. if/IN/if key/JJ/key k/NN/k occurs/NNS/occurs in/IN/in a/DT/a subtree/NN/subtree rooted/VBN/rooted at/IN/at p/NN/p /,/, a/DT/a call/NN/call to/TO/to treesearch/VB/treesearch /:/( t/NN/t /,/, p/NN/p /,/, k/NN/k /:/) results/NNS/results in/IN/in the/DT/the position/NN/position at/IN/at which/WDT/which the/DT/the key/JJ/key is/VBZ/is found/VBN/found ;/:/; in/IN/in this/DT/this case/NN/case /,/, the/DT/the getitem/NN/getitem map/NN/map operation/NN/operation would/MD/would return/VB/return the/DT/the associated/VBN/associated value/NN/value at/IN/at that/DT/that position/NNP/position. in/IN/in the/DT/the event/NN/event of/IN/of an/DT/an unsuccessful/JJ/unsuccessful search/NN/search /,/, the/DT/the treesearch/NN/treesearch algorithm/NN/algorithm returns/NNS/returns the/DT/the final/JJ/final position/NN/position explored/VBD/explored on/IN/on the/DT/the search/NN/search path/NN/path /:/( which/WDT/which we/PRP/we will/MD/will later/VB/later make/VB/make use/NN/use of/IN/of when/WRB/when determining/VBG/determining where/WRB/where to/TO/to insert/VB/insert a/DT/a new/JJ/new item/NN/item in/IN/in a/DT/a search/NN/search tree/NN/tree /:/) /./. 464/CD/464 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees analysis/NN/analysis of/IN/of binary/JJ/binary tree/NN/tree searching/VBG/searching the/DT/the analysis/NN/analysis of/IN/of the/DT/the worst-case/JJ/worst-case running/NN/running time/NN/time of/IN/of searching/VBG/searching in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t is/VBZ/is simple/NNP/simple. algorithm/NN/algorithm treesearch/NN/treesearch is/VBZ/is recursive/JJ/recursive and/CC/and executes/VBZ/executes a/DT/a constant/JJ/constant number/NN/number of/IN/of primitive/JJ/primitive operations/NNS/operations for/IN/for each/DT/each recursive/JJ/recursive call/NNP/call. each/DT/each recursive/JJ/recursive call/NN/call of/IN/of treesearch/NN/treesearch is/VBZ/is made/VBN/made on/IN/on a/DT/a child/NN/child of/IN/of the/DT/the previous/JJ/previous position/NNP/position. that/IN/that is/VBZ/is /,/, treesearch/NN/treesearch is/VBZ/is called/VBN/called on/IN/on the/DT/the positions/NNS/positions of/IN/of a/DT/a path/NN/path of/IN/of t/NN/t that/IN/that starts/NNS/starts at/IN/at the/DT/the root/NN/root and/CC/and goes/VBZ/goes down/RP/down one/CD/one level/NN/level at/IN/at a/DT/a time/NNP/time. thus/RB/thus /,/, the/DT/the number/NN/number of/IN/of such/JJ/such positions/NNS/positions is/VBZ/is bounded/VBN/bounded by/IN/by h/NN/h +/:/+ 1/CD/1 /,/, where/WRB/where h/JJ/h is/VBZ/is the/DT/the height/NN/height of/IN/of t/NNP/t. in/IN/in other/JJ/other words/NNS/words /,/, since/IN/since we/PRP/we spend/VBP/spend o/RB/o /:/( 1/CD/1 /CD/) time/NN/time per/IN/per position/NN/position encountered/VBD/encountered in/IN/in the/DT/the search/NN/search /,/, the/DT/the overall/JJ/overall search/NN/search runs/VBZ/runs in/IN/in o/NN/o /:/( h/NN/h /:/) time/NN/time /,/, where/WRB/where h/JJ/h is/VBZ/is the/DT/the height/NN/height of/IN/of the/DT/the binary/JJ/binary search/NN/search tree/NN/tree t/NNP/t. /NNP/( see/VB/see figure/NN/figure 11.3/CD/11.3. /CD/) figure/NN/figure 11.3/CD/11.3 /:/: illustrating/VBG/illustrating the/DT/the running/VBG/running time/NN/time of/IN/of searching/VBG/searching in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. the/DT/the figure/NN/figure uses/VBZ/uses standard/JJ/standard caricature/NN/caricature of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree as/IN/as a/DT/a big/JJ/big triangle/NN/triangle and/CC/and a/DT/a path/NN/path from/IN/from the/DT/the root/NN/root as/IN/as a/DT/a zig-zag/JJ/zig-zag line/NNP/line. in/IN/in the/DT/the context/NN/context of/IN/of the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt /,/, the/DT/the search/NN/search will/MD/will be/VB/be used/VBN/used as/IN/as a/DT/a subroutine/NN/subroutine for/IN/for implementing/NN/implementing the/DT/the getitem/NN/getitem method/NN/method /,/, as/IN/as well/RB/well as/IN/as for/IN/for the/DT/the setitem/NN/setitem and/CC/and delitem/NN/delitem methods/NNS/methods /,/, since/IN/since each/DT/each of/IN/of these/DT/these begins/NNS/begins by/IN/by trying/VBG/trying to/TO/to locate/VB/locate an/DT/an existing/VBG/existing item/NN/item with/IN/with a/DT/a given/VBN/given key/NNP/key. to/TO/to implement/VB/implement sorted/VBN/sorted map/NN/map operations/NNS/operations such/JJ/such as/IN/as find/NN/find lt/NN/lt and/CC/and find/VB/find gt/NN/gt /,/, we/PRP/we will/MD/will combine/VB/combine this/DT/this search/NN/search with/IN/with traversal/NN/traversal methods/NNS/methods before/IN/before and/CC/and after/NNP/after. all/DT/all of/IN/of these/DT/these operations/NNS/operations will/MD/will run/VB/run in/IN/in worst-case/JJ/worst-case o/NN/o /:/( h/NN/h /:/) time/NN/time for/IN/for a/DT/a tree/NN/tree with/IN/with height/NN/height h/NNP/h. we/PRP/we can/MD/can use/VB/use a/DT/a variation/NN/variation of/IN/of this/DT/this technique/NN/technique to/TO/to implement/VB/implement the/DT/the find/NN/find range/NN/range method/NN/method in/IN/in time/NN/time o/NN/o /:/( s/NNS/s +/VBP/+ h/JJ/h /NN/) /,/, where/WRB/where s/NNS/s is/VBZ/is the/DT/the number/NN/number of/IN/of items/NNS/items reported/VBD/reported /CD/( see/NN/see exercise/NN/exercise c-11.34/-NONE-/c-11.34 /./) /./. admittedly/RB/admittedly /,/, the/DT/the height/NN/height h/NN/h of/IN/of t/NN/t can/MD/can be/VB/be as/RB/as large/JJ/large as/IN/as the/DT/the number/NN/number of/IN/of entries/NNS/entries /,/, n/VBP/n /,/, but/CC/but we/PRP/we expect/VBP/expect that/IN/that it/PRP/it is/VBZ/is usually/RB/usually much/JJ/much smaller/NNP/smaller. indeed/RB/indeed /,/, later/JJ/later in/IN/in this/DT/this chapter/NN/chapter we/PRP/we show/VBP/show various/JJ/various strategies/NNS/strategies to/TO/to maintain/VB/maintain an/DT/an upper/JJ/upper bound/NN/bound of/IN/of o/NN/o /:/( logn/NN/logn /:/) on/IN/on the/DT/the height/NN/height of/IN/of a/DT/a search/NN/search tree/NN/tree t/NNP/t. 11.1/NNP/11.1. binary/NN/binary search/NN/search trees/NNS/trees 465/CD/465 11.1.3/CD/11.1.3 insertions/NNS/insertions and/CC/and deletions/NNS/deletions algorithms/NNS/algorithms for/IN/for inserting/VBG/inserting or/CC/or deleting/VBG/deleting entries/NNS/entries of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree are/VBP/are fairly/RB/fairly straightforward/JJ/straightforward /,/, although/IN/although not/RB/not trivial/NNP/trivial. insertion/NN/insertion the/DT/the map/NN/map command/NN/command m/NN/m /:/[ k/NN/k /:/] =/:/= v/NN/v /,/, as/IN/as supported/VBN/supported by/IN/by the/DT/the setitem/NN/setitem method/NN/method /,/, begins/VBZ/begins with/IN/with a/DT/a search/NN/search for/IN/for key/JJ/key k/NN/k /:/( assuming/VBG/assuming the/DT/the map/NN/map is/VBZ/is nonempty/NN/nonempty /:/) /./. if/IN/if found/NN/found /,/, that/IN/that item/NN/item s/NNS/s existing/VBG/existing value/NN/value is/VBZ/is reassigned/NNP/reassigned. otherwise/RB/otherwise /,/, a/DT/a node/NN/node for/IN/for the/DT/the new/JJ/new item/NN/item can/MD/can be/VB/be inserted/VBN/inserted into/IN/into the/DT/the underlying/JJ/underlying tree/NN/tree t/NN/t in/IN/in place/NN/place of/IN/of the/DT/the empty/NN/empty subtree/NN/subtree that/WDT/that was/VBD/was reached/VBN/reached at/IN/at the/DT/the end/NN/end of/IN/of the/DT/the failed/VBN/failed search/NNP/search. the/DT/the binary/JJ/binary search/NN/search tree/NN/tree property/NN/property is/VBZ/is sustained/VBN/sustained by/IN/by that/DT/that placement/NN/placement /:/( note/NN/note that/IN/that it/PRP/it is/VBZ/is placed/VBN/placed exactly/RB/exactly where/WRB/where a/DT/a search/NN/search would/MD/would expect/VB/expect it/PRP/it /:/) /./. pseudo-code/JJ/pseudo-code for/IN/for such/JJ/such a/DT/a treeinsert/NN/treeinsert algorithm/NN/algorithm is/VBZ/is given/VBN/given in/IN/in in/IN/in code/NN/code fragment/NN/fragment 11.3/CD/11.3. algorithm/NN/algorithm treeinsert/NN/treeinsert /:/( t/NN/t /,/, k/NN/k /,/, v/NN/v /:/) /:/: input/NN/input /:/: a/DT/a search/NN/search key/NN/key k/NN/k to/TO/to be/VB/be associated/VBN/associated with/IN/with value/NN/value v/NN/v p/NN/p =/:/= treesearch/NN/treesearch /:/( t,t.root/JJ/t,t.root /NN/( /:/) ,k/JJ/,k /NN/) if/IN/if k/NN/k =/:/= =/:/= p.key/JJ/p.key /NN/( /:/) then/RB/then set/VBN/set p/NN/p s/NNS/s value/NN/value to/TO/to v/VB/v else/RB/else if/IN/if k/NN/k </:/< p.key/JJ/p.key /NN/( /:/) then/RB/then add/JJ/add node/NN/node with/IN/with item/NN/item /:/( k,v/NN/k,v /:/) as/IN/as left/NN/left child/NN/child of/IN/of p/NN/p else/RB/else add/JJ/add node/NN/node with/IN/with item/NN/item /:/( k,v/NN/k,v /:/) as/IN/as right/NN/right child/NN/child of/IN/of p/NN/p code/NN/code fragment/NN/fragment 11.3/CD/11.3 /:/: algorithm/NN/algorithm for/IN/for inserting/NN/inserting a/DT/a key-value/JJ/key-value pair/NN/pair into/IN/into a/DT/a map/NN/map that/WDT/that is/VBZ/is represented/VBN/represented as/RB/as a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. an/DT/an example/NN/example of/IN/of insertion/NN/insertion into/IN/into a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 11.4/CD/11.4. figure/NN/figure 11.4/CD/11.4 /:/: insertion/NN/insertion of/IN/of an/DT/an item/NN/item with/IN/with key/JJ/key 68/CD/68 into/IN/into the/DT/the search/NN/search tree/NN/tree of/IN/of figure/NN/figure 11.2/CD/11.2. finding/NN/finding the/DT/the position/NN/position to/TO/to insert/VB/insert is/VBZ/is shown/VBN/shown in/IN/in /NNP/( a/DT/a /NN/) /,/, and/CC/and the/DT/the resulting/VBG/resulting tree/NN/tree is/VBZ/is shown/VBN/shown in/IN/in /NNP/( b/NN/b /:/) /./. 466/CD/466 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees deletion/NN/deletion deleting/VBG/deleting an/DT/an item/NN/item from/IN/from a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t is/VBZ/is a/DT/a bit/NN/bit more/RBR/more complex/JJ/complex than/IN/than inserting/NN/inserting a/DT/a new/JJ/new item/NN/item because/IN/because the/DT/the location/NN/location of/IN/of the/DT/the deletion/NN/deletion might/MD/might be/VB/be anywhere/RB/anywhere in/IN/in the/DT/the tree/NNP/tree. /NNP/( in/IN/in contrast/NN/contrast /,/, insertions/NNS/insertions are/VBP/are always/RB/always enacted/VBN/enacted at/IN/at the/DT/the bottom/NN/bottom of/IN/of a/DT/a path/NNP/path. /NNP/) to/TO/to delete/VB/delete an/DT/an item/NN/item with/IN/with key/JJ/key k/NN/k /,/, we/PRP/we begin/VBP/begin by/IN/by calling/VBG/calling treesearch/NN/treesearch /:/( t/NN/t /,/, t.root/JJ/t.root /NN/( /:/) /,/, k/NN/k /:/) to/TO/to find/VB/find the/DT/the position/NN/position p/NN/p of/IN/of t/NN/t storing/VBG/storing an/DT/an item/NN/item with/IN/with key/JJ/key equal/JJ/equal to/TO/to k/NNP/k. if/IN/if the/DT/the search/NN/search is/VBZ/is successful/JJ/successful /,/, we/PRP/we distinguish/VBP/distinguish between/IN/between two/CD/two cases/NNS/cases /:/( of/IN/of increasing/VBG/increasing difficulty/NN/difficulty /:/) /:/: if/IN/if p/NN/p has/VBZ/has at/IN/at most/JJS/most one/CD/one child/NN/child /,/, the/DT/the deletion/NN/deletion of/IN/of the/DT/the node/NN/node at/IN/at position/NN/position p/NN/p is/VBZ/is easily/RB/easily implemented/NNP/implemented. when/WRB/when introducing/VBG/introducing update/NN/update methods/NNS/methods for/IN/for the/DT/the linkedbinarytree/NN/linkedbinarytree class/NN/class in/IN/in section/NN/section 8.3.1/CD/8.3.1 /,/, we/PRP/we declared/VBD/declared a/DT/a nonpublic/JJ/nonpublic utility/NN/utility /,/, delete/JJ/delete /NN/( p/NN/p /:/) /,/, that/IN/that deletes/NNS/deletes a/DT/a node/NN/node at/IN/at position/NN/position p/NN/p and/CC/and replaces/NNS/replaces it/PRP/it with/IN/with its/PRP$/its child/NN/child /:/( if/IN/if any/DT/any /NN/) /,/, presuming/VBG/presuming that/IN/that p/NN/p has/VBZ/has at/IN/at most/JJS/most one/CD/one child/NNP/child. that/WDT/that is/VBZ/is precisely/RB/precisely the/DT/the desired/VBN/desired behavior/NNP/behavior. it/PRP/it removes/VBZ/removes the/DT/the item/NN/item with/IN/with key/JJ/key k/NN/k from/IN/from the/DT/the map/NN/map while/IN/while maintaining/NN/maintaining all/DT/all other/JJ/other ancestor-descendant/JJ/ancestor-descendant relationships/NNS/relationships in/IN/in the/DT/the tree/NN/tree /,/, thereby/RB/thereby assuring/VBG/assuring the/DT/the upkeep/NN/upkeep of/IN/of the/DT/the binary/JJ/binary search/NN/search tree/NN/tree property/NNP/property. /NNP/( see/VB/see figure/NN/figure 11.5/CD/11.5. /CD/) if/IN/if position/NN/position p/NN/p has/VBZ/has two/CD/two children/NNS/children /,/, we/PRP/we can/MD/can not/RB/not simply/RB/simply remove/VB/remove the/DT/the node/NN/node from/IN/from t/NN/t since/IN/since this/DT/this would/MD/would create/VB/create a/DT/a hole/NN/hole and/CC/and two/CD/two orphaned/VBD/orphaned children/NNP/children. instead/RB/instead /,/, we/PRP/we proceed/VBD/proceed as/IN/as follows/NNS/follows /:/( see/VB/see figure/NN/figure 11.6/CD/11.6 /CD/) /:/: we/PRP/we locate/VBP/locate position/NN/position r/NN/r containing/VBG/containing the/DT/the item/NN/item having/VBG/having the/DT/the greatest/JJS/greatest key/JJ/key that/IN/that is/VBZ/is strictly/RB/strictly less/JJR/less than/IN/than that/DT/that of/IN/of position/NN/position p/NN/p /,/, that/IN/that is,r/JJ/is,r =/NN/= before/IN/before /CD/( p/NN/p /:/) by/IN/by the/DT/the notation/NN/notation of/IN/of section/NN/section 11.1.1/CD/11.1.1. because/IN/because p/NN/p has/VBZ/has two/CD/two children/NNS/children /,/, its/PRP$/its predecessor/NN/predecessor is/VBZ/is the/DT/the rightmost/NN/rightmost position/NN/position of/IN/of the/DT/the left/NN/left subtree/NN/subtree of/IN/of p/NNP/p. we/PRP/we use/VBP/use r/NN/r s/NNS/s item/VBP/item as/RB/as a/DT/a replacement/NN/replacement for/IN/for the/DT/the one/CD/one being/VBG/being deleted/VBN/deleted at/IN/at position/NN/position p/NNP/p. because/IN/because r/NN/r has/VBZ/has the/DT/the immediately/RB/immediately preceding/VBG/preceding key/JJ/key in/IN/in the/DT/the map/NN/map /,/, any/DT/any items/NNS/items in/IN/in p/NN/p s/NNS/s right/RB/right subtree/VBP/subtree will/MD/will have/VB/have keys/NNS/keys greater/JJR/greater than/IN/than r/NN/r and/CC/and any/DT/any other/JJ/other items/NNS/items in/IN/in p/NN/p s/NNS/s left/VBN/left subtree/JJ/subtree will/MD/will have/VB/have keys/NNS/keys less/JJR/less than/IN/than r/NNP/r. therefore/NN/therefore /,/, the/DT/the binary/JJ/binary search/NN/search tree/NN/tree property/NN/property is/VBZ/is satisfied/VBN/satisfied after/IN/after the/DT/the replacement/NNP/replacement. having/NN/having used/VBD/used r/NN/r s/NNS/s as/IN/as a/DT/a replacement/NN/replacement for/IN/for p/NN/p /,/, we/PRP/we instead/RB/instead delete/JJ/delete the/DT/the node/NN/node at/IN/at position/NN/position r/NN/r from/IN/from the/DT/the tree/NNP/tree. fortunately/RB/fortunately /,/, since/IN/since r/NN/r was/VBD/was located/VBN/located as/IN/as the/DT/the rightmost/NN/rightmost position/NN/position in/IN/in a/DT/a subtree/NN/subtree /,/, r/NN/r does/VBZ/does not/RB/not have/VB/have a/DT/a right/NN/right child/NNP/child. therefore/RB/therefore /,/, its/PRP$/its deletion/NN/deletion can/MD/can be/VB/be performed/VBN/performed using/VBG/using the/DT/the first/JJ/first /NN/( and/CC/and simpler/NN/simpler /:/) approach/NNP/approach. as/IN/as with/IN/with searching/NN/searching and/CC/and insertion/NN/insertion /,/, this/DT/this algorithm/NN/algorithm for/IN/for a/DT/a deletion/NN/deletion involves/VBZ/involves the/DT/the traversal/NN/traversal of/IN/of a/DT/a single/JJ/single path/NN/path downward/NN/downward from/IN/from the/DT/the root/NN/root /,/, possibly/RB/possibly moving/VBG/moving an/DT/an item/NN/item between/IN/between two/CD/two positions/NNS/positions of/IN/of this/DT/this path/NN/path /,/, and/CC/and removing/VBG/removing a/DT/a node/NN/node from/IN/from that/DT/that path/NN/path and/CC/and promoting/VBG/promoting its/PRP$/its child/NNP/child. therefore/NN/therefore /,/, it/PRP/it executes/VBZ/executes in/IN/in time/NN/time o/NN/o /:/( h/NN/h /:/) where/WRB/where h/JJ/h is/VBZ/is the/DT/the height/NN/height of/IN/of the/DT/the tree/NNP/tree. 11.1/NNP/11.1. binary/NN/binary search/NN/search trees/NNS/trees 467/CD/467 figure/NN/figure 11.5/CD/11.5 /:/: deletion/NN/deletion from/IN/from the/DT/the binary/JJ/binary search/NN/search tree/NN/tree of/IN/of figure/NN/figure 11.4b/CD/11.4b /,/, where/WRB/where the/DT/the item/NN/item to/TO/to delete/VB/delete /:/( with/IN/with key/JJ/key 32/CD/32 /CD/) is/VBZ/is stored/VBN/stored at/IN/at a/DT/a position/NN/position p/NN/p with/IN/with one/CD/one child/NN/child r/NN/r /:/: /:/( a/DT/a /NN/) before/IN/before the/DT/the deletion/NN/deletion ;/:/; /:/( b/NN/b /:/) after/IN/after the/DT/the deletion/NNP/deletion. figure/NN/figure 11.6/CD/11.6 /:/: deletion/NN/deletion from/IN/from the/DT/the binary/JJ/binary search/NN/search tree/NN/tree of/IN/of figure/NN/figure 11.5b/CD/11.5b /,/, where/WRB/where the/DT/the item/NN/item to/TO/to delete/VB/delete /:/( with/IN/with key/JJ/key 88/CD/88 /CD/) is/VBZ/is stored/VBN/stored at/IN/at a/DT/a position/NN/position p/NN/p with/IN/with two/CD/two children/NNS/children /,/, and/CC/and replaced/VBD/replaced by/IN/by its/PRP$/its predecessor/NN/predecessor r/NN/r /:/: /:/( a/DT/a /NN/) before/IN/before the/DT/the deletion/NN/deletion ;/:/; /:/( b/NN/b /:/) after/IN/after the/DT/the deletion/NNP/deletion. 468/CD/468 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees 11.1.4/CD/11.1.4 python/NN/python implementation/NN/implementation in/IN/in code/NN/code fragments/NNS/fragments 11.4/CD/11.4 through/IN/through 11.8/CD/11.8 we/PRP/we define/VBP/define a/DT/a treemap/NN/treemap class/NN/class that/WDT/that implements/VBZ/implements the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt using/VBG/using a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. in/IN/in fact/NN/fact /,/, our/PRP$/our implementation/NN/implementation is/VBZ/is more/RBR/more general/NNP/general. we/PRP/we support/VBP/support all/DT/all of/IN/of the/DT/the standard/JJ/standard map/NN/map operations/NNS/operations /:/( section/NN/section 10.1.1/CD/10.1.1 /CD/) /,/, all/DT/all additional/JJ/additional sorted/VBN/sorted map/NN/map operations/NNS/operations /:/( section/NN/section 10.3/CD/10.3 /CD/) /,/, and/CC/and positional/JJ/positional operations/NNS/operations including/VBG/including first/RB/first /:/( /:/) /,/, last/JJ/last /NN/( /:/) /,/, find/VBP/find position/NN/position /:/( k/NN/k /:/) /,/, before/IN/before /NNP/( p/NN/p /:/) /,/, after/IN/after /NNP/( p/NN/p /:/) /,/, and/CC/and delete/JJ/delete /NN/( p/NN/p /:/) /./. our/PRP$/our treemap/NN/treemap class/NN/class takes/VBZ/takes advantage/NN/advantage of/IN/of multiple/NN/multiple inheritance/NN/inheritance for/IN/for code/NN/code reuse/NN/reuse /,/, inheriting/VBG/inheriting from/IN/from the/DT/the linkedbinarytree/NN/linkedbinarytree class/NN/class of/IN/of section/NN/section 8.3.1/CD/8.3.1 for/IN/for our/PRP$/our representation/NN/representation as/IN/as a/DT/a positional/JJ/positional binary/NN/binary tree/NN/tree /,/, and/CC/and from/IN/from the/DT/the mapbase/NN/mapbase class/NN/class from/IN/from code/NN/code fragment/NN/fragment 10.2/CD/10.2 of/IN/of section/NN/section 10.1.4/CD/10.1.4 to/TO/to provide/VB/provide us/PRP/us with/IN/with the/DT/the key-value/JJ/key-value composite/JJ/composite item/NN/item and/CC/and the/DT/the concrete/JJ/concrete behaviors/NNS/behaviors from/IN/from the/DT/the collections.mutablemapping/JJ/collections.mutablemapping abstract/NN/abstract base/NN/base class/NNP/class. we/PRP/we subclass/VBZ/subclass the/DT/the nested/VBN/nested position/NN/position class/NN/class to/TO/to support/VB/support more/JJR/more specific/JJ/specific p.key/JJ/p.key /NN/( /:/) and/CC/and p.value/JJ/p.value /NN/( /:/) accessors/NNS/accessors for/IN/for our/PRP$/our map/NN/map /,/, rather/RB/rather than/IN/than the/DT/the p.element/JJ/p.element /NN/( /:/) syntax/NN/syntax inherited/VBD/inherited from/IN/from the/DT/the tree/NN/tree adt/NNP/adt. we/PRP/we define/VBP/define several/JJ/several nonpublic/JJ/nonpublic utilities/NNS/utilities /,/, most/JJS/most notably/RB/notably a/DT/a subtree/JJ/subtree search/NN/search /:/( p/NN/p /,/, k/NN/k /:/) method/NN/method that/IN/that corresponds/NNS/corresponds to/TO/to the/DT/the treesearch/NN/treesearch algorithm/NN/algorithm of/IN/of code/NN/code fragment/NN/fragment 11.2/CD/11.2. that/WDT/that returns/NNS/returns a/DT/a position/NN/position /,/, ideally/RB/ideally one/CD/one that/WDT/that contains/VBZ/contains the/DT/the key/NN/key k/NN/k /,/, or/CC/or otherwise/RB/otherwise the/DT/the last/JJ/last position/NN/position that/IN/that is/VBZ/is visited/VBN/visited on/IN/on the/DT/the search/NN/search path/NNP/path. we/PRP/we rely/RB/rely on/IN/on the/DT/the fact/NN/fact that/IN/that the/DT/the final/JJ/final position/NN/position during/IN/during an/DT/an unsuccessful/JJ/unsuccessful search/NN/search is/VBZ/is either/DT/either the/DT/the nearest/JJS/nearest key/JJ/key less/NN/less than/IN/than k/NN/k or/CC/or the/DT/the nearest/JJS/nearest key/JJ/key greater/NN/greater than/IN/than k/NNP/k. this/DT/this search/NN/search utility/NN/utility becomes/VBZ/becomes the/DT/the basis/NN/basis for/IN/for the/DT/the public/NN/public find/NN/find position/NN/position /:/( k/NN/k /:/) method/NN/method /,/, and/CC/and also/RB/also for/IN/for internal/JJ/internal use/NN/use when/WRB/when searching/VBG/searching /,/, inserting/VBG/inserting /,/, or/CC/or deleting/VBG/deleting items/NNS/items from/IN/from a/DT/a map/NN/map /,/, as/IN/as well/RB/well as/IN/as for/IN/for the/DT/the robust/NN/robust searches/VBZ/searches of/IN/of the/DT/the sorted/VBN/sorted map/NN/map adt/NNP/adt. when/WRB/when making/VBG/making structural/JJ/structural modifications/NNS/modifications to/TO/to the/DT/the tree/NN/tree /,/, we/PRP/we rely/RB/rely on/IN/on nonpublic/JJ/nonpublic update/NN/update methods/NNS/methods /,/, such/JJ/such as/IN/as add/JJ/add right/NN/right /,/, that/IN/that are/VBP/are inherited/VBN/inherited from/IN/from the/DT/the linkedbinarytree/NN/linkedbinarytree class/NN/class /:/( see/NN/see section/NN/section 8.3.1/CD/8.3.1 /CD/) /./. it/PRP/it is/VBZ/is important/JJ/important that/IN/that these/DT/these inherited/JJ/inherited methods/NNS/methods remain/VBP/remain nonpublic/JJ/nonpublic /,/, as/IN/as the/DT/the search/NN/search tree/NN/tree property/NN/property could/MD/could be/VB/be violated/VBN/violated through/IN/through misuse/NN/misuse of/IN/of such/JJ/such operations/NNP/operations. finally/RB/finally /,/, we/PRP/we note/VBP/note that/IN/that our/PRP$/our code/NN/code is/VBZ/is peppered/VBN/peppered with/IN/with calls/NNS/calls to/TO/to presumed/VBN/presumed methods/NNS/methods named/VBN/named rebalance/NN/rebalance insert/NN/insert /,/, rebalance/NN/rebalance delete/NN/delete /,/, and/CC/and rebalance/NN/rebalance access/NNP/access. these/DT/these methods/NNS/methods serve/VBP/serve as/IN/as hooks/NNS/hooks for/IN/for future/JJ/future use/NN/use when/WRB/when balancing/VBG/balancing search/NN/search trees/NNS/trees ;/:/; we/PRP/we discuss/VBP/discuss them/PRP/them in/IN/in section/NN/section 11.2/CD/11.2. we/PRP/we conclude/VBP/conclude with/IN/with a/DT/a brief/JJ/brief guide/NN/guide to/TO/to the/DT/the organization/NN/organization of/IN/of our/PRP$/our code/NNP/code. code/NN/code fragment/NN/fragment 11.4/CD/11.4 /:/: beginning/NN/beginning of/IN/of treemap/NN/treemap class/NN/class including/VBG/including redefined/VBN/redefined position/NN/position class/NN/class and/CC/and nonpublic/JJ/nonpublic search/NN/search utilities/NNP/utilities. code/NN/code fragment/NN/fragment 11.5/CD/11.5 /:/: positional/JJ/positional methods/NNS/methods first/RB/first /:/( /:/) /,/, last/JJ/last /NN/( /:/) /,/, before/IN/before /NNP/( p/NN/p /:/) /,/, after/IN/after /NNP/( p/NN/p /:/) /,/, and/CC/and find/VB/find position/NN/position /:/( p/NN/p /:/) accessor/NNP/accessor. code/NN/code fragment/NN/fragment 11.6/CD/11.6 /:/: selected/VBN/selected methods/NNS/methods of/IN/of the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt /:/: find/NN/find min/NN/min /:/( /:/) /,/, find/VBP/find ge/NN/ge /:/( k/NN/k /:/) /,/, and/CC/and find/VB/find range/NN/range /:/( start/NN/start /,/, stop/VB/stop /:/) ;/:/; related/JJ/related methods/NNS/methods are/VBP/are omitted/VBN/omitted for/IN/for the/DT/the sake/NN/sake of/IN/of brevity/NNP/brevity. code/NN/code fragment/NN/fragment 11.7/CD/11.7 /:/: getitem/NN/getitem /:/( k/NN/k /:/) /,/, setitem/NN/setitem /:/( k/NN/k /,/, v/NN/v /:/) /,/, and/CC/and iter/NN/iter /:/( /:/) /./. code/NN/code fragment/NN/fragment 11.8/CD/11.8 /:/: deletion/NN/deletion either/DT/either by/IN/by position/NN/position /,/, as/IN/as delete/JJ/delete /NN/( p/NN/p /:/) /,/, or/CC/or by/IN/by key/JJ/key /,/, as/IN/as delitem/NN/delitem /:/( k/NN/k /:/) /./. 11.1.5/CD/11.1.5 performance/NN/performance of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree an/DT/an analysis/NN/analysis of/IN/of the/DT/the operations/NNS/operations of/IN/of our/PRP$/our treemap/NN/treemap class/NN/class is/VBZ/is given/VBN/given in/IN/in table/JJ/table 11.1/CD/11.1. almost/RB/almost all/DT/all operations/NNS/operations have/VBP/have a/DT/a worst-case/JJ/worst-case running/NN/running time/NN/time that/WDT/that depends/VBZ/depends on/IN/on h/NN/h /,/, where/WRB/where h/JJ/h is/VBZ/is the/DT/the height/NN/height of/IN/of the/DT/the current/JJ/current tree/NNP/tree. this/DT/this is/VBZ/is because/IN/because most/JJS/most operations/NNS/operations rely/RB/rely on/IN/on a/DT/a constant/JJ/constant amount/NN/amount of/IN/of work/NN/work for/IN/for each/DT/each node/NN/node along/IN/along a/DT/a particular/JJ/particular path/NN/path of/IN/of the/DT/the tree/NN/tree /,/, and/CC/and the/DT/the maximum/NN/maximum path/NN/path length/NN/length within/IN/within a/DT/a tree/NN/tree is/VBZ/is proportional/JJ/proportional to/TO/to the/DT/the height/NN/height of/IN/of the/DT/the tree/NNP/tree. most/JJS/most notably/RB/notably /,/, our/PRP$/our implementations/NNS/implementations of/IN/of map/NN/map operations/NNS/operations getitem/VBP/getitem /,/, setitem/NN/setitem /,/, and/CC/and delitem/NN/delitem each/DT/each begin/NN/begin with/IN/with a/DT/a call/NN/call to/TO/to the/DT/the subtree/NN/subtree search/NN/search utility/NN/utility which/WDT/which traces/NNS/traces a/DT/a path/NN/path downward/NN/downward from/IN/from the/DT/the root/NN/root of/IN/of the/DT/the tree/NN/tree /,/, using/VBG/using o/NN/o /:/( 1/CD/1 /CD/) time/NN/time at/IN/at each/DT/each node/NN/node to/TO/to determine/VB/determine how/WRB/how to/TO/to continue/VB/continue the/DT/the search/NNP/search. similar/JJ/similar paths/NNS/paths are/VBP/are traced/VBN/traced when/WRB/when looking/VBG/looking for/IN/for a/DT/a replacement/NN/replacement during/IN/during a/DT/a deletion/NN/deletion /,/, or/CC/or when/WRB/when computing/VBG/computing a/DT/a position/NN/position s/VBZ/s inorder/NN/inorder predecessor/NN/predecessor or/CC/or successor/NNP/successor. we/PRP/we note/VBP/note that/IN/that although/IN/although a/DT/a single/JJ/single call/NN/call to/TO/to the/DT/the after/NN/after method/NN/method has/VBZ/has worst-case/JJ/worst-case running/NN/running time/NN/time of/IN/of o/NN/o /:/( h/NN/h /:/) /,/, the/DT/the n/NN/n successive/NN/successive calls/VBZ/calls made/VBN/made during/IN/during a/DT/a call/NN/call to/TO/to iter/VB/iter require/NN/require a/DT/a total/NN/total of/IN/of o/NN/o /:/( n/NN/n /:/) time/NN/time /,/, since/IN/since each/DT/each edge/NN/edge is/VBZ/is traced/VBN/traced at/IN/at most/JJS/most twice/NN/twice ;/:/; in/IN/in a/DT/a sense/NN/sense /,/, those/DT/those calls/NNS/calls have/VBP/have o/VBN/o /-NONE-/( 1/CD/1 /CD/) amortized/VBN/amortized time/NN/time bounds/NNP/bounds. a/DT/a similar/JJ/similar argument/NN/argument can/MD/can be/VB/be used/VBN/used to/TO/to prove/VB/prove the/DT/the o/NN/o /:/( s/NNS/s +/VBP/+ h/JJ/h /NN/) worst-case/NN/worst-case bound/NN/bound for/IN/for a/DT/a call/NN/call to/TO/to find/VB/find range/NN/range that/WDT/that reports/VBZ/reports s/VBZ/s results/NNS/results /:/( see/VB/see exercise/NN/exercise c-11.34/-NONE-/c-11.34 /./) /./. 474/CD/474 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees table/JJ/table 11.1/CD/11.1 /:/: worst-case/JJ/worst-case running/NN/running times/NNS/times of/IN/of the/DT/the operations/NNS/operations for/IN/for a/DT/a treemap/NN/treemap t/NNP/t. we/PRP/we denote/VBP/denote the/DT/the current/JJ/current height/NN/height of/IN/of the/DT/the tree/NN/tree with/IN/with h/NN/h /,/, and/CC/and the/DT/the number/NN/number of/IN/of items/NNS/items reported/VBD/reported by/IN/by find/NN/find range/NN/range as/IN/as s/NNP/s. the/DT/the space/NN/space usage/NN/usage is/VBZ/is o/RB/o /:/( n/NN/n /:/) /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of items/NNS/items stored/VBN/stored in/IN/in the/DT/the map/NNP/map. a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t is/VBZ/is therefore/RB/therefore an/DT/an efficient/NN/efficient implementation/NN/implementation of/IN/of a/DT/a map/NN/map with/IN/with n/NN/n entries/NNS/entries only/RB/only if/IN/if its/PRP$/its height/NN/height is/VBZ/is small/NNP/small. in/IN/in the/DT/the best/JJS/best case/NN/case /,/, t/NN/t has/VBZ/has height/VBN/height h/NN/h =/:/= log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) _/NNP/_ 1/CD/1 /,/, which/WDT/which yields/NNS/yields logarithmic-time/VBP/logarithmic-time performance/NN/performance for/IN/for all/DT/all the/DT/the map/NN/map operations/NNP/operations. in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, however/RB/however /,/, t/NN/t has/VBZ/has height/VBN/height n/NN/n /,/, in/IN/in which/WDT/which case/NN/case it/PRP/it would/MD/would look/VB/look and/CC/and feel/VB/feel like/IN/like an/DT/an ordered/VBN/ordered list/NN/list implementation/NN/implementation of/IN/of a/DT/a map/NNP/map. such/JJ/such a/DT/a worst-case/JJ/worst-case configuration/NN/configuration arises/NNS/arises /,/, for/IN/for example/NN/example /,/, if/IN/if we/PRP/we insert/VBP/insert items/NNS/items with/IN/with keys/NNS/keys in/IN/in increasing/VBG/increasing or/CC/or decreasing/VBG/decreasing order/NNP/order. figure/NN/figure 11.7/CD/11.7 /:/: example/NN/example of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree with/IN/with linear/JJ/linear height/NN/height /,/, obtained/VBD/obtained by/IN/by inserting/NN/inserting entries/NNS/entries with/IN/with keys/NNS/keys in/IN/in increasing/VBG/increasing order/NNP/order. we/PRP/we can/MD/can nevertheless/VB/nevertheless take/VB/take comfort/NN/comfort that/WDT/that /,/, on/IN/on average/JJ/average /,/, a/DT/a binary/JJ/binary search/NN/search tree/NN/tree with/IN/with n/NN/n keys/NNS/keys generated/VBD/generated from/IN/from a/DT/a random/NN/random series/NN/series of/IN/of insertions/NNS/insertions and/CC/and removals/NNS/removals of/IN/of keys/NNS/keys has/VBZ/has expected/VBN/expected height/NN/height o/NN/o /:/( logn/NN/logn /:/) ;/:/; the/DT/the justification/NN/justification of/IN/of this/DT/this statement/NN/statement is/VBZ/is beyond/IN/beyond the/DT/the scope/NN/scope of/IN/of the/DT/the book/NN/book /,/, requiring/VBG/requiring careful/JJ/careful mathematical/JJ/mathematical language/NN/language to/TO/to precisely/RB/precisely define/VB/define what/WP/what we/PRP/we mean/VBP/mean by/IN/by a/DT/a random/NN/random series/NN/series of/IN/of insertions/NNS/insertions and/CC/and removals/NNS/removals /,/, and/CC/and sophisticated/VBD/sophisticated probability/NN/probability theory/NNP/theory. in/IN/in applications/NNS/applications where/WRB/where one/CD/one can/MD/can not/RB/not guarantee/VB/guarantee the/DT/the random/NN/random nature/NN/nature of/IN/of updates/NNS/updates /,/, it/PRP/it is/VBZ/is better/RBR/better to/TO/to rely/RB/rely on/IN/on variations/NNS/variations of/IN/of search/NN/search trees/NNS/trees /,/, presented/VBD/presented in/IN/in the/DT/the remainder/NN/remainder of/IN/of this/DT/this chapter/NN/chapter /,/, that/IN/that guarantee/NN/guarantee a/DT/a worst-case/NN/worst-case height/NN/height of/IN/of o/NN/o /:/( logn/NN/logn /:/) /,/, and/CC/and thus/RB/thus o/RB/o /:/( logn/NN/logn /:/) worstcase/NN/worstcase time/NN/time for/IN/for searches/NNS/searches /,/, insertions/NNS/insertions /,/, and/CC/and deletions/NNP/deletions. 11.2/CD/11.2 balanced/VBD/balanced search/NN/search trees/NNS/trees in/IN/in the/DT/the closing/JJ/closing of/IN/of the/DT/the previous/JJ/previous section/NN/section /,/, we/PRP/we noted/VBD/noted that/IN/that if/IN/if we/PRP/we could/MD/could assume/VB/assume a/DT/a random/NN/random series/NN/series of/IN/of insertions/NNS/insertions and/CC/and removals/NNS/removals /,/, the/DT/the standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree supports/NNS/supports o/VBP/o /:/( logn/NN/logn /:/) expected/VBN/expected running/VBG/running times/NNS/times for/IN/for the/DT/the basic/JJ/basic map/NN/map operations/NNP/operations. however/RB/however /,/, we/PRP/we may/MD/may only/RB/only claim/VB/claim o/NN/o /:/( n/NN/n /:/) worst-case/JJ/worst-case time/NN/time /,/, because/IN/because some/DT/some sequences/NNS/sequences of/IN/of operations/NNS/operations may/MD/may lead/VB/lead to/TO/to an/DT/an unbalanced/VBN/unbalanced tree/NN/tree with/IN/with height/NN/height proportional/JJ/proportional to/TO/to n/NNP/n. in/IN/in the/DT/the remainder/NN/remainder of/IN/of this/DT/this chapter/NN/chapter /,/, we/PRP/we explore/VBP/explore four/CD/four search/NN/search tree/NN/tree algorithms/NNS/algorithms that/WDT/that provide/VB/provide stronger/JJR/stronger performance/NN/performance guarantees/NNP/guarantees. three/CD/three of/IN/of the/DT/the four/CD/four data/NNS/data structures/NNS/structures /VBP/( avl/NN/avl trees/NNS/trees /,/, splay/VBP/splay trees/NNS/trees /,/, and/CC/and red-black/JJ/red-black trees/NNS/trees /:/) are/VBP/are based/VBN/based on/IN/on augmenting/NN/augmenting a/DT/a standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree with/IN/with occasional/JJ/occasional operations/NNS/operations to/TO/to reshape/VB/reshape the/DT/the tree/NN/tree and/CC/and reduce/VB/reduce its/PRP$/its height/NNP/height. the/DT/the primary/JJ/primary operation/NN/operation to/TO/to rebalance/NN/rebalance a/DT/a binary/JJ/binary search/NN/search tree/NN/tree is/VBZ/is known/VBN/known as/IN/as a/DT/a rotation/NNP/rotation. during/IN/during a/DT/a rotation/NN/rotation /,/, we/PRP/we rotate/VBP/rotate a/DT/a child/NN/child to/TO/to be/VB/be above/IN/above its/PRP$/its parent/NN/parent /,/, as/IN/as diagrammed/VBN/diagrammed in/IN/in figure/NN/figure 11.8/CD/11.8 /:/: a/DT/a rotation/NN/rotation operation/NN/operation in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. a/DT/a rotation/NN/rotation can/MD/can be/VB/be performed/VBN/performed to/TO/to transform/NN/transform the/DT/the left/NN/left formation/NN/formation into/IN/into the/DT/the right/NN/right /,/, or/CC/or the/DT/the right/NN/right formation/NN/formation into/IN/into the/DT/the left/NNP/left. note/NN/note that/IN/that all/DT/all keys/NNS/keys in/IN/in subtree/JJ/subtree t1/NNP/t1 have/VBP/have keys/NNS/keys less/RBR/less than/IN/than that/DT/that of/IN/of position/NN/position x/NN/x /,/, all/DT/all keys/NNS/keys in/IN/in subtree/JJ/subtree t2/NNP/t2 have/VBP/have keys/NNS/keys that/IN/that are/VBP/are between/IN/between those/DT/those of/IN/of positions/NNS/positions x/VBP/x and/CC/and y/NN/y /,/, and/CC/and all/DT/all keys/NNS/keys in/IN/in subtree/JJ/subtree t3/NNP/t3 have/VBP/have keys/NNS/keys that/IN/that are/VBP/are greater/JJR/greater than/IN/than that/DT/that of/IN/of position/NN/position y/NNP/y. to/TO/to maintain/VB/maintain the/DT/the binary/JJ/binary search/NN/search tree/NN/tree property/NN/property through/IN/through a/DT/a rotation/NN/rotation /,/, we/PRP/we note/VBP/note that/IN/that if/IN/if position/NN/position x/NN/x was/VBD/was a/DT/a left/VBN/left child/NN/child of/IN/of position/NN/position y/NN/y prior/RB/prior to/TO/to a/DT/a rotation/NN/rotation /:/( and/CC/and therefore/RB/therefore the/DT/the key/JJ/key of/IN/of x/NN/x is/VBZ/is less/JJR/less than/IN/than the/DT/the key/JJ/key of/IN/of y/NN/y /:/) /,/, then/RB/then y/JJ/y becomes/NNS/becomes the/DT/the right/NN/right child/NN/child of/IN/of x/NN/x after/IN/after the/DT/the rotation/NN/rotation /,/, and/CC/and vice/NN/vice versa/NNP/versa. furthermore/NN/furthermore /,/, we/PRP/we must/MD/must relink/VB/relink the/DT/the subtree/NN/subtree of/IN/of items/NNS/items with/IN/with keys/NNS/keys that/IN/that lie/NN/lie between/IN/between the/DT/the keys/NNS/keys of/IN/of the/DT/the two/CD/two positions/NNS/positions that/WDT/that are/VBP/are being/VBG/being rotated/NNP/rotated. for/IN/for example/NN/example /,/, in/IN/in figure/NN/figure 11.8/CD/11.8 the/DT/the subtree/JJ/subtree labeled/VBN/labeled t2/NNP/t2 represents/NNS/represents items/NNS/items with/IN/with keys/NNS/keys that/IN/that are/VBP/are known/VBN/known to/TO/to be/VB/be greater/JJR/greater than/IN/than that/DT/that of/IN/of position/NN/position x/NN/x and/CC/and less/JJR/less than/IN/than that/DT/that of/IN/of position/NN/position y/NNP/y. in/IN/in the/DT/the first/JJ/first configuration/NN/configuration of/IN/of that/DT/that figure/NN/figure /,/, t2/NNP/t2 is/VBZ/is the/DT/the right/NN/right subtree/NN/subtree of/IN/of position/NN/position x/NN/x ;/:/; in/IN/in the/DT/the second/JJ/second configuration/NN/configuration /,/, it/PRP/it is/VBZ/is the/DT/the left/VBN/left subtree/NN/subtree of/IN/of position/NN/position y/NNP/y. because/IN/because a/DT/a single/JJ/single rotation/NN/rotation modifies/NNS/modifies a/DT/a constant/JJ/constant number/NN/number of/IN/of parent-child/JJ/parent-child relationships/NNS/relationships /,/, it/PRP/it can/MD/can be/VB/be implemented/VBN/implemented in/IN/in o/NN/o /:/( 1/CD/1 /CD/) time/NN/time with/IN/with a/DT/a linked/VBN/linked binary/JJ/binary tree/NN/tree representation/NNP/representation. 476/CD/476 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees in/IN/in the/DT/the context/NN/context of/IN/of a/DT/a tree-balancing/JJ/tree-balancing algorithm/NN/algorithm /,/, a/DT/a rotation/NN/rotation allows/VBZ/allows the/DT/the shape/NN/shape of/IN/of a/DT/a tree/NN/tree to/TO/to be/VB/be modified/VBN/modified while/IN/while maintaining/NN/maintaining the/DT/the search/NN/search tree/NN/tree property/NNP/property. if/IN/if used/VBN/used wisely/RB/wisely /,/, this/DT/this operation/NN/operation can/MD/can be/VB/be performed/VBN/performed to/TO/to avoid/VB/avoid highly/RB/highly unbalanced/VBN/unbalanced tree/NN/tree configurations/NNP/configurations. for/IN/for example/NN/example /,/, a/DT/a rightward/NN/rightward rotation/NN/rotation from/IN/from the/DT/the first/JJ/first formation/NN/formation of/IN/of figure/NN/figure 11.8/CD/11.8 to/TO/to the/DT/the second/JJ/second reduces/NNS/reduces the/DT/the depth/NN/depth of/IN/of each/DT/each node/NN/node in/IN/in subtree/NN/subtree t1/NNP/t1 by/IN/by one/CD/one /,/, while/IN/while increasing/VBG/increasing the/DT/the depth/NN/depth of/IN/of each/DT/each node/NN/node in/IN/in subtree/NN/subtree t3/NNP/t3 by/IN/by one/NNP/one. /NNP/( note/NN/note that/IN/that the/DT/the depth/NN/depth of/IN/of nodes/NNS/nodes in/IN/in subtree/JJ/subtree t2/NNP/t2 are/VBP/are unaffected/VBN/unaffected by/IN/by the/DT/the rotation/NNP/rotation. /NNP/) one/CD/one or/CC/or more/JJR/more rotations/NNS/rotations can/MD/can be/VB/be combined/VBN/combined to/TO/to provide/VB/provide broader/JJR/broader rebalancing/NN/rebalancing within/IN/within a/DT/a tree/NNP/tree. one/CD/one such/JJ/such compound/NN/compound operation/NN/operation we/PRP/we consider/VBP/consider is/VBZ/is a/DT/a trinode/NN/trinode restructuring/NNP/restructuring. for/IN/for this/DT/this manipulation/NN/manipulation /,/, we/PRP/we consider/VBP/consider a/DT/a position/NN/position x/NN/x /,/, its/PRP$/its parent/NN/parent y/NN/y /,/, and/CC/and its/PRP$/its grandparent/NN/grandparent z/NNP/z. the/DT/the goal/NN/goal is/VBZ/is to/TO/to restructure/VB/restructure the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at z/NN/z in/IN/in order/NN/order to/TO/to reduce/VB/reduce the/DT/the overall/JJ/overall path/NN/path length/NN/length to/TO/to x/VB/x and/CC/and its/PRP$/its subtrees/NNP/subtrees. pseudo-code/NNP/pseudo-code for/IN/for a/DT/a restructure/NN/restructure /:/( x/NN/x /:/) method/NN/method is/VBZ/is given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 11.9/CD/11.9 and/CC/and illustrated/VBD/illustrated in/IN/in figure/NN/figure 11.9/CD/11.9. in/IN/in describing/NN/describing a/DT/a trinode/NN/trinode restructuring/VBG/restructuring /,/, we/PRP/we temporarily/RB/temporarily rename/VBD/rename the/DT/the positions/NNS/positions x/VBP/x /,/, y/NN/y /,/, and/CC/and z/NN/z as/IN/as a/DT/a /,/, b/NN/b /,/, and/CC/and c/NN/c /,/, so/RB/so that/IN/that a/DT/a precedes/NNS/precedes b/NN/b and/CC/and b/NN/b precedes/NNS/precedes c/VBP/c in/IN/in an/DT/an inorder/NN/inorder traversal/NN/traversal of/IN/of t/NNP/t. there/EX/there are/VBP/are four/CD/four possible/JJ/possible orientations/NNS/orientations mapping/VBG/mapping x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z to/TO/to a/DT/a /,/, b/NN/b /,/, and/CC/and c/NN/c /,/, as/IN/as shown/NN/shown in/IN/in figure/NN/figure 11.9/CD/11.9 /,/, which/WDT/which are/VBP/are unified/VBN/unified into/IN/into one/CD/one case/NN/case by/IN/by our/PRP$/our relabeling/NNP/relabeling. the/DT/the trinode/NN/trinode restructuring/VBG/restructuring replaces/NNS/replaces z/NN/z with/IN/with the/DT/the node/NN/node identified/VBD/identified as/IN/as b/NN/b /,/, makes/VBZ/makes the/DT/the children/NNS/children of/IN/of this/DT/this node/NN/node be/VB/be a/DT/a and/CC/and c/NN/c /,/, and/CC/and makes/VBZ/makes the/DT/the children/NNS/children of/IN/of a/DT/a and/CC/and c/NN/c be/VB/be the/DT/the four/CD/four previous/JJ/previous children/NNS/children of/IN/of x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z /:/( other/JJ/other than/IN/than x/NN/x and/CC/and y/NN/y /:/) /,/, while/IN/while maintaining/VBG/maintaining the/DT/the inorder/NN/inorder relationships/NNS/relationships of/IN/of all/DT/all the/DT/the nodes/NNS/nodes in/IN/in t/NNP/t. algorithm/NN/algorithm restructure/NN/restructure /:/( x/NN/x /:/) /:/: input/NN/input /:/: a/DT/a position/NN/position x/NN/x of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t that/WDT/that has/VBZ/has both/DT/both a/DT/a parent/NN/parent y/NN/y and/CC/and a/DT/a grandparent/NN/grandparent z/NN/z output/NN/output /:/: tree/NN/tree t/NN/t after/IN/after a/DT/a trinode/NN/trinode restructuring/VBG/restructuring /NN/( which/WDT/which corresponds/NNS/corresponds to/TO/to a/DT/a single/JJ/single or/CC/or double/JJ/double rotation/NN/rotation /:/) involving/VBG/involving positions/NNS/positions x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z 1/CD/1 /:/: let/JJ/let /NN/( a/DT/a /,/, b/NN/b /,/, c/NN/c /:/) be/VB/be a/DT/a left-to-right/JJ/left-to-right /NN/( inorder/NN/inorder /:/) listing/NN/listing of/IN/of the/DT/the positions/NNS/positions x/VBP/x /,/, y/NN/y /,/, and/CC/and z/NN/z /,/, and/CC/and let/VB/let /:/( t1,t2,t3,t4/-NONE-/t1,t2,t3,t4 /:/) be/VB/be a/DT/a left-to-right/JJ/left-to-right /NN/( inorder/NN/inorder /:/) listing/NN/listing of/IN/of the/DT/the four/CD/four subtrees/NNS/subtrees of/IN/of x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z not/RB/not rooted/VBN/rooted at/IN/at x/NN/x /,/, y/NN/y /,/, or/CC/or z/NNP/z. 2/CD/2 /:/: replace/NN/replace the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at z/NN/z with/IN/with a/DT/a new/JJ/new subtree/NN/subtree rooted/VBN/rooted at/IN/at b/NNP/b. 3/CD/3 /:/: let/JJ/let a/DT/a be/NN/be the/DT/the left/NN/left child/NN/child of/IN/of b/NN/b and/CC/and let/VB/let t1/NNP/t1 and/CC/and t2/NNP/t2 be/VB/be the/DT/the left/NN/left and/CC/and right/RB/right subtrees/VBZ/subtrees of/IN/of a/DT/a /,/, respectively/NNP/respectively. 4/CD/4 /:/: let/JJ/let c/NN/c be/VB/be the/DT/the right/NN/right child/NN/child of/IN/of b/NN/b and/CC/and let/VB/let t3/NNP/t3 and/CC/and t4/NNP/t4 be/VB/be the/DT/the left/NN/left and/CC/and right/RB/right subtrees/VBZ/subtrees of/IN/of c/NN/c /,/, respectively/NNP/respectively. code/NN/code fragment/NN/fragment 11.9/CD/11.9 /:/: the/DT/the trinode/NN/trinode restructuring/VBG/restructuring operation/NN/operation in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NNP/tree. in/IN/in practice/NN/practice /,/, the/DT/the modification/NN/modification of/IN/of a/DT/a tree/NN/tree t/NN/t caused/VBD/caused by/IN/by a/DT/a trinode/NN/trinode restructuring/VBG/restructuring operation/NN/operation can/MD/can be/VB/be implemented/VBN/implemented through/IN/through case/NN/case analysis/NN/analysis either/DT/either as/IN/as a/DT/a single/JJ/single rotation/NN/rotation /:/( as/IN/as in/IN/in figure/NN/figure 11.9a/CD/11.9a and/CC/and b/NN/b /:/) or/CC/or as/IN/as a/DT/a double/JJ/double rotation/NN/rotation /:/( as/IN/as in/IN/in figure/NN/figure 11.9c/CD/11.9c and/CC/and d/JJ/d /NN/) /./. the/DT/the double/JJ/double rotation/NN/rotation arises/NNS/arises when/WRB/when position/NN/position x/NN/x has/VBZ/has the/DT/the middle/NN/middle of/IN/of the/DT/the three/CD/three relevant/NN/relevant keys/NNS/keys and/CC/and is/VBZ/is first/JJ/first rotated/VBN/rotated above/IN/above its/PRP$/its parent/NN/parent /,/, and/CC/and then/RB/then above/IN/above what/WP/what was/VBD/was originally/RB/originally its/PRP$/its grandparent/NNP/grandparent. in/IN/in any/DT/any of/IN/of the/DT/the cases/NNS/cases /,/, the/DT/the trinode/NN/trinode restructuring/VBG/restructuring is/VBZ/is completed/VBN/completed with/IN/with o/NN/o /:/( 1/CD/1 /CD/) running/VBG/running time/NNP/time. 11.2/NNP/11.2. balanced/VBD/balanced search/NN/search trees/NNS/trees 477/CD/477 figure/NN/figure 11.9/CD/11.9 /:/: schematic/JJ/schematic illustration/NN/illustration of/IN/of a/DT/a trinode/NN/trinode restructuring/VBG/restructuring operation/NN/operation /:/: /:/( a/DT/a and/CC/and b/NN/b /:/) require/NN/require a/DT/a single/JJ/single rotation/NN/rotation ;/:/; /:/( c/NN/c and/CC/and d/VBD/d /CD/) require/NN/require a/DT/a double/JJ/double rotation/NNP/rotation. 478/CD/478 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees 11.2.1/CD/11.2.1 python/NN/python framework/NN/framework for/IN/for balancing/NN/balancing search/NN/search trees/NNS/trees our/PRP$/our treemap/NN/treemap class/NN/class /,/, introduced/VBD/introduced in/IN/in section/NN/section 11.1.4/CD/11.1.4 /,/, is/VBZ/is a/DT/a concrete/JJ/concrete map/NN/map implementation/NN/implementation that/WDT/that does/VBZ/does not/RB/not perform/VB/perform any/DT/any explicit/NN/explicit balancing/VBG/balancing operations/NNP/operations. however/RB/however /,/, we/PRP/we designed/VBD/designed that/IN/that class/NN/class to/TO/to also/RB/also serve/VB/serve as/IN/as a/DT/a base/NN/base class/NN/class for/IN/for other/JJ/other subclasses/NNS/subclasses that/IN/that implement/NN/implement more/JJR/more advanced/JJ/advanced tree-balancing/JJ/tree-balancing algorithms/NNP/algorithms. a/DT/a summary/NN/summary of/IN/of our/PRP$/our inheritance/NN/inheritance hierarchy/NN/hierarchy is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 11.10/CD/11.10. hooks/NNS/hooks for/IN/for rebalancing/VBG/rebalancing operations/NNS/operations our/PRP$/our implementation/NN/implementation of/IN/of the/DT/the basic/JJ/basic map/NN/map operations/NNS/operations in/IN/in section/NN/section 11.1.4/CD/11.1.4 includes/VBZ/includes strategic/JJ/strategic calls/NNS/calls to/TO/to three/CD/three nonpublic/JJ/nonpublic methods/NNS/methods that/WDT/that serve/VB/serve as/IN/as hooks/NNS/hooks for/IN/for rebalancing/VBG/rebalancing algorithms/NNS/algorithms /:/: a/DT/a call/NN/call to/TO/to rebalance/NN/rebalance insert/NN/insert /:/( p/NN/p /:/) is/VBZ/is made/VBN/made from/IN/from within/IN/within the/DT/the setitem/NN/setitem method/NN/method immediately/RB/immediately after/IN/after a/DT/a new/JJ/new node/NN/node is/VBZ/is added/VBN/added to/TO/to the/DT/the tree/NN/tree at/IN/at position/NN/position p/NNP/p. a/DT/a call/NN/call to/TO/to rebalance/NN/rebalance delete/VB/delete /:/( p/NN/p /:/) is/VBZ/is made/VBN/made each/DT/each time/NN/time a/DT/a node/NN/node has/VBZ/has been/VBN/been deleted/VBN/deleted from/IN/from the/DT/the tree/NN/tree /,/, with/IN/with position/NN/position p/NN/p identifying/VBG/identifying the/DT/the parent/NN/parent of/IN/of the/DT/the node/NN/node that/IN/that has/VBZ/has just/RB/just been/VBN/been removed/NNP/removed. formally/RB/formally /,/, this/DT/this hook/NN/hook is/VBZ/is called/VBN/called from/IN/from within/IN/within the/DT/the public/NN/public delete/NN/delete /:/( p/NN/p /:/) method/NN/method /,/, which/WDT/which is/VBZ/is indirectly/RB/indirectly invoked/VBN/invoked by/IN/by the/DT/the public/NN/public delitem/NN/delitem /:/( k/NN/k /:/) behavior/NNP/behavior. we/PRP/we also/RB/also provide/VBP/provide a/DT/a hook/NN/hook /,/, rebalance/NN/rebalance access/NN/access /:/( p/NN/p /:/) /,/, that/IN/that is/VBZ/is called/VBN/called when/WRB/when an/DT/an item/NN/item at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a tree/NN/tree is/VBZ/is accessed/VBN/accessed through/IN/through a/DT/a public/JJ/public method/NN/method such/JJ/such as/IN/as getitem/NN/getitem /./. this/DT/this hook/NN/hook is/VBZ/is used/VBN/used by/IN/by the/DT/the splay/NN/splay tree/NN/tree structure/NN/structure /:/( see/NN/see section/NN/section 11.4/CD/11.4 /CD/) to/TO/to restructure/VB/restructure a/DT/a tree/NN/tree so/IN/so that/IN/that more/JJR/more frequently/RB/frequently accessed/VBN/accessed items/NNS/items are/VBP/are brought/VBN/brought closer/RBR/closer to/TO/to the/DT/the root/NNP/root. we/PRP/we provide/VBP/provide trivial/JJ/trivial declarations/NNS/declarations of/IN/of these/DT/these three/CD/three methods/NNS/methods /,/, in/IN/in code/NN/code fragment/NN/fragment 11.10/CD/11.10 /,/, having/VBG/having bodies/NNS/bodies that/WDT/that do/VBP/do nothing/NN/nothing /:/( using/VBG/using the/DT/the pass/NN/pass statement/NN/statement /:/) /./. a/DT/a subclass/NN/subclass of/IN/of treemap/NN/treemap may/MD/may override/VB/override any/DT/any of/IN/of these/DT/these methods/NNS/methods to/TO/to implement/VB/implement a/DT/a nontrivial/JJ/nontrivial action/NN/action to/TO/to rebalance/NN/rebalance a/DT/a tree/NNP/tree. this/DT/this is/VBZ/is another/DT/another example/NN/example of/IN/of the/DT/the template/NN/template method/NN/method design/NN/design pattern/NN/pattern /,/, as/IN/as seen/VBN/seen in/IN/in 11.2/CD/11.2. balanced/VBN/balanced search/NN/search trees/NNS/trees 479/CD/479 174/CD/174 def/NN/def rebalance/NN/rebalance insert/NN/insert /:/( self/NN/self /,/, p/NN/p /:/) /:/: pass/NN/pass 175/CD/175 def/NN/def rebalance/NN/rebalance delete/NN/delete /:/( self/NN/self /,/, p/NN/p /:/) /:/: pass/NN/pass 176/CD/176 def/NN/def rebalance/NN/rebalance access/NN/access /:/( self/NN/self /,/, p/NN/p /:/) /:/: pass/NN/pass code/NN/code fragment/NN/fragment 11.10/CD/11.10 /:/: additional/JJ/additional code/NN/code for/IN/for the/DT/the treemap/NN/treemap class/NN/class /:/( continued/VBD/continued from/IN/from code/NN/code fragment/NN/fragment 11.8/CD/11.8 /CD/) /,/, providing/VBG/providing stubs/NNS/stubs for/IN/for the/DT/the rebalancing/VBG/rebalancing hooks/NNP/hooks. nonpublic/JJ/nonpublic methods/NNS/methods for/IN/for rotating/VBG/rotating and/CC/and restructuring/VBG/restructuring a/DT/a second/JJ/second form/NN/form of/IN/of support/NN/support for/IN/for balanced/VBN/balanced search/NN/search trees/NNS/trees is/VBZ/is our/PRP$/our inclusion/NN/inclusion of/IN/of nonpublic/JJ/nonpublic utility/NN/utility methods/NNS/methods rotate/VBP/rotate and/CC/and restructure/NN/restructure that/IN/that /,/, respectively/RB/respectively /,/, implement/NN/implement a/DT/a single/JJ/single rotation/NN/rotation and/CC/and a/DT/a trinode/NN/trinode restructuring/VBG/restructuring /NN/( described/VBD/described at/IN/at the/DT/the beginning/NN/beginning of/IN/of section/NN/section 11.2/CD/11.2 /CD/) /./. although/IN/although these/DT/these methods/NNS/methods are/VBP/are not/RB/not invoked/VBN/invoked by/IN/by the/DT/the public/NN/public treemap/NN/treemap operations/NNS/operations /,/, we/PRP/we promote/VBP/promote code/NN/code reuse/NN/reuse by/IN/by providing/NN/providing these/DT/these implementation/NN/implementation in/IN/in this/DT/this class/NN/class so/IN/so that/IN/that they/PRP/they are/VBP/are inherited/VBN/inherited by/IN/by all/DT/all balanced-tree/JJ/balanced-tree subclasses/NNP/subclasses. our/PRP$/our implementations/NNS/implementations are/VBP/are provided/VBN/provided in/IN/in code/NN/code fragment/NN/fragment 11.11/CD/11.11. to/TO/to simplify/VB/simplify the/DT/the code/NN/code /,/, we/PRP/we define/VBP/define an/DT/an additional/JJ/additional relink/NN/relink utility/NN/utility that/WDT/that properly/RB/properly links/VBZ/links parent/NN/parent and/CC/and child/NN/child nodes/NNS/nodes to/TO/to each/DT/each other/JJ/other /,/, including/VBG/including the/DT/the special/JJ/special case/NN/case in/IN/in which/WDT/which a/DT/a child/NN/child is/VBZ/is a/DT/a none/NN/none reference/NNP/reference. the/DT/the focus/NN/focus of/IN/of the/DT/the rotate/NN/rotate method/NN/method then/RB/then becomes/VBZ/becomes redefining/VBG/redefining the/DT/the relationship/NN/relationship between/IN/between the/DT/the parent/NN/parent and/CC/and child/NN/child /,/, relinking/VBG/relinking a/DT/a rotated/JJ/rotated node/NN/node directly/RB/directly to/TO/to its/PRP$/its original/JJ/original grandparent/NN/grandparent /,/, and/CC/and shifting/VBG/shifting the/DT/the middle/NN/middle subtree/NN/subtree /:/( that/IN/that labeled/VBN/labeled as/IN/as t2/NNP/t2 in/IN/in figure/NN/figure 11.8/CD/11.8 /CD/) between/IN/between the/DT/the rotated/VBN/rotated nodes/NNP/nodes. for/IN/for the/DT/the trinode/NN/trinode restructuring/VBG/restructuring /,/, we/PRP/we determine/VBP/determine whether/IN/whether to/TO/to perform/NN/perform a/DT/a single/JJ/single or/CC/or double/JJ/double rotation/NN/rotation /,/, as/IN/as originally/RB/originally described/VBN/described in/IN/in figure/NN/figure 11.9/CD/11.9. factory/NN/factory for/IN/for creating/NN/creating tree/NN/tree nodes/VBZ/nodes we/PRP/we draw/VBP/draw attention/NN/attention to/TO/to an/DT/an important/JJ/important subtlety/NN/subtlety in/IN/in the/DT/the design/NN/design of/IN/of both/DT/both our/PRP$/our treemap/NN/treemap class/NN/class and/CC/and the/DT/the original/JJ/original linkedbinarytree/NN/linkedbinarytree subclass/NNP/subclass. the/DT/the low-level/NNP/low-level definition/NN/definition of/IN/of a/DT/a node/NN/node is/VBZ/is provided/VBN/provided by/IN/by the/DT/the nested/VBN/nested node/NN/node class/NN/class within/IN/within linkedbinarytree/NNP/linkedbinarytree. yet/RB/yet /,/, several/JJ/several of/IN/of our/PRP$/our tree-balancing/JJ/tree-balancing strategies/NNS/strategies require/VBP/require that/IN/that auxiliary/JJ/auxiliary information/NN/information be/VB/be stored/VBN/stored at/IN/at each/DT/each node/NN/node to/TO/to guide/VB/guide the/DT/the balancing/NN/balancing process/NNP/process. those/DT/those classes/NNS/classes will/MD/will override/VB/override the/DT/the nested/VBN/nested node/NN/node class/NN/class to/TO/to provide/VB/provide storage/NN/storage for/IN/for an/DT/an additional/JJ/additional field/NNP/field. whenever/NN/whenever we/PRP/we add/VBP/add a/DT/a new/JJ/new node/NN/node to/TO/to the/DT/the tree/NN/tree /,/, as/IN/as within/IN/within the/DT/the add/NN/add right/RB/right method/JJ/method of/IN/of the/DT/the linkedbinarytree/JJ/linkedbinarytree /NN/( originally/RB/originally given/VBN/given in/IN/in code/NN/code fragment/NN/fragment 8.10/CD/8.10 /CD/) /,/, we/PRP/we intentionally/RB/intentionally instantiate/VBP/instantiate the/DT/the node/NN/node using/VBG/using the/DT/the syntax/NN/syntax self/NNP/self. node/NN/node /,/, rather/RB/rather than/IN/than the/DT/the qualified/VBN/qualified name/NN/name linkedbinarytree/NNP/linkedbinarytree. node/NNP/node. this/DT/this is/VBZ/is vital/JJ/vital to/TO/to our/PRP$/our framework/NN/framework !/./! when/WRB/when the/DT/the expression/NN/expression self/NNP/self. node/NN/node is/VBZ/is applied/VBN/applied to/TO/to an/DT/an instance/NN/instance of/IN/of a/DT/a tree/NN/tree /:/( sub/NN/sub /:/) class/NN/class /,/, python/NN/python s/NNS/s name/VBD/name resolution/NN/resolution follows/VBZ/follows the/DT/the inheritance/NN/inheritance structure/NN/structure /:/( as/IN/as described/VBN/described in/IN/in section/NN/section 2.5.2/CD/2.5.2 /CD/) /./. if/IN/if a/DT/a subclass/NN/subclass has/VBZ/has overridden/VBN/overridden the/DT/the definition/NN/definition for/IN/for the/DT/the node/NN/node class/NN/class /,/, instantiation/NN/instantiation of/IN/of self/NNP/self. node/NN/node relies/VBZ/relies on/IN/on the/DT/the newly/RB/newly defined/VBN/defined node/NN/node class/NNP/class. this/DT/this technique/NN/technique is/VBZ/is an/DT/an example/NN/example of/IN/of the/DT/the factory/NN/factory method/NN/method design/NN/design pattern/NN/pattern /,/, as/IN/as we/PRP/we provide/VBP/provide a/DT/a subclass/NN/subclass the/DT/the means/NNS/means to/TO/to control/NN/control the/DT/the type/NN/type of/IN/of node/NN/node that/IN/that is/VBZ/is created/VBN/created within/IN/within methods/NNS/methods of/IN/of the/DT/the parent/NN/parent class/NNP/class. chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees code/VBP/code fragment/NN/fragment 11.11/CD/11.11 /:/: additional/JJ/additional code/NN/code for/IN/for the/DT/the treemap/NN/treemap class/NN/class /:/( continued/VBD/continued from/IN/from code/NN/code fragment/NN/fragment 11.10/CD/11.10 /CD/) /,/, to/TO/to provide/VB/provide nonpublic/JJ/nonpublic utilities/NNS/utilities for/IN/for balanced/VBN/balanced search/NN/search tree/NN/tree subclasses/NNP/subclasses. 11.3/CD/11.3. avl/NN/avl trees/NNS/trees 481/CD/481 11.3/CD/11.3 avl/NN/avl trees/NNS/trees the/DT/the treemap/NN/treemap class/NN/class /,/, which/WDT/which uses/NNS/uses a/DT/a standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree as/IN/as its/PRP$/its data/NNS/data structure/NN/structure /,/, should/MD/should be/VB/be an/DT/an efficient/JJ/efficient map/NN/map data/NNS/data structure/NN/structure /,/, but/CC/but its/PRP$/its worst-case/JJ/worst-case performance/NN/performance for/IN/for the/DT/the various/JJ/various operations/NNS/operations is/VBZ/is linear/JJ/linear time/NN/time /,/, because/IN/because it/PRP/it is/VBZ/is possible/JJ/possible that/IN/that a/DT/a series/NN/series of/IN/of operations/NNS/operations results/NNS/results in/IN/in a/DT/a tree/NN/tree with/IN/with linear/JJ/linear height/NNP/height. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we describe/VBP/describe a/DT/a simple/JJ/simple balancing/NN/balancing strategy/NN/strategy that/WDT/that guarantees/VBZ/guarantees worst-case/JJ/worst-case logarithmic/JJ/logarithmic running/NN/running time/NN/time for/IN/for all/DT/all the/DT/the fundamental/JJ/fundamental map/NN/map operations/NNP/operations. definition/NN/definition of/IN/of an/DT/an avl/NN/avl tree/NN/tree the/DT/the simple/NN/simple correction/NN/correction is/VBZ/is to/TO/to add/VB/add a/DT/a rule/NN/rule to/TO/to the/DT/the binary/JJ/binary search/NN/search tree/NN/tree definition/NN/definition that/WDT/that will/MD/will maintain/VB/maintain a/DT/a logarithmic/JJ/logarithmic height/NN/height for/IN/for the/DT/the tree/NNP/tree. although/IN/although we/PRP/we originally/RB/originally defined/VBN/defined the/DT/the height/NN/height of/IN/of a/DT/a subtree/JJ/subtree rooted/VBN/rooted at/IN/at position/NN/position p/NN/p of/IN/of a/DT/a tree/NN/tree to/TO/to be/VB/be the/DT/the number/NN/number of/IN/of edges/NNS/edges on/IN/on the/DT/the longest/JJS/longest path/NN/path from/IN/from p/NN/p to/TO/to a/DT/a leaf/NN/leaf /:/( see/NN/see section/NN/section 8.1.3/CD/8.1.3 /CD/) /,/, it/PRP/it is/VBZ/is easier/JJR/easier for/IN/for explanation/NN/explanation in/IN/in this/DT/this section/NN/section to/TO/to consider/VB/consider the/DT/the height/NN/height to/TO/to be/VB/be the/DT/the number/NN/number of/IN/of nodes/NNS/nodes on/IN/on such/JJ/such a/DT/a longest/NN/longest path/NNP/path. by/IN/by this/DT/this definition/NN/definition /,/, a/DT/a leaf/NN/leaf position/NN/position has/VBZ/has height/VBN/height 1/CD/1 /,/, while/IN/while we/PRP/we trivially/RB/trivially define/VBP/define the/DT/the height/NN/height of/IN/of a/DT/a null/JJ/null child/NN/child to/TO/to be/VB/be 0/CD/0. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we consider/VBP/consider the/DT/the following/VBG/following height-balance/NN/height-balance property/NN/property /,/, which/WDT/which characterizes/VBZ/characterizes the/DT/the structure/NN/structure of/IN/of a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t in/IN/in terms/NNS/terms of/IN/of the/DT/the heights/NNS/heights of/IN/of its/PRP$/its nodes/NNP/nodes. height-balance/NNP/height-balance property/NN/property /:/: for/IN/for every/DT/every position/NN/position p/NN/p of/IN/of t/NN/t /,/, the/DT/the heights/NNS/heights of/IN/of the/DT/the children/NNS/children of/IN/of p/NN/p differ/NN/differ by/IN/by atmost/NN/atmost 1/CD/1. any/DT/any binary/JJ/binary search/NN/search tree/NN/tree t/NN/t that/WDT/that satisfies/VBZ/satisfies the/DT/the height-balance/NN/height-balance property/NN/property is/VBZ/is said/VBN/said to/TO/to be/VB/be an/DT/an avl/NN/avl tree/NN/tree /,/, named/VBD/named after/IN/after the/DT/the initials/NNS/initials of/IN/of its/PRP$/its inventors/NNS/inventors /:/: adel/NN/adel son-vel/NN/son-vel skii/NN/skii and/CC/and landis/NNP/landis. an/DT/an example/NN/example of/IN/of an/DT/an avl/NN/avl tree/NN/tree is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 11.11/CD/11.11. figure/NN/figure 11.11/CD/11.11 /:/: an/DT/an example/NN/example of/IN/of an/DT/an avl/NN/avl tree/NNP/tree. the/DT/the keys/NNS/keys of/IN/of the/DT/the items/NNS/items are/VBP/are shown/VBN/shown inside/NN/inside the/DT/the nodes/NNS/nodes /,/, and/CC/and the/DT/the heights/NNS/heights of/IN/of the/DT/the nodes/NNS/nodes are/VBP/are shown/VBN/shown above/IN/above the/DT/the nodes/NNS/nodes /:/( with/IN/with empty/JJ/empty subtrees/NNS/subtrees having/VBG/having height/NN/height 0/-NONE-/0 /./) /./. chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees an/DT/an immediate/JJ/immediate consequence/NN/consequence of/IN/of the/DT/the height-balance/NN/height-balance property/NN/property is/VBZ/is that/IN/that a/DT/a subtree/JJ/subtree of/IN/of an/DT/an avl/NN/avl tree/NN/tree is/VBZ/is itself/PRP/itself an/DT/an avl/NN/avl tree/NNP/tree. the/DT/the height-balance/NN/height-balance property/NN/property has/VBZ/has also/RB/also the/DT/the important/JJ/important consequence/NN/consequence of/IN/of keeping/VBG/keeping the/DT/the height/NN/height small/JJ/small /,/, as/IN/as shown/NN/shown in/IN/in the/DT/the following/JJ/following proposition/NNP/proposition. proposition/NN/proposition 11.2/CD/11.2 /:/: the/DT/the height/NN/height of/IN/of an/DT/an avl/NN/avl tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. justification/NN/justification /:/: instead/RB/instead of/IN/of trying/VBG/trying to/TO/to find/VB/find an/DT/an upper/JJ/upper bound/NN/bound on/IN/on the/DT/the height/NN/height of/IN/of an/DT/an avl/NN/avl tree/NN/tree directly/RB/directly /,/, it/PRP/it turns/VBZ/turns out/RP/out to/TO/to be/VB/be easier/JJR/easier to/TO/to work/VB/work on/IN/on the/DT/the inverse/NN/inverse problem/NN/problem of/IN/of finding/NN/finding a/DT/a lower/JJR/lower bound/NN/bound on/IN/on the/DT/the minimum/JJ/minimum number/NN/number of/IN/of nodes/NNS/nodes n/VBP/n /:/( h/NN/h /:/) of/IN/of an/DT/an avl/NN/avl tree/NN/tree with/IN/with height/NN/height h/NNP/h. we/PRP/we will/MD/will show/VB/show that/IN/that n/NN/n /:/( h/NN/h /:/) grows/VBZ/grows at/IN/at least/JJS/least exponentially/NNP/exponentially. from/IN/from this/DT/this /,/, it/PRP/it will/MD/will be/VB/be an/DT/an easy/JJ/easy step/NN/step to/TO/to derive/VB/derive that/IN/that the/DT/the height/NN/height of/IN/of an/DT/an avl/NN/avl tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. we/PRP/we begin/VBP/begin by/IN/by noting/VBG/noting that/IN/that n/NN/n /:/( 1/CD/1 /CD/) =/CD/= 1/CD/1 and/CC/and n/NN/n /:/( 2/CD/2 /CD/) =/CD/= 2/CD/2 /,/, because/IN/because an/DT/an avl/NN/avl tree/NN/tree of/IN/of height/NN/height 1/CD/1 must/MD/must have/VB/have exactly/RB/exactly one/CD/one node/NN/node and/CC/and an/DT/an avl/NN/avl tree/NN/tree of/IN/of height/NN/height 2/CD/2 must/MD/must have/VB/have at/IN/at least/JJS/least two/CD/two nodes/NNP/nodes. now/RB/now /,/, an/DT/an avl/NN/avl tree/NN/tree with/IN/with the/DT/the minimum/JJ/minimum number/NN/number of/IN/of nodes/NNS/nodes having/VBG/having height/NN/height h/NN/h for/IN/for h/NN/h 3/CD/3 /,/, is/VBZ/is such/JJ/such that/IN/that both/DT/both its/PRP$/its subtrees/NNS/subtrees are/VBP/are avl/JJ/avl trees/NNS/trees with/IN/with the/DT/the minimum/JJ/minimum number/NN/number of/IN/of nodes/NNS/nodes /:/: one/CD/one with/IN/with height/JJ/height h/NN/h 1/CD/1 and/CC/and the/DT/the other/JJ/other with/IN/with height/JJ/height h/NN/h 2/CD/2. taking/VBG/taking the/DT/the root/NN/root into/IN/into account/NN/account /,/, we/PRP/we obtain/VBP/obtain the/DT/the following/VBG/following formula/NN/formula that/IN/that relates/NNS/relates n/VBP/n /:/( h/NN/h /:/) to/TO/to n/VB/n /:/( h/NN/h 1/CD/1 /CD/) and/CC/and n/NN/n /:/( h/NN/h 2/CD/2 /CD/) /,/, for/IN/for h/NN/h 3/CD/3 /:/: n/JJ/n /NN/( h/NN/h /:/) =/:/= 1/CD/1 +/CD/+ n/NN/n /:/( h/NN/h 1/CD/1 /CD/) +/CD/+ n/NN/n /:/( h/NN/h 2/CD/2 /CD/) /./. /CD/( 11.1/CD/11.1 /CD/) at/IN/at this/DT/this point/NN/point /,/, the/DT/the reader/NN/reader familiar/NN/familiar with/IN/with the/DT/the properties/NNS/properties of/IN/of fibonacci/NN/fibonacci progressions/NNS/progressions /:/( section/NN/section 1.8/CD/1.8 and/CC/and exercise/VB/exercise c-3.49/-NONE-/c-3.49 /./) will/MD/will already/RB/already see/VB/see that/IN/that n/NN/n /:/( h/NN/h /:/) is/VBZ/is a/DT/a function/NN/function exponential/NN/exponential in/IN/in h/NNP/h. to/TO/to formalize/VB/formalize that/IN/that observation/NN/observation /,/, we/PRP/we proceed/VBD/proceed as/IN/as follows/NNP/follows. formula/NN/formula 11.1/CD/11.1 implies/NNS/implies that/WDT/that n/NN/n /:/( h/NN/h /:/) is/VBZ/is a/DT/a strictly/RB/strictly increasing/VBG/increasing function/NN/function of/IN/of h/NNP/h. thus/RB/thus /,/, we/PRP/we know/VBP/know that/IN/that n/NN/n /:/( h/NN/h 1/CD/1 /CD/) >/CD/> n/NN/n /:/( h/NN/h 2/CD/2 /CD/) /./. replacing/NN/replacing n/NN/n /:/( h/NN/h 1/CD/1 /CD/) with/IN/with n/JJ/n /NN/( h/NN/h 2/CD/2 /CD/) in/IN/in formula/NN/formula 11.1/CD/11.1 and/CC/and dropping/VBG/dropping the/DT/the 1/CD/1 /,/, we/PRP/we get/VBP/get /,/, for/IN/for h/NN/h 3/CD/3 /,/, n/JJ/n /NN/( h/NN/h /:/) >/:/> 2/CD/2 n/NN/n /:/( h/NN/h 2/CD/2 /CD/) /./. /CD/( 11.2/CD/11.2 /CD/) formula/NN/formula 11.2/CD/11.2 indicates/NNS/indicates that/WDT/that n/NN/n /:/( h/NN/h /:/) at/IN/at least/JJS/least doubles/NNS/doubles each/DT/each time/NN/time h/NN/h increases/NNS/increases by/IN/by 2/CD/2 /,/, which/WDT/which intuitively/RB/intuitively means/VBZ/means that/IN/that n/NN/n /:/( h/NN/h /:/) grows/VBZ/grows exponentially/NNP/exponentially. to/TO/to show/VB/show this/DT/this fact/NN/fact in/IN/in a/DT/a formal/JJ/formal way/NN/way /,/, we/PRP/we apply/RB/apply formula/VBP/formula 11.2/CD/11.2 repeatedly/RB/repeatedly /,/, yielding/NN/yielding the/DT/the following/VBG/following series/NNS/series of/IN/of inequalities/NNS/inequalities /:/: 11.3/CD/11.3. avl/NN/avl trees/NNS/trees by/IN/by substituting/VBG/substituting the/DT/the above/NN/above value/NN/value of/IN/of i/PRP/i in/IN/in formula/NN/formula 11.3/CD/11.3 /,/, we/PRP/we obtain/VBP/obtain /,/, for/IN/for h/NN/h 3/CD/3 /,/, from/IN/from which/WDT/which we/PRP/we get/VBP/get h/RB/h </:/< 2log/CD/2log /CD/( n/NN/n /:/( h/NN/h /:/) /:/) +/:/+ 2/CD/2 /,/, /:/( 11.5/CD/11.5 /CD/) which/WDT/which implies/NNS/implies that/WDT/that an/DT/an avl/NN/avl tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries has/VBZ/has height/VBN/height at/IN/at most/JJS/most 2logn/CD/2logn +/CD/+ 2/CD/2. by/IN/by proposition/NN/proposition 11.2/CD/11.2 and/CC/and the/DT/the analysis/NN/analysis of/IN/of binary/JJ/binary search/NN/search trees/NNS/trees given/VBN/given in/IN/in section/NN/section 11.1/CD/11.1 /,/, the/DT/the operation/NN/operation getitem/NN/getitem /,/, in/IN/in a/DT/a map/NN/map implemented/VBN/implemented with/IN/with an/DT/an avl/NN/avl tree/NN/tree /,/, runs/VBZ/runs in/IN/in time/NN/time o/NN/o /:/( logn/NN/logn /:/) /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of items/NNS/items in/IN/in the/DT/the map/NNP/map. of/IN/of course/NN/course /,/, we/PRP/we still/RB/still have/VBP/have to/TO/to show/VB/show how/WRB/how to/TO/to maintain/VB/maintain the/DT/the height-balance/NN/height-balance property/NN/property after/IN/after an/DT/an insertion/NN/insertion or/CC/or deletion/NNP/deletion. 11.3.1/CD/11.3.1 update/NN/update operations/NNS/operations given/VBN/given a/DT/a binary/JJ/binary search/NN/search tree/NN/tree t/NN/t /,/, we/PRP/we say/VBP/say that/IN/that a/DT/a position/NN/position is/VBZ/is balanced/VBN/balanced if/IN/if the/DT/the absolute/JJ/absolute value/NN/value of/IN/of the/DT/the difference/NN/difference between/IN/between the/DT/the heights/NNS/heights of/IN/of its/PRP$/its children/NNS/children is/VBZ/is at/IN/at most/JJS/most 1/CD/1 /,/, and/CC/and we/PRP/we say/VBP/say that/IN/that it/PRP/it is/VBZ/is unbalanced/VBN/unbalanced otherwise/-NONE-/otherwise. thus/RB/thus /,/, the/DT/the height-balance/NN/height-balance property/NN/property characterizing/VBG/characterizing avl/NN/avl trees/NNS/trees is/VBZ/is equivalent/JJ/equivalent to/TO/to saying/VBG/saying that/IN/that every/DT/every position/NN/position is/VBZ/is balanced/NNP/balanced. the/DT/the insertion/NN/insertion and/CC/and deletion/NN/deletion operations/NNS/operations for/IN/for avl/NN/avl trees/NNS/trees begin/VBP/begin similarly/RB/similarly to/TO/to the/DT/the corresponding/NN/corresponding operations/NNS/operations for/IN/for /CD/( standard/JJ/standard /NN/) binary/NN/binary search/NN/search trees/NNS/trees /,/, but/CC/but with/IN/with post-processing/JJ/post-processing for/IN/for each/DT/each operation/NN/operation to/TO/to restore/VB/restore the/DT/the balance/NN/balance of/IN/of any/DT/any portions/NNS/portions of/IN/of the/DT/the tree/NN/tree that/IN/that are/VBP/are adversely/RB/adversely affected/VBN/affected by/IN/by the/DT/the change/NNP/change. insertion/NN/insertion suppose/NN/suppose that/WDT/that tree/NN/tree t/VBD/t satisfies/NNS/satisfies the/DT/the height-balance/NN/height-balance property/NN/property /,/, and/CC/and hence/NN/hence is/VBZ/is an/DT/an avl/NN/avl tree/NN/tree /,/, prior/RB/prior to/TO/to the/DT/the insertion/NN/insertion of/IN/of a/DT/a new/JJ/new item/NNP/item. an/DT/an insertion/NN/insertion of/IN/of a/DT/a new/JJ/new item/NN/item in/IN/in a/DT/a binary/JJ/binary search/NN/search tree/NN/tree /,/, as/IN/as described/VBN/described in/IN/in section/NN/section 11.1.3/CD/11.1.3 /,/, results/NNS/results in/IN/in a/DT/a new/JJ/new node/NN/node at/IN/at a/DT/a leaf/NN/leaf position/NN/position p/NNP/p. this/DT/this action/NN/action may/MD/may violate/VB/violate the/DT/the height-balance/NN/height-balance property/NN/property /:/( see/NN/see /,/, for/IN/for example/NN/example /,/, figure/NN/figure 11.12a/CD/11.12a /CD/) /,/, yet/CC/yet the/DT/the only/JJ/only positions/NNS/positions that/WDT/that may/MD/may become/VB/become unbalanced/VBN/unbalanced are/VBP/are ancestors/NNS/ancestors of/IN/of p/NN/p /,/, because/IN/because those/DT/those are/VBP/are the/DT/the only/JJ/only positions/NNS/positions whose/WP$/whose subtrees/NNS/subtrees have/VBP/have changed/NNP/changed. therefore/RB/therefore /,/, let/VB/let us/PRP/us describe/VB/describe how/WRB/how to/TO/to restructure/VB/restructure t/NN/t to/TO/to fix/VB/fix any/DT/any unbalance/NN/unbalance that/IN/that may/MD/may have/VB/have occurred/NNP/occurred. chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees figure/VBP/figure 11.12/CD/11.12 /:/: an/DT/an example/NN/example insertion/NN/insertion of/IN/of an/DT/an item/NN/item with/IN/with key/JJ/key 54/CD/54 in/IN/in the/DT/the avl/NN/avl tree/NN/tree of/IN/of figure/NN/figure 11.11/CD/11.11 /:/: /:/( a/DT/a /NN/) after/IN/after adding/VBG/adding a/DT/a new/JJ/new node/NN/node for/IN/for key/JJ/key 54/CD/54 /,/, the/DT/the nodes/NNS/nodes storing/VBG/storing keys/NNS/keys 78/CD/78 and/CC/and 44/CD/44 become/NN/become unbalanced/VBD/unbalanced ;/:/; /:/( b/NN/b /:/) a/DT/a trinode/NN/trinode restructuring/VBG/restructuring restores/NNS/restores the/DT/the height-balance/NN/height-balance property/NNP/property. we/PRP/we show/VBP/show the/DT/the heights/NNS/heights of/IN/of nodes/NNS/nodes above/IN/above them/PRP/them /,/, and/CC/and we/PRP/we identify/VBP/identify the/DT/the nodes/NNS/nodes x/VBP/x /,/, y/NN/y /,/, and/CC/and z/NN/z and/CC/and subtrees/NNS/subtrees t1/NNP/t1 /,/, t2/NNP/t2 /,/, t3/NNP/t3 /,/, and/CC/and t4/NNP/t4 participating/NN/participating in/IN/in the/DT/the trinode/NN/trinode restructuring/NNP/restructuring. we/PRP/we restore/VBP/restore the/DT/the balance/NN/balance of/IN/of the/DT/the nodes/NNS/nodes in/IN/in the/DT/the binary/JJ/binary search/NN/search tree/NN/tree t/NN/t by/IN/by a/DT/a simple/JJ/simple search-and-repair/JJ/search-and-repair strategy/NNP/strategy. in/IN/in particular/JJ/particular /,/, let/VB/let z/NN/z be/VB/be the/DT/the first/JJ/first position/NN/position we/PRP/we encounter/VBP/encounter in/IN/in going/VBG/going up/RP/up from/IN/from p/NN/p toward/IN/toward the/DT/the root/NN/root of/IN/of t/NN/t such/JJ/such that/IN/that z/NN/z is/VBZ/is unbalanced/VBN/unbalanced /-NONE-/( see/VB/see figure/NN/figure 11.12a/CD/11.12a. /CD/) also/RB/also /,/, let/VB/let y/NN/y denote/NN/denote the/DT/the child/NN/child of/IN/of z/NN/z with/IN/with higher/JJR/higher height/JJ/height /NN/( and/CC/and note/VB/note that/IN/that y/NN/y must/MD/must be/VB/be an/DT/an ancestor/NN/ancestor of/IN/of p/NN/p /:/) /./. finally/RB/finally /,/, let/VB/let x/NN/x be/VB/be the/DT/the child/NN/child of/IN/of y/NN/y with/IN/with higher/JJR/higher height/JJ/height /NN/( there/EX/there can/MD/can not/RB/not be/VB/be a/DT/a tie/NN/tie and/CC/and position/NN/position x/NN/x must/MD/must also/RB/also be/VB/be an/DT/an ancestor/NN/ancestor of/IN/of p/NN/p /,/, possibly/RB/possibly p/VB/p itself/PRP/itself /:/) /./. we/PRP/we rebalance/VBP/rebalance the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at z/NN/z by/IN/by calling/NN/calling the/DT/the trinode/NN/trinode restructuring/VBG/restructuring method/NN/method /,/, restructure/NN/restructure /:/( x/NN/x /:/) /,/, originally/RB/originally described/VBN/described in/IN/in section/NN/section 11.2/CD/11.2. an/DT/an example/NN/example of/IN/of such/JJ/such a/DT/a restructuring/NN/restructuring in/IN/in the/DT/the context/NN/context of/IN/of an/DT/an avl/NN/avl insertion/NN/insertion is/VBZ/is portrayed/VBN/portrayed in/IN/in figure/NN/figure 11.12/CD/11.12. to/TO/to formally/RB/formally argue/VB/argue the/DT/the correctness/NN/correctness of/IN/of this/DT/this process/NN/process in/IN/in reestablishing/NN/reestablishing the/DT/the avl/NN/avl height-balance/NN/height-balance property/NN/property /,/, we/PRP/we consider/VBP/consider the/DT/the implication/NN/implication of/IN/of z/NN/z being/VBG/being the/DT/the nearest/JJS/nearest ancestor/NN/ancestor of/IN/of p/NN/p that/IN/that became/VBD/became unbalanced/VBN/unbalanced after/IN/after the/DT/the insertion/NN/insertion of/IN/of p/NNP/p. it/PRP/it must/MD/must be/VB/be that/IN/that the/DT/the height/NN/height of/IN/of y/NN/y increased/VBN/increased by/IN/by one/CD/one due/JJ/due to/TO/to the/DT/the insertion/NN/insertion and/CC/and that/IN/that it/PRP/it is/VBZ/is now/RB/now 2/CD/2 greater/JJR/greater than/IN/than its/PRP$/its sibling/NNP/sibling. since/IN/since y/NN/y remains/VBZ/remains balanced/VBN/balanced /,/, it/PRP/it must/MD/must be/VB/be that/IN/that it/PRP/it formerly/RB/formerly had/VBD/had subtrees/NNS/subtrees with/IN/with equal/JJ/equal heights/NNS/heights /,/, and/CC/and that/IN/that the/DT/the subtree/NN/subtree containing/VBG/containing x/NN/x has/VBZ/has increased/VBN/increased its/PRP$/its height/NN/height by/IN/by one/NNP/one. that/IN/that subtree/JJ/subtree increased/VBN/increased either/DT/either because/IN/because x/NN/x =/:/= p/NN/p /,/, and/CC/and thus/RB/thus its/PRP$/its height/NN/height changed/VBD/changed from/IN/from 0/-NONE-/0 to/TO/to 1/CD/1 /,/, or/CC/or because/IN/because x/NN/x previously/RB/previously had/VBD/had equal-height/JJ/equal-height subtrees/NNS/subtrees and/CC/and the/DT/the height/NN/height of/IN/of the/DT/the one/CD/one containing/VBG/containing p/NN/p has/VBZ/has increased/VBN/increased by/IN/by 1/CD/1. letting/VBG/letting h/NN/h 0/-NONE-/0 denote/NN/denote the/DT/the height/NN/height of/IN/of the/DT/the tallest/JJS/tallest child/NN/child of/IN/of x/NN/x /,/, this/DT/this scenario/NN/scenario might/MD/might be/VB/be portrayed/VBN/portrayed as/IN/as in/IN/in figure/NN/figure 11.13/CD/11.13. after/IN/after the/DT/the trinode/NN/trinode restructuring/VBG/restructuring /,/, we/PRP/we see/VBP/see that/IN/that each/DT/each of/IN/of x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z has/VBZ/has become/VBN/become balanced/NNP/balanced. furthermore/RB/furthermore /,/, the/DT/the node/NN/node that/IN/that becomes/VBZ/becomes the/DT/the root/NN/root of/IN/of the/DT/the subtree/JJ/subtree after/IN/after the/DT/the restructuring/NN/restructuring has/VBZ/has height/VBN/height h/NN/h +/:/+ 2/CD/2 /,/, which/WDT/which is/VBZ/is precisely/RB/precisely the/DT/the height/NN/height that/IN/that z/NN/z had/VBD/had before/IN/before the/DT/the insertion/NN/insertion of/IN/of the/DT/the new/JJ/new item/NNP/item. therefore/RB/therefore /,/, any/DT/any ancestor/NN/ancestor of/IN/of z/NN/z that/IN/that became/VBD/became temporarily/RB/temporarily unbalanced/VBN/unbalanced becomes/NNS/becomes balanced/VBN/balanced again/RB/again /,/, and/CC/and this/DT/this one/CD/one restructuring/NN/restructuring restores/NNS/restores the/DT/the heightbalance/NN/heightbalance property/NN/property globally/NNP/globally. figure/NN/figure 11.13/CD/11.13 /:/: rebalancing/VBG/rebalancing of/IN/of a/DT/a subtree/JJ/subtree during/IN/during a/DT/a typical/JJ/typical insertion/NN/insertion into/IN/into an/DT/an avl/NN/avl tree/NN/tree /:/: /:/( a/DT/a /NN/) before/IN/before the/DT/the insertion/NN/insertion ;/:/; /:/( b/NN/b /:/) after/IN/after an/DT/an insertion/NN/insertion in/IN/in subtree/NN/subtree t3/NNP/t3 causes/NNS/causes imbalance/NN/imbalance at/IN/at z/NN/z ;/:/; /:/( c/NN/c /:/) after/IN/after restoring/NN/restoring balance/NN/balance with/IN/with trinode/NN/trinode restructuring/NNP/restructuring. notice/NN/notice that/WDT/that the/DT/the overall/JJ/overall height/NN/height of/IN/of the/DT/the subtree/JJ/subtree after/IN/after the/DT/the insertion/NN/insertion is/VBZ/is the/DT/the same/JJ/same as/IN/as before/IN/before the/DT/the insertion/NNP/insertion. chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees deletion/NN/deletion recall/NN/recall that/WDT/that a/DT/a deletion/NN/deletion from/IN/from a/DT/a regular/JJ/regular binary/NN/binary search/NN/search tree/NN/tree results/NNS/results in/IN/in the/DT/the structural/JJ/structural removal/NN/removal of/IN/of a/DT/a node/NN/node having/VBG/having either/DT/either zero/NN/zero or/CC/or one/CD/one children/NNP/children. such/JJ/such a/DT/a change/NN/change may/MD/may violate/VB/violate the/DT/the height-balance/NN/height-balance property/NN/property in/IN/in an/DT/an avl/NN/avl tree/NNP/tree. in/IN/in particular/JJ/particular /,/, if/IN/if position/NN/position p/NN/p represents/VBZ/represents the/DT/the parent/NN/parent of/IN/of the/DT/the removed/VBN/removed node/NN/node in/IN/in tree/NN/tree t/NN/t /,/, there/EX/there may/MD/may be/VB/be an/DT/an unbalanced/VBN/unbalanced node/NN/node on/IN/on the/DT/the path/NN/path from/IN/from p/NN/p to/TO/to the/DT/the root/NN/root of/IN/of t/NNP/t. in/IN/in fact/NN/fact /,/, there/EX/there can/MD/can be/VB/be at/IN/at most/JJS/most one/CD/one such/JJ/such unbalanced/JJ/unbalanced node/NNP/node. figure/NN/figure 11.14/CD/11.14 /:/: deletion/NN/deletion of/IN/of the/DT/the item/NN/item with/IN/with key/JJ/key 32/CD/32 from/IN/from the/DT/the avl/NN/avl tree/NN/tree of/IN/of figure/NN/figure 11.12b/CD/11.12b /:/: /:/( a/DT/a /NN/) after/IN/after removing/VBG/removing the/DT/the node/NN/node storing/VBG/storing key/JJ/key 32/CD/32 /,/, the/DT/the root/NN/root becomes/VBZ/becomes unbalanced/VBN/unbalanced ;/:/; /:/( b/NN/b /:/) a/DT/a /NN/( single/NN/single /:/) rotation/NN/rotation restores/NNS/restores the/DT/the height-balance/NN/height-balance property/NNP/property. as/IN/as with/IN/with insertion/NN/insertion /,/, we/PRP/we use/VBP/use trinode/NN/trinode restructuring/NN/restructuring to/TO/to restore/VB/restore balance/NN/balance in/IN/in the/DT/the tree/NN/tree t/NNP/t. in/IN/in particular/JJ/particular /,/, let/VB/let z/NN/z be/VB/be the/DT/the first/JJ/first unbalanced/VBN/unbalanced position/NN/position encountered/VBN/encountered going/VBG/going up/RP/up from/IN/from p/NN/p toward/IN/toward the/DT/the root/NN/root of/IN/of t/NNP/t. also/RB/also /,/, let/VB/let y/NN/y be/VB/be the/DT/the child/NN/child of/IN/of z/NN/z with/IN/with larger/JJR/larger height/NN/height /:/( note/NN/note that/IN/that position/NN/position y/NN/y is/VBZ/is the/DT/the child/NN/child of/IN/of z/NN/z that/IN/that is/VBZ/is not/RB/not an/DT/an ancestor/NN/ancestor of/IN/of p/NN/p /:/) /,/, and/CC/and let/VB/let x/NN/x be/VB/be the/DT/the child/NN/child of/IN/of y/NN/y defined/VBN/defined as/IN/as follows/NNS/follows /:/: if/IN/if one/CD/one of/IN/of the/DT/the children/NNS/children of/IN/of y/NN/y is/VBZ/is taller/JJR/taller than/IN/than the/DT/the other/JJ/other /,/, let/VB/let x/NN/x be/VB/be the/DT/the taller/NN/taller child/NN/child of/IN/of y/NN/y ;/:/; else/NN/else /:/( both/DT/both children/NNS/children of/IN/of y/NN/y have/VBP/have the/DT/the same/JJ/same height/NN/height /:/) /,/, let/VB/let x/NN/x be/VB/be the/DT/the child/NN/child of/IN/of y/NN/y on/IN/on the/DT/the same/JJ/same side/NN/side as/IN/as y/NN/y /:/( that/IN/that is/VBZ/is /,/, if/IN/if y/NN/y is/VBZ/is the/DT/the left/VBN/left child/NN/child of/IN/of z/NN/z /,/, let/VB/let x/NN/x be/VB/be the/DT/the left/NN/left child/NN/child of/IN/of y/NN/y /,/, else/RB/else let/VB/let x/NN/x be/VB/be the/DT/the right/NN/right child/NN/child of/IN/of y/NN/y /:/) /./. in/IN/in any/DT/any case/NN/case /,/, we/PRP/we then/RB/then perform/NN/perform a/DT/a restructure/NN/restructure /:/( x/NN/x /:/) operation/NNP/operation. /:/( see/VB/see figure/NN/figure 11.14b/CD/11.14b. /CD/) the/DT/the restructured/VBN/restructured subtree/NN/subtree is/VBZ/is rooted/VBN/rooted at/IN/at the/DT/the middle/NN/middle position/NN/position denoted/VBD/denoted as/IN/as b/NN/b in/IN/in the/DT/the description/NN/description of/IN/of the/DT/the trinode/NN/trinode restructuring/VBG/restructuring operation/NNP/operation. the/DT/the height-balance/NN/height-balance property/NN/property is/VBZ/is guaranteed/VBN/guaranteed to/TO/to be/VB/be locally/RB/locally restored/VBN/restored within/IN/within the/DT/the subtree/NN/subtree of/IN/of b/NNP/b. /NNP/( see/VB/see exercises/NNS/exercises r-11.11/-NONE-/r-11.11 and/CC/and r-11.12/-NONE-/r-11.12 /:/) /./. unfortunately/RB/unfortunately /,/, this/DT/this trinode/NN/trinode restructuring/NN/restructuring may/MD/may reduce/VB/reduce the/DT/the height/NN/height of/IN/of the/DT/the subtree/JJ/subtree rooted/VBN/rooted at/IN/at b/NN/b by/IN/by 1/CD/1 /,/, which/WDT/which may/MD/may cause/VB/cause an/DT/an ancestor/NN/ancestor of/IN/of b/NN/b to/TO/to become/VB/become unbalanced/NNP/unbalanced. so/RB/so /,/, after/IN/after rebalancing/NN/rebalancing z/NN/z /,/, we/PRP/we continue/VBP/continue walking/VBG/walking up/RP/up t/NN/t looking/VBG/looking for/IN/for unbalanced/JJ/unbalanced positions/NNP/positions. if/IN/if we/PRP/we find/VBP/find another/DT/another /,/, we/PRP/we perform/VBP/perform a/DT/a restructure/NN/restructure operation/NN/operation to/TO/to restore/VB/restore its/PRP$/its balance/NN/balance /,/, and/CC/and continue/VB/continue marching/VBG/marching up/RP/up t/NN/t looking/VBG/looking for/IN/for more/JJR/more /,/, all/DT/all the/DT/the way/NN/way to/TO/to the/DT/the root/NNP/root. still/RB/still /,/, since/IN/since the/DT/the height/NN/height of/IN/of t/NN/t is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /,/, where/WRB/where n/NN/n is/VBZ/is the/DT/the number/NN/number of/IN/of entries/NNS/entries /,/, by/IN/by proposition/NN/proposition 11.2/CD/11.2 /,/, o/NN/o /:/( logn/NN/logn /:/) trinode/NN/trinode restructurings/NNS/restructurings are/VBP/are sufficient/JJ/sufficient to/TO/to restore/VB/restore the/DT/the height-balance/NN/height-balance property/NNP/property. performance/NN/performance of/IN/of avl/NN/avl trees/NNS/trees by/IN/by proposition/NN/proposition 11.2/CD/11.2 /,/, the/DT/the height/NN/height of/IN/of an/DT/an avl/NN/avl tree/NN/tree with/IN/with n/NN/n items/NNS/items is/VBZ/is guaranteed/VBN/guaranteed to/TO/to be/VB/be o/RB/o /-NONE-/( logn/NN/logn /:/) /./. because/IN/because the/DT/the standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree operation/NN/operation had/VBD/had running/VBG/running times/NNS/times bounded/VBD/bounded by/IN/by the/DT/the height/NN/height /:/( see/NN/see table/NN/table 11.1/CD/11.1 /CD/) /,/, and/CC/and because/IN/because the/DT/the additional/JJ/additional work/NN/work in/IN/in maintaining/NN/maintaining balance/NN/balance factors/NNS/factors and/CC/and restructuring/VBG/restructuring an/DT/an avl/NN/avl tree/NN/tree can/MD/can be/VB/be bounded/VBN/bounded by/IN/by the/DT/the length/NN/length of/IN/of a/DT/a path/NN/path in/IN/in the/DT/the tree/NN/tree /,/, the/DT/the traditional/JJ/traditional map/NN/map operations/NNS/operations run/VBP/run in/IN/in worst-case/JJ/worst-case logarithmic/JJ/logarithmic time/NN/time with/IN/with an/DT/an avl/NN/avl tree/NNP/tree. we/PRP/we summarize/VBP/summarize these/DT/these results/NNS/results in/IN/in table/JJ/table 11.2/CD/11.2 /,/, and/CC/and illustrate/VB/illustrate this/DT/this performance/NN/performance in/IN/in figure/NN/figure in/IN/in this/DT/this section/NN/section /,/, we/PRP/we consider/VBP/consider a/DT/a data/NN/data structure/NN/structure known/VBN/known as/IN/as a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. it/PRP/it is/VBZ/is a/DT/a particular/JJ/particular example/NN/example of/IN/of a/DT/a more/RBR/more general/JJ/general structure/NN/structure known/VBN/known as/IN/as a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree /,/, in/IN/in which/WDT/which internal/JJ/internal nodes/NNS/nodes may/MD/may have/VB/have more/RBR/more than/IN/than two/CD/two children/NNP/children. other/JJ/other forms/NNS/forms of/IN/of multiway/NN/multiway search/NN/search trees/NNS/trees will/MD/will be/VB/be discussed/VBN/discussed in/IN/in section/NN/section 15.3/CD/15.3. 11.5.1/CD/11.5.1 multiway/NN/multiway search/NN/search trees/NNS/trees recall/VBP/recall that/IN/that general/JJ/general trees/NNS/trees are/VBP/are defined/VBN/defined so/RB/so that/IN/that internal/JJ/internal nodes/NNS/nodes may/MD/may have/VB/have many/JJ/many children/NNP/children. in/IN/in this/DT/this section/NN/section /,/, we/PRP/we discuss/VBP/discuss how/WRB/how general/JJ/general trees/NNS/trees can/MD/can be/VB/be used/VBN/used as/IN/as multiway/NN/multiway search/NN/search trees/NNP/trees. map/NN/map items/NNS/items stored/VBD/stored in/IN/in a/DT/a search/NN/search tree/NN/tree are/VBP/are pairs/NNS/pairs of/IN/of the/DT/the form/NN/form /:/( k,v/NN/k,v /:/) /,/, where/WRB/where k/NN/k is/VBZ/is the/DT/the key/JJ/key and/CC/and v/NN/v is/VBZ/is the/DT/the value/NN/value associated/VBN/associated with/IN/with the/DT/the key/NNP/key. definition/NN/definition of/IN/of a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree let/NN/let w/NN/w be/VB/be a/DT/a node/NN/node of/IN/of an/DT/an ordered/VBN/ordered tree/NNP/tree. we/PRP/we say/VBP/say that/IN/that w/NN/w is/VBZ/is a/DT/a d-node/JJ/d-node if/IN/if w/NN/w has/VBZ/has d/VBN/d children/NNP/children. we/PRP/we define/VBP/define a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree to/TO/to be/VB/be an/DT/an ordered/VBN/ordered tree/NN/tree t/NN/t that/WDT/that has/VBZ/has the/DT/the following/VBG/following properties/NNS/properties /,/, which/WDT/which are/VBP/are illustrated/VBN/illustrated in/IN/in figure/NN/figure 11.23a/CD/11.23a /:/: each/DT/each internal/JJ/internal node/NN/node of/IN/of t/NN/t has/VBZ/has at/IN/at least/JJS/least two/CD/two children/NNP/children. that/IN/that is/VBZ/is /,/, each/DT/each internal/JJ/internal node/NN/node is/VBZ/is a/DT/a d-node/JJ/d-node such/JJ/such that/IN/that d/NN/d 2/CD/2. each/DT/each internal/JJ/internal d-node/JJ/d-node w/NN/w of/IN/of t/NN/t with/IN/with children/NNS/children c1/NNP/c1 /,/, /./. /./. /./. ,cd/JJ/,cd stores/NNS/stores an/DT/an ordered/VBN/ordered set/NN/set of/IN/of d/NN/d 1/CD/1 key-value/JJ/key-value pairs/NNS/pairs /:/( k1,v1/-NONE-/k1,v1 /:/) /,/, /./. /./. /./. /,/, /:/( kd/NN/kd 1,vd/CD/1,vd 1/CD/1 /CD/) /,/, where/WRB/where k1/NNP/k1 kd/NN/kd 1/CD/1. let/NN/let us/PRP/us conventionally/RB/conventionally define/VBP/define k0/NNP/k0 =/NNP/= and/CC/and kd/VBD/kd =/CD/= +/CD/+ /./. for/IN/for each/DT/each item/NN/item /:/( k,v/NN/k,v /:/) stored/VBD/stored at/IN/at a/DT/a node/NN/node in/IN/in the/DT/the subtree/NN/subtree of/IN/of w/NN/w rooted/VBN/rooted at/IN/at ci/NN/ci /,/, i/PRP/i =/VBP/= 1/CD/1 /,/, /./. /./. /./. ,d/JJ/,d /,/, we/PRP/we have/VBP/have that/IN/that ki/NN/ki 1/CD/1 k/NN/k ki/NNP/ki. that/IN/that is/VBZ/is /,/, if/IN/if we/PRP/we think/VBP/think of/IN/of the/DT/the set/NN/set of/IN/of keys/NNS/keys stored/VBN/stored at/IN/at w/NN/w as/IN/as including/VBG/including the/DT/the special/JJ/special fictitious/JJ/fictitious keys/NNS/keys k0/NNP/k0 =/NNP/= and/CC/and kd/VBD/kd =/CD/= +/CD/+ /,/, then/RB/then a/DT/a key/JJ/key k/NN/k stored/VBD/stored in/IN/in the/DT/the subtree/NN/subtree of/IN/of t/NN/t rooted/VBN/rooted at/IN/at a/DT/a child/NN/child node/NN/node ci/NN/ci must/MD/must be/VB/be in/IN/in between/IN/between two/CD/two keys/NNS/keys stored/VBD/stored at/IN/at w/NNP/w. this/DT/this simple/NN/simple viewpoint/NN/viewpoint gives/VBZ/gives rise/NN/rise to/TO/to the/DT/the rule/NN/rule that/IN/that a/DT/a d-node/JJ/d-node stores/NNS/stores d/VBP/d 1/CD/1 regular/JJ/regular keys/NNS/keys /,/, and/CC/and it/PRP/it also/RB/also forms/VBZ/forms the/DT/the basis/NN/basis of/IN/of the/DT/the algorithm/NN/algorithm for/IN/for searching/VBG/searching in/IN/in a/DT/a multiway/NN/multiway search/NN/search tree/NNP/tree. by/IN/by the/DT/the above/JJ/above definition/NN/definition /,/, the/DT/the external/JJ/external nodes/NNS/nodes of/IN/of a/DT/a multiway/NN/multiway search/NN/search do/VBP/do not/RB/not store/VB/store any/DT/any data/NNS/data and/CC/and serve/VB/serve only/RB/only as/IN/as placeholders/NNP/placeholders. these/DT/these external/JJ/external nodes/NNS/nodes can/MD/can be/VB/be efficiently/RB/efficiently represented/VBN/represented by/IN/by none/NN/none references/NNS/references /,/, as/IN/as has/VBZ/has been/VBN/been our/PRP$/our convention/NN/convention with/IN/with binary/JJ/binary search/NN/search trees/NNS/trees /:/( section/NN/section 11.1/CD/11.1 /CD/) /./. however/RB/however /,/, for/IN/for the/DT/the sake/NN/sake of/IN/of exposition/NN/exposition /,/, we/PRP/we will/MD/will discuss/VB/discuss these/DT/these as/IN/as actual/JJ/actual nodes/NNS/nodes that/WDT/that do/VBP/do not/RB/not store/VB/store anything/NNP/anything. based/VBN/based on/IN/on this/DT/this definition/NN/definition /,/, there/EX/there is/VBZ/is an/DT/an interesting/JJ/interesting relationship/NN/relationship between/IN/between the/DT/the number/NN/number of/IN/of key-value/JJ/key-value pairs/NNS/pairs and/CC/and the/DT/the number/NN/number of/IN/of external/JJ/external nodes/NNS/nodes in/IN/in a/DT/a multiway/NN/multiway search/NN/search tree/NNP/tree. proposition/NN/proposition 11.7/CD/11.7 /:/: an/DT/an n-item/JJ/n-item multiway/NN/multiway search/NN/search tree/NN/tree has/VBZ/has n/VBN/n +/-NONE-/+ 1/CD/1 external/JJ/external nodes/NNP/nodes. we/PRP/we leave/VBP/leave the/DT/the justification/NN/justification of/IN/of this/DT/this proposition/NN/proposition as/IN/as an/DT/an exercise/NN/exercise /:/( c-11.52/-NONE-/c-11.52 /:/) /./. /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees 503/CD/503 25/CD/25 11/CD/11 13/CD/13 3/CD/3 4/CD/4 6/CD/6 8/CD/8 14/CD/14 23/CD/23 24/CD/24 27/CD/27 5/CD/5 10/CD/10 22/CD/22 17/CD/17 /CD/( a/DT/a /NN/) 6/CD/6 8/CD/8 5/CD/5 10/CD/10 22/CD/22 25/CD/25 11/CD/11 13/CD/13 17/CD/17 3/CD/3 4/CD/4 14/CD/14 23/CD/23 24/CD/24 27/CD/27 /CD/( b/NN/b /:/) 23/CD/23 24/CD/24 17/CD/17 3/CD/3 4/CD/4 6/CD/6 8/CD/8 27/CD/27 25/CD/25 11/CD/11 13/CD/13 14/CD/14 5/CD/5 10/CD/10 22/CD/22 /CD/( c/NN/c /:/) figure/NN/figure 11.23/CD/11.23 /:/: /:/( a/DT/a /NN/) a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree t/NN/t ;/:/; /:/( b/NN/b /:/) search/NN/search path/NN/path in/IN/in t/NN/t for/IN/for key/JJ/key 12/CD/12 /CD/( unsuccessful/JJ/unsuccessful search/NN/search /:/) ;/:/; /:/( c/NN/c /:/) search/NN/search path/NN/path in/IN/in t/NN/t for/IN/for key/JJ/key 24/CD/24 /CD/( successful/JJ/successful search/NN/search /:/) /./. 504/CD/504 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees searching/VBG/searching in/IN/in a/DT/a multiway/NN/multiway tree/NN/tree searching/VBG/searching for/IN/for an/DT/an item/NN/item with/IN/with key/JJ/key k/NN/k in/IN/in a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree t/NN/t is/VBZ/is simple/NNP/simple. we/PRP/we perform/VBP/perform such/JJ/such a/DT/a search/NN/search by/IN/by tracing/NN/tracing a/DT/a path/NN/path in/IN/in t/NN/t starting/VBG/starting at/IN/at the/DT/the root/NNP/root. /NNP/( see/VB/see figure/NN/figure 11.23b/CD/11.23b and/CC/and c/NNP/c. /NNP/) when/WRB/when we/PRP/we are/VBP/are at/IN/at a/DT/a d-node/JJ/d-node w/NN/w during/IN/during this/DT/this search/NN/search /,/, we/PRP/we compare/VBP/compare the/DT/the key/JJ/key k/NN/k with/IN/with the/DT/the keys/NNS/keys k1/NNP/k1 /,/, /./. /./. /./. ,kd/JJ/,kd 1/CD/1 stored/VBN/stored at/IN/at w/NNP/w. if/IN/if k/NN/k =/:/= ki/NN/ki for/IN/for some/DT/some i/PRP/i /,/, the/DT/the search/NN/search is/VBZ/is successfully/RB/successfully completed/NNP/completed. otherwise/RB/otherwise /,/, we/PRP/we continue/VBP/continue the/DT/the search/NN/search in/IN/in the/DT/the child/NN/child ci/NN/ci of/IN/of w/NN/w such/JJ/such that/IN/that ki/NN/ki 1/CD/1 </CD/< k/NN/k </:/< ki/NNP/ki. /:/( recall/NN/recall that/IN/that we/PRP/we conventionally/RB/conventionally define/VBP/define k0/NNP/k0 =/NNP/= and/CC/and kd/VBD/kd =/CD/= +/CD/+ /./. /CD/) if/IN/if we/PRP/we reach/VBP/reach an/DT/an external/JJ/external node/NN/node /,/, then/RB/then we/PRP/we know/VBP/know that/IN/that there/EX/there is/VBZ/is no/DT/no item/NN/item with/IN/with key/JJ/key k/NN/k in/IN/in t/NN/t /,/, and/CC/and the/DT/the search/NN/search terminates/VBZ/terminates unsuccessfully/NNP/unsuccessfully. data/NNS/data structures/NNS/structures for/IN/for representing/VBG/representing multiway/NN/multiway search/NN/search trees/NNS/trees in/IN/in section/NN/section 8.3.3/CD/8.3.3 /,/, we/PRP/we discuss/VBP/discuss a/DT/a linked/VBN/linked data/NNS/data structure/NN/structure for/IN/for representing/VBG/representing a/DT/a general/JJ/general tree/NNP/tree. this/DT/this representation/NN/representation can/MD/can also/RB/also be/VB/be used/VBN/used for/IN/for a/DT/a multiway/NN/multiway search/NN/search tree/NNP/tree. when/WRB/when using/VBG/using a/DT/a general/JJ/general tree/NN/tree to/TO/to implement/VB/implement a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree /,/, we/PRP/we must/MD/must store/VB/store at/IN/at each/DT/each node/NN/node one/CD/one or/CC/or more/JJR/more key-value/JJ/key-value pairs/NNS/pairs associated/VBN/associated with/IN/with that/DT/that node/NNP/node. that/IN/that is/VBZ/is /,/, we/PRP/we need/VBP/need to/TO/to store/VB/store with/IN/with w/NN/w a/DT/a reference/NN/reference to/TO/to some/DT/some collection/NN/collection that/IN/that stores/NNS/stores the/DT/the items/NNS/items for/IN/for w/NNP/w. during/IN/during a/DT/a search/NN/search for/IN/for key/JJ/key k/NN/k in/IN/in a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree /,/, the/DT/the primary/JJ/primary operation/NN/operation needed/VBN/needed when/WRB/when navigating/VBG/navigating a/DT/a node/NN/node is/VBZ/is finding/VBG/finding the/DT/the smallest/JJS/smallest key/JJ/key at/IN/at that/DT/that node/NN/node that/IN/that is/VBZ/is greater/JJR/greater than/IN/than or/CC/or equal/JJ/equal to/TO/to k/NNP/k. for/IN/for this/DT/this reason/NN/reason /,/, it/PRP/it is/VBZ/is natural/JJ/natural to/TO/to model/NN/model the/DT/the information/NN/information at/IN/at a/DT/a node/NN/node itself/PRP/itself as/IN/as a/DT/a sorted/VBN/sorted map/NN/map /,/, allowing/VBG/allowing use/NN/use of/IN/of the/DT/the find/NN/find ge/NN/ge /:/( k/NN/k /:/) method/NNP/method. we/PRP/we say/VBP/say such/JJ/such a/DT/a map/NN/map serves/VBZ/serves as/IN/as a/DT/a secondary/JJ/secondary data/NNS/data structure/NN/structure to/TO/to support/VB/support the/DT/the primary/JJ/primary data/NNS/data structure/NN/structure represented/VBD/represented by/IN/by the/DT/the entire/JJ/entire multiway/NN/multiway search/NN/search tree/NNP/tree. this/DT/this reasoning/NN/reasoning may/MD/may at/IN/at first/JJ/first seem/NN/seem like/IN/like a/DT/a circular/JJ/circular argument/NN/argument /,/, since/IN/since we/PRP/we need/VBP/need a/DT/a representation/NN/representation of/IN/of a/DT/a /NN/( secondary/NN/secondary /:/) ordered/VBN/ordered map/NN/map to/TO/to represent/VB/represent a/DT/a /NN/( primary/JJ/primary /NN/) ordered/VBN/ordered map/NNP/map. we/PRP/we can/MD/can avoid/VB/avoid any/DT/any circular/JJ/circular dependence/NN/dependence /,/, however/RB/however /,/, by/IN/by using/NN/using the/DT/the bootstrapping/NN/bootstrapping technique/NN/technique /,/, where/WRB/where we/PRP/we use/VBP/use a/DT/a simple/JJ/simple solution/NN/solution to/TO/to a/DT/a problem/NN/problem to/TO/to create/VB/create a/DT/a new/JJ/new /,/, more/RBR/more advanced/JJ/advanced solution/NNP/solution. in/IN/in the/DT/the context/NN/context of/IN/of a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree /,/, a/DT/a natural/JJ/natural choice/NN/choice for/IN/for the/DT/the secondary/JJ/secondary structure/NN/structure at/IN/at each/DT/each node/NN/node is/VBZ/is the/DT/the sortedtablemap/NN/sortedtablemap of/IN/of section/NN/section 10.3.1/CD/10.3.1. because/IN/because we/PRP/we want/VBP/want to/TO/to determine/VB/determine the/DT/the associated/VBN/associated value/NN/value in/IN/in case/NN/case of/IN/of a/DT/a match/NN/match for/IN/for key/JJ/key k/NN/k /,/, and/CC/and otherwise/VB/otherwise the/DT/the corresponding/NN/corresponding child/NN/child ci/NN/ci such/JJ/such that/IN/that ki/NN/ki 1/CD/1 </CD/< k/NN/k </:/< ki/NN/ki /,/, we/PRP/we recommend/VBP/recommend having/VBG/having each/DT/each key/JJ/key ki/NN/ki in/IN/in the/DT/the secondary/JJ/secondary structure/NN/structure map/NN/map to/TO/to the/DT/the pair/NN/pair /:/( vi,ci/NNP/vi,ci /:/) /./. with/IN/with such/JJ/such a/DT/a realization/NN/realization of/IN/of a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree t/NN/t /,/, processing/NN/processing a/DT/a d-node/JJ/d-node w/NN/w while/IN/while searching/VBG/searching for/IN/for an/DT/an item/NN/item of/IN/of t/NN/t with/IN/with key/JJ/key k/NN/k can/MD/can be/VB/be performed/VBN/performed using/VBG/using a/DT/a binary/JJ/binary search/NN/search operation/NN/operation in/IN/in o/NN/o /:/( logd/NN/logd /:/) time/NNP/time. let/NN/let dmax/NN/dmax denote/NN/denote the/DT/the maximum/NN/maximum number/NN/number of/IN/of children/NNS/children of/IN/of any/DT/any node/NN/node of/IN/of t/NN/t /,/, and/CC/and let/VB/let h/NN/h denote/NN/denote the/DT/the height/NN/height of/IN/of t/NNP/t. the/DT/the search/NN/search time/NN/time in/IN/in a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree is/VBZ/is therefore/RB/therefore o/RB/o /:/( hlog/NN/hlog dmax/NN/dmax /:/) /./. if/IN/if dmax/NN/dmax is/VBZ/is a/DT/a constant/JJ/constant /,/, the/DT/the running/NN/running time/NN/time for/IN/for performing/VBG/performing a/DT/a search/NN/search is/VBZ/is o/RB/o /:/( h/NN/h /:/) /./. the/DT/the primary/JJ/primary efficiency/NN/efficiency goal/NN/goal for/IN/for a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree is/VBZ/is to/TO/to keep/VB/keep the/DT/the height/NN/height as/IN/as small/JJ/small as/IN/as possible/NNP/possible. we/PRP/we next/JJ/next discuss/NN/discuss a/DT/a strategy/NN/strategy that/WDT/that caps/VBZ/caps dmax/NN/dmax at/IN/at 4/CD/4 while/IN/while guaranteeing/NN/guaranteeing a/DT/a height/NN/height h/NN/h that/WDT/that is/VBZ/is logarithmic/JJ/logarithmic in/IN/in n/NN/n /,/, the/DT/the total/JJ/total number/NN/number of/IN/of items/NNS/items stored/VBN/stored in/IN/in the/DT/the map/NNP/map. 11.5/NNP/11.5. /NNP/( 2,4/CD/2,4 /CD/) trees/NNS/trees 505/CD/505 11.5.2/CD/11.5.2 /CD/( 2,4/CD/2,4 /CD/) -tree/JJ/-tree operations/NNS/operations a/DT/a multiway/NN/multiway search/NN/search tree/NN/tree that/WDT/that keeps/VBZ/keeps the/DT/the secondary/JJ/secondary data/NNS/data structures/NNS/structures stored/VBD/stored at/IN/at each/DT/each node/NN/node small/JJ/small and/CC/and also/RB/also keeps/VBZ/keeps the/DT/the primary/JJ/primary multiway/NN/multiway tree/NN/tree balanced/VBD/balanced is/VBZ/is the/DT/the /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree /,/, which/WDT/which is/VBZ/is sometimes/RB/sometimes called/VBN/called a/DT/a 2-4/CD/2-4 tree/NN/tree or/CC/or 2-3-4/CD/2-3-4 tree/NNP/tree. this/DT/this data/NN/data structure/NN/structure achieves/NNS/achieves these/DT/these goals/NNS/goals by/IN/by maintaining/VBG/maintaining two/CD/two simple/JJ/simple properties/NNS/properties /:/( see/VB/see figure/NN/figure 11.24/CD/11.24 /CD/) /:/: size/NN/size property/NN/property /:/: every/DT/every internal/JJ/internal node/NN/node has/VBZ/has at/IN/at most/JJS/most four/CD/four children/NNP/children. depth/NN/depth property/NN/property /:/: all/DT/all the/DT/the external/JJ/external nodes/NNS/nodes have/VBP/have the/DT/the same/JJ/same depth/NNP/depth. 12/CD/12 3/CD/3 4/CD/4 6/CD/6 7/CD/7 8/CD/8 11/CD/11 17/CD/17 5/CD/5 10/CD/10 15/CD/15 13/CD/13 14/CD/14 figure/NN/figure 11.24/CD/11.24 /:/: a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. again/RB/again /,/, we/PRP/we assume/VBP/assume that/IN/that external/JJ/external nodes/NNS/nodes are/VBP/are empty/JJ/empty and/CC/and /,/, for/IN/for the/DT/the sake/NN/sake of/IN/of simplicity/NN/simplicity /,/, we/PRP/we describe/VBP/describe our/PRP$/our search/NN/search and/CC/and update/VB/update methods/NNS/methods assuming/VBG/assuming that/IN/that external/JJ/external nodes/NNS/nodes are/VBP/are real/JJ/real nodes/NNS/nodes /,/, although/IN/although this/DT/this latter/NN/latter requirement/NN/requirement is/VBZ/is not/RB/not strictly/RB/strictly needed/NNP/needed. enforcing/NN/enforcing the/DT/the size/NN/size property/NN/property for/IN/for /CD/( 2,4/CD/2,4 /CD/) trees/NNS/trees keeps/NNS/keeps the/DT/the nodes/NNS/nodes in/IN/in the/DT/the multiway/NN/multiway search/NN/search tree/NN/tree simple/NNP/simple. it/PRP/it also/RB/also gives/VBZ/gives rise/NN/rise to/TO/to the/DT/the alternative/NN/alternative name/NN/name 2-3-4/CD/2-3-4 tree/NN/tree /,/, since/IN/since it/PRP/it implies/VBZ/implies that/IN/that each/DT/each internal/JJ/internal node/NN/node in/IN/in the/DT/the tree/NN/tree has/VBZ/has 2/CD/2 /,/, 3/CD/3 /,/, or/CC/or 4/CD/4 children/NNP/children. another/DT/another implication/NN/implication of/IN/of this/DT/this rule/NN/rule is/VBZ/is that/IN/that we/PRP/we can/MD/can represent/VB/represent the/DT/the secondary/JJ/secondary map/NN/map stored/VBD/stored at/IN/at each/DT/each internal/JJ/internal node/NN/node using/VBG/using an/DT/an unordered/JJ/unordered list/NN/list or/CC/or an/DT/an ordered/VBN/ordered array/NN/array /,/, and/CC/and still/RB/still achieve/VBP/achieve o/RB/o /:/( 1/CD/1 /CD/) -time/JJ/-time performance/NN/performance for/IN/for all/DT/all operations/NNS/operations /VBP/( since/IN/since dmax/NN/dmax =/:/= 4/CD/4 /CD/) /./. the/DT/the depth/NN/depth property/NN/property /,/, on/IN/on the/DT/the other/JJ/other hand/NN/hand /,/, enforces/NNS/enforces an/DT/an important/JJ/important bound/NN/bound on/IN/on the/DT/the height/NN/height of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. proposition/NN/proposition 11.8/CD/11.8 /:/: the/DT/the height/NN/height of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree storing/VBG/storing n/NN/n items/NNS/items is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. justification/NN/justification /:/: let/VB/let h/JJ/h be/VB/be the/DT/the height/NN/height of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree t/NN/t storing/VBG/storing n/NN/n items/NNP/items. we/PRP/we justify/VBP/justify the/DT/the proposition/NN/proposition by/IN/by showing/NN/showing the/DT/the claim/NN/claim 1/CD/1 2/CD/2 log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) h/NN/h log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) /./. /CD/( 11.9/CD/11.9 /CD/) to/TO/to justify/VB/justify this/DT/this claim/NN/claim note/NN/note first/RB/first that/IN/that /,/, by/IN/by the/DT/the size/NN/size property/NN/property /,/, we/PRP/we can/MD/can have/VB/have at/IN/at most/JJS/most 4/CD/4 nodes/NNS/nodes at/IN/at depth/NN/depth 1/CD/1 /,/, at/IN/at most/JJS/most 42/CD/42 nodes/NNS/nodes at/IN/at depth/NN/depth 2/CD/2 /,/, and/CC/and so/RB/so on/NNP/on. thus/RB/thus /,/, the/DT/the number/NN/number of/IN/of external/JJ/external nodes/NNS/nodes in/IN/in t/NN/t is/VBZ/is at/IN/at most/JJS/most 4h/CD/4h. likewise/NN/likewise /,/, by/IN/by the/DT/the depth/NN/depth property/NN/property and/CC/and the/DT/the definition/NN/definition 506/CD/506 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree /,/, we/PRP/we must/MD/must have/VB/have at/IN/at least/JJS/least 2/CD/2 nodes/NNS/nodes at/IN/at depth/NN/depth 1/CD/1 /,/, at/IN/at least/JJS/least 22/CD/22 nodes/NNS/nodes at/IN/at depth/NN/depth 2/CD/2 /,/, and/CC/and so/RB/so on/NNP/on. thus/RB/thus /,/, the/DT/the number/NN/number of/IN/of external/JJ/external nodes/NNS/nodes in/IN/in t/NN/t is/VBZ/is at/IN/at least/JJS/least 2h/CD/2h. in/IN/in addition/NN/addition /,/, by/IN/by proposition/NN/proposition 11.7/CD/11.7 /,/, the/DT/the number/NN/number of/IN/of external/JJ/external nodes/NNS/nodes in/IN/in t/NN/t is/VBZ/is n/VBN/n +/-NONE-/+ 1/CD/1. therefore/NN/therefore /,/, we/PRP/we obtain/VBP/obtain 2h/CD/2h n/NN/n +/:/+ 1/CD/1 4h/CD/4h. taking/VBG/taking the/DT/the logarithm/NN/logarithm in/IN/in base/NN/base 2/CD/2 of/IN/of the/DT/the terms/NNS/terms for/IN/for the/DT/the above/NN/above inequalities/NNS/inequalities /,/, we/PRP/we get/VBP/get that/IN/that h/NN/h log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) 2h/CD/2h /,/, which/WDT/which justifies/NNS/justifies our/PRP$/our claim/NN/claim /:/( formula/NN/formula 11.9/CD/11.9 /CD/) when/WRB/when terms/NNS/terms are/VBP/are rearranged/NNP/rearranged. proposition/NN/proposition 11.8/CD/11.8 states/NNS/states that/WDT/that the/DT/the size/NN/size and/CC/and depth/NN/depth properties/NNS/properties are/VBP/are sufficient/JJ/sufficient for/IN/for keeping/NN/keeping a/DT/a multiway/NN/multiway tree/NN/tree balanced/NNP/balanced. moreover/RB/moreover /,/, this/DT/this proposition/NN/proposition implies/VBZ/implies that/IN/that performing/VBG/performing a/DT/a search/NN/search in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree takes/VBZ/takes o/NN/o /:/( logn/NN/logn /:/) time/NN/time and/CC/and that/IN/that the/DT/the specific/JJ/specific realization/NN/realization of/IN/of the/DT/the secondary/JJ/secondary structures/NNS/structures at/IN/at the/DT/the nodes/NNS/nodes is/VBZ/is not/RB/not a/DT/a crucial/JJ/crucial design/NN/design choice/NN/choice /,/, since/IN/since the/DT/the maximum/NN/maximum number/NN/number of/IN/of children/NNS/children dmax/VBP/dmax is/VBZ/is a/DT/a constant/NNP/constant. maintaining/NN/maintaining the/DT/the size/NN/size and/CC/and depth/NN/depth properties/NNS/properties requires/VBZ/requires some/DT/some effort/NN/effort after/IN/after performing/VBG/performing insertions/NNS/insertions and/CC/and deletions/NNS/deletions in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree /,/, however/NNP/however. we/PRP/we discuss/VBZ/discuss these/DT/these operations/NNS/operations next/NNP/next. insertion/NN/insertion to/TO/to insert/VB/insert a/DT/a new/JJ/new item/NN/item /:/( k,v/NN/k,v /:/) /,/, with/IN/with key/JJ/key k/NN/k /,/, into/IN/into a/DT/a /JJ/( 2,4/CD/2,4 /CD/) tree/NN/tree t/NN/t /,/, we/PRP/we first/RB/first perform/VBP/perform a/DT/a search/NN/search for/IN/for k/NNP/k. assuming/VBG/assuming that/IN/that t/NN/t has/VBZ/has no/DT/no item/NN/item with/IN/with key/JJ/key k/NN/k /,/, this/DT/this search/NN/search terminates/VBZ/terminates unsuccessfully/RB/unsuccessfully at/IN/at an/DT/an external/JJ/external node/NN/node z/NNP/z. let/NN/let w/NN/w be/VB/be the/DT/the parent/NN/parent of/IN/of z/NNP/z. we/PRP/we insert/VBP/insert the/DT/the new/JJ/new item/NN/item into/IN/into node/NN/node w/NN/w and/CC/and add/VBD/add a/DT/a new/JJ/new child/NN/child y/NN/y /:/( an/DT/an external/JJ/external node/NN/node /:/) to/TO/to w/VB/w on/IN/on the/DT/the left/NN/left of/IN/of z/NNP/z. our/PRP$/our insertion/NN/insertion method/NN/method preserves/NNS/preserves the/DT/the depth/NN/depth property/NN/property /,/, since/IN/since we/PRP/we add/VBP/add a/DT/a new/JJ/new external/JJ/external node/NN/node at/IN/at the/DT/the same/JJ/same level/NN/level as/IN/as existing/VBG/existing external/JJ/external nodes/NNP/nodes. nevertheless/NN/nevertheless /,/, it/PRP/it may/MD/may violate/VB/violate the/DT/the size/NN/size property/NNP/property. indeed/RB/indeed /,/, if/IN/if a/DT/a node/NN/node w/NN/w was/VBD/was previously/RB/previously a/DT/a 4-node/JJ/4-node /,/, then/RB/then it/PRP/it would/MD/would become/VB/become a/DT/a 5-node/JJ/5-node after/IN/after the/DT/the insertion/NN/insertion /,/, which/WDT/which causes/NNS/causes the/DT/the tree/NN/tree t/NN/t to/TO/to no/DT/no longer/NN/longer be/VB/be a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. this/DT/this type/NN/type of/IN/of violation/NN/violation of/IN/of the/DT/the size/NN/size property/NN/property is/VBZ/is called/VBN/called an/DT/an overflow/JJ/overflow at/IN/at node/NN/node w/NN/w /,/, and/CC/and it/PRP/it must/MD/must be/VB/be resolved/VBN/resolved in/IN/in order/NN/order to/TO/to restore/VB/restore the/DT/the properties/NNS/properties of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. let/NN/let c1/NNP/c1 /,/, /./. /./. /./. ,c5/-NONE-/,c5 be/VB/be the/DT/the children/NNS/children of/IN/of w/NN/w /,/, and/CC/and let/VB/let k1/NNP/k1 /,/, /./. /./. /./. ,k4/-NONE-/,k4 be/VB/be the/DT/the keys/NNS/keys stored/VBD/stored at/IN/at w/NNP/w. to/TO/to remedy/VB/remedy the/DT/the overflow/NN/overflow at/IN/at node/NN/node w/NN/w /,/, we/PRP/we perform/VBP/perform a/DT/a split/NN/split operation/NN/operation on/IN/on w/NN/w as/IN/as follows/NNS/follows /:/( see/VB/see figure/NN/figure 11.25/CD/11.25 /CD/) /:/: replace/NN/replace w/NN/w with/IN/with two/CD/two nodes/NNS/nodes w_/NNP/w_ and/CC/and w__/NNP/w__ /,/, where/WRB/where w_/NNP/w_ is/VBZ/is a/DT/a 3-node/JJ/3-node with/IN/with children/NNS/children c1,c2,c3/-NONE-/c1,c2,c3 storing/VBG/storing keys/NNS/keys k1/NNP/k1 and/CC/and k2/NNP/k2 w__/NNP/w__ is/VBZ/is a/DT/a 2-node/JJ/2-node with/IN/with children/NNS/children c4,c5/-NONE-/c4,c5 storing/VBG/storing key/JJ/key k4/NNP/k4. if/IN/if w/NN/w is/VBZ/is the/DT/the root/NN/root of/IN/of t/NN/t /,/, create/VB/create a/DT/a new/JJ/new root/NN/root node/NN/node u/NN/u ;/:/; else/NN/else /,/, let/VB/let u/PRP/u be/VB/be the/DT/the parent/NN/parent of/IN/of w/NNP/w. insert/NN/insert key/NN/key k3/NNP/k3 into/IN/into u/NN/u and/CC/and make/VB/make w_/NNP/w_ and/CC/and w__/NNP/w__ children/NNS/children of/IN/of u/NN/u /,/, so/RB/so that/IN/that if/IN/if w/NN/w was/VBD/was child/VBN/child i/PRP/i of/IN/of u/NN/u /,/, then/RB/then w_/NNP/w_ and/CC/and w__/NNP/w__ become/NN/become children/NNS/children i/PRP/i and/CC/and i/PRP/i +/VBP/+ 1/CD/1 of/IN/of u/NN/u /,/, respectively/NNP/respectively. as/IN/as a/DT/a consequence/NN/consequence of/IN/of a/DT/a split/NN/split operation/NN/operation on/IN/on node/NN/node w/NN/w /,/, a/DT/a new/JJ/new overflow/NN/overflow may/MD/may occur/VB/occur at/IN/at the/DT/the parent/NN/parent u/NN/u of/IN/of w/NNP/w. if/IN/if such/JJ/such an/DT/an overflow/JJ/overflow occurs/NNS/occurs /,/, it/PRP/it triggers/VBZ/triggers in/IN/in turn/NN/turn a/DT/a split/NN/split at/IN/at node/NN/node u/NNP/u. /NNP/( see/VB/see figure/NN/figure 11.26/CD/11.26. /CD/) a/DT/a split/NN/split operation/NN/operation either/DT/either eliminates/NNS/eliminates the/DT/the overflow/NN/overflow or/CC/or propagates/VBZ/propagates it/PRP/it into/IN/into the/DT/the parent/NN/parent of/IN/of the/DT/the current/JJ/current node/NNP/node. we/PRP/we show/VBP/show a/DT/a sequence/NN/sequence of/IN/of insertions/NNS/insertions in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree in/IN/in figure/NN/figure 11.27/CD/11.27. figure/NN/figure 11.26/CD/11.26 /:/: an/DT/an insertion/NN/insertion in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree that/WDT/that causes/VBZ/causes a/DT/a cascading/NN/cascading split/NN/split /:/: /:/( a/DT/a /NN/) before/IN/before the/DT/the insertion/NN/insertion ;/:/; /:/( b/NN/b /:/) insertion/NN/insertion of/IN/of 17/CD/17 /,/, causing/VBG/causing an/DT/an overflow/JJ/overflow ;/:/; /:/( c/NN/c /:/) a/DT/a split/NN/split ;/:/; /:/( d/NN/d /:/) after/IN/after the/DT/the split/NN/split a/DT/a new/JJ/new overflow/NN/overflow occurs/NNS/occurs ;/:/; /:/( e/NN/e /:/) another/DT/another split/NN/split /,/, creating/VBG/creating a/DT/a new/JJ/new root/NN/root node/NN/node ;/:/; /:/( f/NN/f /:/) final/JJ/final tree/NNP/tree. 508/CD/508 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees /:/( k/NN/k /:/) /:/( l/NN/l /:/) figure/NN/figure 11.27/CD/11.27 /:/: a/DT/a sequence/NN/sequence of/IN/of insertions/NNS/insertions into/IN/into a/DT/a /JJ/( 2,4/CD/2,4 /CD/) tree/NN/tree /:/: /:/( a/DT/a /NN/) initial/JJ/initial tree/NN/tree with/IN/with one/CD/one item/NN/item ;/:/; /:/( b/NN/b /:/) insertion/NN/insertion of/IN/of 6/CD/6 ;/:/; /:/( c/NN/c /:/) insertion/NN/insertion of/IN/of 12/CD/12 ;/:/; /:/( d/NN/d /:/) insertion/NN/insertion of/IN/of 15/CD/15 /,/, which/WDT/which causes/NNS/causes an/DT/an overflow/JJ/overflow ;/:/; /:/( e/NN/e /:/) split/NN/split /,/, which/WDT/which causes/NNS/causes the/DT/the creation/NN/creation of/IN/of a/DT/a new/JJ/new root/NN/root node/NN/node ;/:/; /:/( f/NN/f /:/) after/IN/after the/DT/the split/NN/split ;/:/; /:/( g/NN/g /:/) insertion/NN/insertion of/IN/of 3/CD/3 ;/:/; /:/( h/NN/h /:/) insertion/NN/insertion of/IN/of 5/CD/5 /,/, which/WDT/which causes/NNS/causes an/DT/an overflow/JJ/overflow ;/:/; /:/( i/PRP/i /VBP/) split/JJ/split ;/:/; /:/( j/NN/j /:/) after/IN/after the/DT/the split/NN/split ;/:/; /:/( k/NN/k /:/) insertion/NN/insertion of/IN/of 10/CD/10 ;/:/; /:/( l/NN/l /:/) insertion/NN/insertion of/IN/of 8/CD/8. 11.5/CD/11.5. /CD/( 2,4/CD/2,4 /CD/) trees/NNS/trees 509/CD/509 analysis/NN/analysis of/IN/of insertion/NN/insertion in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree because/IN/because dmax/NN/dmax is/VBZ/is at/IN/at most/JJS/most 4/CD/4 /,/, the/DT/the original/JJ/original search/NN/search for/IN/for the/DT/the placement/NN/placement of/IN/of new/JJ/new key/JJ/key k/NN/k uses/NNS/uses o/VBP/o /:/( 1/CD/1 /CD/) time/NN/time at/IN/at each/DT/each level/NN/level /,/, and/CC/and thus/RB/thus o/RB/o /:/( logn/NN/logn /:/) time/NN/time overall/JJ/overall /,/, since/IN/since the/DT/the height/NN/height of/IN/of the/DT/the tree/NN/tree is/VBZ/is o/RB/o /:/( log/NN/log n/NN/n /:/) by/IN/by proposition/NN/proposition 11.8/CD/11.8. the/DT/the modifications/NNS/modifications to/TO/to a/DT/a single/JJ/single node/NN/node to/TO/to insert/VB/insert a/DT/a new/JJ/new key/JJ/key and/CC/and child/NN/child can/MD/can be/VB/be implemented/VBN/implemented to/TO/to run/VB/run in/IN/in o/NN/o /:/( 1/CD/1 /CD/) time/NN/time /,/, as/IN/as can/MD/can a/DT/a single/JJ/single split/NN/split operation/NNP/operation. the/DT/the number/NN/number of/IN/of cascading/VBG/cascading split/NN/split operations/NNS/operations is/VBZ/is bounded/VBN/bounded by/IN/by the/DT/the height/NN/height of/IN/of the/DT/the tree/NN/tree /,/, and/CC/and so/RB/so that/IN/that phase/NN/phase of/IN/of the/DT/the insertion/NN/insertion process/NN/process also/RB/also runs/VBZ/runs ino/DT/ino /NN/( log/NN/log n/NN/n /:/) time/NNP/time. therefore/RB/therefore /,/, the/DT/the total/JJ/total time/NN/time to/TO/to perform/VB/perform an/DT/an insertion/NN/insertion in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. deletion/NN/deletion let/VBD/let us/PRP/us now/RB/now consider/VBP/consider the/DT/the removal/NN/removal of/IN/of an/DT/an item/NN/item with/IN/with key/JJ/key k/NN/k from/IN/from a/DT/a /CD/( 2,4/CD/2,4 /CD/) tree/NN/tree t/NNP/t. webegin/NN/webegin such/JJ/such an/DT/an operation/NN/operation by/IN/by performing/VBG/performing a/DT/a search/NN/search in/IN/in t/NN/t for/IN/for an/DT/an item/NN/item with/IN/with key/JJ/key k/NNP/k. removing/NN/removing an/DT/an item/NN/item from/IN/from a/DT/a /CD/( 2,4/CD/2,4 /CD/) tree/NN/tree can/MD/can always/RB/always be/VB/be reduced/VBN/reduced to/TO/to the/DT/the case/NN/case where/WRB/where the/DT/the item/NN/item to/TO/to be/VB/be removed/VBN/removed is/VBZ/is stored/VBN/stored at/IN/at a/DT/a node/NN/node w/NN/w whose/WP$/whose children/NNS/children are/VBP/are external/JJ/external nodes/NNP/nodes. suppose/NN/suppose /,/, for/IN/for instance/NN/instance /,/, that/IN/that the/DT/the item/NN/item with/IN/with key/JJ/key k/NN/k that/WDT/that we/PRP/we wish/VBP/wish to/TO/to remove/VB/remove is/VBZ/is stored/VBN/stored in/IN/in the/DT/the ith/NN/ith item/NN/item /:/( ki,vi/NNP/ki,vi /:/) at/IN/at a/DT/a node/NN/node z/NN/z that/WDT/that has/VBZ/has only/RB/only internal-node/JJ/internal-node children/NNP/children. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we swap/VBP/swap the/DT/the item/NN/item /:/( ki,vi/NNP/ki,vi /:/) with/IN/with an/DT/an appropriate/JJ/appropriate item/NN/item that/WDT/that is/VBZ/is stored/VBN/stored at/IN/at a/DT/a node/NN/node w/NN/w with/IN/with external-node/JJ/external-node children/NNS/children as/IN/as follows/NNS/follows /:/( see/VB/see figure/NN/figure 11.28d/CD/11.28d /CD/) /:/: 1/CD/1. we/PRP/we find/VBP/find the/DT/the rightmost/JJS/rightmost internal/JJ/internal node/NN/node w/NN/w in/IN/in the/DT/the subtree/NN/subtree rooted/VBD/rooted at/IN/at the/DT/the ith/NN/ith child/NN/child of/IN/of z/NN/z /,/, noting/VBG/noting that/IN/that the/DT/the children/NNS/children of/IN/of node/NN/node w/NN/w are/VBP/are all/DT/all external/JJ/external nodes/NNP/nodes. 2/NNP/2. we/PRP/we swap/VBP/swap the/DT/the item/NN/item /:/( ki,vi/NNP/ki,vi /:/) at/IN/at z/NN/z with/IN/with the/DT/the last/JJ/last item/NN/item of/IN/of w/NNP/w. once/RB/once we/PRP/we ensure/VBP/ensure that/IN/that the/DT/the item/NN/item to/TO/to remove/VB/remove is/VBZ/is stored/VBN/stored at/IN/at a/DT/a node/NN/node w/NN/w with/IN/with only/RB/only externalnode/VBP/externalnode children/NNS/children /:/( because/IN/because either/DT/either it/PRP/it was/VBD/was already/RB/already at/IN/at w/NN/w or/CC/or we/PRP/we swapped/VBD/swapped it/PRP/it into/IN/into w/NN/w /:/) /,/, we/PRP/we simply/RB/simply remove/VBP/remove the/DT/the item/NN/item from/IN/from w/NN/w and/CC/and remove/VB/remove the/DT/the ith/NN/ith external/JJ/external node/NN/node of/IN/of w/NNP/w. removing/NN/removing an/DT/an item/NN/item /:/( and/CC/and a/DT/a child/NN/child /:/) from/IN/from a/DT/a node/NN/node w/NN/w as/IN/as described/VBN/described above/IN/above preserves/NNS/preserves the/DT/the depth/NN/depth property/NN/property /,/, for/IN/for we/PRP/we always/RB/always remove/VBP/remove an/DT/an external/JJ/external child/NN/child from/IN/from a/DT/a node/NN/node w/NN/w with/IN/with only/RB/only external/JJ/external children/NNP/children. however/RB/however /,/, in/IN/in removing/NN/removing such/JJ/such an/DT/an external/JJ/external node/NN/node /,/, we/PRP/we may/MD/may violate/VB/violate the/DT/the size/NN/size property/NN/property at/IN/at w/NNP/w. indeed/RB/indeed /,/, if/IN/if w/NN/w was/VBD/was previously/RB/previously a/DT/a 2-node/JJ/2-node /,/, then/RB/then it/PRP/it becomes/VBZ/becomes a/DT/a 1-node/JJ/1-node with/IN/with no/DT/no items/NNS/items after/IN/after the/DT/the removal/NN/removal /:/( figure/NN/figure 11.28a/CD/11.28a and/CC/and d/JJ/d /NN/) /,/, which/WDT/which is/VBZ/is not/RB/not allowed/VBN/allowed in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. this/DT/this type/NN/type of/IN/of violation/NN/violation of/IN/of the/DT/the size/NN/size property/NN/property is/VBZ/is called/VBN/called an/DT/an underflow/JJ/underflow at/IN/at node/NN/node w/NNP/w. to/TO/to remedy/VB/remedy an/DT/an underflow/JJ/underflow /,/, we/PRP/we check/VBP/check whether/IN/whether an/DT/an immediate/JJ/immediate sibling/NN/sibling of/IN/of w/NN/w is/VBZ/is a/DT/a 3-node/JJ/3-node or/CC/or a/DT/a 4-node/CD/4-node. if/IN/if we/PRP/we find/VBP/find such/JJ/such a/DT/a sibling/NN/sibling s/VBZ/s /,/, then/RB/then we/PRP/we perform/VBP/perform a/DT/a transfer/NN/transfer operation/NN/operation /,/, in/IN/in which/WDT/which we/PRP/we move/VBP/move a/DT/a child/NN/child of/IN/of s/NNS/s to/TO/to w/VB/w /,/, a/DT/a key/JJ/key of/IN/of s/NNS/s to/TO/to the/DT/the parent/NN/parent u/NN/u of/IN/of w/NN/w and/CC/and s/NNS/s /,/, and/CC/and a/DT/a key/JJ/key of/IN/of u/NN/u to/TO/to w/NNP/w. /NNP/( see/VB/see figure/NN/figure 11.28b/CD/11.28b and/CC/and c/NNP/c. /NNP/) if/IN/if w/NN/w has/VBZ/has only/RB/only one/CD/one sibling/VBG/sibling /,/, or/CC/or if/IN/if both/DT/both immediate/JJ/immediate siblings/NNS/siblings of/IN/of w/NN/w are/VBP/are 2-nodes/NNS/2-nodes /,/, then/RB/then we/PRP/we perform/VBP/perform a/DT/a fusion/NN/fusion operation/NN/operation /,/, in/IN/in which/WDT/which we/PRP/we merge/VBP/merge w/NN/w with/IN/with a/DT/a sibling/NN/sibling /,/, creating/VBG/creating a/DT/a new/JJ/new node/NN/node w_/NNP/w_ /,/, and/CC/and move/VB/move a/DT/a key/JJ/key from/IN/from the/DT/the parent/NN/parent u/NN/u of/IN/of w/NN/w to/TO/to w_/NNP/w_. /NNP/( see/VB/see figure/NN/figure 11.28e/CD/11.28e and/CC/and f/NNP/f. /NNP/) 510/CD/510 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees figure/VBP/figure 11.28/CD/11.28 /:/: a/DT/a sequence/NN/sequence of/IN/of removals/NNS/removals from/IN/from a/DT/a /CD/( 2,4/CD/2,4 /CD/) tree/NN/tree /:/: /:/( a/DT/a /NN/) removal/NN/removal of/IN/of 4/CD/4 /,/, causing/VBG/causing an/DT/an underflow/JJ/underflow ;/:/; /:/( b/NN/b /:/) a/DT/a transfer/NN/transfer operation/NN/operation ;/:/; /:/( c/NN/c /:/) after/IN/after the/DT/the transfer/NN/transfer operation/NN/operation ;/:/; /:/( d/NN/d /:/) removal/NN/removal of/IN/of 12/CD/12 /,/, causing/VBG/causing an/DT/an underflow/JJ/underflow ;/:/; /:/( e/NN/e /:/) a/DT/a fusion/NN/fusion operation/NN/operation ;/:/; /:/( f/NN/f /:/) after/IN/after the/DT/the fusion/NN/fusion operation/NN/operation ;/:/; /:/( g/NN/g /:/) removal/NN/removal of/IN/of 13/CD/13 ;/:/; /:/( h/NN/h /:/) after/IN/after removing/NN/removing 13/CD/13. 11.5/CD/11.5. /CD/( 2,4/CD/2,4 /CD/) trees/NNS/trees 511/CD/511 a/DT/a fusion/NN/fusion operation/NN/operation at/IN/at node/NN/node w/NN/w may/MD/may cause/VB/cause a/DT/a new/JJ/new underflow/NN/underflow to/TO/to occur/VB/occur at/IN/at the/DT/the parent/NN/parent u/NN/u of/IN/of w/NN/w /,/, which/WDT/which in/IN/in turn/NN/turn triggers/NNS/triggers a/DT/a transfer/NN/transfer or/CC/or fusion/NN/fusion at/IN/at u/NNP/u. /NNP/( see/VB/see figure/NN/figure 11.29/CD/11.29. /CD/) hence/NN/hence /,/, the/DT/the number/NN/number of/IN/of fusion/NN/fusion operations/NNS/operations is/VBZ/is bounded/VBN/bounded by/IN/by the/DT/the height/NN/height of/IN/of the/DT/the tree/NN/tree /,/, which/WDT/which is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) by/IN/by proposition/NN/proposition 11.8/CD/11.8. if/IN/if an/DT/an underflow/JJ/underflow propagates/NNS/propagates all/DT/all the/DT/the way/NN/way up/RP/up to/TO/to the/DT/the root/NN/root /,/, then/RB/then the/DT/the root/NN/root is/VBZ/is simply/RB/simply deleted/NNP/deleted. /:/( see/VB/see figure/NN/figure 11.29c/CD/11.29c and/CC/and d/NNP/d. /NNP/) 11/CD/11 8/CD/8 10/CD/10 17/CD/17 6/CD/6 5/CD/5 14/CD/14 15/CD/15 6/CD/6 w/NN/w 8/CD/8 10/CD/10 17/CD/17 11/CD/11 u/NN/u 5/CD/5 15/CD/15 /CD/( a/DT/a /NN/) /:/( b/NN/b /:/) 8/CD/8 10/CD/10 6/CD/6 u/NN/u w/NN/w 5/CD/5 15/CD/15 17/CD/17 11/CD/11 5/CD/5 8/CD/8 10/CD/10 17/CD/17 6/CD/6 11/CD/11 15/CD/15 /CD/( c/NN/c /:/) /:/( d/NN/d /:/) figure/NN/figure 11.29/CD/11.29 /:/: a/DT/a propagating/NN/propagating sequence/NN/sequence of/IN/of fusions/NNS/fusions in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree /:/: /:/( a/DT/a /NN/) removal/NN/removal of/IN/of 14/CD/14 /,/, which/WDT/which causes/NNS/causes an/DT/an underflow/JJ/underflow ;/:/; /:/( b/NN/b /:/) fusion/NN/fusion /,/, which/WDT/which causes/NNS/causes another/DT/another underflow/NN/underflow ;/:/; /:/( c/NN/c /:/) second/JJ/second fusion/NN/fusion operation/NN/operation /,/, which/WDT/which causes/NNS/causes the/DT/the root/NN/root to/TO/to be/VB/be removed/VBN/removed ;/:/; /:/( d/NN/d /:/) final/JJ/final tree/NNP/tree. performance/NN/performance of/IN/of /NNP/( 2,4/CD/2,4 /CD/) trees/NNS/trees the/DT/the asymptotic/JJ/asymptotic performance/NN/performance of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree is/VBZ/is identical/JJ/identical to/TO/to that/DT/that of/IN/of an/DT/an avl/NN/avl tree/NN/tree /:/( see/NN/see table/NN/table 11.2/CD/11.2 /CD/) in/IN/in terms/NNS/terms of/IN/of the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt /,/, with/IN/with guaranteed/NN/guaranteed logarithmic/JJ/logarithmic bounds/NNS/bounds for/IN/for most/JJS/most operations/NNP/operations. the/DT/the time/NN/time complexity/NN/complexity analysis/NN/analysis for/IN/for a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree having/VBG/having n/NN/n keyvalue/NN/keyvalue pairs/NNS/pairs is/VBZ/is based/VBN/based on/IN/on the/DT/the following/JJ/following /:/: the/DT/the height/NN/height of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /,/, by/IN/by proposition/NN/proposition 11.8/CD/11.8. a/DT/a split/NN/split /,/, transfer/NN/transfer /,/, or/CC/or fusion/NN/fusion operation/NN/operation takes/VBZ/takes o/NN/o /:/( 1/CD/1 /CD/) time/NNP/time. a/DT/a search/NN/search /,/, insertion/NN/insertion /,/, or/CC/or removal/NN/removal of/IN/of an/DT/an entry/NN/entry visits/VBZ/visits o/NN/o /:/( logn/NN/logn /:/) nodes/NNP/nodes. thus/RB/thus /,/, /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees provide/VB/provide for/IN/for fast/JJ/fast map/NN/map search/NN/search and/CC/and update/VB/update operations/NNP/operations. /NNP/( 2,4/CD/2,4 /CD/) trees/NNS/trees also/RB/also have/VBP/have an/DT/an interesting/JJ/interesting relationship/NN/relationship to/TO/to the/DT/the data/NNS/data structure/VBP/structure we/PRP/we discuss/VBP/discuss next/NNP/next. 512/CD/512 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees 11.6/CD/11.6 red-black/JJ/red-black trees/NNS/trees although/IN/although avl/NN/avl trees/NNS/trees and/CC/and /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees have/VBP/have a/DT/a number/NN/number of/IN/of nice/NN/nice properties/NNS/properties /,/, they/PRP/they also/RB/also have/VBP/have some/DT/some disadvantages/NNP/disadvantages. for/IN/for instance/NN/instance /,/, avl/NN/avl trees/NNS/trees may/MD/may require/VB/require many/JJ/many restructure/NN/restructure operations/NNS/operations /:/( rotations/NNS/rotations /VBP/) to/TO/to be/VB/be performed/VBN/performed after/IN/after a/DT/a deletion/NN/deletion /,/, and/CC/and /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees may/MD/may require/VB/require many/JJ/many split/NN/split or/CC/or fusing/VBG/fusing operations/NNS/operations to/TO/to be/VB/be performed/VBN/performed after/IN/after an/DT/an insertion/NN/insertion or/CC/or removal/NNP/removal. the/DT/the data/NNS/data structure/VBP/structure we/PRP/we discuss/VBP/discuss in/IN/in this/DT/this section/NN/section /,/, the/DT/the red-black/JJ/red-black tree/NN/tree /,/, does/VBZ/does not/RB/not have/VB/have these/DT/these drawbacks/NNS/drawbacks ;/:/; it/PRP/it uses/VBZ/uses o/RB/o /:/( 1/CD/1 /CD/) structural/JJ/structural changes/NNS/changes after/IN/after an/DT/an update/NN/update in/IN/in order/NN/order to/TO/to stay/VB/stay balanced/NNP/balanced. formally/RB/formally /,/, a/DT/a red-black/JJ/red-black tree/NN/tree is/VBZ/is a/DT/a binary/JJ/binary search/NN/search tree/NN/tree /:/( see/NN/see section/NN/section 11.1/CD/11.1 /CD/) with/IN/with nodes/NNS/nodes colored/VBN/colored red/VBN/red and/CC/and black/JJ/black in/IN/in a/DT/a way/NN/way that/WDT/that satisfies/VBZ/satisfies the/DT/the following/VBG/following properties/NNS/properties /:/: root/NN/root property/NN/property /:/: the/DT/the root/NN/root is/VBZ/is black/NNP/black. red/VBD/red property/NN/property /:/: the/DT/the children/NNS/children of/IN/of a/DT/a red/VBN/red node/NN/node /:/( if/IN/if any/DT/any /NN/) are/VBP/are black/NNP/black. depth/NN/depth property/NN/property /:/: all/DT/all nodes/NNS/nodes with/IN/with zero/NN/zero or/CC/or one/CD/one children/NNS/children have/VBP/have the/DT/the same/JJ/same black/NN/black depth/NN/depth /,/, defined/VBD/defined as/IN/as the/DT/the number/NN/number of/IN/of black/JJ/black ancestors/NNP/ancestors. /NNP/( recall/NN/recall that/WDT/that a/DT/a node/NN/node is/VBZ/is its/PRP$/its own/JJ/own ancestor/NN/ancestor /:/) /./. an/DT/an example/NN/example of/IN/of a/DT/a red-black/JJ/red-black tree/NN/tree is/VBZ/is shown/VBN/shown in/IN/in figure/NN/figure 11.30/CD/11.30. 10/CD/10 13/CD/13 17/CD/17 15/CD/15 12/CD/12 5/CD/5 3/CD/3 4/CD/4 6/CD/6 8/CD/8 7/CD/7 11/CD/11 14/CD/14 figure/NN/figure 11.30/CD/11.30 /:/: an/DT/an example/NN/example of/IN/of a/DT/a red-black/JJ/red-black tree/NN/tree /,/, with/IN/with red/JJ/red nodes/NNS/nodes drawn/VBN/drawn in/IN/in white/NNP/white. the/DT/the common/JJ/common black/NN/black depth/NN/depth for/IN/for this/DT/this tree/NN/tree is/VBZ/is 3/CD/3. we/PRP/we can/MD/can make/VB/make the/DT/the red-black/JJ/red-black tree/NN/tree definition/NN/definition more/RBR/more intuitive/JJ/intuitive by/IN/by noting/NN/noting an/DT/an interesting/JJ/interesting correspondence/NN/correspondence between/IN/between red-black/JJ/red-black trees/NNS/trees and/CC/and /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees /:/( excluding/VBG/excluding their/PRP$/their trivial/JJ/trivial external/JJ/external nodes/NNS/nodes /:/) /./. namely/RB/namely /,/, given/VBN/given a/DT/a red-black/JJ/red-black tree/NN/tree /,/, we/PRP/we can/MD/can construct/VB/construct a/DT/a corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree by/IN/by merging/NN/merging every/DT/every red/NN/red node/NN/node w/NN/w into/IN/into its/PRP$/its parent/NN/parent /,/, storing/VBG/storing the/DT/the entry/NN/entry from/IN/from w/NN/w at/IN/at its/PRP$/its parent/NN/parent /,/, and/CC/and with/IN/with the/DT/the children/NNS/children of/IN/of w/NN/w becoming/VBG/becoming ordered/VBN/ordered children/NNS/children of/IN/of the/DT/the parent/NNP/parent. for/IN/for example/NN/example /,/, the/DT/the red-black/JJ/red-black tree/NN/tree in/IN/in figure/NN/figure 11.30/CD/11.30 corresponds/NNS/corresponds to/TO/to the/DT/the /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree from/IN/from figure/NN/figure 11.24/CD/11.24 /,/, as/IN/as illustrated/VBN/illustrated in/IN/in figure/NN/figure 11.31/CD/11.31. the/DT/the depth/NN/depth property/NN/property of/IN/of the/DT/the red-black/JJ/red-black tree/NN/tree corresponds/NNS/corresponds to/TO/to the/DT/the depth/NN/depth property/NN/property of/IN/of the/DT/the /NNP/( 2,4/CD/2,4 /CD/) tree/NN/tree since/IN/since exactly/RB/exactly one/CD/one black/JJ/black node/NN/node of/IN/of the/DT/the red-black/JJ/red-black tree/NN/tree contributes/NNS/contributes to/TO/to each/DT/each node/NN/node of/IN/of the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NNP/tree. conversely/RB/conversely /,/, we/PRP/we can/MD/can transform/VB/transform any/DT/any /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree into/IN/into a/DT/a corresponding/JJ/corresponding red-black/NN/red-black tree/NN/tree by/IN/by coloring/NN/coloring each/DT/each node/NN/node w/NN/w black/NN/black and/CC/and then/RB/then performing/VBG/performing the/DT/the following/VBG/following transformations/NNS/transformations /,/, as/IN/as illustrated/VBN/illustrated in/IN/in figure/NN/figure 11.32/CD/11.32. 11.6/CD/11.6. red-black/JJ/red-black trees/NNS/trees 513/CD/513 11/CD/11 5/CD/5 14/CD/14 3/CD/3 13/CD/13 17/CD/17 15/CD/15 12/CD/12 4/CD/4 6/CD/6 8/CD/8 7/CD/7 10/CD/10 figure/NN/figure 11.31/CD/11.31 /:/: an/DT/an illustration/NN/illustration that/IN/that the/DT/the red-black/JJ/red-black tree/NN/tree of/IN/of figure/NN/figure 11.30/CD/11.30 corresponds/NNS/corresponds to/TO/to the/DT/the /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree of/IN/of figure/NN/figure 11.24/CD/11.24 /,/, based/VBN/based on/IN/on the/DT/the highlighted/VBN/highlighted grouping/VBG/grouping of/IN/of red/JJ/red nodes/NNS/nodes with/IN/with their/PRP$/their black/JJ/black parents/NNP/parents. if/IN/if w/NN/w is/VBZ/is a/DT/a 2-node/JJ/2-node /,/, then/RB/then keep/VB/keep the/DT/the /NNP/( black/NN/black /:/) children/NNS/children of/IN/of w/NN/w as/IN/as is/NNP/is. if/IN/if w/NN/w is/VBZ/is a/DT/a 3-node/JJ/3-node /,/, then/RB/then create/VB/create a/DT/a new/JJ/new red/JJ/red node/NN/node y/NN/y /,/, give/JJ/give w/NN/w s/NNS/s last/JJ/last two/CD/two /CD/( black/JJ/black /NN/) children/NNS/children to/TO/to y/VB/y /,/, and/CC/and make/VB/make the/DT/the first/JJ/first child/NN/child of/IN/of w/NN/w and/CC/and y/NN/y be/VB/be the/DT/the two/CD/two children/NNS/children of/IN/of w/NNP/w. if/IN/if w/NN/w is/VBZ/is a/DT/a 4-node/JJ/4-node /,/, then/RB/then create/VB/create two/CD/two new/JJ/new red/JJ/red nodes/NNS/nodes y/VBP/y and/CC/and z/NN/z /,/, give/JJ/give w/NN/w s/NNS/s first/RB/first two/CD/two /CD/( black/JJ/black /NN/) children/NNS/children to/TO/to y/VB/y /,/, give/VB/give w/NN/w s/NNS/s last/JJ/last two/CD/two /CD/( black/JJ/black /NN/) children/NNS/children to/TO/to z/VB/z /,/, and/CC/and make/VB/make y/JJ/y and/CC/and z/NN/z be/VB/be the/DT/the two/CD/two children/NNS/children of/IN/of w/NNP/w. notice/NN/notice that/WDT/that a/DT/a red/VBD/red node/NN/node always/RB/always has/VBZ/has a/DT/a black/JJ/black parent/NN/parent in/IN/in this/DT/this construction/NNP/construction. proposition/NN/proposition 11.9/CD/11.9 /:/: the/DT/the height/NN/height of/IN/of a/DT/a red-black/JJ/red-black tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. 15/CD/15 15/CD/15 /CD/( a/DT/a /NN/) 13/CD/13 14/CD/14 13/CD/13 14/CD/14 14/CD/14 13/CD/13 or/CC/or /CD/( b/NN/b /:/) 6/CD/6 7/CD/7 8/CD/8 7/CD/7 6/CD/6 8/CD/8 /CD/( c/NN/c /:/) figure/NN/figure 11.32/CD/11.32 /:/: correspondence/NN/correspondence between/IN/between nodes/NNS/nodes of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree and/CC/and a/DT/a red-black/JJ/red-black tree/NN/tree /:/: /:/( a/DT/a /NN/) 2-node/CD/2-node ;/:/; /:/( b/NN/b /:/) 3-node/JJ/3-node ;/:/; /:/( c/NN/c /:/) 4-node/CD/4-node. 514/CD/514 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees justification/NN/justification /:/: let/VB/let t/NN/t be/VB/be a/DT/a red-black/JJ/red-black tree/NN/tree storing/VBG/storing n/NN/n entries/NNS/entries /,/, and/CC/and let/VB/let h/NN/h be/VB/be the/DT/the height/NN/height of/IN/of t/NNP/t. we/PRP/we justify/VBP/justify this/DT/this proposition/NN/proposition by/IN/by establishing/NN/establishing the/DT/the following/VBG/following fact/NN/fact /:/: log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) 1/CD/1 h/NN/h 2log/CD/2log /CD/( n/NN/n +/:/+ 1/CD/1 /CD/) 2/CD/2. let/NN/let d/NN/d be/VB/be the/DT/the common/JJ/common black/NN/black depth/NN/depth of/IN/of all/DT/all nodes/NNS/nodes of/IN/of t/NN/t having/VBG/having zero/NN/zero or/CC/or one/CD/one children/NNP/children. let/NN/let t_/NNP/t_ be/VB/be the/DT/the /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree associated/VBN/associated with/IN/with t/NN/t /,/, and/CC/and let/VB/let h_/NNP/h_ be/VB/be the/DT/the height/NN/height of/IN/of t_/NNP/t_ /NNP/( excluding/VBG/excluding trivial/JJ/trivial leaves/NNS/leaves /:/) /./. because/IN/because of/IN/of the/DT/the correspondence/NN/correspondence between/IN/between red-black/JJ/red-black trees/NNS/trees and/CC/and /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees /,/, we/PRP/we know/VBP/know that/IN/that h_/NNP/h_ =/NNP/= d/NNP/d. hence/NN/hence /,/, by/IN/by proposition/NN/proposition 11.8/CD/11.8 /,/, d/JJ/d =/NN/= h_/NNP/h_ log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) 1/CD/1. by/IN/by the/DT/the red/NN/red property/NN/property /,/, h/NN/h 2d/CD/2d. thus/RB/thus /,/, we/PRP/we obtain/VBP/obtain h/JJ/h 2log/CD/2log /CD/( n/NN/n +/:/+ 1/CD/1 /CD/) 2/CD/2. the/DT/the other/JJ/other inequality/NN/inequality /,/, log/NN/log /:/( n/NN/n +/:/+ 1/CD/1 /CD/) 1/CD/1 h/NN/h /,/, follows/VBZ/follows from/IN/from proposition/NN/proposition 8.8/CD/8.8 and/CC/and the/DT/the fact/NN/fact that/IN/that t/NN/t has/VBZ/has n/VBN/n nodes/NNP/nodes. 11.6.1/CD/11.6.1 red-black/JJ/red-black tree/NN/tree operations/NNS/operations the/DT/the algorithm/NN/algorithm for/IN/for searching/VBG/searching in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree t/NN/t is/VBZ/is the/DT/the same/JJ/same as/IN/as that/DT/that for/IN/for a/DT/a standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree /:/( section/NN/section 11.1/CD/11.1 /CD/) /./. thus/RB/thus /,/, searching/VBG/searching in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree takes/VBZ/takes time/NN/time proportional/JJ/proportional to/TO/to the/DT/the height/NN/height of/IN/of the/DT/the tree/NN/tree /,/, which/WDT/which is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) by/IN/by proposition/NN/proposition 11.9/CD/11.9. the/DT/the correspondence/NN/correspondence between/IN/between /CD/( 2,4/CD/2,4 /CD/) trees/NNS/trees and/CC/and red-black/JJ/red-black trees/NNS/trees provides/VBZ/provides important/JJ/important intuition/NN/intuition that/WDT/that we/PRP/we will/MD/will use/VB/use in/IN/in our/PRP$/our discussion/NN/discussion of/IN/of how/WRB/how to/TO/to perform/VB/perform updates/NNS/updates in/IN/in red-black/JJ/red-black trees/NNS/trees ;/:/; in/IN/in fact/NN/fact /,/, the/DT/the update/NN/update algorithms/NNS/algorithms for/IN/for red-black/JJ/red-black trees/NNS/trees can/MD/can seem/VB/seem mysteriously/RB/mysteriously complex/JJ/complex without/IN/without this/DT/this intuition/NNP/intuition. split/NN/split and/CC/and fuse/NN/fuse operations/NNS/operations of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree will/MD/will be/VB/be effectively/RB/effectively mimicked/VBN/mimicked by/IN/by recoloring/NN/recoloring neighboring/VBG/neighboring red-black/JJ/red-black tree/NN/tree nodes/NNP/nodes. a/DT/a rotation/NN/rotation within/IN/within a/DT/a red-black/JJ/red-black tree/NN/tree will/MD/will be/VB/be used/VBN/used to/TO/to change/VB/change orientations/NNS/orientations of/IN/of a/DT/a 3-node/JJ/3-node between/IN/between the/DT/the two/CD/two forms/NNS/forms shown/IN/shown in/IN/in figure/NN/figure 11.32/CD/11.32 /CD/( b/NN/b /:/) /./. insertion/NN/insertion now/RB/now consider/JJR/consider the/DT/the insertion/NN/insertion of/IN/of a/DT/a key-value/JJ/key-value pair/NN/pair /:/( k,v/NN/k,v /:/) into/IN/into a/DT/a red-black/JJ/red-black tree/NN/tree t/NNP/t. the/DT/the algorithm/NN/algorithm initially/RB/initially proceeds/VBZ/proceeds as/IN/as in/IN/in a/DT/a standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree /:/( section/NN/section 11.1.3/CD/11.1.3 /CD/) /./. namely/RB/namely /,/, we/PRP/we search/VBP/search for/IN/for k/NN/k in/IN/in t/NN/t until/IN/until we/PRP/we reach/VBP/reach a/DT/a null/NN/null subtree/NN/subtree /,/, and/CC/and we/PRP/we introduce/VBP/introduce a/DT/a new/JJ/new leaf/NN/leaf x/NN/x at/IN/at that/DT/that position/NN/position /,/, storing/VBG/storing the/DT/the item/NNP/item. in/IN/in the/DT/the special/JJ/special case/NN/case that/WDT/that x/NN/x is/VBZ/is the/DT/the only/JJ/only node/NN/node of/IN/of t/NN/t /,/, and/CC/and thus/RB/thus the/DT/the root/NN/root /,/, we/PRP/we color/VBP/color it/PRP/it black/NNP/black. in/IN/in all/DT/all other/JJ/other cases/NNS/cases /,/, we/PRP/we color/VBP/color x/NN/x red/NNP/red. this/DT/this action/NN/action corresponds/VBZ/corresponds to/TO/to inserting/VBG/inserting /NN/( k,v/NN/k,v /:/) into/IN/into a/DT/a node/NN/node of/IN/of the/DT/the /NNP/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_ with/IN/with external/JJ/external children/NNP/children. the/DT/the insertion/NN/insertion preserves/VBZ/preserves the/DT/the root/NN/root and/CC/and depth/NN/depth properties/NNS/properties of/IN/of t/NN/t /,/, but/CC/but it/PRP/it may/MD/may violate/VB/violate the/DT/the red/NN/red property/NNP/property. indeed/RB/indeed /,/, if/IN/if x/NN/x is/VBZ/is not/RB/not the/DT/the root/NN/root of/IN/of t/NN/t and/CC/and the/DT/the parent/NN/parent y/NN/y of/IN/of x/NN/x is/VBZ/is red/VBN/red /,/, then/RB/then we/PRP/we have/VBP/have a/DT/a parent/NN/parent and/CC/and a/DT/a child/NN/child /:/( namely/RB/namely /,/, y/NN/y and/CC/and x/NN/x /:/) that/IN/that are/VBP/are both/DT/both red/NNP/red. note/NN/note that/IN/that by/IN/by the/DT/the root/NN/root property/NN/property /,/, y/NN/y can/MD/can not/RB/not be/VB/be the/DT/the root/NN/root of/IN/of t/NN/t /,/, and/CC/and by/IN/by the/DT/the red/NN/red property/NN/property /:/( which/WDT/which was/VBD/was previously/RB/previously satisfied/VBN/satisfied /-NONE-/) /,/, the/DT/the parent/NN/parent z/NN/z of/IN/of y/NN/y must/MD/must be/VB/be black/NNP/black. since/IN/since x/NN/x and/CC/and its/PRP$/its parent/NN/parent are/VBP/are red/VBN/red /,/, but/CC/but x/NN/x s/NNS/s grandparent/NN/grandparent z/NN/z is/VBZ/is black/JJ/black /,/, we/PRP/we call/VBP/call this/DT/this violation/NN/violation of/IN/of the/DT/the red/NN/red property/NN/property a/DT/a double/JJ/double red/VBN/red at/IN/at node/NN/node x/NNP/x. to/TO/to remedy/VB/remedy a/DT/a double/JJ/double red/VBN/red /,/, we/PRP/we consider/VBP/consider two/CD/two cases/NNP/cases. 11.6/CD/11.6. red-black/JJ/red-black trees/NNS/trees case/NN/case 1/CD/1 /:/: the/DT/the sibling/NN/sibling s/VBZ/s of/IN/of y/NN/y is/VBZ/is black/JJ/black /NN/( or/CC/or none/NN/none /:/) /./. /:/( see/VB/see figure/NN/figure 11.33/CD/11.33. /CD/) in/IN/in this/DT/this case/NN/case /,/, the/DT/the double/JJ/double red/NN/red denotes/NNS/denotes the/DT/the fact/NN/fact that/IN/that we/PRP/we have/VBP/have added/VBN/added the/DT/the new/JJ/new node/NN/node to/TO/to a/DT/a corresponding/NN/corresponding 3-node/CD/3-node of/IN/of the/DT/the /NNP/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_ /,/, effectively/RB/effectively creating/VBG/creating a/DT/a malformed/JJ/malformed 4-node/CD/4-node. this/DT/this formation/NN/formation has/VBZ/has one/CD/one red/VBN/red node/NN/node /:/( y/NN/y /:/) that/IN/that is/VBZ/is the/DT/the parent/NN/parent of/IN/of another/DT/another red/NN/red node/NN/node /:/( x/NN/x /:/) /,/, while/IN/while we/PRP/we want/VBP/want it/PRP/it to/TO/to have/VB/have the/DT/the two/CD/two red/VBD/red nodes/NNS/nodes as/IN/as siblings/NNS/siblings instead/NNP/instead. to/TO/to fix/VB/fix this/DT/this problem/NN/problem /,/, we/PRP/we perform/VBP/perform a/DT/a trinode/NN/trinode restructuring/VBG/restructuring of/IN/of t/NNP/t. the/DT/the trinode/NN/trinode restructuring/VBG/restructuring is/VBZ/is done/VBN/done by/IN/by the/DT/the operation/NN/operation restructure/NN/restructure /:/( x/NN/x /:/) /,/, which/WDT/which consists/NNS/consists of/IN/of the/DT/the following/JJ/following steps/NNS/steps /:/( see/VB/see again/RB/again figure/VB/figure 11.33/CD/11.33 ;/:/; this/DT/this operation/NN/operation is/VBZ/is also/RB/also discussed/VBN/discussed in/IN/in section/NN/section 11.2/CD/11.2 /CD/) /:/: take/NN/take node/NN/node x/NN/x /,/, its/PRP$/its parent/NN/parent y/NN/y /,/, and/CC/and grandparent/NN/grandparent z/NN/z /,/, and/CC/and temporarily/RB/temporarily relabel/NN/relabel them/PRP/them as/IN/as a/DT/a /,/, b/NN/b /,/, and/CC/and c/NN/c /,/, in/IN/in left-to-right/JJ/left-to-right order/NN/order /,/, so/RB/so that/IN/that a/DT/a /,/, b/NN/b /,/, and/CC/and c/NN/c will/MD/will be/VB/be visited/VBN/visited in/IN/in this/DT/this order/NN/order by/IN/by an/DT/an inorder/NN/inorder tree/NN/tree traversal/NNP/traversal. replace/NN/replace the/DT/the grandparent/NN/grandparent z/NN/z with/IN/with the/DT/the node/NN/node labeled/VBD/labeled b/NN/b /,/, and/CC/and make/VB/make nodes/NNS/nodes a/DT/a and/CC/and c/NN/c the/DT/the children/NNS/children of/IN/of b/NN/b /,/, keeping/VBG/keeping inorder/NN/inorder relationships/NNS/relationships unchanged/NNP/unchanged. after/IN/after performing/VBG/performing the/DT/the restructure/NN/restructure /:/( x/NN/x /:/) operation/NN/operation /,/, we/PRP/we color/VBP/color b/NN/b black/NN/black and/CC/and we/PRP/we color/VBP/color a/DT/a and/CC/and c/NN/c red/NNP/red. thus/RB/thus /,/, the/DT/the restructuring/NN/restructuring eliminates/VBZ/eliminates the/DT/the double-red/JJ/double-red problem/NNP/problem. notice/NN/notice that/WDT/that the/DT/the portion/NN/portion of/IN/of any/DT/any path/NN/path through/IN/through the/DT/the restructured/VBN/restructured part/NN/part of/IN/of the/DT/the tree/NN/tree is/VBZ/is incident/NN/incident to/TO/to exactly/RB/exactly one/CD/one black/JJ/black node/NN/node /,/, both/DT/both before/IN/before and/CC/and after/IN/after the/DT/the trinode/NN/trinode restructuring/NNP/restructuring. therefore/RB/therefore /,/, the/DT/the black/JJ/black depth/NN/depth of/IN/of the/DT/the tree/NN/tree is/VBZ/is unaffected/NNP/unaffected. figure/NN/figure 11.33/CD/11.33 /:/: restructuring/NN/restructuring a/DT/a red-black/JJ/red-black tree/NN/tree to/TO/to remedy/VB/remedy a/DT/a double/JJ/double red/VBN/red /:/: /:/( a/DT/a /NN/) the/DT/the four/CD/four configurations/NNS/configurations for/IN/for x/NN/x /,/, y/NN/y /,/, and/CC/and z/NN/z before/IN/before restructuring/NN/restructuring ;/:/; /:/( b/NN/b /:/) after/IN/after restructuring/NNP/restructuring. 516/CD/516 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees case/NN/case 2/CD/2 /:/: the/DT/the sibling/NN/sibling s/VBZ/s of/IN/of y/NN/y is/VBZ/is red/NNP/red. /:/( see/VB/see figure/NN/figure 11.34/CD/11.34. /CD/) in/IN/in this/DT/this case/NN/case /,/, the/DT/the double/JJ/double red/NN/red denotes/NNS/denotes an/DT/an overflow/JJ/overflow in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_. to/TO/to fix/VB/fix the/DT/the problem/NN/problem /,/, we/PRP/we perform/VBP/perform the/DT/the equivalent/NN/equivalent of/IN/of a/DT/a split/NN/split operation/NNP/operation. namely/RB/namely /,/, we/PRP/we do/VBP/do a/DT/a recoloring/VBG/recoloring /:/: we/PRP/we color/VBP/color y/JJ/y and/CC/and s/NNS/s black/VBP/black and/CC/and their/PRP$/their parent/NN/parent z/NN/z red/VBD/red /CD/( unless/IN/unless z/NN/z is/VBZ/is the/DT/the root/NN/root /,/, in/IN/in which/WDT/which case/NN/case /,/, it/PRP/it remains/VBZ/remains black/JJ/black /NN/) /./. notice/NN/notice that/IN/that unless/IN/unless z/NN/z is/VBZ/is the/DT/the root/NN/root /,/, the/DT/the portion/NN/portion of/IN/of any/DT/any path/NN/path through/IN/through the/DT/the affected/VBN/affected part/NN/part of/IN/of the/DT/the tree/NN/tree is/VBZ/is incident/NN/incident to/TO/to exactly/RB/exactly one/CD/one black/JJ/black node/NN/node /,/, both/DT/both before/IN/before and/CC/and after/IN/after the/DT/the recoloring/NNP/recoloring. therefore/NN/therefore /,/, the/DT/the black/JJ/black depth/NN/depth of/IN/of the/DT/the tree/NN/tree is/VBZ/is unaffected/VBN/unaffected by/IN/by the/DT/the recoloring/VBG/recoloring unless/IN/unless z/NN/z is/VBZ/is the/DT/the root/NN/root /,/, in/IN/in which/WDT/which case/NN/case it/PRP/it is/VBZ/is increased/VBN/increased by/IN/by one/NNP/one. however/RB/however /,/, it/PRP/it is/VBZ/is possible/JJ/possible that/IN/that the/DT/the double-red/JJ/double-red problem/NN/problem reappears/NNS/reappears after/IN/after such/JJ/such a/DT/a recoloring/NN/recoloring /,/, albeit/NN/albeit higher/JJR/higher up/IN/up in/IN/in the/DT/the tree/NN/tree t/NN/t /,/, since/IN/since z/NN/z may/MD/may have/VB/have a/DT/a red/VBN/red parent/NNP/parent. if/IN/if the/DT/the double-red/JJ/double-red problem/NN/problem reappears/NNS/reappears at/IN/at z/NN/z /,/, then/RB/then we/PRP/we repeat/VBP/repeat the/DT/the consideration/NN/consideration of/IN/of the/DT/the two/CD/two cases/NNS/cases at/IN/at z/NNP/z. thus/RB/thus /,/, a/DT/a recoloring/NN/recoloring either/NN/either eliminates/VBZ/eliminates the/DT/the double-red/JJ/double-red problem/NN/problem at/IN/at node/NN/node x/NN/x /,/, or/CC/or propagates/NNS/propagates it/PRP/it to/TO/to the/DT/the grandparent/NN/grandparent z/NN/z of/IN/of x/NNP/x. we/PRP/we continue/VBP/continue going/VBG/going up/RP/up t/NN/t performing/VBG/performing recolorings/NNS/recolorings until/IN/until we/PRP/we finally/RB/finally resolve/VBP/resolve the/DT/the double-red/JJ/double-red problem/NN/problem /:/( with/IN/with either/DT/either a/DT/a final/JJ/final recoloring/NN/recoloring or/CC/or a/DT/a trinode/NN/trinode restructuring/VBG/restructuring /NN/) /./. thus/RB/thus /,/, the/DT/the number/NN/number of/IN/of recolorings/NNS/recolorings caused/VBN/caused by/IN/by an/DT/an insertion/NN/insertion is/VBZ/is no/DT/no more/RBR/more than/IN/than half/PDT/half the/DT/the height/NN/height of/IN/of tree/NN/tree t/NN/t /,/, that/IN/that is/VBZ/is /,/, o/RB/o /:/( logn/NN/logn /:/) by/IN/by proposition/NN/proposition 11.9/CD/11.9. /CD/( b/NN/b /:/) figure/NN/figure 11.34/CD/11.34 /:/: recoloring/VBG/recoloring to/TO/to remedy/JJ/remedy the/DT/the double-red/JJ/double-red problem/NN/problem /:/: /:/( a/DT/a /NN/) before/IN/before recoloring/VBG/recoloring and/CC/and the/DT/the corresponding/NN/corresponding 5-node/CD/5-node in/IN/in the/DT/the associated/VBN/associated /-NONE-/( 2,4/CD/2,4 /CD/) tree/NN/tree before/IN/before the/DT/the split/NN/split ;/:/; /:/( b/NN/b /:/) after/IN/after recoloring/NN/recoloring and/CC/and the/DT/the corresponding/NN/corresponding nodes/VBZ/nodes in/IN/in the/DT/the associated/VBN/associated /-NONE-/( 2,4/CD/2,4 /CD/) tree/NN/tree after/IN/after the/DT/the split/NNP/split. as/IN/as further/JJ/further examples/NNS/examples /,/, figures/NNS/figures 11.35/CD/11.35 and/CC/and 11.36/CD/11.36 show/NN/show a/DT/a sequence/NN/sequence of/IN/of insertion/NN/insertion operations/NNS/operations in/IN/in a/DT/a red-black/JJ/red-black tree/NNP/tree. 11.6/NNP/11.6. red-black/NNP/red-black trees/VBZ/trees 517/CD/517 figure/NN/figure 11.35/CD/11.35 /:/: a/DT/a sequence/NN/sequence of/IN/of insertions/NNS/insertions in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree /:/: /:/( a/DT/a /NN/) initial/JJ/initial tree/NN/tree ;/:/; /:/( b/NN/b /:/) insertion/NN/insertion of/IN/of 7/CD/7 ;/:/; /:/( c/NN/c /:/) insertion/NN/insertion of/IN/of 12/CD/12 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( d/NN/d /:/) after/IN/after restructuring/NN/restructuring ;/:/; /:/( e/NN/e /:/) insertion/NN/insertion of/IN/of 15/CD/15 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( f/NN/f /:/) after/IN/after recoloring/NN/recoloring /:/( the/DT/the root/NN/root remains/VBZ/remains black/JJ/black /NN/) ;/:/; /:/( g/NN/g /:/) insertion/NN/insertion of/IN/of 3/CD/3 ;/:/; /:/( h/NN/h /:/) insertion/NN/insertion of/IN/of 5/CD/5 ;/:/; /:/( i/PRP/i /VBP/) insertion/NN/insertion of/IN/of 14/CD/14 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( j/NN/j /:/) after/IN/after restructuring/NN/restructuring ;/:/; /:/( k/NN/k /:/) insertion/NN/insertion of/IN/of 18/CD/18 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( l/NN/l /:/) after/IN/after recoloring/NNP/recoloring. /NNP/( continues/VBZ/continues in/IN/in figure/NN/figure 11.36/CD/11.36. /CD/) 518/CD/518 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees /:/( q/NN/q /:/) figure/NN/figure 11.36/CD/11.36 /:/: a/DT/a sequence/NN/sequence of/IN/of insertions/NNS/insertions in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree /:/: /:/( m/NN/m /:/) insertion/NN/insertion of/IN/of 16/CD/16 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( n/NN/n /:/) after/IN/after restructuring/NN/restructuring ;/:/; /:/( o/NN/o /:/) insertion/NN/insertion of/IN/of 17/CD/17 /,/, which/WDT/which causes/NNS/causes a/DT/a double/JJ/double red/VBN/red ;/:/; /:/( p/NN/p /:/) after/IN/after recoloring/NN/recoloring there/EX/there is/VBZ/is again/RB/again a/DT/a double/JJ/double red/VBN/red /,/, to/TO/to be/VB/be handled/VBN/handled by/IN/by a/DT/a restructuring/NN/restructuring ;/:/; /:/( q/NN/q /:/) after/IN/after restructuring/NNP/restructuring. /NNP/( continued/VBD/continued from/IN/from figure/NN/figure 11.35/CD/11.35. /CD/) 11.6/CD/11.6. red-black/JJ/red-black trees/NNS/trees 519/CD/519 deletion/NN/deletion deleting/VBG/deleting an/DT/an item/NN/item with/IN/with key/JJ/key k/NN/k from/IN/from a/DT/a red-black/JJ/red-black tree/NN/tree t/NN/t initially/RB/initially proceeds/VBZ/proceeds as/IN/as for/IN/for a/DT/a binary/JJ/binary search/NN/search tree/NN/tree /:/( section/NN/section 11.1.3/CD/11.1.3 /CD/) /./. structurally/RB/structurally /,/, the/DT/the process/NN/process results/NNS/results in/IN/in the/DT/the removal/NN/removal a/DT/a node/NN/node that/WDT/that has/VBZ/has at/IN/at most/JJS/most one/CD/one child/NN/child /:/( either/DT/either that/WDT/that originally/RB/originally containing/VBG/containing key/JJ/key k/NN/k or/CC/or its/PRP$/its inorder/NN/inorder predecessor/NN/predecessor /:/) and/CC/and the/DT/the promotion/NN/promotion of/IN/of its/PRP$/its remaining/VBG/remaining child/NN/child /:/( if/IN/if any/DT/any /NN/) /./. if/IN/if the/DT/the removed/VBN/removed node/NN/node was/VBD/was red/VBN/red /,/, this/DT/this structural/JJ/structural change/NN/change does/VBZ/does not/RB/not affect/VB/affect the/DT/the black/JJ/black depths/NNS/depths of/IN/of any/DT/any paths/NNS/paths in/IN/in the/DT/the tree/NN/tree /,/, nor/CC/nor introduce/VB/introduce any/DT/any red/VBN/red violations/NNS/violations /,/, and/CC/and so/RB/so the/DT/the resulting/VBG/resulting tree/NN/tree remains/VBZ/remains a/DT/a valid/JJ/valid red-black/NN/red-black tree/NNP/tree. in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_ /,/, this/DT/this case/NN/case denotes/VBZ/denotes the/DT/the shrinking/VBG/shrinking of/IN/of a/DT/a 3-node/JJ/3-node or/CC/or 4-node/CD/4-node. if/IN/if the/DT/the removed/VBN/removed node/NN/node was/VBD/was black/JJ/black /,/, then/RB/then it/PRP/it either/RB/either had/VBD/had zero/CD/zero children/NNS/children or/CC/or it/PRP/it had/VBD/had one/CD/one child/NN/child that/WDT/that was/VBD/was a/DT/a red/VBN/red leaf/NN/leaf /:/( because/IN/because the/DT/the null/NN/null subtree/NN/subtree of/IN/of the/DT/the removed/VBN/removed node/NN/node has/VBZ/has black/JJ/black height/NN/height 0/-NONE-/0 /./) /./. in/IN/in the/DT/the latter/NN/latter case/NN/case /,/, the/DT/the removed/VBN/removed node/NN/node represents/NNS/represents the/DT/the black/JJ/black part/NN/part of/IN/of a/DT/a corresponding/NN/corresponding 3-node/CD/3-node /,/, and/CC/and we/PRP/we restore/VBP/restore the/DT/the redblack/NN/redblack properties/NNS/properties by/IN/by recoloring/VBG/recoloring the/DT/the promoted/JJ/promoted child/NN/child to/TO/to black/NNP/black. the/DT/the more/JJR/more complex/JJ/complex case/NN/case is/VBZ/is when/WRB/when a/DT/a /NN/( nonroot/NN/nonroot /:/) black/JJ/black leaf/NN/leaf is/VBZ/is removed/NNP/removed. in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree /,/, this/DT/this denotes/VBZ/denotes the/DT/the removal/NN/removal of/IN/of an/DT/an item/NN/item from/IN/from a/DT/a 2-node/CD/2-node. without/IN/without rebalancing/NN/rebalancing /,/, such/JJ/such a/DT/a change/NN/change results/NNS/results in/IN/in a/DT/a deficit/NN/deficit of/IN/of one/CD/one for/IN/for the/DT/the black/JJ/black depth/NN/depth along/IN/along the/DT/the path/NN/path leading/VBG/leading to/TO/to the/DT/the deleted/VBN/deleted item/NNP/item. by/IN/by necessity/NN/necessity /,/, the/DT/the removed/VBN/removed node/NN/node must/MD/must have/VB/have a/DT/a sibling/VBG/sibling whose/WP$/whose subtree/JJ/subtree has/VBZ/has black/JJ/black height/NN/height 1/CD/1 /CD/( given/VBN/given that/IN/that this/DT/this was/VBD/was a/DT/a valid/JJ/valid red-black/NN/red-black tree/NN/tree prior/RB/prior to/TO/to the/DT/the deletion/NN/deletion of/IN/of the/DT/the black/JJ/black leaf/NN/leaf /:/) /./. to/TO/to remedy/VB/remedy this/DT/this scenario/NN/scenario /,/, we/PRP/we consider/VBP/consider a/DT/a more/RBR/more general/JJ/general setting/NN/setting with/IN/with a/DT/a node/NN/node z/NN/z that/WDT/that is/VBZ/is known/VBN/known to/TO/to have/VB/have two/CD/two subtrees/NNS/subtrees /,/, theavy/JJ/theavy and/CC/and tlight/NN/tlight /,/, such/JJ/such that/IN/that the/DT/the root/NN/root of/IN/of tlight/NN/tlight /:/( if/IN/if any/DT/any /NN/) is/VBZ/is black/JJ/black and/CC/and such/JJ/such that/IN/that the/DT/the black/JJ/black depth/NN/depth of/IN/of theavy/JJ/theavy is/VBZ/is exactly/RB/exactly one/CD/one more/JJR/more than/IN/than that/DT/that of/IN/of tlight/NN/tlight /,/, as/IN/as portrayed/VBN/portrayed in/IN/in figure/NN/figure 11.37/CD/11.37. in/IN/in the/DT/the case/NN/case of/IN/of a/DT/a removed/JJ/removed black/NN/black leaf/NN/leaf /,/, z/NN/z is/VBZ/is the/DT/the parent/NN/parent of/IN/of that/DT/that leaf/NN/leaf and/CC/and tlight/NN/tlight is/VBZ/is trivially/RB/trivially the/DT/the empty/NN/empty subtree/NN/subtree that/WDT/that remains/VBZ/remains after/IN/after the/DT/the deletion/NNP/deletion. we/PRP/we describe/VBP/describe the/DT/the more/RBR/more general/JJ/general case/NN/case of/IN/of a/DT/a deficit/NN/deficit because/IN/because our/PRP$/our algorithm/NN/algorithm for/IN/for rebalancing/NN/rebalancing the/DT/the tree/NN/tree will/MD/will /,/, in/IN/in some/DT/some cases/NNS/cases /,/, push/VBP/push the/DT/the deficit/NN/deficit higher/JJR/higher in/IN/in the/DT/the tree/NN/tree /:/( just/RB/just as/IN/as the/DT/the resolution/NN/resolution of/IN/of a/DT/a deletion/NN/deletion in/IN/in a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree sometimes/RB/sometimes cascades/VBZ/cascades upward/JJ/upward /NN/) /./. we/PRP/we let/VBP/let y/RB/y denote/JJ/denote the/DT/the root/NN/root of/IN/of theavy/NNP/theavy. /NNP/( such/JJ/such a/DT/a node/NN/node exists/VBZ/exists because/IN/because theavy/JJ/theavy has/VBZ/has black/JJ/black height/NN/height at/IN/at least/JJS/least one/NNP/one. /NNP/) y/NN/y theavy/NN/theavy tlight/NN/tlight z/NN/z figure/NN/figure 11.37/CD/11.37 /:/: portrayal/JJ/portrayal of/IN/of a/DT/a deficit/NN/deficit between/IN/between the/DT/the black/JJ/black heights/NNS/heights of/IN/of subtrees/NNS/subtrees of/IN/of node/NN/node z/NNP/z. the/DT/the gray/NN/gray color/NN/color in/IN/in illustrating/NN/illustrating y/NN/y and/CC/and z/NN/z denotes/NNS/denotes the/DT/the fact/NN/fact that/IN/that these/DT/these nodes/NNS/nodes may/MD/may be/VB/be colored/VBN/colored either/DT/either black/JJ/black or/CC/or red/NNP/red. 520/CD/520 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees we/PRP/we consider/VBP/consider three/CD/three possible/JJ/possible cases/NNS/cases to/TO/to remedy/VB/remedy a/DT/a deficit/NNP/deficit. case/NN/case 1/CD/1 /:/: node/NN/node y/NN/y is/VBZ/is black/JJ/black and/CC/and has/VBZ/has a/DT/a red/VBN/red child/NN/child x/NNP/x. /NNP/( see/VB/see figure/NN/figure 11.38/CD/11.38. /CD/) we/PRP/we perform/NN/perform a/DT/a trinode/NN/trinode restructuring/VBG/restructuring /,/, as/IN/as originally/RB/originally described/VBN/described in/IN/in section/NN/section 11.2/CD/11.2. the/DT/the operation/NN/operation restructure/NN/restructure /:/( x/NN/x /:/) takes/VBZ/takes the/DT/the node/NN/node x/NN/x /,/, its/PRP$/its parent/NN/parent y/NN/y /,/, and/CC/and grandparent/NN/grandparent z/NN/z /,/, labels/NNS/labels them/PRP/them temporarily/RB/temporarily left/VBN/left to/TO/to right/RB/right as/IN/as a/DT/a /,/, b/NN/b /,/, and/CC/and c/NN/c /,/, and/CC/and replaces/NNS/replaces z/VBP/z with/IN/with the/DT/the node/NN/node labeled/VBD/labeled b/NN/b /,/, making/VBG/making it/PRP/it the/DT/the parent/NN/parent of/IN/of the/DT/the other/JJ/other two/NNP/two. we/PRP/we color/VBP/color a/DT/a and/CC/and c/NN/c black/NN/black /,/, and/CC/and give/VB/give b/NN/b the/DT/the former/JJ/former color/NN/color of/IN/of z/NNP/z. notice/NN/notice that/WDT/that the/DT/the path/NN/path to/TO/to tlight/NN/tlight in/IN/in the/DT/the result/NN/result includes/VBZ/includes one/CD/one additional/JJ/additional black/JJ/black node/NN/node after/IN/after the/DT/the restructure/NN/restructure /,/, thereby/RB/thereby resolving/VBG/resolving its/PRP$/its deficit/NNP/deficit. in/IN/in contrast/NN/contrast /,/, the/DT/the number/NN/number of/IN/of black/JJ/black nodes/NNS/nodes on/IN/on paths/NNS/paths to/TO/to any/DT/any of/IN/of the/DT/the other/JJ/other three/CD/three subtrees/NNS/subtrees illustrated/VBN/illustrated in/IN/in figure/NN/figure 11.38/CD/11.38 remains/VBZ/remains unchanged/NNP/unchanged. resolving/NN/resolving this/DT/this case/NN/case corresponds/VBZ/corresponds to/TO/to a/DT/a transfer/NN/transfer operation/NN/operation in/IN/in the/DT/the /NN/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_ between/IN/between the/DT/the two/CD/two children/NNS/children of/IN/of the/DT/the node/NN/node with/IN/with z/NNP/z. the/DT/the fact/NN/fact that/IN/that y/NN/y has/VBZ/has a/DT/a red/VBN/red child/NN/child assures/NNS/assures us/PRP/us that/IN/that it/PRP/it represents/VBZ/represents either/DT/either a/DT/a 3-node/JJ/3-node or/CC/or a/DT/a 4-node/CD/4-node. in/IN/in effect/NN/effect /,/, the/DT/the item/NN/item previously/RB/previously stored/VBD/stored at/IN/at z/NN/z is/VBZ/is demoted/VBN/demoted to/TO/to become/VB/become a/DT/a new/JJ/new 2-node/JJ/2-node to/TO/to resolve/VB/resolve the/DT/the deficiency/NN/deficiency /,/, while/IN/while an/DT/an item/NN/item stored/VBD/stored at/IN/at y/NN/y or/CC/or its/PRP$/its child/NN/child is/VBZ/is promoted/VBN/promoted to/TO/to take/VB/take the/DT/the place/NN/place of/IN/of the/DT/the item/NN/item previously/RB/previously stored/VBD/stored at/IN/at z/NNP/z. figure/NN/figure 11.38/CD/11.38 /:/: resolving/VBG/resolving a/DT/a black/JJ/black deficit/NN/deficit in/IN/in tlight/NN/tlight by/IN/by performing/VBG/performing a/DT/a trinode/NN/trinode restructuring/VBG/restructuring as/IN/as restructure/NN/restructure /:/( x/NN/x /:/) /./. two/CD/two possible/JJ/possible configurations/NNS/configurations are/VBP/are shown/VBN/shown /-NONE-/( two/CD/two other/JJ/other configurations/NNS/configurations are/VBP/are symmetric/JJ/symmetric /NN/) /./. the/DT/the gray/NN/gray color/NN/color of/IN/of z/NN/z in/IN/in the/DT/the left/NN/left figures/NNS/figures denotes/VBZ/denotes the/DT/the fact/NN/fact that/IN/that this/DT/this node/NN/node may/MD/may be/VB/be colored/VBN/colored either/DT/either red/VBN/red or/CC/or black/NNP/black. the/DT/the root/NN/root of/IN/of the/DT/the restructured/VBN/restructured portion/NN/portion is/VBZ/is given/VBN/given that/IN/that same/JJ/same color/NN/color /,/, while/IN/while the/DT/the children/NNS/children of/IN/of that/DT/that node/NN/node are/VBP/are both/DT/both colored/VBN/colored black/NN/black in/IN/in the/DT/the result/NNP/result. 11.6/NNP/11.6. red-black/NNP/red-black trees/VBZ/trees 521/CD/521 case/NN/case 2/CD/2 /:/: node/NN/node y/NN/y is/VBZ/is black/JJ/black and/CC/and both/DT/both children/NNS/children of/IN/of y/NN/y are/VBP/are black/JJ/black /NN/( or/CC/or none/NN/none /:/) /./. resolving/NN/resolving this/DT/this case/NN/case corresponds/VBZ/corresponds to/TO/to a/DT/a fusion/NN/fusion operation/NN/operation in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_ /,/, as/IN/as y/NN/y must/MD/must represent/VB/represent a/DT/a 2-node/CD/2-node. we/PRP/we do/VBP/do a/DT/a recoloring/VBG/recoloring ;/:/; we/PRP/we color/VBP/color y/JJ/y red/VBN/red /,/, and/CC/and /,/, if/IN/if z/NN/z is/VBZ/is red/VBN/red /,/, we/PRP/we color/VBP/color it/PRP/it black/NNP/black. /:/( see/VB/see figure/NN/figure 11.39/CD/11.39 /CD/) /./. this/DT/this does/VBZ/does not/RB/not introduce/VB/introduce any/DT/any red/VBN/red violation/NN/violation /,/, because/IN/because y/NN/y does/VBZ/does not/RB/not have/VB/have a/DT/a red/VBN/red child/NNP/child. in/IN/in the/DT/the case/NN/case that/IN/that z/NN/z was/VBD/was originally/RB/originally red/VBN/red /,/, and/CC/and thus/RB/thus the/DT/the parent/NN/parent in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree is/VBZ/is a/DT/a 3-node/JJ/3-node or/CC/or 4-node/CD/4-node /,/, this/DT/this recoloring/NN/recoloring resolves/VBZ/resolves the/DT/the deficit/NNP/deficit. /NNP/( see/VB/see figure/NN/figure 11.39a/CD/11.39a. /CD/) the/DT/the path/NN/path leading/VBG/leading to/TO/to tlight/NN/tlight includes/VBZ/includes one/CD/one additional/JJ/additional black/JJ/black node/NN/node in/IN/in the/DT/the result/NN/result /,/, while/IN/while the/DT/the recoloring/NN/recoloring did/VBD/did not/RB/not affect/VB/affect the/DT/the number/NN/number of/IN/of black/JJ/black nodes/NNS/nodes on/IN/on the/DT/the path/NN/path to/TO/to the/DT/the subtrees/NNS/subtrees of/IN/of theavy/NNP/theavy. in/IN/in the/DT/the case/NN/case that/IN/that z/NN/z was/VBD/was originally/RB/originally black/JJ/black /,/, and/CC/and thus/RB/thus the/DT/the parent/NN/parent in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree is/VBZ/is a/DT/a 2-node/JJ/2-node /,/, the/DT/the recoloring/NN/recoloring has/VBZ/has not/RB/not increased/VBN/increased the/DT/the number/NN/number of/IN/of black/JJ/black nodes/NNS/nodes on/IN/on the/DT/the path/NN/path to/TO/to tlight/NN/tlight ;/:/; in/IN/in fact/NN/fact /,/, it/PRP/it has/VBZ/has reduced/VBN/reduced the/DT/the number/NN/number of/IN/of black/JJ/black nodes/NNS/nodes on/IN/on the/DT/the path/NN/path to/TO/to theavy/NNP/theavy. /NNP/( see/VB/see figure/NN/figure 11.39b/CD/11.39b. /CD/) after/IN/after this/DT/this step/NN/step /,/, the/DT/the two/CD/two children/NNS/children of/IN/of z/NN/z will/MD/will have/VB/have the/DT/the same/JJ/same black/NN/black height/NNP/height. however/RB/however /,/, the/DT/the entire/JJ/entire tree/NN/tree rooted/VBD/rooted at/IN/at z/NN/z has/VBZ/has become/VBN/become deficient/NN/deficient /,/, thereby/RB/thereby propogating/VBG/propogating the/DT/the problem/NN/problem higher/JJR/higher in/IN/in the/DT/the tree/NN/tree ;/:/; we/PRP/we must/MD/must repeat/VB/repeat consideration/NN/consideration of/IN/of all/DT/all three/CD/three cases/NNS/cases at/IN/at the/DT/the parent/NN/parent of/IN/of z/NN/z as/IN/as a/DT/a remedy/NNP/remedy. figure/NN/figure 11.39/CD/11.39 /:/: resolving/VBG/resolving a/DT/a black/JJ/black deficit/NN/deficit in/IN/in tlight/NN/tlight by/IN/by a/DT/a recoloring/NN/recoloring operation/NN/operation /:/: /:/( a/DT/a /NN/) when/WRB/when z/NN/z is/VBZ/is originally/RB/originally red/VBN/red /,/, reversing/NN/reversing the/DT/the colors/NNS/colors of/IN/of y/NN/y and/CC/and z/NN/z resolves/NNS/resolves the/DT/the black/JJ/black deficit/NN/deficit in/IN/in tlight/NN/tlight /,/, ending/VBG/ending the/DT/the process/NN/process ;/:/; /:/( b/NN/b /:/) when/WRB/when z/NN/z is/VBZ/is originally/RB/originally black/JJ/black /,/, recoloring/NN/recoloring y/NN/y causes/NNS/causes the/DT/the entire/JJ/entire subtree/NN/subtree of/IN/of z/NN/z to/TO/to have/VB/have a/DT/a black/JJ/black deficit/NN/deficit /,/, requiring/VBG/requiring a/DT/a cascading/NN/cascading remedy/NNP/remedy. 522/CD/522 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees case/NN/case 3/CD/3 /:/: node/JJ/node y/NN/y is/VBZ/is red/NNP/red. /:/( see/VB/see figure/NN/figure 11.40/CD/11.40. /CD/) because/IN/because y/JJ/y is/VBZ/is red/VBN/red and/CC/and theavy/JJ/theavy has/VBZ/has black/JJ/black depth/NN/depth at/IN/at least/JJS/least 1/CD/1 /,/, z/NN/z must/MD/must be/VB/be black/JJ/black and/CC/and the/DT/the two/CD/two subtrees/NNS/subtrees of/IN/of y/NN/y must/MD/must each/VB/each have/VB/have a/DT/a black/JJ/black root/NN/root and/CC/and a/DT/a black/JJ/black depth/NN/depth equal/JJ/equal to/TO/to that/DT/that of/IN/of theavy/NNP/theavy. in/IN/in this/DT/this case/NN/case /,/, we/PRP/we perform/VBP/perform a/DT/a rotation/NN/rotation about/IN/about y/NN/y and/CC/and z/NN/z /,/, and/CC/and then/RB/then recolor/VB/recolor y/NN/y black/NN/black and/CC/and z/NN/z red/NNP/red. this/DT/this denotes/VBZ/denotes a/DT/a reorientation/NN/reorientation of/IN/of a/DT/a 3-node/JJ/3-node in/IN/in the/DT/the corresponding/NN/corresponding /:/( 2,4/CD/2,4 /CD/) tree/NN/tree t_/NNP/t_. this/DT/this does/VBZ/does not/RB/not immediately/RB/immediately resolve/VB/resolve the/DT/the deficit/NN/deficit /,/, as/IN/as the/DT/the new/JJ/new subtree/NN/subtree of/IN/of z/NN/z is/VBZ/is an/DT/an old/JJ/old subtree/NN/subtree of/IN/of y/NN/y with/IN/with black/JJ/black root/NN/root y_/NNP/y_ and/CC/and black/VB/black height/NN/height equal/JJ/equal to/TO/to that/DT/that of/IN/of the/DT/the original/JJ/original theavy/NNP/theavy. we/PRP/we reapply/RB/reapply the/DT/the algorithm/NN/algorithm to/TO/to resolve/VB/resolve the/DT/the deficit/NN/deficit at/IN/at z/NN/z /,/, knowing/VBG/knowing that/IN/that the/DT/the new/JJ/new child/NN/child y_/NNP/y_ /,/, that/IN/that is/VBZ/is the/DT/the root/NN/root of/IN/of theavy/JJ/theavy is/VBZ/is now/RB/now black/JJ/black /,/, and/CC/and therefore/RB/therefore that/IN/that either/DT/either case/NN/case 1/CD/1 applies/NNS/applies or/CC/or case/NN/case 2/CD/2 applies/NNP/applies. furthermore/NN/furthermore /,/, the/DT/the next/JJ/next application/NN/application will/MD/will be/VB/be the/DT/the last/JJ/last /,/, because/IN/because case/NN/case 1/CD/1 is/VBZ/is always/RB/always terminal/JJ/terminal and/CC/and case/NN/case 2/CD/2 will/MD/will be/VB/be terminal/JJ/terminal given/VBN/given that/IN/that z/NN/z is/VBZ/is red/NNP/red. figure/NN/figure 11.40/CD/11.40 /:/: a/DT/a rotation/NN/rotation and/CC/and recoloring/VBG/recoloring about/IN/about red/JJ/red node/NN/node y/NN/y and/CC/and black/JJ/black node/NN/node z/NN/z /,/, assuming/VBG/assuming a/DT/a black/JJ/black deficit/NN/deficit at/IN/at z/NNP/z. this/DT/this amounts/VBZ/amounts to/TO/to a/DT/a change/NN/change of/IN/of orientation/NN/orientation in/IN/in the/DT/the corresponding/NN/corresponding 3-node/CD/3-node of/IN/of a/DT/a /NN/( 2,4/CD/2,4 /CD/) tree/NNP/tree. this/DT/this operation/NN/operation does/VBZ/does not/RB/not affect/VB/affect the/DT/the black/JJ/black depth/NN/depth of/IN/of any/DT/any paths/NNS/paths through/IN/through this/DT/this portion/NN/portion of/IN/of the/DT/the tree/NNP/tree. furthermore/NN/furthermore /,/, because/IN/because y/NN/y was/VBD/was originally/RB/originally red/VBN/red /,/, the/DT/the new/JJ/new subtree/NN/subtree of/IN/of z/NN/z must/MD/must have/VB/have a/DT/a black/JJ/black root/NN/root y_/NNP/y_ and/CC/and must/MD/must have/VB/have black/JJ/black height/NN/height equal/JJ/equal to/TO/to the/DT/the original/JJ/original theavy/NNP/theavy. therefore/NN/therefore /,/, a/DT/a black/JJ/black deficit/NN/deficit remains/VBZ/remains at/IN/at node/NN/node z/NN/z after/IN/after the/DT/the transformation/NNP/transformation. in/IN/in figure/NN/figure 11.41/CD/11.41 /,/, we/PRP/we show/VBP/show a/DT/a sequence/NN/sequence of/IN/of deletions/NNS/deletions on/IN/on a/DT/a red-black/JJ/red-black tree/NNP/tree. a/DT/a dashed/JJ/dashed edge/NN/edge in/IN/in those/DT/those figures/NNS/figures /,/, such/JJ/such as/IN/as to/TO/to the/DT/the right/NN/right of/IN/of 7/CD/7 in/IN/in part/NN/part /:/( c/NN/c /:/) /,/, represents/VBZ/represents a/DT/a branch/NN/branch with/IN/with a/DT/a black/JJ/black deficiency/NN/deficiency that/WDT/that has/VBZ/has not/RB/not yet/RB/yet been/VBN/been resolved/NNP/resolved. we/PRP/we illustrate/VBP/illustrate a/DT/a case/NN/case 1/CD/1 restructuring/NN/restructuring in/IN/in parts/NNS/parts /:/( c/NN/c /:/) and/CC/and /:/( d/NN/d /:/) /./. we/PRP/we illustrate/VBP/illustrate a/DT/a case/NN/case 2/CD/2 recoloring/VBG/recoloring in/IN/in parts/NNS/parts /:/( f/NN/f /:/) and/CC/and /:/( g/NN/g /:/) /./. finally/RB/finally /,/, we/PRP/we show/VBP/show an/DT/an example/NN/example of/IN/of a/DT/a case/NN/case 3/CD/3 rotation/NN/rotation between/IN/between parts/NNS/parts /:/( i/PRP/i /VBP/) and/CC/and /NNP/( j/NN/j /:/) /,/, concluding/VBG/concluding with/IN/with a/DT/a case/NN/case 2/CD/2 recoloring/VBG/recoloring in/IN/in part/NN/part /:/( k/NN/k /:/) /./. 11.6/CD/11.6. red-black/JJ/red-black trees/NNS/trees 523/CD/523 figure/NN/figure 11.41/CD/11.41 /:/: a/DT/a sequence/NN/sequence of/IN/of deletions/NNS/deletions from/IN/from a/DT/a red-black/JJ/red-black tree/NN/tree /:/: /:/( a/DT/a /NN/) initial/JJ/initial tree/NN/tree ;/:/; /:/( b/NN/b /:/) removal/NN/removal of/IN/of 3/CD/3 ;/:/; /:/( c/NN/c /:/) removal/NN/removal of/IN/of 12/CD/12 /,/, causing/VBG/causing a/DT/a black/JJ/black deficit/NN/deficit to/TO/to the/DT/the right/NN/right of/IN/of 7/CD/7 /CD/( handled/VBN/handled by/IN/by restructuring/NN/restructuring /:/) ;/:/; /:/( d/NN/d /:/) after/IN/after restructuring/NN/restructuring ;/:/; /:/( e/NN/e /:/) removal/NN/removal of/IN/of 17/CD/17 ;/:/; /:/( f/NN/f /:/) removal/NN/removal of/IN/of 18/CD/18 /,/, causing/VBG/causing a/DT/a black/JJ/black deficit/NN/deficit to/TO/to the/DT/the right/NN/right of/IN/of 16/CD/16 /CD/( handled/VBN/handled by/IN/by recoloring/NN/recoloring /:/) ;/:/; /:/( g/NN/g /:/) after/IN/after recoloring/NN/recoloring ;/:/; /:/( h/NN/h /:/) removal/NN/removal of/IN/of 15/CD/15 ;/:/; /:/( i/PRP/i /VBP/) removal/JJ/removal of/IN/of 16/CD/16 /,/, causing/VBG/causing a/DT/a black/JJ/black deficit/NN/deficit to/TO/to the/DT/the right/NN/right of/IN/of 14/CD/14 /CD/( handled/VBN/handled initially/RB/initially by/IN/by a/DT/a rotation/NN/rotation /:/) ;/:/; /:/( j/NN/j /:/) after/IN/after the/DT/the rotation/NN/rotation the/DT/the black/JJ/black deficit/NN/deficit needs/VBZ/needs to/TO/to be/VB/be handled/VBN/handled by/IN/by a/DT/a recoloring/NN/recoloring ;/:/; /:/( k/NN/k /:/) after/IN/after the/DT/the recoloring/NNP/recoloring. 524/CD/524 chapter/NN/chapter 11/CD/11. search/NN/search trees/NNS/trees performance/NN/performance of/IN/of red-black/JJ/red-black trees/NNS/trees the/DT/the asymptotic/JJ/asymptotic performance/NN/performance of/IN/of a/DT/a red-black/JJ/red-black tree/NN/tree is/VBZ/is identical/JJ/identical to/TO/to that/DT/that of/IN/of an/DT/an avl/NN/avl tree/NN/tree or/CC/or a/DT/a /CD/( 2,4/CD/2,4 /CD/) tree/NN/tree in/IN/in terms/NNS/terms of/IN/of the/DT/the sorted/VBN/sorted map/NN/map adt/NN/adt /,/, with/IN/with guaranteed/NN/guaranteed logarithmic/JJ/logarithmic time/NN/time bounds/NNS/bounds for/IN/for most/JJS/most operations/NNP/operations. /NNP/( see/VB/see table/JJ/table 11.2/CD/11.2 for/IN/for a/DT/a summary/NN/summary of/IN/of the/DT/the avl/NN/avl performance/NNP/performance. /NNP/) the/DT/the primary/JJ/primary advantage/NN/advantage of/IN/of a/DT/a red-black/JJ/red-black tree/NN/tree is/VBZ/is that/IN/that an/DT/an insertion/NN/insertion or/CC/or deletion/NN/deletion requires/VBZ/requires only/RB/only a/DT/a constant/JJ/constant number/NN/number of/IN/of restructuring/NN/restructuring operations/NNP/operations. /NNP/( this/DT/this is/VBZ/is in/IN/in contrast/NN/contrast to/TO/to avl/VB/avl trees/NNS/trees and/CC/and /:/( 2,4/CD/2,4 /CD/) trees/NNS/trees /,/, both/DT/both of/IN/of which/WDT/which require/NN/require a/DT/a logarithmic/JJ/logarithmic number/NN/number of/IN/of structural/JJ/structural changes/NNS/changes per/IN/per map/NN/map operation/NN/operation in/IN/in the/DT/the worst/JJS/worst case/NNP/case. /NNP/) that/IN/that is/VBZ/is /,/, an/DT/an insertion/NN/insertion or/CC/or deletion/NN/deletion in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree requires/VBZ/requires logarithmic/JJ/logarithmic time/NN/time for/IN/for a/DT/a search/NN/search /,/, and/CC/and may/MD/may require/VB/require a/DT/a logarithmic/JJ/logarithmic number/NN/number of/IN/of recoloring/VBG/recoloring operations/NNS/operations that/WDT/that cascade/NN/cascade upward/NNP/upward. yet/CC/yet we/PRP/we show/VBP/show /,/, in/IN/in the/DT/the following/JJ/following propositions/NNS/propositions /,/, that/IN/that there/EX/there are/VBP/are a/DT/a constant/JJ/constant number/NN/number of/IN/of rotations/NNS/rotations or/CC/or restructure/VB/restructure operations/NNS/operations for/IN/for a/DT/a single/JJ/single map/NN/map operation/NNP/operation. proposition/NN/proposition 11.10/CD/11.10 /:/: the/DT/the insertion/NN/insertion of/IN/of an/DT/an item/NN/item in/IN/in a/DT/a red-black/JJ/red-black tree/NN/tree storing/VBG/storing n/NN/n items/NNS/items can/MD/can be/VB/be done/VBN/done in/IN/in o/NN/o /:/( logn/NN/logn /:/) time/NN/time and/CC/and requires/VBZ/requires o/NN/o /:/( logn/NN/logn /:/) recolorings/NNS/recolorings and/CC/and at/IN/at most/JJS/most one/CD/one trinode/NN/trinode restructuring/NNP/restructuring. justification/NN/justification /:/: recall/NN/recall that/IN/that an/DT/an insertion/NN/insertion begins/VBZ/begins with/IN/with a/DT/a downward/JJ/downward search/NN/search /,/, the/DT/the creation/NN/creation of/IN/of a/DT/a new/JJ/new leaf/NN/leaf node/NN/node /,/, and/CC/and then/RB/then a/DT/a potential/JJ/potential upward/NN/upward effort/NN/effort to/TO/to remedy/VB/remedy a/DT/a double-red/JJ/double-red violation/NNP/violation. there/RB/there may/MD/may be/VB/be logarithmically/RB/logarithmically many/JJ/many recoloring/VBG/recoloring operations/NNS/operations due/JJ/due to/TO/to an/DT/an upward/NN/upward cascading/VBG/cascading of/IN/of case/NN/case 2/CD/2 applications/NNS/applications /,/, but/CC/but a/DT/a single/JJ/single application/NN/application of/IN/of the/DT/the case/NN/case 1/CD/1 action/NN/action eliminates/NNS/eliminates the/DT/the double-red/JJ/double-red problem/NN/problem with/IN/with a/DT/a trinode/NN/trinode restructuring/NNP/restructuring. therefore/RB/therefore /,/, at/IN/at most/JJS/most one/CD/one restructuring/NN/restructuring operation/NN/operation is/VBZ/is needed/VBN/needed for/IN/for a/DT/a red-black/JJ/red-black tree/NN/tree insertion/NNP/insertion. proposition/NN/proposition 11.11/CD/11.11 /:/: the/DT/the algorithm/NN/algorithm for/IN/for deleting/NN/deleting an/DT/an item/NN/item from/IN/from a/DT/a red-black/JJ/red-black tree/NN/tree with/IN/with n/NN/n items/NNS/items takes/VBZ/takes o/NN/o /:/( log/NN/log n/NN/n /:/) time/NN/time and/CC/and performs/NNS/performs o/VBP/o /:/( log/NN/log n/NN/n /:/) recolorings/NNS/recolorings and/CC/and at/IN/at most/JJS/most two/CD/two restructuring/VBG/restructuring operations/NNP/operations. justification/NN/justification /:/: a/DT/a deletion/NN/deletion begins/VBZ/begins with/IN/with the/DT/the standard/JJ/standard binary/NN/binary search/NN/search tree/NN/tree deletion/NN/deletion algorithm/NN/algorithm /,/, which/WDT/which requires/VBZ/requires time/NN/time proportional/JJ/proportional to/TO/to the/DT/the height/NN/height of/IN/of the/DT/the tree/NN/tree ;/:/; for/IN/for red-black/JJ/red-black trees/NNS/trees /,/, that/IN/that height/NN/height is/VBZ/is o/RB/o /:/( logn/NN/logn /:/) /./. the/DT/the subsequent/JJ/subsequent rebalancing/NN/rebalancing takes/VBZ/takes place/NN/place along/IN/along an/DT/an upward/NN/upward path/NN/path from/IN/from the/DT/the parent/NN/parent of/IN/of a/DT/a deleted/VBN/deleted node/NNP/node. we/PRP/we considered/VBD/considered three/CD/three cases/NNS/cases to/TO/to remedy/VB/remedy a/DT/a resulting/VBG/resulting black/NN/black deficit/NNP/deficit. case/NN/case 1/CD/1 requires/NNS/requires a/DT/a trinode/NN/trinode restructuring/VBG/restructuring operation/NN/operation /,/, yet/CC/yet completes/NNS/completes the/DT/the process/NN/process /,/, so/RB/so this/DT/this case/NN/case is/VBZ/is applied/VBN/applied at/IN/at most/JJS/most once/NNP/once. case/NN/case 2/CD/2 may/MD/may be/VB/be applied/VBN/applied logarithmically/RB/logarithmically many/JJ/many times/NNS/times /,/, but/CC/but it/PRP/it only/RB/only involves/VBZ/involves a/DT/a recoloring/NN/recoloring of/IN/of up/IN/up to/TO/to two/CD/two nodes/NNS/nodes per/IN/per application/NNP/application. case/NN/case 3/CD/3 requires/NNS/requires a/DT/a rotation/NN/rotation /,/, but/CC/but this/DT/this case/NN/case can/MD/can only/RB/only apply/RB/apply once/RB/once /,/, because/IN/because if/IN/if the/DT/the rotation/NN/rotation does/VBZ/does not/RB/not resolve/VB/resolve the/DT/the problem/NN/problem /,/, the/DT/the very/JJ/very next/JJ/next action/NN/action will/MD/will be/VB/be a/DT/a terminal/JJ/terminal application/NN/application of/IN/of either/DT/either case/NN/case 1/CD/1 or/CC/or case/NN/case 2/CD/2. in/IN/in the/DT/the worst/JJS/worst case/NN/case /,/, there/EX/there will/MD/will be/VB/be o/RB/o /-NONE-/( logn/NN/logn /:/) recolorings/NNS/recolorings from/IN/from case/NN/case 2/CD/2 /,/, a/DT/a single/JJ/single rotation/NN/rotation from/IN/from case/NN/case 3/CD/3 /,/, and/CC/and a/DT/a trinode/NN/trinode restructuring/VBG/restructuring from/IN/from case/NN/case 1/CD/1. 11.6/CD/11.6. red-black/JJ/red-black trees/NNS/trees 525/CD/525 11.6.2/CD/11.6.2 python/NN/python implementation/NN/implementation a/DT/a complete/JJ/complete implementation/NN/implementation of/IN/of a/DT/a redblacktreemap/NN/redblacktreemap class/NN/class is/VBZ/is provided/VBN/provided in/IN/in code/NN/code fragments/NNS/fragments 11.15/CD/11.15 through/IN/through 11.17/CD/11.17. it/PRP/it inherits/VBZ/inherits from/IN/from the/DT/the standard/JJ/standard treemap/NN/treemap class/NN/class and/CC/and relies/NNS/relies on/IN/on the/DT/the balancing/NN/balancing framework/NN/framework described/VBD/described in/IN/in section/NN/section 11.2.1/CD/11.2.1. we/PRP/we begin/VBP/begin /,/, in/IN/in code/NN/code fragment/NN/fragment 11.15/CD/11.15 /,/, by/IN/by overriding/NN/overriding the/DT/the definition/NN/definition of/IN/of the/DT/the nested/VBN/nested node/NN/node class/NN/class to/TO/to introduce/VB/introduce an/DT/an additional/JJ/additional boolean/JJ/boolean field/NN/field to/TO/to denote/VB/denote the/DT/the current/JJ/current color/NN/color of/IN/of a/DT/a node/NNP/node. our/PRP$/our constructor/NN/constructor intentionally/RB/intentionally sets/VBZ/sets the/DT/the color/NN/color of/IN/of a/DT/a new/JJ/new node/NN/node to/TO/to red/VBN/red to/TO/to be/VB/be consistent/JJ/consistent with/IN/with our/PRP$/our approach/NN/approach for/IN/for inserting/NN/inserting items/NNP/items. we/PRP/we define/VBP/define several/JJ/several additional/JJ/additional utility/NN/utility functions/NNS/functions /,/, at/IN/at the/DT/the top/JJ/top of/IN/of code/NN/code fragment/NN/fragment 11.16/CD/11.16 /,/, that/IN/that aid/NN/aid in/IN/in setting/NN/setting the/DT/the color/NN/color of/IN/of nodes/NNS/nodes and/CC/and querying/VBG/querying various/JJ/various conditions/NNP/conditions. when/WRB/when an/DT/an element/NN/element has/VBZ/has been/VBN/been inserted/VBN/inserted as/IN/as a/DT/a leaf/NN/leaf in/IN/in the/DT/the tree/NN/tree /,/, the/DT/the rebalance/NN/rebalance insert/NN/insert hook/NN/hook is/VBZ/is called/VBN/called /,/, allowing/NN/allowing us/PRP/us the/DT/the opportunity/NN/opportunity to/TO/to modify/VB/modify the/DT/the tree/NNP/tree. the/DT/the new/JJ/new node/NN/node is/VBZ/is red/VBN/red by/IN/by default/NN/default /,/, so/RB/so we/PRP/we need/VBP/need only/RB/only look/VBP/look for/IN/for the/DT/the special/JJ/special case/NN/case of/IN/of the/DT/the new/JJ/new node/NN/node being/VBG/being the/DT/the root/NN/root /:/( in/IN/in which/WDT/which case/NN/case it/PRP/it should/MD/should be/VB/be colored/VBN/colored black/RP/black /:/) /,/, or/CC/or the/DT/the possibility/NN/possibility that/IN/that we/PRP/we have/VBP/have a/DT/a double-red/JJ/double-red violation/NN/violation because/IN/because the/DT/the new/JJ/new node/NN/node s/NNS/s parent/NN/parent is/VBZ/is also/RB/also red/NNP/red. to/TO/to remedy/VB/remedy such/JJ/such violations/NNS/violations /,/, we/PRP/we closely/RB/closely follow/VBP/follow the/DT/the case/NN/case analysis/NN/analysis described/VBD/described in/IN/in section/NN/section 11.6.1/CD/11.6.1. the/DT/the rebalancing/NN/rebalancing after/IN/after a/DT/a deletion/NN/deletion also/RB/also follows/VBZ/follows the/DT/the case/NN/case analysis/NN/analysis described/VBD/described in/IN/in section/NN/section 11.6.1/CD/11.6.1. an/DT/an additional/JJ/additional challenge/NN/challenge is/VBZ/is that/IN/that by/IN/by the/DT/the time/NN/time the/DT/the rebalance/NN/rebalance hook/NN/hook is/VBZ/is called/VBN/called /,/, the/DT/the old/JJ/old node/NN/node has/VBZ/has already/RB/already been/VBN/been removed/VBN/removed from/IN/from the/DT/the tree/NNP/tree. that/IN/that hook/NN/hook is/VBZ/is invoked/VBN/invoked on/IN/on the/DT/the parent/NN/parent of/IN/of the/DT/the removed/VBN/removed node/NNP/node. some/DT/some of/IN/of the/DT/the case/NN/case analysis/NN/analysis depends/NNS/depends on/IN/on knowing/VBG/knowing about/IN/about the/DT/the properties/NNS/properties of/IN/of the/DT/the removed/VBN/removed node/NNP/node. fortunately/RB/fortunately /,/, we/PRP/we can/MD/can reverse/VB/reverse engineer/NN/engineer that/WDT/that information/NN/information by/IN/by relying/VBG/relying on/IN/on the/DT/the red-black/JJ/red-black tree/NN/tree properties/NNP/properties. in/IN/in particular/JJ/particular /,/, if/IN/if p/NN/p denotes/NNS/denotes the/DT/the parent/NN/parent of/IN/of the/DT/the removed/VBN/removed node/NN/node /,/, it/PRP/it must/MD/must be/VB/be that/IN/that /:/: if/IN/if p/NN/p has/VBZ/has no/DT/no children/NNS/children /,/, the/DT/the removed/VBN/removed node/NN/node was/VBD/was a/DT/a red/VBN/red leaf/NNP/leaf. /NNP/( exercise/NN/exercise r-11.26/NNP/r-11.26. /NNP/) if/IN/if p/NN/p has/VBZ/has one/CD/one child/NN/child /,/, the/DT/the removed/VBN/removed node/NN/node was/VBD/was a/DT/a black/JJ/black leaf/NN/leaf /,/, causing/VBG/causing a/DT/a deficit/NN/deficit /,/, unless/IN/unless that/DT/that one/CD/one remaining/VBG/remaining child/NN/child is/VBZ/is a/DT/a red/VBN/red leaf/NNP/leaf. /NNP/( exercise/NN/exercise r-11.27/NNP/r-11.27. /NNP/) if/IN/if p/NN/p has/VBZ/has two/CD/two children/NNS/children /,/, the/DT/the removed/VBN/removed node/NN/node was/VBD/was a/DT/a black/JJ/black node/NN/node with/IN/with one/CD/one red/VBN/red child/NN/child /,/, which/WDT/which was/VBD/was promoted/NNP/promoted. 